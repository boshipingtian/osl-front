(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[1551],{81618:function(rr){"use strict";(function(G,D){rr.exports=D()})(this,function(){function G(se){var le=[];return se.AMapUI&&le.push(D(se.AMapUI)),se.Loca&&le.push(oe(se.Loca)),Promise.all(le)}function D(se){return new Promise(function(le,ye){var Ce=[];if(se.plugins)for(var Oe=0;Oe<se.plugins.length;Oe+=1)ce.AMapUI.plugins.indexOf(se.plugins[Oe])==-1&&Ce.push(se.plugins[Oe]);if(J.AMapUI===E.failed)ye("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(J.AMapUI===E.notload){J.AMapUI=E.loading,ce.AMapUI.version=se.version||ce.AMapUI.version,Oe=ce.AMapUI.version;var Ue=document.body||document.head,pt=document.createElement("script");pt.type="text/javascript",pt.src="https://webapi.amap.com/ui/"+Oe+"/main.js",pt.onerror=function(Ge){J.AMapUI=E.failed,ye("\u8BF7\u6C42 AMapUI \u5931\u8D25")},pt.onload=function(){if(J.AMapUI=E.loaded,Ce.length)window.AMapUI.loadUI(Ce,function(){for(var Ge=0,lt=Ce.length;Ge<lt;Ge++){var Je=Ce[Ge].split("/").slice(-1)[0];window.AMapUI[Je]=arguments[Ge]}for(le();U.AMapUI.length;)U.AMapUI.splice(0,1)[0]()});else for(le();U.AMapUI.length;)U.AMapUI.splice(0,1)[0]()},Ue.appendChild(pt)}else J.AMapUI===E.loaded?se.version&&se.version!==ce.AMapUI.version?ye("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Ce.length?window.AMapUI.loadUI(Ce,function(){for(var Ge=0,lt=Ce.length;Ge<lt;Ge++){var Je=Ce[Ge].split("/").slice(-1)[0];window.AMapUI[Je]=arguments[Ge]}le()}):le():se.version&&se.version!==ce.AMapUI.version?ye("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):U.AMapUI.push(function(Ge){Ge?ye(Ge):Ce.length?window.AMapUI.loadUI(Ce,function(){for(var lt=0,Je=Ce.length;lt<Je;lt++){var Ye=Ce[lt].split("/").slice(-1)[0];window.AMapUI[Ye]=arguments[lt]}le()}):le()})})}function oe(se){return new Promise(function(le,ye){if(J.Loca===E.failed)ye("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(J.Loca===E.notload){J.Loca=E.loading,ce.Loca.version=se.version||ce.Loca.version;var Ce=ce.Loca.version,Oe=ce.AMap.version.startsWith("2"),Ue=Ce.startsWith("2");if(Oe&&!Ue||!Oe&&Ue)ye("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{Oe=ce.key,Ue=document.body||document.head;var pt=document.createElement("script");pt.type="text/javascript",pt.src="https://webapi.amap.com/loca?v="+Ce+"&key="+Oe,pt.onerror=function(Ge){J.Loca=E.failed,ye("\u8BF7\u6C42 AMapUI \u5931\u8D25")},pt.onload=function(){for(J.Loca=E.loaded,le();U.Loca.length;)U.Loca.splice(0,1)[0]()},Ue.appendChild(pt)}}else J.Loca===E.loaded?se.version&&se.version!==ce.Loca.version?ye("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):le():se.version&&se.version!==ce.Loca.version?ye("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):U.Loca.push(function(Ge){Ge?ye(Ge):ye()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var E;(function(se){se.notload="notload",se.loading="loading",se.loaded="loaded",se.failed="failed"})(E||(E={}));var ce={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},J={AMap:E.notload,AMapUI:E.notload,Loca:E.notload},U={AMap:[],AMapUI:[],Loca:[]},re=[],Y=function(se){typeof se=="function"&&(J.AMap===E.loaded?se(window.AMap):re.push(se))};return{load:function(se){return new Promise(function(le,ye){if(J.AMap==E.failed)ye("");else if(J.AMap==E.notload){var Ce=se.key,Oe=se.version,Ue=se.plugins;Ce?(window.AMap&&location.host!=="lbs.amap.com"&&ye("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),ce.key=Ce,ce.AMap.version=Oe||ce.AMap.version,ce.AMap.plugins=Ue||ce.AMap.plugins,J.AMap=E.loading,Oe=document.body||document.head,window.___onAPILoaded=function(Ge){if(delete window.___onAPILoaded,Ge)J.AMap=E.failed,ye(Ge);else for(J.AMap=E.loaded,G(se).then(function(){le(window.AMap)}).catch(ye);re.length;)re.splice(0,1)[0]()},Ue=document.createElement("script"),Ue.type="text/javascript",Ue.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+ce.AMap.version+"&key="+Ce+"&plugin="+ce.AMap.plugins.join(","),Ue.onerror=function(Ge){J.AMap=E.failed,ye(Ge)},Oe.appendChild(Ue)):ye("\u8BF7\u586B\u5199key")}else if(J.AMap==E.loaded)if(se.key&&se.key!==ce.key)ye("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(se.version&&se.version!==ce.AMap.version)ye("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(Ce=[],se.plugins)for(Oe=0;Oe<se.plugins.length;Oe+=1)ce.AMap.plugins.indexOf(se.plugins[Oe])==-1&&Ce.push(se.plugins[Oe]);Ce.length?window.AMap.plugin(Ce,function(){G(se).then(function(){le(window.AMap)}).catch(ye)}):G(se).then(function(){le(window.AMap)}).catch(ye)}else if(se.key&&se.key!==ce.key)ye("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(se.version&&se.version!==ce.AMap.version)ye("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var pt=[];if(se.plugins)for(Oe=0;Oe<se.plugins.length;Oe+=1)ce.AMap.plugins.indexOf(se.plugins[Oe])==-1&&pt.push(se.plugins[Oe]);Y(function(){pt.length?window.AMap.plugin(pt,function(){G(se).then(function(){le(window.AMap)}).catch(ye)}):G(se).then(function(){le(window.AMap)}).catch(ye)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,ce={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},J={AMap:E.notload,AMapUI:E.notload,Loca:E.notload},U={AMap:[],AMapUI:[],Loca:[]}}}})},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(rr){try{let le=function(){U||(U=!0,ce())},ye=function(){try{J.documentElement.doScroll("left")}catch(Ce){return void setTimeout(ye,50)}le()};var se=le,Y=ye,G=(G=document.getElementsByTagName("script"))[G.length-1],D=G.getAttribute("data-injectcss"),G=G.getAttribute("data-disable-injectsvg");if(!G){var oe,E,ce,J,U,re=function(Oe,Ue){Ue.parentNode.insertBefore(Oe,Ue)};if(D&&!rr.__iconfont__svg__cssinject__){rr.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(Ce){console&&console.log(Ce)}}oe=function(){var Oe,Ue=document.createElement("div");Ue.innerHTML=rr._iconfont_svg_string_3580659,(Ue=Ue.getElementsByTagName("svg")[0])&&(Ue.setAttribute("aria-hidden","true"),Ue.style.position="absolute",Ue.style.width=0,Ue.style.height=0,Ue.style.overflow="hidden",Ue=Ue,(Oe=document.body).firstChild?re(Ue,Oe.firstChild):Oe.appendChild(Ue))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(oe,0):(E=function(){document.removeEventListener("DOMContentLoaded",E,!1),oe()},document.addEventListener("DOMContentLoaded",E,!1)):document.attachEvent&&(ce=oe,J=rr.document,U=!1,ye(),J.onreadystatechange=function(){J.readyState=="complete"&&(J.onreadystatechange=null,le())})}}catch(le){}}(window)},84242:function(rr,G,D){"use strict";D.d(G,{MK:function(){return b8},Ie:function(){return I6},Jx:function(){return q6}});var oe={};D.r(oe),D.d(oe,{add:function(){return Fm},adjoint:function(){return _m},clone:function(){return xv},copy:function(){return mm},create:function(){return Ro},determinant:function(){return ya},equals:function(){return Jp},exactEquals:function(){return Bm},frob:function(){return km},fromQuat:function(){return Mm},fromQuat2:function(){return Am},fromRotation:function(){return Sm},fromRotationTranslation:function(){return qp},fromRotationTranslationScale:function(){return rf},fromRotationTranslationScaleOrigin:function(){return wm},fromScaling:function(){return bv},fromTranslation:function(){return Sv},fromValues:function(){return Vh},fromXRotation:function(){return bm},fromYRotation:function(){return Em},fromZRotation:function(){return Ev},frustum:function(){return Rm},getRotation:function(){return Cm},getScaling:function(){return Av},getTranslation:function(){return Tm},identity:function(){return Hh},invert:function(){return jh},lookAt:function(){return Rv},mul:function(){return Zm},multiply:function(){return Ri},multiplyScalar:function(){return Nm},multiplyScalarAndAdd:function(){return Dm},ortho:function(){return Lm},orthoNO:function(){return Mv},orthoZO:function(){return Pm},perspective:function(){return Qp},perspectiveFromFieldOfView:function(){return wv},perspectiveNO:function(){return Tv},perspectiveZO:function(){return Cv},rotate:function(){return xm},rotateX:function(){return tf},rotateY:function(){return Wh},rotateZ:function(){return $h},scale:function(){return ef},set:function(){return gm},str:function(){return Om},sub:function(){return Um},subtract:function(){return Lv},targetTo:function(){return Im},translate:function(){return cc},transpose:function(){return ym}});var E={};D.r(E),D.d(E,{add:function(){return Xw},angle:function(){return Pg},bezier:function(){return aM},ceil:function(){return Yw},clone:function(){return jw},copy:function(){return Ww},create:function(){return Jh},cross:function(){return vS},dist:function(){return yM},distance:function(){return cS},div:function(){return gM},divide:function(){return lS},dot:function(){return dS},equals:function(){return vM},exactEquals:function(){return dM},floor:function(){return Kw},forEach:function(){return bM},fromValues:function(){return Va},hermite:function(){return iM},inverse:function(){return rM},len:function(){return xM},length:function(){return oS},lerp:function(){return nM},max:function(){return Qw},min:function(){return qw},mul:function(){return mM},multiply:function(){return sS},negate:function(){return pS},normalize:function(){return ep},random:function(){return oM},rotateX:function(){return lM},rotateY:function(){return cM},rotateZ:function(){return fM},round:function(){return Jw},scale:function(){return eM},scaleAndAdd:function(){return tM},set:function(){return $w},sqrDist:function(){return _M},sqrLen:function(){return SM},squaredDistance:function(){return fS},squaredLength:function(){return hS},str:function(){return pM},sub:function(){return Ig},subtract:function(){return uS},transformMat3:function(){return uM},transformMat4:function(){return yd},transformQuat:function(){return sM},zero:function(){return hM}});var ce=D(67294),J=(0,ce.createContext)({});function U(){return(0,ce.useContext)(J)}var re={},Y={},se=function(n){return Y[n]},le=function(n,t){Y[n]=t},ye=function(n){return re[n]},Ce=function(n,t){re[n]=t},Oe={},Ue={},pt=34,Ge=10,lt=13;function Je(e){return new Function("d","return {"+e.map(function(n,t){return JSON.stringify(n)+": d["+t+'] || ""'}).join(",")+"}")}function Ye(e,n){var t=Je(e);return function(i,r){return n(t(i),r,e)}}function Ke(e){var n=Object.create(null),t=[];return e.forEach(function(i){for(var r in i)r in n||t.push(n[r]=r)}),t}function xt(e,n){var t=e+"",i=t.length;return i<n?new Array(n-i+1).join(0)+t:t}function I(e){return e<0?"-"+xt(-e,6):e>9999?"+"+xt(e,6):xt(e,4)}function ht(e){var n=e.getUTCHours(),t=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":I(e.getUTCFullYear(),4)+"-"+xt(e.getUTCMonth()+1,2)+"-"+xt(e.getUTCDate(),2)+(r?"T"+xt(n,2)+":"+xt(t,2)+":"+xt(i,2)+"."+xt(r,3)+"Z":i?"T"+xt(n,2)+":"+xt(t,2)+":"+xt(i,2)+"Z":t||n?"T"+xt(n,2)+":"+xt(t,2)+"Z":"")}function Fe(e){var n=new RegExp('["'+e+`
\r]`),t=e.charCodeAt(0);function i(d,v){var y,x,S=r(d,function(M,O){if(y)return y(M,O-1);x=M,y=v?Ye(M,v):Je(M)});return S.columns=x||[],S}function r(d,v){var y=[],x=d.length,S=0,M=0,O,H=x<=0,W=!1;d.charCodeAt(x-1)===Ge&&--x,d.charCodeAt(x-1)===lt&&--x;function he(){if(H)return Ue;if(W)return W=!1,Oe;var Re,ze=S,ft;if(d.charCodeAt(ze)===pt){for(;S++<x&&d.charCodeAt(S)!==pt||d.charCodeAt(++S)===pt;);return(Re=S)>=x?H=!0:(ft=d.charCodeAt(S++))===Ge?W=!0:ft===lt&&(W=!0,d.charCodeAt(S)===Ge&&++S),d.slice(ze+1,Re-1).replace(/""/g,'"')}for(;S<x;){if((ft=d.charCodeAt(Re=S++))===Ge)W=!0;else if(ft===lt)W=!0,d.charCodeAt(S)===Ge&&++S;else if(ft!==t)continue;return d.slice(ze,Re)}return H=!0,d.slice(ze,x)}for(;(O=he())!==Ue;){for(var ve=[];O!==Oe&&O!==Ue;)ve.push(O),O=he();v&&(ve=v(ve,M++))==null||y.push(ve)}return y}function a(d,v){return d.map(function(y){return v.map(function(x){return h(y[x])}).join(e)})}function o(d,v){return v==null&&(v=Ke(d)),[v.map(h).join(e)].concat(a(d,v)).join(`
`)}function u(d,v){return v==null&&(v=Ke(d)),a(d,v).join(`
`)}function s(d){return d.map(l).join(`
`)}function l(d){return d.map(h).join(e)}function h(d){return d==null?"":d instanceof Date?ht(d):n.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:i,parseRows:r,format:o,formatBody:u,formatRows:s,formatRow:l,formatValue:h}}var ge=Fe(","),je=ge.parse,Be=ge.parseRows,tt=ge.format,_t=ge.formatBody,k=ge.formatRows,ne=ge.formatRow,P=ge.formatValue,L=D(85061),b=D(28991),de=D(38163),Te=D.n(de),we=63710088e-1,We={centimeters:we*100,centimetres:we*100,degrees:we/111325,feet:we*3.28084,inches:we*39.37,kilometers:we/1e3,kilometres:we/1e3,meters:we,metres:we,miles:we/1609.344,millimeters:we*1e3,millimetres:we*1e3,nauticalmiles:we/1852,radians:1,yards:we*1.0936},St={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/we,yards:1.0936133},ar={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function jt(e,n,t){t===void 0&&(t={});var i={type:"Feature"};return(t.id===0||t.id)&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.properties=n||{},i.geometry=e,i}function Or(e,n,t){switch(t===void 0&&(t={}),e){case"Point":return Wr(n).geometry;case"LineString":return Fn(n).geometry;case"Polygon":return pn(n).geometry;case"MultiPoint":return Tr(n).geometry;case"MultiLineString":return nn(n).geometry;case"MultiPolygon":return Vr(n).geometry;default:throw new Error(e+" is invalid")}}function Wr(e,n,t){if(t===void 0&&(t={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Gt(e[0])||!Gt(e[1]))throw new Error("coordinates must contain numbers");var i={type:"Point",coordinates:e};return jt(i,n,t)}function Zr(e,n,t){return t===void 0&&(t={}),gn(e.map(function(i){return Wr(i,n)}),t)}function pn(e,n,t){t===void 0&&(t={});for(var i=0,r=e;i<r.length;i++){var a=r[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:e};return jt(u,n,t)}function an(e,n,t){return t===void 0&&(t={}),gn(e.map(function(i){return pn(i,n)}),t)}function Fn(e,n,t){if(t===void 0&&(t={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:e};return jt(i,n,t)}function ln(e,n,t){return t===void 0&&(t={}),gn(e.map(function(i){return Fn(i,n)}),t)}function gn(e,n){n===void 0&&(n={});var t={type:"FeatureCollection"};return n.id&&(t.id=n.id),n.bbox&&(t.bbox=n.bbox),t.features=e,t}function nn(e,n,t){t===void 0&&(t={});var i={type:"MultiLineString",coordinates:e};return jt(i,n,t)}function Tr(e,n,t){t===void 0&&(t={});var i={type:"MultiPoint",coordinates:e};return jt(i,n,t)}function Vr(e,n,t){t===void 0&&(t={});var i={type:"MultiPolygon",coordinates:e};return jt(i,n,t)}function fi(e,n,t){t===void 0&&(t={});var i={type:"GeometryCollection",geometries:e};return jt(i,n,t)}function ti(e,n){if(n===void 0&&(n=0),n&&!(n>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,n||0);return Math.round(e*t)/t}function Zn(e,n){n===void 0&&(n="kilometers");var t=We[n];if(!t)throw new Error(n+" units is invalid");return e*t}function Ne(e,n){n===void 0&&(n="kilometers");var t=We[n];if(!t)throw new Error(n+" units is invalid");return e/t}function V(e,n){return $(Ne(e,n))}function Z(e){var n=e%360;return n<0&&(n+=360),n}function $(e){var n=e%(2*Math.PI);return n*180/Math.PI}function T(e){var n=e%360;return n*Math.PI/180}function xe(e,n,t){if(n===void 0&&(n="kilometers"),t===void 0&&(t="kilometers"),!(e>=0))throw new Error("length must be a positive number");return Zn(Ne(e,n),t)}function vt(e,n,t){if(n===void 0&&(n="meters"),t===void 0&&(t="kilometers"),!(e>=0))throw new Error("area must be a positive number");var i=ar[n];if(!i)throw new Error("invalid original units");var r=ar[t];if(!r)throw new Error("invalid final units");return e/i*r}function Gt(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function _e(e){return!!e&&e.constructor===Object}function $e(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(n){if(!Gt(n))throw new Error("bbox must only contain numbers")})}function At(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function Zt(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function er(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function lr(e){if(e.length>1&&isNumber(e[0])&&isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return lr(e[0]);throw new Error("coordinates must only contain numbers")}function Nr(e,n,t){if(!n||!t)throw new Error("type and name required");if(!e||e.type!==n)throw new Error("Invalid input to "+t+": must be a "+n+", given "+e.type)}function Ir(e,n,t){if(!e)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!e.geometry||e.geometry.type!==n)throw new Error("Invalid input to "+t+": must be a "+n+", given "+e.geometry.type)}function cr(e,n,t){if(!e)throw new Error("No featureCollection passed");if(!t)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+t+", FeatureCollection required");for(var i=0,r=e.features;i<r.length;i++){var a=r[i];if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!a.geometry||a.geometry.type!==n)throw new Error("Invalid input to "+t+": must be a "+n+", given "+a.geometry.type)}}function Yr(e){return e.type==="Feature"?e.geometry:e}function en(e,n){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}function Un(e,n,t){if(e!==null)for(var i,r,a,o,u,s,l,h=0,d=0,v,y=e.type,x=y==="FeatureCollection",S=y==="Feature",M=x?e.features.length:1,O=0;O<M;O++){l=x?e.features[O].geometry:S?e.geometry:e,v=l?l.type==="GeometryCollection":!1,u=v?l.geometries.length:1;for(var H=0;H<u;H++){var W=0,he=0;if(o=v?l.geometries[H]:l,o!==null){s=o.coordinates;var ve=o.type;switch(h=t&&(ve==="Polygon"||ve==="MultiPolygon")?1:0,ve){case null:break;case"Point":if(n(s,d,O,W,he)===!1)return!1;d++,W++;break;case"LineString":case"MultiPoint":for(i=0;i<s.length;i++){if(n(s[i],d,O,W,he)===!1)return!1;d++,ve==="MultiPoint"&&W++}ve==="LineString"&&W++;break;case"Polygon":case"MultiLineString":for(i=0;i<s.length;i++){for(r=0;r<s[i].length-h;r++){if(n(s[i][r],d,O,W,he)===!1)return!1;d++}ve==="MultiLineString"&&W++,ve==="Polygon"&&he++}ve==="Polygon"&&W++;break;case"MultiPolygon":for(i=0;i<s.length;i++){for(he=0,r=0;r<s[i].length;r++){for(a=0;a<s[i][r].length-h;a++){if(n(s[i][r][a],d,O,W,he)===!1)return!1;d++}he++}W++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(Un(o.geometries[i],n,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function mi(e,n,t,i){var r=t;return Un(e,function(a,o,u,s,l){o===0&&t===void 0?r=a:r=n(r,a,o,u,s,l)},i),r}function di(e,n){var t;switch(e.type){case"FeatureCollection":for(t=0;t<e.features.length&&n(e.features[t].properties,t)!==!1;t++);break;case"Feature":n(e.properties,0);break}}function Yn(e,n,t){var i=t;return di(e,function(r,a){a===0&&t===void 0?i=r:i=n(i,r,a)}),i}function Vi(e,n){if(e.type==="Feature")n(e,0);else if(e.type==="FeatureCollection")for(var t=0;t<e.features.length&&n(e.features[t],t)!==!1;t++);}function ja(e,n,t){var i=t;return Vi(e,function(r,a){a===0&&t===void 0?i=r:i=n(i,r,a)}),i}function ea(e){var n=[];return Un(e,function(t){n.push(t)}),n}function Ra(e,n){var t,i,r,a,o,u,s,l,h,d,v=0,y=e.type==="FeatureCollection",x=e.type==="Feature",S=y?e.features.length:1;for(t=0;t<S;t++){for(u=y?e.features[t].geometry:x?e.geometry:e,l=y?e.features[t].properties:x?e.properties:{},h=y?e.features[t].bbox:x?e.bbox:void 0,d=y?e.features[t].id:x?e.id:void 0,s=u?u.type==="GeometryCollection":!1,o=s?u.geometries.length:1,r=0;r<o;r++){if(a=s?u.geometries[r]:u,a===null){if(n(null,v,l,h,d)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(a,v,l,h,d)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<a.geometries.length;i++)if(n(a.geometries[i],v,l,h,d)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}v++}}function Wa(e,n,t){var i=t;return Ra(e,function(r,a,o,u,s){a===0&&t===void 0?i=r:i=n(i,r,a,o,u,s)}),i}function ia(e,n){Ra(e,function(t,i,r,a,o){var u=t===null?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return n(jt(t,r,{bbox:a,id:o}),i,0)===!1?!1:void 0}var s;switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var l=0;l<t.coordinates.length;l++){var h=t.coordinates[l],d={type:s,coordinates:h};if(n(jt(d,r),i,l)===!1)return!1}})}function Ei(e,n,t){var i=t;return ia(e,function(r,a,o){a===0&&o===0&&t===void 0?i=r:i=n(i,r,a,o)}),i}function ho(e,n){ia(e,function(t,i,r){var a=0;if(!!t.geometry){var o=t.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var u,s=0,l=0,h=0;if(Un(t,function(d,v,y,x,S){if(u===void 0||i>s||x>l||S>h){u=d,s=i,l=x,h=S,a=0;return}var M=lineString([u,d],t.properties);if(n(M,i,r,S,a)===!1)return!1;a++,u=d})===!1)return!1}}})}function Mu(e,n,t){var i=t,r=!1;return ho(e,function(a,o,u,s,l){r===!1&&t===void 0?i=a:i=n(i,a,o,u,s,l),r=!0}),i}function Ru(e,n){if(!e)throw new Error("geojson is required");ia(e,function(t,i,r){if(t.geometry!==null){var a=t.geometry.type,o=t.geometry.coordinates;switch(a){case"LineString":if(n(t,i,r,0,0)===!1)return!1;break;case"Polygon":for(var u=0;u<o.length;u++)if(n(lineString(o[u],t.properties),i,r,u)===!1)return!1;break}}})}function Rl(e,n,t){var i=t;return Ru(e,function(r,a,o,u){a===0&&t===void 0?i=r:i=n(i,r,a,o,u)}),i}function Lu(e,n){if(n=n||{},!isObject(n))throw new Error("options is invalid");var t=n.featureIndex||0,i=n.multiFeatureIndex||0,r=n.geometryIndex||0,a=n.segmentIndex||0,o=n.properties,u;switch(e.type){case"FeatureCollection":t<0&&(t=e.features.length+t),o=o||e.features[t].properties,u=e.features[t].geometry;break;case"Feature":o=o||e.properties,u=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=e;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var s=u.coordinates;switch(u.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=s.length+a-1),lineString([s[a],s[a+1]],o,n);case"Polygon":return r<0&&(r=s.length+r),a<0&&(a=s[r].length+a-1),lineString([s[r][a],s[r][a+1]],o,n);case"MultiLineString":return i<0&&(i=s.length+i),a<0&&(a=s[i].length+a-1),lineString([s[i][a],s[i][a+1]],o,n);case"MultiPolygon":return i<0&&(i=s.length+i),r<0&&(r=s[i].length+r),a<0&&(a=s[i][r].length-a-1),lineString([s[i][r][a],s[i][r][a+1]],o,n)}throw new Error("geojson is invalid")}function rn(e,n){if(n=n||{},!isObject(n))throw new Error("options is invalid");var t=n.featureIndex||0,i=n.multiFeatureIndex||0,r=n.geometryIndex||0,a=n.coordIndex||0,o=n.properties,u;switch(e.type){case"FeatureCollection":t<0&&(t=e.features.length+t),o=o||e.features[t].properties,u=e.features[t].geometry;break;case"Feature":o=o||e.properties,u=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=e;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var s=u.coordinates;switch(u.type){case"Point":return point(s,o,n);case"MultiPoint":return i<0&&(i=s.length+i),point(s[i],o,n);case"LineString":return a<0&&(a=s.length+a),point(s[a],o,n);case"Polygon":return r<0&&(r=s.length+r),a<0&&(a=s[r].length+a),point(s[r][a],o,n);case"MultiLineString":return i<0&&(i=s.length+i),a<0&&(a=s[i].length+a),point(s[i][a],o,n);case"MultiPolygon":return i<0&&(i=s.length+i),r<0&&(r=s[i].length+r),a<0&&(a=s[i][r].length-a),point(s[i][r][a],o,n)}throw new Error("geojson is invalid")}function aa(e,n){var t=n.x,i=n.y,r=n.x1,a=n.y1,o=n.coordinates,u=n.geometry,s=[];if(!Array.isArray(e))return{dataArray:[]};if(u)return e.filter(function(O){return O[u]&&O[u].type&&O[u].coordinates&&O[u].coordinates.length>0}).forEach(function(O,H){var W=Te()((0,b.Z)({},O[u]),!0);ia(W,function(he){var ve=er(he),Re=(0,b.Z)((0,b.Z)({},O),{},{_id:H,coordinates:ve});s.push(Re)})}),{dataArray:s};for(var l=0;l<e.length;l++){var h=e[l],d=[];if(o){var v="Polygon";Array.isArray(o[0])||(v="Point"),Array.isArray(o[0])&&!Array.isArray(o[0][0])&&(v="LineString");var y=Te()({type:v,coordinates:(0,L.Z)(h[o])},!0);d=y.coordinates}else if(t&&i&&r&&a){var x=[parseFloat(h[t]),parseFloat(h[i])],S=[parseFloat(h[r]),parseFloat(h[a])];d=[x,S]}else t&&i&&(d=[parseFloat(h[t]),parseFloat(h[i])]);var M=(0,b.Z)((0,b.Z)({},h),{},{_id:l,coordinates:d});s.push(M)}return{dataArray:s}}function Pu(e,n){var t=je(e);return aa(t,n)}var Oo=D(90484);function as(e){for(var n=e.toString(),t=5381,i=n.length;i;)t=t*33^n.charCodeAt(--i);return t>>>0}function oi(e,n){return n===void 0?null:(0,Oo.Z)(e.properties[n])*1==="number"?e.properties[n]*1:e.properties&&e.properties[n]?as(e.properties[n]+"")%1000019:null}function Vs(e,n){var t=[],i={};return e.features?(e.features=e.features.filter(function(r){var a=r.geometry;return r!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),Te()(e,!0),e.features.length===0?{dataArray:[],featureKeys:i}:(ia(e,function(r,a){var o=oi(r,n==null?void 0:n.featureId);o===null&&(o=a);var u=o,s=er(r),l=(0,b.Z)((0,b.Z)({},r.properties),{},{coordinates:s,_id:u});t.push(l)}),{dataArray:t,featureKeys:i})):(e.features=[],{dataArray:[]})}var st=D(92137),Hs=D(87757),q=D.n(Hs);function Iu(e,n,t,i){for(var r=i,a=t-n>>1,o=t-n,u,s=e[n],l=e[n+1],h=e[t],d=e[t+1],v=n+3;v<t;v+=3){var y=uu(e[v],e[v+1],s,l,h,d);if(y>r)u=v,r=y;else if(y===r){var x=Math.abs(v-a);x<o&&(u=v,o=x)}}r>i&&(u-n>3&&Iu(e,n,u,i),e[u+2]=r,t-u>3&&Iu(e,u,t,i))}function uu(e,n,t,i,r,a){var o=r-t,u=a-i;if(o!==0||u!==0){var s=((e-t)*o+(n-i)*u)/(o*o+u*u);s>1?(t=r,i=a):s>0&&(t+=o*s,i+=u*s)}return o=e-t,u=n-i,o*o+u*u}function ko(e,n,t,i){var r={id:typeof e=="undefined"?null:e,type:n,geometry:t,tags:i,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};return Ou(r),r}function Ou(e){var n=e.geometry,t=e.type;if(t==="Point"||t==="MultiPoint"||t==="LineString")La(e,n);else if(t==="Polygon"||t==="MultiLineString")for(var i=0;i<n.length;i++)La(e,n[i]);else if(t==="MultiPolygon")for(i=0;i<n.length;i++)for(var r=0;r<n[i].length;r++)La(e,n[i][r])}function La(e,n){for(var t=0;t<n.length;t+=3)e.minX=Math.min(e.minX,n[t]),e.minY=Math.min(e.minY,n[t+1]),e.maxX=Math.max(e.maxX,n[t]),e.maxY=Math.max(e.maxY,n[t+1])}function Pa(e,n){var t=[];if(e.type==="FeatureCollection")for(var i=0;i<e.features.length;i++)dn(t,e.features[i],n,i);else e.type==="Feature"?dn(t,e,n):dn(t,{geometry:e},n);return t}function dn(e,n,t,i){if(!!n.geometry){var r=n.geometry.coordinates,a=n.geometry.type,o=Math.pow(t.tolerance/((1<<t.maxZoom)*t.extent),2),u=[],s=n.id;if(t.promoteId?s=n.properties[t.promoteId]:t.generateId&&(s=i||0),a==="Point")po(r,u);else if(a==="MultiPoint")for(var l=0;l<r.length;l++)po(r[l],u);else if(a==="LineString")jo(r,u,o,!1);else if(a==="MultiLineString")if(t.lineMetrics){for(l=0;l<r.length;l++)u=[],jo(r[l],u,o,!1),e.push(ko(s,"LineString",u,n.properties));return}else su(r,u,o,!1);else if(a==="Polygon")su(r,u,o,!0);else if(a==="MultiPolygon")for(l=0;l<r.length;l++){var h=[];su(r[l],h,o,!0),u.push(h)}else if(a==="GeometryCollection"){for(l=0;l<n.geometry.geometries.length;l++)dn(e,{id:s,geometry:n.geometry.geometries[l],properties:n.properties},t,i);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(ko(s,a,u,n.properties))}}function po(e,n){n.push(os(e[0])),n.push(Wo(e[1])),n.push(0)}function jo(e,n,t,i){for(var r,a,o=0,u=0;u<e.length;u++){var s=os(e[u][0]),l=Wo(e[u][1]);n.push(s),n.push(l),n.push(0),u>0&&(i?o+=(r*l-s*a)/2:o+=Math.sqrt(Math.pow(s-r,2)+Math.pow(l-a,2))),r=s,a=l}var h=n.length-3;n[2]=1,Iu(n,0,h,t),n[h+2]=1,n.size=Math.abs(o),n.start=0,n.end=n.size}function su(e,n,t,i){for(var r=0;r<e.length;r++){var a=[];jo(e[r],a,t,i),n.push(a)}}function os(e){return e/360+.5}function Wo(e){var n=Math.sin(e*Math.PI/180),t=.5-.25*Math.log((1+n)/(1-n))/Math.PI;return t<0?0:t>1?1:t}function gi(e,n,t,i,r,a,o,u){if(t/=n,i/=n,a>=t&&o<i)return e;if(o<t||a>=i)return null;for(var s=[],l=0;l<e.length;l++){var h=e[l],d=h.geometry,v=h.type,y=r===0?h.minX:h.minY,x=r===0?h.maxX:h.maxY;if(y>=t&&x<i){s.push(h);continue}else if(x<t||y>=i)continue;var S=[];if(v==="Point"||v==="MultiPoint")$o(d,S,t,i,r);else if(v==="LineString")vo(d,S,t,i,r,!1,u.lineMetrics);else if(v==="MultiLineString")fa(d,S,t,i,r,!1);else if(v==="Polygon")fa(d,S,t,i,r,!0);else if(v==="MultiPolygon")for(var M=0;M<d.length;M++){var O=[];fa(d[M],O,t,i,r,!0),O.length&&S.push(O)}if(S.length){if(u.lineMetrics&&v==="LineString"){for(M=0;M<S.length;M++)s.push(ko(h.id,v,S[M],h.tags));continue}(v==="LineString"||v==="MultiLineString")&&(S.length===1?(v="LineString",S=S[0]):v="MultiLineString"),(v==="Point"||v==="MultiPoint")&&(v=S.length===3?"Point":"MultiPoint"),s.push(ko(h.id,v,S,h.tags))}}return s.length?s:null}function $o(e,n,t,i,r){for(var a=0;a<e.length;a+=3){var o=e[a+r];o>=t&&o<=i&&(n.push(e[a]),n.push(e[a+1]),n.push(e[a+2]))}}function vo(e,n,t,i,r,a,o){for(var u=Hi(e),s=r===0?oa:us,l=e.start,h,d,v=0;v<e.length-3;v+=3){var y=e[v],x=e[v+1],S=e[v+2],M=e[v+3],O=e[v+4],H=r===0?y:x,W=r===0?M:O,he=!1;o&&(h=Math.sqrt(Math.pow(y-M,2)+Math.pow(x-O,2))),H<t?W>t&&(d=s(u,y,x,M,O,t),o&&(u.start=l+h*d)):H>i?W<i&&(d=s(u,y,x,M,O,i),o&&(u.start=l+h*d)):ha(u,y,x,S),W<t&&H>=t&&(d=s(u,y,x,M,O,t),he=!0),W>i&&H<=i&&(d=s(u,y,x,M,O,i),he=!0),!a&&he&&(o&&(u.end=l+h*d),n.push(u),u=Hi(e)),o&&(l+=h)}var ve=e.length-3;y=e[ve],x=e[ve+1],S=e[ve+2],H=r===0?y:x,H>=t&&H<=i&&ha(u,y,x,S),ve=u.length-3,a&&ve>=3&&(u[ve]!==u[0]||u[ve+1]!==u[1])&&ha(u,u[0],u[1],u[2]),u.length&&n.push(u)}function Hi(e){var n=[];return n.size=e.size,n.start=e.start,n.end=e.end,n}function fa(e,n,t,i,r,a){for(var o=0;o<e.length;o++)vo(e[o],n,t,i,r,a,!1)}function ha(e,n,t,i){e.push(n),e.push(t),e.push(i)}function oa(e,n,t,i,r,a){var o=(a-n)/(i-n);return e.push(a),e.push(t+(r-t)*o),e.push(1),o}function us(e,n,t,i,r,a){var o=(a-t)/(r-t);return e.push(n+(i-n)*o),e.push(a),e.push(1),o}function Xo(e,n){var t=n.buffer/n.extent,i=e,r=gi(e,1,-1-t,t,0,-1,2,n),a=gi(e,1,1-t,2+t,0,-1,2,n);return(r||a)&&(i=gi(e,1,-t,1+t,0,-1,2,n)||[],r&&(i=$a(r,1).concat(i)),a&&(i=i.concat($a(a,-1)))),i}function $a(e,n){for(var t=[],i=0;i<e.length;i++){var r=e[i],a=r.type,o;if(a==="Point"||a==="MultiPoint"||a==="LineString")o=ua(r.geometry,n);else if(a==="MultiLineString"||a==="Polygon"){o=[];for(var u=0;u<r.geometry.length;u++)o.push(ua(r.geometry[u],n))}else if(a==="MultiPolygon")for(o=[],u=0;u<r.geometry.length;u++){for(var s=[],l=0;l<r.geometry[u].length;l++)s.push(ua(r.geometry[u][l],n));o.push(s)}t.push(ko(r.id,a,o,r.tags))}return t}function ua(e,n){var t=[];t.size=e.size,e.start!==void 0&&(t.start=e.start,t.end=e.end);for(var i=0;i<e.length;i+=3)t.push(e[i]+n,e[i+1],e[i+2]);return t}function Xa(e,n){if(e.transformed)return e;var t=1<<e.z,i=e.x,r=e.y,a,o,u;for(a=0;a<e.features.length;a++){var s=e.features[a],l=s.geometry,h=s.type;if(s.geometry=[],h===1)for(o=0;o<l.length;o+=2)s.geometry.push(Ia(l[o],l[o+1],n,t,i,r));else for(o=0;o<l.length;o++){var d=[];for(u=0;u<l[o].length;u+=2)d.push(Ia(l[o][u],l[o][u+1],n,t,i,r));s.geometry.push(d)}}return e.transformed=!0,e}function Ia(e,n,t,i,r,a){return[Math.round(t*(e*i-r)),Math.round(t*(n*i-a))]}function ku(e,n,t,i,r){for(var a=n===r.maxZoom?0:r.tolerance/((1<<n)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:t,y:i,z:n,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},u=0;u<e.length;u++){o.numFeatures++,lu(o,e[u],a,r);var s=e[u].minX,l=e[u].minY,h=e[u].maxX,d=e[u].maxY;s<o.minX&&(o.minX=s),l<o.minY&&(o.minY=l),h>o.maxX&&(o.maxX=h),d>o.maxY&&(o.maxY=d)}return o}function lu(e,n,t,i){var r=n.geometry,a=n.type,o=[];if(a==="Point"||a==="MultiPoint")for(var u=0;u<r.length;u+=3)o.push(r[u]),o.push(r[u+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")Oa(o,r,e,t,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(u=0;u<r.length;u++)Oa(o,r[u],e,t,a==="Polygon",u===0);else if(a==="MultiPolygon")for(var s=0;s<r.length;s++){var l=r[s];for(u=0;u<l.length;u++)Oa(o,l[u],e,t,!0,u===0)}if(o.length){var h=n.tags||null;if(a==="LineString"&&i.lineMetrics){h={};for(var d in n.tags)h[d]=n.tags[d];h.mapbox_clip_start=r.start/r.size,h.mapbox_clip_end=r.end/r.size}var v={geometry:o,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:h};n.id!==null&&(v.id=n.id),e.features.push(v)}}function Oa(e,n,t,i,r,a){var o=i*i;if(i>0&&n.size<(r?o:i)){t.numPoints+=n.length/3;return}for(var u=[],s=0;s<n.length;s+=3)(i===0||n[s+2]>o)&&(t.numSimplified++,u.push(n[s]),u.push(n[s+1])),t.numPoints++;r&&Fi(u,a),e.push(u)}function Fi(e,n){for(var t=0,i=0,r=e.length,a=r-2;i<r;a=i,i+=2)t+=(e[i]-e[a])*(e[i+1]+e[a+1]);if(t>0===n)for(i=0,r=e.length;i<r/2;i+=2){var o=e[i],u=e[i+1];e[i]=e[r-2-i],e[i+1]=e[r-1-i],e[r-2-i]=o,e[r-1-i]=u}}function ri(e,n){return new Yo(e,n)}function Yo(e,n){n=this.options=Fo(Object.create(this.options),n);var t=n.debug;if(t&&console.time("preprocess data"),n.maxZoom<0||n.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(n.promoteId&&n.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=Pa(e,n);this.tiles={},this.tileCoords=[],t&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",n.indexMaxZoom,n.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=Xo(i,n),i.length&&this.splitTile(i,0,0,0),t&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Yo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Yo.prototype.splitTile=function(e,n,t,i,r,a,o){for(var u=[e,n,t,i],s=this.options,l=s.debug;u.length;){i=u.pop(),t=u.pop(),n=u.pop(),e=u.pop();var h=1<<n,d=mo(n,t,i),v=this.tiles[d];if(!v&&(l>1&&console.time("creation"),v=this.tiles[d]=ku(e,n,t,i,s),this.tileCoords.push({z:n,x:t,y:i}),l)){l>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",n,t,i,v.numFeatures,v.numPoints,v.numSimplified),console.timeEnd("creation"));var y="z"+n;this.stats[y]=(this.stats[y]||0)+1,this.total++}if(v.source=e,r){if(n===s.maxZoom||n===r)continue;var x=1<<r-n;if(t!==Math.floor(a/x)||i!==Math.floor(o/x))continue}else if(n===s.indexMaxZoom||v.numPoints<=s.indexMaxPoints)continue;if(v.source=null,e.length!==0){l>1&&console.time("clipping");var S=.5*s.buffer/s.extent,M=.5-S,O=.5+S,H=1+S,W,he,ve,Re,ze,ft;W=he=ve=Re=null,ze=gi(e,h,t-S,t+O,0,v.minX,v.maxX,s),ft=gi(e,h,t+M,t+H,0,v.minX,v.maxX,s),e=null,ze&&(W=gi(ze,h,i-S,i+O,1,v.minY,v.maxY,s),he=gi(ze,h,i+M,i+H,1,v.minY,v.maxY,s),ze=null),ft&&(ve=gi(ft,h,i-S,i+O,1,v.minY,v.maxY,s),Re=gi(ft,h,i+M,i+H,1,v.minY,v.maxY,s),ft=null),l>1&&console.timeEnd("clipping"),u.push(W||[],n+1,t*2,i*2),u.push(he||[],n+1,t*2,i*2+1),u.push(ve||[],n+1,t*2+1,i*2),u.push(Re||[],n+1,t*2+1,i*2+1)}}},Yo.prototype.getTile=function(e,n,t){var i=this.options,r=i.extent,a=i.debug;if(e<0||e>24)return null;var o=1<<e;n=(n%o+o)%o;var u=mo(e,n,t);if(this.tiles[u])return Xa(this.tiles[u],r);a>1&&console.log("drilling down to z%d-%d-%d",e,n,t);for(var s=e,l=n,h=t,d;!d&&s>0;)s--,l=Math.floor(l/2),h=Math.floor(h/2),d=this.tiles[mo(s,l,h)];return!d||!d.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",s,l,h),a>1&&console.time("drilling down"),this.splitTile(d.source,s,l,h,e,n,t),a>1&&console.timeEnd("drilling down"),this.tiles[u]?Xa(this.tiles[u],r):null)};function mo(e,n,t){return((1<<e)*t+n)*32+e}function Fo(e,n){for(var t in n)e[t]=n[t];return e}var ot=D(6610),at=D(5991),R=D(96156),z=function(){function e(n,t,i,r){(0,ot.Z)(this,e),(0,R.Z)(this,"vectorLayerCache",{}),this.x=t,this.y=i,this.z=r,this.vectorTile=n}return(0,at.Z)(e,[{key:"getTileData",value:function(t){if(!t||!this.vectorTile.layers[t])return[];if(this.vectorLayerCache[t])return this.vectorLayerCache[t];var i=this.vectorTile.layers[t];return i.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),ee={tileSize:256,minZoom:0,maxZoom:Infinity,zoomOffset:0};function Pe(e){for(var n=0,t=0,i=e.length,r=i-1,a,o;t<i;r=t++)a=e[t],o=e[r],n+=(o.x-a.x)*(a.y+o.y);return n}function dt(e){var n=e.length;if(n<=1)return[e];for(var t=[],i,r,a=0;a<n;a++){var o=Pe(e[a]);o!==0&&(r===void 0&&(r=o<0),r===o<0?(i&&t.push(i),i=[e[a]]):i.push(e[a]))}return i&&t.push(i),t}var nr=["Unknown","Point","LineString","Polygon"];function kr(e,n,t,i,r){var a=r.geometry,o=r.type,u=r.tags,s=r.id,l=e*Math.pow(2,i),h=e*n,d=e*t,v=nr[o],y,x;function S(H){for(var W=0;W<H.length;W++){var he=H[W];if(he[3])break;var ve=180-(he[1]+d)*360/l,Re=(he[0]+h)*360/l-180,ze=360/Math.PI*Math.atan(Math.exp(ve*Math.PI/180))-90;H[W]=[Re,ze,0,1]}}switch(o){case 1:var M=[];for(y=0;y<a.length;y++)M[y]=a[y][0];a=M,S(a);break;case 2:for(y=0;y<a.length;y++)S(a[y]);break;case 3:for(a=dt(a),y=0;y<a.length;y++)for(x=0;x<a[y].length;x++)S(a[y][x]);break}a.length===1?a=a[0]:v="Multi"+v;var O={type:"Feature",geometry:{type:v,coordinates:a},properties:u,id:s,tileOrigin:[0,0],coord:""};return O}var Tn=function(){var e=(0,st.Z)(q().mark(function n(t,i,r,a){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",new Promise(function(s){var l=i.getTile(t.z,t.x,t.y),h=l?l.features.map(function(y){return kr(a,r.x,r.y,r.z,y)}):[],d={layers:{defaultLayer:{features:h}}},v=new z(d,t.x,t.y,t.z);s(v)}));case 1:case"end":return u.stop()}},n)}));return function(t,i,r,a){return e.apply(this,arguments)}}();function Ai(e){var n={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions=="undefined"?n:(0,b.Z)((0,b.Z)({},n),e.geojsonvtOptions)}function yi(e,n){var t=Ai(n),i=t.extent||4096,r=ri(e,t),a=function(s,l){return Tn(l,r,s,i)},o=(0,b.Z)((0,b.Z)((0,b.Z)({},ee),n),{},{getTileData:a});return{data:e,dataArray:[],tilesetOptions:o,isTile:!0}}var Ot=D(10379),zt=D(46070),be=D(77608),Ya=D(14665);function cu(e){return Function.toString.call(e).indexOf("[native code]")!==-1}var go=D(51814);function Ka(e,n,t){return(0,go.Z)()?Ka=Reflect.construct.bind():Ka=function(r,a,o){var u=[null];u.push.apply(u,a);var s=Function.bind.apply(r,u),l=new s;return o&&(0,Ya.Z)(l,o.prototype),l},Ka.apply(null,arguments)}function Fu(e){var n=typeof Map=="function"?new Map:void 0;return Fu=function(i){if(i===null||!cu(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n!="undefined"){if(n.has(i))return n.get(i);n.set(i,r)}function r(){return Ka(i,arguments,(0,be.Z)(this).constructor)}return r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,Ya.Z)(r,i)},Fu(e)}var qa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ll(e){this.message=e}Ll.prototype=new Error,Ll.prototype.name="InvalidCharacterError";function yo(e){var n=String(e).replace(/=+$/,"");if(n.length%4==1)throw new Ll("'atob' failed: The string to be decoded is not correctly encoded.");for(var t="",i=0,r,a,o=0;a=n.charAt(o++);~a&&(r=i%4?r*64+a:a,i++%4)?t+=String.fromCharCode(255&r>>(-2*i&6)):0)a=qa.indexOf(a);return t}function Cn(e){e=String(e);for(var n,t,i,r,a="",o=0,u=e.length%3;o<e.length;){if((t=e.charCodeAt(o++))>255||(i=e.charCodeAt(o++))>255||(r=e.charCodeAt(o++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");n=t<<16|i<<8|r,a+=qa.charAt(n>>18&63)+qa.charAt(n>>12&63)+qa.charAt(n>>6&63)+qa.charAt(n&63)}return u?a.slice(0,u-3)+"===".substring(u):a}var Jn=function(){function e(n,t){(0,ot.Z)(this,e),this.buffers=n,this.type=t}return(0,at.Z)(e,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(t,i,r){throw new Error("not implemented")}}]),e}(),ss,Nu=function(){return ss||(ss=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{})};ss=Nu();var ka;typeof window=="undefined"?ka={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(n){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(n){return null},clearMeasures:function(n){return null},clearMarks:function(n){return null},measure:function(n,t,i){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(n){return!0},Event:function(n,t){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:ka=window;var Pl=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,js=Pl?my.getSystemInfoSync().pixelRatio:ka.devicePixelRatio,Fa=(0,at.Z)(function e(n,t){(0,ot.Z)(this,e),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=n,this.timeStamp=Date.now()}),pe=D(63349);function p(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=g(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function g(e,n){if(!!e){if(typeof e=="string")return w(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return w(e,n)}}function w(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var _=new WeakMap,F=function(){function e(){(0,ot.Z)(this,e),_.set(this,{})}return(0,at.Z)(e,[{key:"addEventListener",value:function(t,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=_.get(this);a||(a={}),a[t]||(a[t]=[]),a[t].push(i),_.set(this,a),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=_.get(this);if(a){var o=a[t];if(o&&o.length>0){for(var u=o.length;u--;u>0)if(o[u]===i){o.splice(u,1);break}}}}},{key:"dispatchEvent",value:function(t){var i=_.get(this)[t.type];if(i){var r=p(i),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;o(t)}}catch(u){r.e(u)}finally{r.f()}}}}]),e}();function ae(e){var n=Ee();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Ee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Qe=function(e){(0,Ot.Z)(t,e);var n=ae(t);function t(){var i;return(0,ot.Z)(this,t),i=n.call(this),i.childNodes=[],i}return(0,at.Z)(t,[{key:"appendChild",value:function(r){this.childNodes.push(r)}},{key:"cloneNode",value:function(){var r=Object.create(this);return Object.assign(r,this),r}},{key:"removeChild",value:function(r){var a=this.childNodes.findIndex(function(o){return o===r});return a>-1?this.childNodes.splice(a,1):null}}]),t}(F);function et(e){var n=Nt();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Nt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $t=function(e){(0,Ot.Z)(t,e);var n=et(t);function t(){var i;return(0,ot.Z)(this,t),i=n.call(this),i.className="",i.children=[],i}return(0,at.Z)(t,[{key:"setAttribute",value:function(r,a){this[r]=a}},{key:"getAttribute",value:function(r){return this[r]}},{key:"setAttributeNS",value:function(r,a){this[r]=a}},{key:"getAttributeNS",value:function(r){return this[r]}}]),t}(Qe),Hr=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,cn,jr,Dn,yn;if(Hr){var jn=my.getSystemInfoSync();cn=jn.screenWidth,jr=jn.screenHeight,Dn=jn.windowWidth,yn=jn.windowHeight}else{var Na=ka.innerWidth,Si=ka.innerHeight;cn=Na,jr=Si,Dn=Na,yn=Si}var xa={width:cn,height:jr,availWidth:Dn,availHeight:yn,availLeft:0,availTop:0},_o=xa.availWidth,ni=xa.availHeight,Sa={style:[]};function ls(e,n){if(!("parentNode"in e)){var t;n===0?t=function(){return null}:n===1?t=function(){return Sa}:t=function(){return null},Object.defineProperty(e,"parentNode",{enumerable:!0,get:t})}if(!("parentElement"in e)){var i;n===0?i=function(){return null}:n===1?i=function(){return Sa}:i=function(){return null},Object.defineProperty(e,"parentElement",{enumerable:!0,get:i})}}function yc(e){e.style=e.style||{},Object.assign(e.style,{top:"0px",left:"0px",width:_o+"px",height:ni+"px",margin:"0px",padding:"0px"})}function Il(e){"clientLeft"in e||(e.clientLeft=0,e.clientTop=0),"clientWidth"in e||(e.clientWidth=_o,e.clientHeight=ni),"getBoundingClientRect"in e||(e.getBoundingClientRect=function(){var n={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return n})}function _c(e){"offsetLeft"in e||(e.offsetLeft=0,e.offsetTop=0),"offsetWidth"in e||(e.offsetWidth=_o,e.offsetHeight=ni)}function Ti(e){"scrollLeft"in e||(e.scrollLeft=0,e.scrollTop=0),"scrollWidth"in e||(e.scrollWidth=_o,e.scrollHeight=ni)}function df(e){var n=function(){return!0};e.classList=[],e.classList.add=n,e.classList.remove=n,e.classList.contains=n,e.classList.toggle=n}function lh(e){var n=Qa();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Qa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Ja(){}var fu=function(e){(0,Ot.Z)(t,e);var n=lh(t);function t(){var i,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;return(0,ot.Z)(this,t),i=n.call(this),i.className="",i.children=[],i.focus=Ja,i.blur=Ja,i.insertBefore=Ja,i.appendChild=Ja,i.removeChild=Ja,i.remove=Ja,i.innerHTML="",i.tagName=r.toUpperCase(),ls((0,pe.Z)(i),a),yc((0,pe.Z)(i)),df((0,pe.Z)(i)),Il((0,pe.Z)(i)),_c((0,pe.Z)(i)),Ti((0,pe.Z)(i)),i}return(0,at.Z)(t)}($t);function Du(e){var n=xc();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function xc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cs=function(e){(0,Ot.Z)(t,e);var n=Du(t);function t(i){return(0,ot.Z)(this,t),n.call(this,i)}return(0,at.Z)(t,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),t}(fu);function fs(e){var n=Ol();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Ol(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vf=function(e){(0,Ot.Z)(t,e);var n=fs(t);function t(){return(0,ot.Z)(this,t),n.call(this,"video")}return(0,at.Z)(t)}(cs),sa={},ba={};function jd(e,n){sa=e,sa.id=n,"tagName"in sa||(sa.tagName="CANVAS"),sa.type="canvas",Mixin.parentNode(sa),Mixin.style(sa),Mixin.classList(sa),Mixin.clientRegion(sa),Mixin.offsetRegion(sa),sa.focus=function(){},sa.blur=function(){}}function dp(e,n){var t=1024,i=1024;ba={width:t,height:i,clientWidth:t/devicePixelRatio,clientHeight:i/devicePixelRatio,id:n,type:"canvas"},"tagName"in ba||(ba.tagName="CANVAS"),Mixin.parentNode(ba),Mixin.style(ba),Mixin.classList(ba),Mixin.clientRegion(ba),Mixin.offsetRegion(ba),ba.getContext=function(r){if(r==="2d")return e},ba.focus=function(){},ba.blur=function(){}}function Ni(){return sa}function ch(){return ba}var Bu=(0,at.Z)(function e(){(0,ot.Z)(this,e);var n=Ni(),t=n.createImage&&n.createImage()||{};return"tagName"in t||(t.tagName="IMG",t.__proto__=e.prototype),ls(t),df(t),Object.assign(t,{addEventListener:function(r,a){t["on".concat(r)]=a.bind(t)},removeEventListener:function(r){t["on".concat(r)]=null}}),t}),Ws={href:"",protocol:"",host:""};function kl(e){var n=mf();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function mf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $s=function(e){(0,Ot.Z)(t,e);var n=kl(t);function t(){return(0,ot.Z)(this,t),n.call(this,"body",0)}return(0,at.Z)(t,[{key:"addEventListener",value:function(r,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(r,a,o){}},{key:"dispatchEvent",value:function(r){}}]),t}(fu),gf=function(e){(0,Ot.Z)(t,e);var n=kl(t);function t(){return(0,ot.Z)(this,t),n.call(this,"html",0)}return(0,at.Z)(t,[{key:"addEventListener",value:function(r,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(r,a){}},{key:"dispatchEvent",value:function(r){}}]),t}(fu),hs={},eo={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Ws,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(n){return n=n.toLowerCase(),n==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):n==="img"?new Bu:n==="video"?new vf:new fu(n)},createElementNS:function(n,t){return this.createElement(t)},createTextNode:function(n){return n},getElementById:function(n){return null},getElementsByTagName:function(n){return n=n.toLowerCase(),[]},getElementsByTagNameNS:function(n,t){return this.getElementsByTagName(t)},getElementsByName:function(n){return[]},querySelector:function(n){return null},querySelectorAll:function(n){return[]},addEventListener:function(n,t,i){hs[n]||(hs[n]=[]),hs[n].push(t)},removeEventListener:function(n,t){var i=hs[n];if(i&&i.length>0){for(var r=i.length;r--;r>0)if(i[r]===t){i.splice(r,1);break}}},dispatchEvent:function(n){var t=n.type,i=hs[t];if(i)for(var r=0;r<i.length;r++)i[r](n);n.target&&typeof n.target["on"+t]=="function"&&n.target["on"+t](n)},createEvent:function(n){return new Fa(n)}};eo.documentElement=new gf,eo.head=new fu("head"),eo.body=new $s;var Zu=Object,fh=function(){function e(){(0,ot.Z)(this,e);var n=arguments.length;if(n===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else n===3&&(0,Oo.Z)(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return(0,at.Z)(e,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),e}(),hh=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Xs,pa,xo;if(hh){var ps=my.getSystemInfoSync();Xs=ps.system,pa=ps.platform,xo=ps.language}else{var Da={versions:function(){var e=ka.navigator.userAgent;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")===-1,weixin:e.indexOf("MicroMessenger")>-1,qq:e.match(/\sQQ/i)===" qq"}}(),language:(ka.navigator.browserLanguage||ka.navigator.language).toLowerCase()};Da.versions.android?pa="android":Da.versions.trident?pa="IE":Da.versions.presto?pa="Opera":Da.versions.webKit?pa="webKit":Da.versions.gecko?pa="Firefox":Da.versions.mobile?pa="mobile":Da.versions.ios?pa="ios":Da.versions.iPhone?pa="iPhone":Da.versions.iPad?pa="ipad":Da.versions.webApp?pa="webApp":Da.versions.weixin?pa="weixin":Da.versions.qq&&(pa="qq"),Xs=ka.navigator.userAgent,xo=Da.language}var ph=Xs.toLowerCase().indexOf("android")!==-1,ds=ph?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",Uu="Mozilla/5.0 (".concat(ds,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(xo),to={platform:pa,language:xo,appVersion:"5.0 (".concat(ds,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:Uu},Ys={mark:function(n){return null},clearMeasures:function(n){return null},clearMarks:function(n){return null},measure:function(n,t,i){return{duration:0}},now:function(){}},dh=0,vh=0;function vp(e){var n=Date.now(),t=Math.max(dh+23,n);return vh=setTimeout(function(){e(dh=t)},t-n),vh}function yf(e){var n=Ni();return n.requestAnimationFrame?n.requestAnimationFrame(e):vp(e)}function mp(e){var n=Ni();return n.cancelAnimationFrame?n.cancelAnimationFrame(e):clearTimeout(e)}var Sc=function(){function e(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if((0,ot.Z)(this,e),n.indexOf("http://")==0||n.indexOf("https://")==0){this.href=n;return}this.href=t+n}return(0,at.Z)(e,null,[{key:"createObjectURL",value:function(t){var i=t.buffers[0],r=t.type,a=rt(i),o="data:".concat(r,";base64, ");return o+a}}]),e}();function rt(e){for(var n="",t=new Uint8Array(e),i=t.byteLength,r=0;r<i;r++)n+=String.fromCharCode(t[r]);return Cn(n)}var Dt={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},Ct={};function zr(e){var n=xn();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function xn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Gn=new Map,hi=new Map,Kn=new Map,Fl={json:"application/json",text:"application/text",arraybuffer:"application/octet-stream"};function gp(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:this};typeof this["on".concat(e)]=="function"&&this["on".concat(e)].call(this,n)}function No(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{readyState:e};this.readyState=e,gp.call(this,"readystatechange",n)}var Ko=function(e){(0,Ot.Z)(t,e);var n=zr(t);function t(){var i;return(0,ot.Z)(this,t),i=n.call(this),i.onabort=null,i.onerror=null,i.onload=null,i.onloadstart=null,i.onprogress=null,i.ontimeout=null,i.onloadend=null,i.onreadystatechange=null,i.readyState=0,i.response=null,i.responseText=null,i._responseType="text",i.responseXML=null,i.status=0,i.statusText="",i.upload={},i.withCredentials=!1,Gn.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),i}return(0,at.Z)(t,[{key:"responseType",set:function(r){this._responseType=r}},{key:"abort",value:function(){var r=Kn.get("requestTask");r&&r.abort()}},{key:"getAllResponseHeaders",value:function(){var r=hi.get("responseHeader");return Object.keys(r).map(function(a){return"".concat(a,": ").concat(r[a])}).join(`
`)}},{key:"getResponseHeader",value:function(r){return hi.get("responseHeader")[r]}},{key:"open",value:function(r,a,o){this._method=r,this._url=a}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:""}},{key:"setRequestHeader",value:function(r,a){var o=Gn.get("requestHeader");o[r]=a,Gn.set("requestHeader",o)}},{key:"addEventListener",value:function(r,a){var o=this;typeof a=="function"&&(this["on"+r]=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u.target=u.target||o,a.call(o,u)})}},{key:"removeEventListener",value:function(r,a){this["on"+r]===a&&(this["on"+r]=null)}}]),t}(F);Ko.UNSEND=0,Ko.OPENED=1,Ko.HEADERS_RECEIVED=2,Ko.LOADING=3,Ko.DONE=4;function yp(e){var n=Ks();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Ks(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _f=function(e){(0,Ot.Z)(t,e);var n=yp(t);function t(i){return(0,ot.Z)(this,t),n.call(this,i)}return(0,at.Z)(t)}(Fa);function qs(e){return function(n){n.type=e,eo.dispatchEvent(n)}}var ii=qs("mousedown"),bc=qs("mousemove"),_p=qs("mouseup");function vs(e){var n=So();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function So(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Qs=function(e){(0,Ot.Z)(t,e);var n=vs(t);function t(i){var r;return(0,ot.Z)(this,t),r=n.call(this,i),r.target=Ni(),r.currentTarget=Ni(),r}return(0,at.Z)(t)}(Fa),xf=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],Nl=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],hu="touch";function Dl(e,n,t){for(var i=new Qs(e),r=0;r<xf.length;r++){var a=xf[r];i[a]=n[a]||Nl[r]}return i.type=e,i.target=Ni(),i.currentTarget=Ni(),i.buttons=Sf(e),i.which=i.buttons,i.pointerId=(n.identifier||0)+2,i.bubbles=!0,i.cancelable=!0,i.button=0,i.width=(n.radiusX||.5)*2,i.height=(n.radiusY||.5)*2,i.pressure=n.force||.5,i.isPrimary=mh(n),i.pointerType=hu,i.altKey=t.altKey,i.ctrlKey=t.ctrlKey,i.metaKey=t.metaKey,i.shiftKey=t.shiftKey,t.preventDefault&&(i.preventDefault=function(){t.preventDefault()}),i}function Sf(e){var n=0;return(e==="touchstart"||e==="touchmove"||e==="pointerdown"||e==="pointermove")&&(n=1),n}var pu=null;function mh(e){return pu===e.identifier}function ms(e){pu===null&&(pu=e.identifier)}function Di(e){pu===e.identifier&&(pu=null)}function Bl(e){return function(n){for(var t=n.changedTouches,i=0;i<t.length;i++){var r=t[i];i===0&&e==="pointerdown"?ms(r):(e==="pointerup"||e==="pointercancel")&&Di(r);var a=Dl(e,r,n);eo.dispatchEvent(a)}}}var Zl=Bl("pointerdown"),bo=Bl("pointermove"),Ec=Bl("pointerup");function gh(e){var n=xp();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function xp(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Sp=function(e){(0,Ot.Z)(t,e);var n=gh(t);function t(i){var r;return(0,ot.Z)(this,t),r=n.call(this,i),r.touches=[],r.targetTouches=[],r.changedTouches=[],r.target=Ni(),r.currentTarget=Ni(),r}return(0,at.Z)(t)}(Fa);function Js(e){var n=e||{},t=n.x,i=t===void 0?0:t,r=n.y,a=r===void 0?0:r,o=n.clientX,u=o===void 0?0:o,s=n.clientY,l=s===void 0?0:s;Object.keys(e).indexOf("x")!==-1?(e.pageX=e.clientX=i,e.pageY=e.clientY=a):(e.x=u,e.y=l)}function el(e){return function(n){var t=new Sp(e);t.changedTouches=n.changedTouches,t.touches=n.touches,t.targetTouches=Array.prototype.slice.call(n.touches),t.timeStamp=n.timeStamp,t.changedTouches.forEach(function(i){return Js(i)}),t.touches.forEach(function(i){return Js(i)}),t.targetTouches.forEach(function(i){return Js(i)}),eo.dispatchEvent(t)}}function Ul(e){return function(n){n.type=e,eo.dispatchEvent(n)}}var bp=el("touchstart"),bf=el("touchmove"),Ep=el("touchend"),Wd=Ul("mapCameaParams"),Bi=!1;function la(e){Bi=e}var Ap=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Ac=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),Ba=(Ap||Ac)&&Bi,zu={atob:yo,btoa:Cn,devicePixelRatio:js,Blob:Jn,document:eo,Element:$t,Event:Fa,EventTarget:F,HTMLCanvasElement:Zu,HTMLElement:fu,HTMLMediaElement:cs,HTMLVideoElement:vf,Image:Bu,ImageData:fh,navigator:to,Node:Qe,requestAnimationFrame:yf,cancelAnimationFrame:mp,screen:xa,XMLHttpRequest:Ko,performance:Ys,URL:Sc,WebGLRenderingContext:Dt,WebGL2RenderingContext:Ct,addEventListener:function(n,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};eo.addEventListener(n,t,i)},removeEventListener:function(n,t,i){eo.removeEventListener(n,t)},dispatchEvent:function(n){eo.dispatchEvent(n)},innerWidth:xa.availWidth,innerHeight:xa.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},In=Ba?zu:ka,tl=Ba?Ko:ka.XMLHttpRequest,Ef=Ba?Ws:ka.location;function gs(e){var n=rl();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function rl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nl=function(e){(0,Ot.Z)(t,e);var n=gs(t);function t(i,r,a,o){var u;return(0,ot.Z)(this,t),u=n.call(this,"AJAXError: ".concat(r," (").concat(i,"): ").concat(a)),u.status=i,u.statusText=r,u.url=a,u.body=o,u}return(0,at.Z)(t)}(Fu(Error));function il(e,n){var t=new tl,i=Array.isArray(e.url)?e.url[0]:e.url;t.open(e.method||"GET",i,!0),e.type==="arrayBuffer"&&(t.responseType="arraybuffer");for(var r in e.headers)e.headers.hasOwnProperty(r)&&t.setRequestHeader(r,e.headers[r]);return e.type==="json"&&(t.responseType="text",t.setRequestHeader("Accept","application/json")),t.withCredentials=e.credentials==="include",t.onerror=function(){n(new Error(t.statusText))},t.onload=function(){if((t.status>=200&&t.status<300||t.status===0)&&t.response!==null){var a=t.response;if(e.type==="json")try{a=JSON.parse(t.response)}catch(u){return n(u)}n(null,a,t.getResponseHeader("Cache-Control"),t.getResponseHeader("Expires"),t)}else{var o=new Blob([t.response],{type:t.getResponseHeader("Content-Type")});n(new nl(t.status,t.statusText,i.toString(),o))}},t.send(e.body),t}function ys(e){return new Promise(function(n,t){il(e,function(i,r,a,o,u){i?t({err:i,data:null,xhr:u}):n({err:null,data:r,cacheControl:a,expires:o,xhr:u})})})}function Tc(e,n){return il(e,n)}var yh=function(n,t){return Tc((0,b.Z)((0,b.Z)({},n),{},{type:"json"}),t)},ro=function(n,t){return Tc((0,b.Z)((0,b.Z)({},n),{},{type:"arrayBuffer"}),t)},Tp=function(n,t){return Tc(_objectSpread(_objectSpread({},n),{},{method:"POST"}),t)};function $d(e){var n=$window.document.createElement("a");return n.href=e,n.protocol===$window.document.location.protocol&&n.host===$window.document.location.host}var no="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Gu(e,n){var t=new In.Image,i=In.URL||In.webkitURL;t.crossOrigin="anonymous",t.onload=function(){n(null,t),i.revokeObjectURL(t.src),t.onload=null,window.requestAnimationFrame(function(){t.src=no})},t.onerror=function(){return n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var r=new Blob([new Uint8Array(e)],{type:"image/png"});t.src=e.byteLength?i.createObjectURL(r):no}function du(e,n){var t=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(t).then(function(i){n(null,i)}).catch(function(i){n(new Error("Could not load image because of ".concat(i.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var K=function(n,t,i){var r=function(o,u){if(o)t(o);else if(u){var s=typeof createImageBitmap=="function",l=i?i(u):u;s?du(l,t):Gu(l,t)}};return n.type==="json"?yh(n,r):ro(n,r)},_s=function(n,t){var i=typeof createImageBitmap=="function";i?du(n,t):Gu(n,t)},Vu;(function(e){e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e["BOTTOM-RIGHT"]="bottom-right",e.LEFT="left",e.RIGHT="right"})(Vu||(Vu={}));var da={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function On(e,n,t){var i=e.classList;for(var r in da)da.hasOwnProperty(r)&&i.remove("l7-".concat(t,"-anchor-").concat(r));i.add("l7-".concat(t,"-anchor-").concat(n))}function Cc(e,n,t){e.prototype=n.prototype=t,t.constructor=e}function _h(e,n){var t=Object.create(e.prototype);for(var i in n)t[i]=n[i];return t}function zl(){}var Do=.7,wc=1/Do,al="\\s*([+-]?\\d+)\\s*",Gl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",qo="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xh=/^#([0-9a-f]{3,8})$/,Qo=new RegExp("^rgb\\("+[al,al,al]+"\\)$"),Cp=new RegExp("^rgb\\("+[qo,qo,qo]+"\\)$"),wp=new RegExp("^rgba\\("+[al,al,al,Gl]+"\\)$"),Af=new RegExp("^rgba\\("+[qo,qo,qo,Gl]+"\\)$"),Mc=new RegExp("^hsl\\("+[Gl,qo,qo]+"\\)$"),Mp=new RegExp("^hsla\\("+[Gl,qo,qo,Gl]+"\\)$"),Jo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Cc(zl,xs,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Sh,formatHex:Sh,formatHsl:Rp,formatRgb:bh,toString:bh});function Sh(){return this.rgb().formatHex()}function Rp(){return Vl(this).formatHsl()}function bh(){return this.rgb().formatRgb()}function xs(e){var n,t;return e=(e+"").trim().toLowerCase(),(n=xh.exec(e))?(t=n[1].length,n=parseInt(n[1],16),t===6?Eh(n):t===3?new Ci(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):t===8?eu(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):t===4?eu(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Qo.exec(e))?new Ci(n[1],n[2],n[3],1):(n=Cp.exec(e))?new Ci(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=wp.exec(e))?eu(n[1],n[2],n[3],n[4]):(n=Af.exec(e))?eu(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Mc.exec(e))?Cf(n[1],n[2]/100,n[3]/100,1):(n=Mp.exec(e))?Cf(n[1],n[2]/100,n[3]/100,n[4]):Jo.hasOwnProperty(e)?Eh(Jo[e]):e==="transparent"?new Ci(NaN,NaN,NaN,0):null}function Eh(e){return new Ci(e>>16&255,e>>8&255,e&255,1)}function eu(e,n,t,i){return i<=0&&(e=n=t=NaN),new Ci(e,n,t,i)}function Lp(e){return e instanceof zl||(e=xs(e)),e?(e=e.rgb(),new Ci(e.r,e.g,e.b,e.opacity)):new Ci}function Rc(e,n,t,i){return arguments.length===1?Lp(e):new Ci(e,n,t,i==null?1:i)}function Ci(e,n,t,i){this.r=+e,this.g=+n,this.b=+t,this.opacity=+i}Cc(Ci,Rc,_h(zl,{brighter:function(e){return e=e==null?wc:Math.pow(wc,e),new Ci(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Do:Math.pow(Do,e),new Ci(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ss,formatHex:Ss,formatRgb:Ah,toString:Ah}));function Ss(){return"#"+Tf(this.r)+Tf(this.g)+Tf(this.b)}function Ah(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Tf(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Cf(e,n,t,i){return i<=0?e=n=t=NaN:t<=0||t>=1?e=n=NaN:n<=0&&(e=NaN),new io(e,n,t,i)}function Vl(e){if(e instanceof io)return new io(e.h,e.s,e.l,e.opacity);if(e instanceof zl||(e=xs(e)),!e)return new io;if(e instanceof io)return e;e=e.rgb();var n=e.r/255,t=e.g/255,i=e.b/255,r=Math.min(n,t,i),a=Math.max(n,t,i),o=NaN,u=a-r,s=(a+r)/2;return u?(n===a?o=(t-i)/u+(t<i)*6:t===a?o=(i-n)/u+2:o=(n-t)/u+4,u/=s<.5?a+r:2-a-r,o*=60):u=s>0&&s<1?0:o,new io(o,u,s,e.opacity)}function wf(e,n,t,i){return arguments.length===1?Vl(e):new io(e,n,t,i==null?1:i)}function io(e,n,t,i){this.h=+e,this.s=+n,this.l=+t,this.opacity=+i}Cc(io,wf,_h(zl,{brighter:function(e){return e=e==null?wc:Math.pow(wc,e),new io(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Do:Math.pow(Do,e),new io(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*n,r=2*t-i;return new Ci(Mf(e>=240?e-240:e+120,r,i),Mf(e,r,i),Mf(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Mf(e,n,t){return(e<60?n+(t-n)*e/60:e<180?t:e<240?n+(t-n)*(240-e)/60:n)*255}function Pp(e){return typeof e=="string"?!!d3.color(e):!1}function wn(e){var n=xs(e),t=[0,0,0,0];return n!=null&&(t[0]=n.r/255,t[1]=n.g/255,t[2]=n.b/255,t[3]=n.opacity),t}function Bo(e){var n=e&&e[0],t=e&&e[1],i=e&&e[2],r=n+t*256+i*65536-1;return r}function Eo(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function Rf(e){var n=In.document.createElement("canvas"),t=n.getContext("2d");n.width=256,n.height=1;for(var i=null,r=t.createLinearGradient(0,0,256,1),a=e.positions[0],o=e.positions[e.positions.length-1],u=0;u<e.colors.length;++u){var s=(e.positions[u]-a)/(o-a);r.addColorStop(s,e.colors[u])}if(t.fillStyle=r,t.fillRect(0,0,256,1),Ba)return i=new Uint8ClampedArray(t.getImageData(0,0,256,1).data),n=null,t=null,{data:i,width:256,height:1};i=t.getImageData(0,0,256,1).data;for(var l=t.createImageData(256,1),h=0;h<l.data.length;h+=4)l.data[h+0]=i[h+0],l.data[h+1]=i[h+1],l.data[h+2]=i[h+2],l.data[h+3]=i[h+3];return n=null,t=null,l}function Th(e,n){var t=In.document.createElement("canvas"),i=t.getContext("2d");t.width=256,t.height=1;for(var r=i.createLinearGradient(0,0,256,1),a=n[1]-n[0],o=0;o<e.colors.length;++o){var u=Math.max((e.positions[o]-n[0])/a,0);r.addColorStop(u,e.colors[o])}i.fillStyle=r,i.fillRect(0,0,256,1);var s=i.getImageData(0,0,256,1).data,l=mu(i,s);return t=null,i=null,l}function Hl(e){var n=In.document.createElement("canvas"),t=n.getContext("2d");n.width=256,n.height=1;var i=t.createImageData(256,1);return i.data.fill(0),e.positions.forEach(function(r,a){var o=wn(e.colors[a]);i.data[r*4+0]=o[0]*255,i.data[r*4+1]=o[1]*255,i.data[r*4+2]=o[2]*255,i.data[r*4+3]=o[3]*255}),n=null,t=null,i}function vu(e){var n=In.document.createElement("canvas"),t=n.getContext("2d");t.globalAlpha=1,n.width=256,n.height=1;for(var i=256/e.colors.length,r=0;r<e.colors.length;r++)t.beginPath(),t.lineWidth=2,t.strokeStyle=e.colors[r],t.moveTo(r*i,0),t.lineTo((r+1)*i,0),t.stroke();var a=t.getImageData(0,0,256,1).data,o=mu(t,a);return n=null,t=null,o}function ol(e,n){var t=In.document.createElement("canvas"),i=t.getContext("2d");i.globalAlpha=1,t.width=256,t.height=1;var r=n[1]-n[0];e.positions.length-e.colors.length!=1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(var a=0;a<e.colors.length;a++)i.beginPath(),i.lineWidth=2,i.strokeStyle=e.colors[a],i.moveTo((e.positions[a]-n[0])/r*255,0),i.lineTo((e.positions[a+1]-n[0])/r*255,0),i.stroke();var o=i.getImageData(0,0,256,1).data,u=mu(i,o);return t=null,i=null,u}function mu(e,n){for(var t=e.createImageData(256,1),i=0;i<t.data.length;i+=4)t.data[i+0]=n[i+0],t.data[i+1]=n[i+1],t.data[i+2]=n[i+2],t.data[i+3]=n[i+3];return t}function Yi(e){switch(e.type){case"cat":return[0,255];default:return[0,1]}}var Ao={BACK:1029,FRONT:1028};function jl(e){switch(e){case"GAODE1.x":return Ao.BACK;case"GAODE2.x":return Ao.BACK;case"MAPBOX":return Ao.FRONT;case"SIMPLE":return Ao.FRONT;case"GLOBEL":return Ao.BACK;case"DEBAULT":return Ao.FRONT;default:return Ao.FRONT}}var Dr=D(28481),Rr=D(96486);function Za(e){var n=e;return typeof e=="string"&&(n=In.document.getElementById(e)),n}function Wl(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Lc(e){return Wl(e).split(/\s+/)}function ul(e){var n,t,i=In==null||(n=In.document)===null||n===void 0||(t=n.documentElement)===null||t===void 0?void 0:t.style;if(!i)return e[0];for(var r in e)if(e[r]&&e[r]in i)return e[r];return e[0]}function bn(e,n,t){var i=In.document.createElement(e);return n&&(i.className=n||""),t&&t.appendChild(i),i}function va(e){var n=e.parentNode;n&&n.removeChild(e)}function ei(e,n){if(e.classList!==void 0)for(var t=Lc(n),i=0,r=t.length;i<r;i++)e.classList.add(t[i]);else if(!Lf(e,n)){var a=sl(e);To(e,(a?a+" ":"")+n)}}function tu(e,n){if(e.classList!==void 0){var t=Lc(n);t.forEach(function(i){e.classList.remove(i)})}else To(e,Wl((" "+sl(e)+" ").replace(" "+n+" "," ")))}function Lf(e,n){if(e.classList!==void 0)return e.classList.contains(n);var t=sl(e);return t.length>0&&new RegExp("(^|\\s)"+n+"(\\s|$)").test(t)}function To(e,n){e instanceof HTMLElement?e.className=n:e.className.baseVal=n}function sl(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Pc(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var gu=ul(["transform","WebkitTransform"]);function $l(e,n){e.style[gu]=n}function ma(){if(typeof Event=="function")In.dispatchEvent(new Event("resize"));else{var e=In.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,In,0),In.dispatchEvent(e)}}function Pf(e){var n=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log(`%c
`,n.join(""))}function Ch(){var e,n=In.document.querySelector('meta[name="viewport"]');if(!n)return 1;var t=(e=n.content)===null||e===void 0?void 0:e.split(","),i=t.find(function(r){var a=r.split("="),o=(0,Dr.Z)(a,1),u=o[0];return u==="initial-scale"});return i?i.split("=")[1]*1:1}var bi=Ch()<1?1:In.devicePixelRatio;function Ic(e,n){e.setAttribute("style","".concat(e.style.cssText).concat(n))}function Xl(e){return e.split(";").map(function(n){return n.trim()}).filter(function(n){return n})}function Ip(e,n){var t,i=Xl((t=e.getAttribute("style"))!==null&&t!==void 0?t:""),r=Xl(n),a=Rr.pull.apply(void 0,[i].concat((0,L.Z)(r)));e.setAttribute("style",a.join(";"))}function bs(e){return Object.entries(e).map(function(n){var t=(0,Dr.Z)(n,2),i=t[0],r=t[1];return"".concat(i,": ").concat(r)}).join(";")}function Oc(e,n){return{left:e.left-n.left,top:e.top-n.top,right:n.left+n.width-e.left-e.width,bottom:n.top+n.height-e.top-e.height}}function kc(e,n){e.checked=n,n?e.setAttribute("checked","true"):e.removeAttribute("checked")}function Es(e){e.innerHTML=""}function As(e){e.setAttribute("draggable","false")}function Hu(e,n){if(typeof n=="string"){var t=document.createElement("div");for(t.innerHTML=n;t.firstChild;)e.append(t.firstChild)}else Array.isArray(n)?e.append.apply(e,(0,L.Z)(n)):e.append(n)}var Yl;function Fc(e){return typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap}function If(){return typeof importScripts=="function"}var wh=If()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},ll=(Yl=navigator)===null||Yl===void 0?void 0:Yl.userAgent,Nc=!!ll.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Mh=ll.indexOf("Android")>-1||ll.indexOf("Adr")>-1;function cl(){for(var e=ll,n=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],t=!0,i=0,r=n;i<r.length;i++){var a=r[i];if(e.indexOf(a)>0){t=!1;break}}return t}function ru(e,n){e.forEach(function(t){!n[t]||(n[t]=n[t].bind(n))})}var fl=null;function nu(e){var n=[Infinity,Infinity,-Infinity,-Infinity];return Un(e,function(t){n[0]>t[0]&&(n[0]=t[0]),n[1]>t[1]&&(n[1]=t[1]),n[2]<t[0]&&(n[2]=t[0]),n[3]<t[1]&&(n[3]=t[1])}),n}nu.default=nu;var hl=nu;function ju(e){return typeof e=="number"}var ao=2*Math.PI*6378137/2;function Ts(e,n){var t=(0,Dr.Z)(n,4),i=t[0],r=t[1],a=t[2],o=t[3];return e.lng>i&&e.lng<=a&&e.lat>r&&e.lat<=o}function Wu(e){var n=[Infinity,Infinity,-Infinity,-Infinity];return e.forEach(function(t){var i=t.coordinates;pl(n,i)}),n}function pl(e,n){return Array.isArray(n[0])?n.forEach(function(t){pl(e,t)}):(e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])),e}function Of(e,n){return Cs(e,n)}function Cs(e,n){return Array.isArray(e[0])?e.map(function(t){return Cs(t,n)}):n(e)}function Kl(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=Op(e,n);var i=e[0],r=e[1],a=i*ao/180,o=Math.log(Math.tan((90+r)*Math.PI/360))/(Math.PI/180);return o=o*ao/180,t.enable&&(a=Number(a.toFixed(t.decimal)),o=Number(o.toFixed(t.decimal))),e.length===3?[a,o,e[2]]:[a,o]}function Dc(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,t=e[0],i=e[1],r=t/ao*180,a=i/ao*180;return a=180/Math.PI*(2*Math.atan(Math.exp(a*Math.PI/180))-Math.PI/2),n!=null&&(r=Number(r.toFixed(n)),a=Number(a.toFixed(n))),e.length===3?[r,a,e[2]]:[r,a]}function ws(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function $u(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function Op(e,n){if(n===!1)return e;var t=ws(e[0]),i=$u(e[1]);return i>85&&(i=85),i<-85&&(i=-85),e.length===3?[t,i,e[2]]:[t,i]}function ji(e){var n=85.0511287798,t=Math.max(Math.min(n,e[1]),-n),i=256<<20,r=Math.PI/180,a=e[0]*r,o=t*r;o=Math.log(Math.tan(Math.PI/4+o/2));var u=.5/Math.PI,s=.5,l=-.5/Math.PI;return r=.5,a=i*(u*a+s),o=i*(l*o+r),[Math.floor(a),Math.floor(o)]}function Ln(e){var n=.5/Math.PI,t=.5,i=-.5/Math.PI,r=.5,a=256<<20,o=_slicedToArray(e,2),u=o[0],s=o[1];u=(u/a-t)/n,s=(s/a-r)/i,s=(Math.atan(Math.pow(Math.E,s))-Math.PI/4)*2,r=Math.PI/180;var l=s/r,h=u/r;return[h,l]}function ql(e,n){var t=85.0511287798,i=Math.PI/180,r=6378137;return n=Math.max(Math.min(t,n),-t),e*=i,n*=i,n=Math.log(Math.tan(Math.PI/4+n/2)),[e*r,n*r]}function kp(e,n){var t=Math.PI/180,i=6378137,r=e/i/t,a=2*(Math.atan(Math.exp(n/i))-Math.PI/4)/t;return[r,a]}function Ql(e,n,t){var i=T(n[1]-e[1]),r=T(n[0]-e[0]),a=T(e[1]),o=T(n[1]),u=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(r/2),2)*Math.cos(a)*Math.cos(o);return Zn(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),t="meters")}function dl(e){var n=Math.PI/180,t=85.0511287798,i=6378137,r=Math.max(Math.min(t,e[1]),-t),a=Math.sin(r*n),o=i*e[0]*n,u=i*Math.log((1+a)/(1-a))/2;return[o,u]}function Ms(e,n){var t=Math.abs(e[1][1]-e[0][1])*n,i=Math.abs(e[1][0]-e[0][0])*n;return[[e[0][0]-i,e[0][1]-t],[e[1][0]+i,e[1][1]+t]]}function kf(e,n){return e[0][0]<=n[0][0]&&e[0][1]<=n[0][1]&&e[1][0]>=n[1][0]&&e[1][1]>=n[1][1]}function Ea(e){return[[e[0],e[1]],[e[2],e[3]]]}function Ff(e){var n=Jl(e,[0,0]);return[e[0]/n,e[1]/n]}function Jl(e,n){return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}function Nf(e,n){return e[0]*n[0]+e[1]*n[1]}function Df(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Fp(e,n){return Math.acos(Nf(e,n)/(Df(e)*Df(n)))*180/Math.PI}function oo(e,n){return n[0]>0?n[1]>0?90-Math.atan(n[1]/n[0])*180/Math.PI:90+Math.atan(-n[1]/n[0])*180/Math.PI:n[1]<0?180+(90-Math.atan(n[1]/n[0])*180/Math.PI):270+Math.atan(n[1]/-n[0])*180/Math.PI}function Rs(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!e||e.length<2)){for(var t=[0,1],i=0,r=[],a=0;a<e.length-1;a++){var o=e[a],u=e[a+1],s=Jl(o,u);i+=s;var l=[o[0]-u[0],o[1]-u[1]],h=oo(t,l);if(a>0){var d=r[a-1].rotation;d-h>360-d+h&&(h=h+360)}r.push({start:o,end:u,dis:s,rotation:h,duration:0})}return r.map(function(v){v.duration=n*(v.dis/i)}),r}}function Zo(e){if(ju(e[0]))return e;if(ju(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(ju(e[0][0][0])){var n=e,t=0,i=0,r=0;return n.forEach(function(a){a.forEach(function(o){t+=o[0],i+=o[1],r++})}),[t/r,i/r,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Rh(e){for(var n=e[0],t=e[1],i=e[0],r=e[1],a=0,o=0,u=0,s=0;s<e.length;s+=2){var l=e[s],h=e[s+1];l&&h&&(n=Math.max(l,n),t=Math.max(h,t),i=Math.min(l,i),r=Math.min(h,r),a+=l,o+=h,u++)}return{center:[a/u,o/u],radius:Math.sqrt(Math.pow(n-i,2)+Math.pow(t-r,2))/2}}function Bc(e){return hl(gn([Fn(e)]))}function Np(e){var n=131,t=137,i=0;e+="x";for(var r=Math.floor(9007199254740991/t),a=0;a<e.length;a++)i>r&&(i=Math.floor(i/t)),i=i*n+e.charCodeAt(a);return i}function Zc(e){e=e.toString();for(var n=5381,t=e.length;t;)n=n*33^e.charCodeAt(--t);return n>>>0}function ec(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=Math.random()*16|0,t=e==="x"?n:n&3|8;return t.toString(16)})}var Ls;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFAULT="DEFAUlTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL"})(Ls||(Ls={}));function tc(e,n,t,i,r){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,o=arguments.length>6?arguments[6]:void 0,u=t;return o&&(u=Math.round(t*(a-1))/(a-1)),i?vl(e,n,u,i,r):vl(e,n,u,.314,r)}function uo(e,n){var t=1-n;return(e[0]*t+e[1]*n)*t+(e[1]*t+e[2]*n)*n}function Uc(e,n){return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}function Co(e,n,t){var i=[n[0]-e[0],n[1]-e[1]],r=Uc(i,[0,0]),a=Math.atan2(i[1],i[0]),o=r/2/Math.cos(t),u=a+t,s=[o*Math.cos(u)+e[0],o*Math.sin(u)+e[1]];return s}function vl(e,n,t,i,r){if(r===Version["GAODE2.x"]){var a=amap2Project(e[0],e[1]),o=amap2Project(n[0],n[1]),u=Co(a,o,i),s=[a[0],u[0],o[0]],l=[a[1],u[1],o[1]];return[].concat(_toConsumableArray(amap2UnProject(uo(s,t),uo(l,t))),[0])}else{var h=Co(e,n,i),d=[e[0],h[0],n[0]],v=[e[1],h[1],n[1]];return[uo(d,t),uo(v,t),0]}}function Bf(e,n,t,i,r){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,o=arguments.length>6?arguments[6]:void 0,u=t;return o&&(u=Math.round(t*29)/29),nc(e,n,u,r)}function ml(e,n){var t=[n[0]-e[0],n[1]-e[1]],i=calDistance(t,[0,0]),r=Math.atan2(t[1],t[0]),a=.314,o=i/2/Math.cos(a),u=r+a,s=[o*Math.cos(u)+e[0],o*Math.sin(u)+e[1]];return s}function rc(e,n){var t=1-n;return(e[0]*t+e[1]*n)*t+(e[1]*t+e[2]*n)*n}function zc(e,n){var t=[e[0]-n[0],e[1]-n[1]],i=[Math.sin(t[0]/2),Math.sin(t[1]/2)],r=i[1]*i[1]+Math.cos(e[1])*Math.cos(n[1])*i[0]*i[0];return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))}function nc(e,n,t,i){var r=[degreesToRadians(e[0]),degreesToRadians(e[1])],a=[degreesToRadians(n[0]),degreesToRadians(n[1])];if(i==="GAODE2.x"){var o=ml(r,a),u=[r[0],o[0],a[0]],s=[r[1],o[1],a[1]];return[rc(u,t),rc(s,t),0]}else{var l=zc(r,a);if(Math.abs(l-Math.PI)<.001)return[(1-t)*r[0]+t*a[0],(1-t)*r[1]+t*a[1]];var h=Math.sin((1-t)*l)/Math.sin(l),d=Math.sin(t*l)/Math.sin(l),v=[Math.sin(r[0]),Math.sin(r[1])],y=[Math.cos(r[0]),Math.cos(r[1])],x=[Math.sin(a[0]),Math.sin(a[1])],S=[Math.cos(a[0]),Math.cos(a[1])],M=h*y[1]*y[0]+d*S[1]*S[0],O=h*y[1]*v[0]+d*S[1]*x[0],H=h*v[1]+d*x[1];return[radiansToDegrees(Math.atan2(O,M)),radiansToDegrees(Math.atan2(H,Math.sqrt(M*M+O*O)))]}}function ic(e,n){for(var t=0,i=[],r=0;r<e.length-1;r++){var a=e[r],o=e[r+1],u=ac(a,o),s=t;t+=u,i.push({p1:a,p2:o,totalDistance:t,distance:u,lastTotalDistance:s})}for(var l=t*n,h,d,v=0,y=i;v<y.length;v++){var x=y[v],S=x.totalDistance;if(S>l){var M=x.p1,O=x.p2,H=(l-x.lastTotalDistance)/x.distance,W=gl(O,M,H);h=W[0],d=W[1];break}}return{lng:h,lat:d,height:0}}function gl(e,n,t){return[e[0]*t+n[0]*(1-t),e[1]*t+n[1]*(1-t)]}function ac(e,n){return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}function Ps(e,n){var t=n.featureId,i=e.data.dataArray;return typeof t=="number"&&(i=i.filter(function(r){var a=r.id;return a===t})),i.map(function(r){var a=ta(r,n);return _objectSpread(_objectSpread({},r),a)})}function Zf(e,n){return new Promise(function(t){e.inited?t(Ps(e,n)):e.once("update",function(){t(Ps(e,n))})})}function ta(e,n){var t=n.offset,i=n.shape,r=n.thetaOffset,a=n.mapVersion,o=n.segmentNumber,u=o===void 0?30:o,s=n.autoFit,l=s===void 0?!0:s,h=e.coordinates;if(i==="line")return pathLineAtOffset(h,t);var d=h[0],v=h[1],y=typeof r=="string"?e[r]||0:r,x;switch(i){case"arc":x=arcLineAtOffset;break;case"greatcircle":x=greatCircleLineAtOffset;break;default:x=arcLineAtOffset}var S=x(d,v,t,y,a,u,l),M=_slicedToArray(S,3),O=M[0],H=M[1],W=M[2];return{lng:O,lat:H,height:W}}var ga=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0;(0,ot.Z)(this,e),this.limit=n,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}return(0,at.Z)(e,[{key:"clear",value:function(){var t=this;this.order.forEach(function(i){t.delete(i)}),this.cache={},this.order=[]}},{key:"get",value:function(t){var i=this.cache[t];return i&&(this.deleteOrder(t),this.appendOrder(t)),i}},{key:"set",value:function(t,i){this.cache[t]?(this.delete(t),this.cache[t]=i,this.appendOrder(t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[t]=i,this.appendOrder(t))}},{key:"delete",value:function(t){var i=this.cache[t];i&&(this.deleteCache(t),this.deleteOrder(t),this.destroy(i,t))}},{key:"deleteCache",value:function(t){delete this.cache[t]}},{key:"deleteOrder",value:function(t){var i=this.order.findIndex(function(r){return r===t});i>=0&&this.order.splice(i,1)}},{key:"appendOrder",value:function(t){this.order.push(t)}},{key:"defaultDestroy",value:function(t,i){return null}}]),e}();function Lh(e){if(e.length===0)throw new Error("max requires at least one data point");for(var n=e[0],t=1;t<e.length;t++)e[t]>n&&(n=e[t]);return n*1}function Uf(e){if(e.length===0)throw new Error("min requires at least one data point");for(var n=e[0],t=1;t<e.length;t++)e[t]<n&&(n=e[t]);return n*1}function oc(e){if(e.length===0)return 0;for(var n=e[0]*1,t=1;t<e.length;t++)n+=e[t]*1;return n}function yl(e){if(e.length===0)throw new Error("mean requires at least one data point");return oc(e)/e.length}function Ph(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var n=e[0],t=NaN,i=0,r=1,a=1;a<e.length+1;a++)e[a]!==n?(r>i&&(i=r,t=n),r=1,n=e[a]):r++;return t*1}var Uo={min:Uf,max:Lh,mean:yl,sum:oc,mode:Ph};function Gc(e,n){return e.map(function(t){return t[n]})}function zf(e,n){return Uo[e](n)}function Is(e,n){n===void 0&&(n={});var t=Number(e[0]),i=Number(e[1]),r=Number(e[2]),a=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[t,i],u=[t,a],s=[r,a],l=[r,i];return pn([[o,l,s,u,o]],n.properties,{bbox:e,id:n.id})}var Wi=D(26729),Vc=D.n(Wi),Os;(function(e){e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace"})(Os||(Os={}));var wi;(function(e){e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled"})(wi||(wi={}));var _l=0,Xu=1,Ua=2;function Hc(e){e.forEach(function(n){n.isCurrent&&(n.isVisible=n.isLoaded)})}function xl(e){e.forEach(function(n){n.properties.state=_l}),e.forEach(function(n){n.isCurrent&&!Wc(n)&&_i(n)}),e.forEach(function(n){n.isVisible=Boolean(n.properties.state&Ua)})}function jc(e){e.forEach(function(t){t.properties.state=_l}),e.forEach(function(t){t.isCurrent&&Wc(t)});var n=e.slice().sort(function(t,i){return t.z-i.z});n.forEach(function(t){t.isVisible=Boolean(t.properties.state&Ua),t.children.length&&(t.isVisible||t.properties.state&Xu)?t.children.forEach(function(i){i.properties.state=Xu}):t.isCurrent&&_i(t)})}function Wc(e){for(;e;){if(e.isLoaded)return e.properties.state|=Ua,!0;e=e.parent}return!1}function _i(e){e.children.forEach(function(n){n.isLoaded?n.properties.state|=Ua:_i(n)})}var so,Mi=256,Aa=[-Infinity,-Infinity,Infinity,Infinity],Gf=.2,yu=5,Ih=(so={},(0,R.Z)(so,Os.Realtime,Hc),(0,R.Z)(so,Os.Overlap,xl),(0,R.Z)(so,Os.Replace,jc),so),Oh=function(){};function Vf(e,n,t){var i=Math.floor((e+180)/360*Math.pow(2,t)),r=Math.floor((1-Math.log(Math.tan(n*Math.PI/180)+1/Math.cos(n*Math.PI/180))/Math.PI)/2*Math.pow(2,t));return[i,r]}function $c(e,n,t){var i=e/Math.pow(2,t)*360-180,r=Math.PI-2*Math.PI*n/Math.pow(2,t),a=180/Math.PI*Math.atan(.5*(Math.exp(r)-Math.exp(-r)));return[i,a]}var kh=function(n,t,i){var r=$c(n,t,i),a=(0,Dr.Z)(r,2),o=a[0],u=a[1],s=$c(n+1,t+1,i),l=(0,Dr.Z)(s,2),h=l[0],d=l[1];return[o,d,h,u]};function Dp(e){var n=e.zoom,t=e.latLonBounds,i=e.maxZoom,r=i===void 0?Infinity:i,a=e.minZoom,o=a===void 0?0:a,u=e.zoomOffset,s=u===void 0?0:u,l=e.extent,h=l===void 0?Aa:l,d=Math.ceil(n)+s;if(Number.isFinite(o)&&d<o)return[];Number.isFinite(r)&&d>r&&(d=r);for(var v=(0,Dr.Z)(t,4),y=v[0],x=v[1],S=v[2],M=v[3],O=[Math.max(y,h[0]),Math.max(x,h[1]),Math.min(S,h[2]),Math.min(M,h[3])],H=[],W=Vf(O[0],O[1],d),he=(0,Dr.Z)(W,2),ve=he[0],Re=he[1],ze=Vf(O[2],O[3],d),ft=(0,Dr.Z)(ze,2),gt=ft[0],Pt=ft[1],Mt=ve;Mt<=gt;Mt++)for(var sr=Pt;sr<=Re;sr++)H.push({x:Mt,y:sr,z:d});var xr=(gt+ve)/2,Br=(Re+Pt)/2,kn=function(xi,vi){return Math.abs(xi-xr)+Math.abs(vi-Br)};return H.sort(function(Oi,xi){return kn(Oi.x,Oi.y)-kn(xi.x,xi.y)}),H}var _u=function(n,t,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Math.pow(2,i),o=a-1,u=a,s=n,l=t;return r&&(s<0?s=s+u:s>o&&(s=s%u)),{warpX:s,warpY:l}};function Hf(e){var n=jf();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function jf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Xc=function(e){(0,Ot.Z)(t,e);var n=Hf(t);function t(i){var r;(0,ot.Z)(this,t),r=n.call(this),(0,R.Z)((0,pe.Z)(r),"tileSize",256),(0,R.Z)((0,pe.Z)(r),"isVisible",!1),(0,R.Z)((0,pe.Z)(r),"isCurrent",!1),(0,R.Z)((0,pe.Z)(r),"isVisibleChange",!1),(0,R.Z)((0,pe.Z)(r),"loadedLayers",0),(0,R.Z)((0,pe.Z)(r),"isLayerLoaded",!1),(0,R.Z)((0,pe.Z)(r),"isLoad",!1),(0,R.Z)((0,pe.Z)(r),"isChildLoad",!1),(0,R.Z)((0,pe.Z)(r),"parent",null),(0,R.Z)((0,pe.Z)(r),"children",[]),(0,R.Z)((0,pe.Z)(r),"data",null),(0,R.Z)((0,pe.Z)(r),"properties",{}),(0,R.Z)((0,pe.Z)(r),"loadDataId",0);var a=i.x,o=i.y,u=i.z,s=i.tileSize,l=i.warp,h=l===void 0?!0:l;return r.x=a,r.y=o,r.z=u,r.warp=h||!0,r.tileSize=s,r}return(0,at.Z)(t,[{key:"isLoading",get:function(){return this.loadStatus===wi.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===wi.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===wi.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===wi.Cancelled}},{key:"isDone",get:function(){return[wi.Loaded,wi.Cancelled,wi.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return kh(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var r=(0,Dr.Z)(this.bounds,4),a=r[0],o=r[1],u=r[2],s=r[3],l=[(u-a)/2,(s-o)/2],h=Is(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:l,meta:`
      `.concat(this.key,`
      `)}});return h}},{key:"key",get:function(){var r="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return r}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var i=(0,st.Z)(q().mark(function a(o){var u,s,l,h,d,v,y,x,S,M,O,H,W,he,ve,Re,ze;return q().wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:return u=o.getData,s=o.onLoad,l=o.onError,this.loadDataId++,h=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=wi.Loading,d=null,gt.prev=7,y=this.x,x=this.y,S=this.z,M=this.bounds,O=this.tileSize,H=this.warp,W=_u(y,x,S,H),he=W.warpX,ve=W.warpY,Re=this.abortController.signal,ze={x:he,y:ve,z:S,bounds:M,tileSize:O,signal:Re,warp:H},gt.next=14,u(ze,this);case 14:d=gt.sent,gt.next=20;break;case 17:gt.prev=17,gt.t0=gt.catch(7),v=gt.t0;case 20:if(h===this.loadDataId){gt.next=22;break}return gt.abrupt("return");case 22:if(!(this.isCancelled&&!d)){gt.next=24;break}return gt.abrupt("return");case 24:if(!(v||!d)){gt.next=28;break}return this.loadStatus=wi.Failure,l(v,this),gt.abrupt("return");case 28:this.loadStatus=wi.Loaded,this.data=d,s(this);case 31:case"end":return gt.stop()}},a,this,[[7,17]])}));function r(a){return i.apply(this,arguments)}return r}()},{key:"reloadData",value:function(r){this.isLoading&&this.abortLoad(),this.loadData(r)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=wi.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),t}(Wi.EventEmitter),uc=function(n,t){var i=Ea(n),r=Ms(i,t),a=360*3-180,o=85.0511287798065,u=[Math.max(r[0][0],-a),Math.max(r[0][1],-o),Math.min(r[1][0],a),Math.min(r[1][1],o)];return u},ks=function(n,t){var i=Ea(n),r=Ea(t),a=kf(i,r);return a};function Qr(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Yc(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function Yc(e,n){if(!!e){if(typeof e=="string")return sc(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return sc(e,n)}}function sc(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function Fs(e){var n=C();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var X;(function(e){e.TilesLoadStart="tiles-load-start",e.TileLoaded="tile-loaded",e.TileError="tile-error",e.TileUnload="tile-unload",e.TileUpdate="tile-update",e.TilesLoadFinished="tiles-load-finished"})(X||(X={}));var me=function(e){(0,Ot.Z)(t,e);var n=Fs(t);function t(i){var r;return(0,ot.Z)(this,t),r=n.call(this),(0,R.Z)((0,pe.Z)(r),"currentTiles",[]),(0,R.Z)((0,pe.Z)(r),"cacheTiles",new Map),(0,R.Z)((0,pe.Z)(r),"throttleUpdate",(0,Rr.throttle)(function(a,o){r.update(a,o)},16)),(0,R.Z)((0,pe.Z)(r),"onTileLoad",function(a){r.emit(X.TileLoaded,a),r.updateTileVisible(),r.loadFinished()}),(0,R.Z)((0,pe.Z)(r),"onTileError",function(a,o){r.emit(X.TileError,{error:a,tile:o}),r.updateTileVisible(),r.loadFinished()}),(0,R.Z)((0,pe.Z)(r),"onTileUnload",function(a){r.emit(X.TileUnload,a),r.loadFinished()}),r.options={tileSize:256,minZoom:0,maxZoom:Infinity,zoomOffset:0,extent:Aa,getTileData:Oh,warp:!0,updateStrategy:Os.Overlap},r.updateOptions(i),r}return(0,at.Z)(t,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(r){return r.isDone})}},{key:"tiles",get:function(){var r=Array.from(this.cacheTiles.values()).sort(function(a,o){return a.z-o.z});return r}},{key:"updateOptions",value:function(r){var a=r.minZoom===void 0?this.options.minZoom:Math.ceil(r.minZoom),o=r.maxZoom===void 0?this.options.maxZoom:Math.floor(r.maxZoom);this.options=(0,b.Z)((0,b.Z)((0,b.Z)({},this.options),r),{},{minZoom:a,maxZoom:o})}},{key:"update",value:function(r,a){var o=this,u=Math.max(0,Math.ceil(r));if(!(this.lastViewStates&&this.lastViewStates.zoom===u&&ks(this.lastViewStates.latLonBoundsBuffer,a))){var s=uc(a,Gf);this.lastViewStates={zoom:u,latLonBounds:a,latLonBoundsBuffer:s},this.currentZoom=u;var l=!1,h=this.getTileIndices(u,s).filter(function(d){return o.options.warp||d.x>=0&&d.x<Math.pow(2,u)});this.emit(X.TilesLoadStart),this.currentTiles=h.map(function(d){var v=d.x,y=d.y,x=d.z,S=o.getTile(v,y,x);if(S){var M,O,H=((M=S)===null||M===void 0?void 0:M.isFailure)||((O=S)===null||O===void 0?void 0:O.isCancelled);return H&&S.loadData({getData:o.options.getTileData,onLoad:o.onTileLoad,onError:o.onTileError}),S}return S=o.createTile(v,y,x),l=!0,S}),l&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var r=Qr(this.cacheTiles),a;try{for(r.s();!(a=r.n()).done;){var o=(0,Dr.Z)(a.value,2),u=o[0],s=o[1];if(!this.currentTiles.includes(s)){this.cacheTiles.delete(u),this.onTileUnload(s);return}this.onTileUnload(s),s.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(l){r.e(l)}finally{r.f()}}},{key:"reloadTileById",value:function(r,a,o){var u=this.cacheTiles.get("".concat(a,",").concat(o,",").concat(r));u&&(this.onTileUnload(u),u.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}},{key:"reloadTileByLnglat",value:function(r,a,o){var u=this.getTileByLngLat(r,a,o);u&&this.reloadTileById(u.z,u.x,u.y)}},{key:"reloadTileByExtent",value:function(r,a){var o=this,u=this.getTileIndices(a,r);u.forEach(function(s){o.reloadTileById(s.z,s.x,s.y)})}},{key:"pruneRequests",value:function(){var r=[],a=Qr(this.cacheTiles.values()),o;try{for(a.s();!(o=a.n()).done;){var u=o.value;u.isLoading&&!u.isCurrent&&!u.isVisible&&r.push(u)}}catch(l){a.e(l)}finally{a.f()}for(;r.length>0;){var s=r.shift();s.abortLoad()}}},{key:"getTileByLngLat",value:function(r,a,o){var u=this.options.zoomOffset,s=Math.ceil(o)+u,l=Vf(r,a,s),h=this.tiles.filter(function(d){return d.key==="".concat(l[0],"_").concat(l[1],"_").concat(s)});return h[0]}},{key:"getTileExtent",value:function(r,a){return this.getTileIndices(a,r)}},{key:"getTileByZXY",value:function(r,a,o){var u=this.tiles.filter(function(s){return s.key==="".concat(a,"_").concat(o,"_").concat(r)});return u[0]}},{key:"clear",value:function(){var r=Qr(this.cacheTiles.values()),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;o.isLoading?o.abortLoad():this.onTileUnload(o)}}catch(u){r.e(u)}finally{r.f()}this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var r=this.options.updateStrategy,a=new Map,o=Qr(this.cacheTiles.values()),u;try{for(o.s();!(u=o.n()).done;){var s=u.value;a.set(s.key,s.isVisible),s.isCurrent=!1,s.isVisible=!1}}catch(x){o.e(x)}finally{o.f()}var l=Qr(this.currentTiles),h;try{for(l.s();!(h=l.n()).done;){var d=h.value;d.isCurrent=!0,d.isVisible=!0}}catch(x){l.e(x)}finally{l.f()}var v=Array.from(this.cacheTiles.values());typeof r=="function"?r(v):Ih[r](v);var y=!1;Array.from(this.cacheTiles.values()).forEach(function(x){x.isVisible!==a.get(x.key)?(x.isVisibleChange=!0,y=!0):x.isVisibleChange=!1}),y&&this.emit(X.TileUpdate)}},{key:"getTileIndices",value:function(r,a){var o=this.options,u=o.tileSize,s=o.extent,l=o.zoomOffset,h=Math.floor(this.options.maxZoom),d=Math.ceil(this.options.minZoom),v=Dp({maxZoom:h,minZoom:d,zoomOffset:l,tileSize:u,zoom:r,latLonBounds:a,extent:s});return v}},{key:"getTileId",value:function(r,a,o){var u="".concat(r,",").concat(a,",").concat(o);return u}},{key:"loadFinished",value:function(){var r=!this.currentTiles.some(function(a){return!a.isDone});return r&&this.emit(X.TilesLoadFinished),r}},{key:"getTile",value:function(r,a,o){var u=this.getTileId(r,a,o),s=this.cacheTiles.get(u);return s}},{key:"createTile",value:function(r,a,o){var u=this.getTileId(r,a,o),s=new Xc({x:r,y:a,z:o,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(u,s),s.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),s}},{key:"resizeCacheTiles",value:function(){var r=yu*this.currentTiles.length,a=this.cacheTiles.size>r;if(a){var o=Qr(this.cacheTiles),u;try{for(o.s();!(u=o.n()).done;){var s=(0,Dr.Z)(u.value,2),l=s[0],h=s[1];if(!h.isVisible&&!this.currentTiles.includes(h)&&(this.cacheTiles.delete(l),this.onTileUnload(h)),this.cacheTiles.size<=r)break}}catch(d){o.e(d)}finally{o.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var r=Qr(this.cacheTiles.values()),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;o.parent=null,o.children.length=0}}catch(d){r.e(d)}finally{r.f()}var u=Qr(this.cacheTiles.values()),s;try{for(u.s();!(s=u.n()).done;){var l=s.value,h=this.getNearestAncestor(l.x,l.y,l.z);l.parent=h,h!=null&&h.children&&h.children.push(l)}}catch(d){u.e(d)}finally{u.f()}}},{key:"getNearestAncestor",value:function(r,a,o){for(;o>this.options.minZoom;){r=Math.floor(r/2),a=Math.floor(a/2),o=o-1;var u=this.getTile(r,a,o);if(u)return u}return null}}]),t}(Vc());function nt(e){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function Rt(e){var n=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var i=t[1].charCodeAt(0),r=t[2].charCodeAt(0),a;for(a=i;a<=r;++a)n.push(e.replace(t[0],String.fromCharCode(a)));return n}if(t=/\{(\d+)-(\d+)\}/.exec(e),t){for(var o=parseInt(t[2],10),u=parseInt(t[1],10);u<=o;u++)n.push(e.replace(t[0],u.toString()));return n}return n.push(e),n}function ut(e,n){if(!e||!e.length)throw new Error("url is not allowed to be empty");var t=n.x,i=n.y,r=n.z,a=Rt(e),o=Math.abs(t+i)%a.length,u=a[o];return u.replace(/\{x\}/g,t.toString()).replace(/\{y\}/g,i.toString()).replace(/\{z\}/g,r.toString()).replace(/\{bbox\}/g,kh(t,i,r).join(",")).replace(/\{-y\}/g,(Math.pow(2,r)-i-1).toString())}function Tt(e,n){var t=n.x,i=n.y,r=n.z,a=n.layer,o=n.version,u=o===void 0?"1.0.0":o,s=n.style,l=s===void 0?"default":s,h=n.format,d=n.service,v=d===void 0?"WMTS":d,y=n.tileMatrixset,x="".concat(e,"&SERVICE=").concat(v,"&REQUEST=GetTile&VERSION=").concat(u,"&LAYER=").concat(a,"&STYLE=").concat(l,"&TILEMATRIXSET=").concat(y,"&FORMAT=").concat(h,"&TILECOL=").concat(t,"&TILEROW=").concat(i,"&TILEMATRIX=").concat(r);return x}function It(e,n){if(!e)throw new Error(n||"web worker helper assertion failed.")}var Bt={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},Kt=Bt.self||Bt.window||{},Qt=Bt.window||Bt.self||{},Jt=Bt.self||Bt.window||{},tr=Bt.document||{},kt=typeof importScripts=="function",Xt=typeof window!="undefined"&&typeof window.orientation!="undefined",Ve=function(){function e(n,t){var i=this;this.name=n,this.workerThread=t,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(r,a){i.resolve=r,i.reject=a})}return e.prototype.postMessage=function(n,t){this.workerThread.postMessage({source:"Main thread",type:n,payload:t})},e.prototype.done=function(n){It(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(n)},e.prototype.error=function(n){It(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(n)},e}(),bt=Ve,Wt=new Map;function Sr(e){It(e.source&&!e.url||!e.source&&e.url);var n=Wt.get(e.source||e.url);return n||(e.url&&(n=Ft(e.url),Wt.set(e.url,n)),e.source&&(n=gr(e.source),Wt.set(e.source,n))),It(n),n}function Ft(e){if(!e.startsWith("http"))return e;var n=mr(e);return gr(n)}function gr(e){var n=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(n)}function mr(e){return`try {
  importScripts('`+e+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function Gr(e,n,t){n===void 0&&(n=!0);var i=t||new Set;if(e){if(Lt(e))i.add(e);else if(Lt(e.buffer))i.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(n&&typeof e=="object")for(var r in e)Gr(e[r],n,i)}}return t===void 0?Array.from(i):[]}function Lt(e){return e?e instanceof ArrayBuffer||typeof MessagePort!="undefined"&&e instanceof MessagePort||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&e instanceof OffscreenCanvas:!1}var wt=function(){},Mr=function(){function e(n){this.terminated=!1,this.loadableURL="";var t=n.name,i=n.source,r=n.url;It(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=wt,this.onError=function(a){return console.log(a)},this.worker=this.createBrowserWorker()}return e.isSupported=function(){return typeof Worker!="undefined"},e.prototype.destroy=function(){this.onMessage=wt,this.onError=wt,this.worker.terminate(),this.terminated=!0},Object.defineProperty(e.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(n,t){t=t||Gr(n),this.worker.postMessage(n,t)},e.prototype.getErrorFromErrorEvent=function(n){var t="Failed to load ";return t+="worker "+this.name+" from "+this.url+". ",n.message&&(t+=n.message+" in "),n.lineno&&(t+=":"+n.lineno+":"+n.colno),new Error(t)},e.prototype.createBrowserWorker=function(){var n=this;this.loadableURL=Sr({source:this.source,url:this.url});var t=new Worker(this.loadableURL,{name:this.name});return t.onmessage=function(i){i.data?n.onMessage(i.data):n.onError(new Error("No data received"))},t.onerror=function(i){n.onError(n.getErrorFromErrorEvent(i)),n.terminated=!0},t.onmessageerror=function(i){return console.error("worker "+n.name+", message error: "+i)},t},e}(),fr=Mr,Vt=function(){return Vt=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vt.apply(this,arguments)},vr=function(e,n,t,i){function r(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function u(h){try{l(i.next(h))}catch(d){o(d)}}function s(h){try{l(i.throw(h))}catch(d){o(d)}}function l(h){h.done?a(h.value):r(h.value).then(u,s)}l((i=i.apply(e,n||[])).next())})},dr=function(e,n){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(h){return s([l,h])}}function s(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=l[0]&2?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=n.call(e,t)}catch(h){l=[6,h],r=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},on=function(){function e(n){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=n.source,this.url=n.url,this.setProps(n)}return e.prototype.destroy=function(){this.idleQueue.forEach(function(n){return n.destroy()}),this.isDestroyed=!0},e.prototype.setProps=function(n){this.props=Vt(Vt({},this.props),n),n.name!==void 0&&(this.name=n.name),n.maxConcurrency!==void 0&&(this.maxConcurrency=n.maxConcurrency),n.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=n.maxMobileConcurrency),n.reuseWorkers!==void 0&&(this.reuseWorkers=n.reuseWorkers),n.onDebug!==void 0&&(this.onDebug=n.onDebug)},e.prototype.startJob=function(n,t,i){return t===void 0&&(t=function(r,a,o){return r.done(o)}),i===void 0&&(i=function(r,a){return r.error(a)}),vr(this,void 0,void 0,function(){var r,a=this;return dr(this,function(o){switch(o.label){case 0:return r=new Promise(function(u){return a.jobQueue.push({name:n,onMessage:t,onError:i,onStart:u}),a}),this.startQueuedJob(),[4,r];case 1:return[2,o.sent()]}})})},e.prototype.startQueuedJob=function(){return vr(this,void 0,void 0,function(){var n,t,i;return dr(this,function(r){switch(r.label){case 0:if(!this.jobQueue.length)return[2];if(n=this.getAvailableWorker(),!n)return[2];if(t=this.jobQueue.shift(),!t)return[3,4];this.onDebug({message:"Starting job",name:t.name,backlog:this.jobQueue.length,workerThread:n}),i=new bt(t.name,n),n.onMessage=function(a){return t.onMessage(i,a.type,a.payload)},n.onError=function(a){return t.onError(i,a)},t.onStart(i),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,i.result];case 2:return r.sent(),[3,4];case 3:return this.returnWorkerToQueue(n),[7];case 4:return[2]}})})},e.prototype.returnWorkerToQueue=function(n){var t=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();t?(n.destroy(),this.count--):this.idleQueue.push(n),this.isDestroyed||this.startQueuedJob()},e.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var n=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new fr({name:n,source:this.source,url:this.url})}return null},e.prototype.getMaxConcurrency=function(){return Xt?this.maxMobileConcurrency:this.maxConcurrency},e}(),$r=on,hr=function(){return hr=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hr.apply(this,arguments)},yr=function(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},Xr={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},tn=function(){function e(n){this.workerPools=new Map,this.props=hr({},Xr),this.setProps(n),this.workerPools=new Map}return e.isSupported=function(){return fr.isSupported()},e.getWorkerFarm=function(n){return n===void 0&&(n={}),e.workerFarm=e.workerFarm||new e({}),e.workerFarm.setProps(n),e.workerFarm},e.prototype.destroy=function(){var n,t;try{for(var i=yr(this.workerPools.values()),r=i.next();!r.done;r=i.next()){var a=r.value;a.destroy()}}catch(o){n={error:o}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}},e.prototype.setProps=function(n){var t,i;this.props=hr(hr({},this.props),n);try{for(var r=yr(this.workerPools.values()),a=r.next();!a.done;a=r.next()){var o=a.value;o.setProps(this.getWorkerPoolProps())}}catch(u){t={error:u}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},e.prototype.getWorkerPool=function(n){var t=n.name,i=n.source,r=n.url,a=this.workerPools.get(t);return a||(a=new $r({name:t,source:i,url:r}),a.setProps(this.getWorkerPoolProps()),this.workerPools.set(t,a)),a},e.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},e}(),Sn=null,Nn=new Map,qn=function(){function e(){}return Object.defineProperty(e,"onmessage",{set:function(n){self.onmessage=function(t){if(!!Zi(t)){var i=t.data,r=i.type,a=i.payload;n(r,a)}}},enumerable:!1,configurable:!0}),e.addEventListener=function(n){var t=Nn.get(n);t||(t=function(i){if(!!Zi(i)){var r=i.data,a=r.type,o=r.payload;n(a,o)}}),self.addEventListener("message",t)},e.removeEventListener=function(n){var t=Nn.get(n);Nn.delete(n),self.removeEventListener("message",t)},e.postMessage=function(n,t){if(self){var i={source:"Worker thread",type:n,payload:t},r=Gr(t);self.postMessage(i,r)}},e}(),sn=qn;function Zi(e){var n=e.type,t=e.data;return n==="message"&&t&&typeof t.source=="string"&&t.source==="Main thread"}function ui(e){return JSON.parse(Ui(e))}function Ui(e){var n=new Set;return JSON.stringify(e,function(t,i){if(typeof i=="object"&&i!==null){if(n.has(i))try{return JSON.parse(JSON.stringify(i))}catch(r){return}n.add(i)}return i})}function Li(e){return""+e.name}function Ki(e,n){n===void 0&&(n={});var t=n[e.id]||{},i=e.name+".worker.js",r=t.workerUrl;return n._workerType==="test"&&(r=e.module+"/dist/"+i),r||(r="https://unpkg.com/"+e.module+"/dist/"+i),assert(r),r}var $i=function(e,n,t,i){function r(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function u(h){try{l(i.next(h))}catch(d){o(d)}}function s(h){try{l(i.throw(h))}catch(d){o(d)}}function l(h){h.done?a(h.value):r(h.value).then(u,s)}l((i=i.apply(e,n||[])).next())})},qi=function(e,n){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(h){return s([l,h])}}function s(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=l[0]&2?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=n.call(e,t)}catch(h){l=[6,h],r=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};function Pi(e,n){return WorkerFarm.isSupported()?e.worker&&(n==null?void 0:n.worker):!1}function fn(e,n,t,i){return t===void 0&&(t={}),i===void 0&&(i={}),$i(this,void 0,void 0,function(){var r,a,o,u,s,l,h,d;return qi(this,function(v){switch(v.label){case 0:return r=getWorkerName(e),a=getWorkerURL(e,t),o=WorkerFarm.getWorkerFarm(t),u=o.getWorkerPool({name:r,url:a}),s=t.jobName||e.name,[4,u.startJob(s,Qi.bind(null,i))];case 1:return l=v.sent(),h=removeNontransferableOptions(t),l.postMessage("process",{input:n,options:h}),[4,l.result];case 2:return d=v.sent(),[2,d.result]}})})}function Qi(e,n,t,i){return $i(this,void 0,void 0,function(){var r,a,o,u,s,l,h;return qi(this,function(d){switch(d.label){case 0:switch(r=t,r){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return n.done(i),[3,9];case 2:return n.error(new Error(i.error)),[3,9];case 3:a=i.id,o=i.input,u=i.options,d.label=4;case 4:return d.trys.push([4,6,,7]),e.process?[4,e.process(o,u)]:(n.postMessage("error",{id:a,error:"Worker not set up to process on main thread"}),[2]);case 5:return s=d.sent(),n.postMessage("done",{id:a,result:s}),[3,7];case 6:return l=d.sent(),h=l instanceof Error?l.message:"unknown error",n.postMessage("error",{id:a,error:h}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+t),d.label=9;case 9:return[2]}})})}var zn=function(){function e(){this._values=[],this._settlers=[],this._closed=!1}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.push=function(n){return this.enqueue(n)},e.prototype.enqueue=function(n){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var t=this._settlers.shift();n instanceof Error?t.reject(n):t.resolve({value:n})}else this._values.push(n)},e.prototype.close=function(){for(;this._settlers.length>0;){var n=this._settlers.shift();n.resolve({done:!0})}this._closed=!0},e.prototype.next=function(){var n=this;if(this._values.length>0){var t=this._values.shift();return t instanceof Error?Promise.reject(t):Promise.resolve({done:!1,value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(i,r){n._settlers.push({resolve:i,reject:r})})},e}(),Xi=zn,Kr=function(e,n,t,i){function r(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function u(h){try{l(i.next(h))}catch(d){o(d)}}function s(h){try{l(i.throw(h))}catch(d){o(d)}}function l(h){h.done?a(h.value):r(h.value).then(u,s)}l((i=i.apply(e,n||[])).next())})},vn=function(e,n){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(h){return s([l,h])}}function s(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=l[0]&2?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=n.call(e,t)}catch(h){l=[6,h],r=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Wn=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=e[a]&&function(o){return new Promise(function(u,s){o=e[a](o),r(u,s,o.done,o.value)})}}function r(a,o,u,s){Promise.resolve(s).then(function(l){a({value:l,done:u})},o)}},Ii=0,wo,fe;function yt(e,n){var t=this;if(typeof self!="undefined"){var i={process:it};sn.onmessage=function(r,a){return Kr(t,void 0,void 0,function(){var o,u,s,l,h,d,v,y,x,S,M;return vn(this,function(O){switch(O.label){case 0:switch(O.trys.push([0,19,,20]),o=r,o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!e)throw new Error("Worker does not support atomic processing");return[4,e(a.input,a.options||{},i)];case 2:return u=O.sent(),sn.postMessage("done",{result:u}),[3,18];case 3:if(!n)throw new Error("Worker does not support batched processing");wo=new Xi,fe=a.options||{},s=n(wo,fe,i),O.label=4;case 4:O.trys.push([4,9,10,15]),l=Wn(s),O.label=5;case 5:return[4,l.next()];case 6:if(h=O.sent(),!!h.done)return[3,8];d=h.value,sn.postMessage("output-batch",{result:d}),O.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return v=O.sent(),S={error:v},[3,15];case 10:return O.trys.push([10,,13,14]),h&&!h.done&&(M=l.return)?[4,M.call(l)]:[3,12];case 11:O.sent(),O.label=12;case 12:return[3,14];case 13:if(S)throw S.error;return[7];case 14:return[7];case 15:return sn.postMessage("done",{}),[3,18];case 16:return wo.push(a.input),[3,18];case 17:return wo.close(),[3,18];case 18:return[3,20];case 19:return y=O.sent(),x=y instanceof Error?y.message:"",sn.postMessage("error",{error:x}),[3,20];case 20:return[2]}})})}}}function it(e,n){return n===void 0&&(n={}),new Promise(function(t,i){var r=Ii++,a=function(u,s){if(s.id===r)switch(u){case"done":sn.removeEventListener(a),t(s.result);break;case"error":sn.removeEventListener(a),i(s.error);break;default:}};sn.addEventListener(a);var o={id:r,input:e,options:n};sn.postMessage("process",o)})}var br=function(e,n,t,i){function r(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function u(h){try{l(i.next(h))}catch(d){o(d)}}function s(h){try{l(i.throw(h))}catch(d){o(d)}}function l(h){h.done?a(h.value):r(h.value).then(u,s)}l((i=i.apply(e,n||[])).next())})},_n=function(e,n){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(h){return s([l,h])}}function s(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=l[0]&2?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=n.call(e,t)}catch(h){l=[6,h],r=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},ie={};function j(e,n,t){return n===void 0&&(n=null),t===void 0&&(t={}),br(this,void 0,void 0,function(){return _n(this,function(i){switch(i.label){case 0:return n&&(e=Ae(e,n,t)),ie[e]=ie[e]||De(e),[4,ie[e]];case 1:return[2,i.sent()]}})})}function Ae(e,n,t){if(e.startsWith("http"))return e;var i=t.modules||{};return i[e]?i[e]:t.CDN?(assert(t.CDN.startsWith("http")),t.CDN+"/"+n+"/dist/libs/"+e):isWorker?"../src/libs/"+e:"modules/"+n+"/src/libs/"+e}function De(e){return br(this,void 0,void 0,function(){var n,t,i;return _n(this,function(r){switch(r.label){case 0:return e.endsWith("wasm")?[4,fetch(e)]:[3,3];case 1:return n=r.sent(),[4,n.arrayBuffer()];case 2:return[2,r.sent()];case 3:return isWorker?[2,importScripts(e)]:[4,fetch(e)];case 4:return t=r.sent(),[4,t.text()];case 5:return i=r.sent(),[2,mt(i,e)]}})})}function mt(e,n){if(isWorker)return eval.call(global,e),null;var t=document.createElement("script");t.id=n;try{t.appendChild(document.createTextNode(e))}catch(i){t.text=e}return document.body.appendChild(t),null}var Ie="0.0.3",Le={id:"null",name:"null",module:"web-worker-helper",options:{}};function ke(e){var n=e.color;return!n||!n.length?[1,1,1,1]:n}function Q(e,n,t){return t.length===2?[t[0],t[1],0]:[t[0],t[1],t[2]]}function Se(e){var n=e.filter;return n?[1]:[0]}function ue(e,n){return[n]}var He=D(9187),Xe=D.n(He),Et=1e-6,Ht=typeof Float32Array!="undefined"?Float32Array:Array,or=Math.random;function _r(e){Ht=e}var ir=Math.PI/180;function Pr(e){return e*ir}function Er(e,n){return Math.abs(e-n)<=Et*Math.max(1,Math.abs(e),Math.abs(n))}Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});function Ut(){var e=new Ht(2);return Ht!=Float32Array&&(e[0]=0,e[1]=0),e}function Lr(e){var n=new glMatrix.ARRAY_TYPE(2);return n[0]=e[0],n[1]=e[1],n}function Cr(e,n){var t=new Ht(2);return t[0]=e,t[1]=n,t}function Ur(e,n){return e[0]=n[0],e[1]=n[1],e}function Qn(e,n,t){return e[0]=n,e[1]=t,e}function Rn(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e}function Ta(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e}function Yu(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e}function Ku(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e}function Ca(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e}function xu(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e}function zo(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e}function Bp(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e}function Mo(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e}function Fh(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e}function _y(e,n,t,i){return e[0]=n[0]+t[0]*i,e[1]=n[1]+t[1]*i,e}function xy(e,n){var t=n[0]-e[0],i=n[1]-e[1];return Math.hypot(t,i)}function Sy(e,n){var t=n[0]-e[0],i=n[1]-e[1];return t*t+i*i}function by(e){var n=e[0],t=e[1];return Math.hypot(n,t)}function Ey(e){var n=e[0],t=e[1];return n*n+t*t}function N0(e,n){return e[0]=-n[0],e[1]=-n[1],e}function Ay(e,n){return e[0]=1/n[0],e[1]=1/n[1],e}function qu(e,n){var t=n[0],i=n[1],r=t*t+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=n[0]*r,e[1]=n[1]*r,e}function Ns(e,n){return e[0]*n[0]+e[1]*n[1]}function Ty(e,n,t){var i=n[0]*t[1]-n[1]*t[0];return e[0]=e[1]=0,e[2]=i,e}function Nh(e,n,t,i){var r=n[0],a=n[1];return e[0]=r+i*(t[0]-r),e[1]=a+i*(t[1]-a),e}function Cy(e,n){n=n||1;var t=glMatrix.RANDOM()*2*Math.PI;return e[0]=Math.cos(t)*n,e[1]=Math.sin(t)*n,e}function wy(e,n,t){var i=n[0],r=n[1];return e[0]=t[0]*i+t[2]*r,e[1]=t[1]*i+t[3]*r,e}function My(e,n,t){var i=n[0],r=n[1];return e[0]=t[0]*i+t[2]*r+t[4],e[1]=t[1]*i+t[3]*r+t[5],e}function Ry(e,n,t){var i=n[0],r=n[1];return e[0]=t[0]*i+t[3]*r+t[6],e[1]=t[1]*i+t[4]*r+t[7],e}function Ly(e,n,t){var i=n[0],r=n[1];return e[0]=t[0]*i+t[4]*r+t[12],e[1]=t[1]*i+t[5]*r+t[13],e}function Py(e,n,t,i){var r=n[0]-t[0],a=n[1]-t[1],o=Math.sin(i),u=Math.cos(i);return e[0]=r*u-a*o+t[0],e[1]=r*o+a*u+t[1],e}function Iy(e,n){var t=e[0],i=e[1],r=n[0],a=n[1],o=Math.sqrt(t*t+i*i)*Math.sqrt(r*r+a*a),u=o&&(t*r+i*a)/o;return Math.acos(Math.min(Math.max(u,-1),1))}function Oy(e){return e[0]=0,e[1]=0,e}function ky(e){return"vec2("+e[0]+", "+e[1]+")"}function Fy(e,n){return e[0]===n[0]&&e[1]===n[1]}function Ny(e,n){var t=e[0],i=e[1],r=n[0],a=n[1];return Math.abs(t-r)<=glMatrix.EPSILON*Math.max(1,Math.abs(t),Math.abs(r))&&Math.abs(i-a)<=glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))}var Dy=null,Kc=Ta,By=null,Zy=null,Uy=null,D0=null,B0=null,zy=function(){var e=Ut();return function(n,t,i,r,a,o){var u,s;for(t||(t=2),i||(i=0),r?s=Math.min(r*t+i,n.length):s=n.length,u=i;u<s;u+=t)e[0]=n[u],e[1]=n[u+1],a(e,e,o),n[u]=e[0],n[u+1]=e[1];return n}}(),Dh=Ut(),Gy=Ut(),ra=Ut(),Su=Ut(),qc=Ut();function Zp(e,n,t,i,r){Rn(e,t,i),qu(e,e),n=Cr(-e[1],e[0]);var a=Cr(-t[1],t[0]);return[r/Ns(n,a),n]}function Sl(e,n){return Qn(e,-n[1],n[0])}function Qc(e,n,t){return Kc(e,n,t),qu(e,e),e}function Up(e,n){return e[0]===n[0]&&e[1]===n[1]}function Vy(e){for(var n=new Map,t=0;t<e.length;t++){var i=e[0].toString()+"-"+e[1].toString();n.get(i)?(e.splice(t,1),t++):n.set(i,i)}return e}var Z0=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,ot.Z)(this,e),(0,R.Z)(this,"lastFlip",-1),(0,R.Z)(this,"miter",Cr(0,0)),(0,R.Z)(this,"started",!1),(0,R.Z)(this,"dash",!1),(0,R.Z)(this,"totalDistance",0),(0,R.Z)(this,"currentIndex",0),this.join=n.join||"miter",this.cap=n.cap||"butt",this.miterLimit=n.miterLimit||10,this.thickness=n.thickness||1,this.dash=n.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,at.Z)(e,[{key:"extrude_gaode2",value:function(t,i){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,o=r.startIndex,u=1;u<a;u++){var s,l,h,d=t[u-1];d.push((s=i[u-1][2])!==null&&s!==void 0?s:0);var v=i[u-1],y=t[u];y.push((l=i[u][2])!==null&&l!==void 0?l:0);var x=i[u],S=u<t.length-1?[].concat((0,L.Z)(t[u+1]),[(h=i[u+1][2])!==null&&h!==void 0?h:0]):null,M=u<i.length-1?i[u+1]:null,O=this.segment_gaode2(r,o,d,y,S,v,x,M);o+=O}if(this.dash)for(var H=0;H<r.positions.length/6;H++)r.positions[H*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,i){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,o=r.startIndex,u=1;u<a;u++){var s,l,h,d=t[u-1];d.push((s=i[u-1][2])!==null&&s!==void 0?s:0);var v=i[u-1],y=t[u];y.push((l=i[u][2])!==null&&l!==void 0?l:0);var x=i[u],S=u<t.length-1?[].concat((0,L.Z)(t[u+1]),[(h=i[u+1][2])!==null&&h!==void 0?h:0]):null,M=u<i.length-1?i[u+1]:null,O=this.simpleSegment(r,o,d,y,S,v,x,M);o+=O}if(this.dash)for(var H=0;H<r.positions.length/6;H++)r.positions[H*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,a=i.startIndex,o=1;o<r;o++){var u=t[o-1],s=t[o],l=o<t.length-1?t[o+1]:null,h=this.segment(i,a,u,s,l);a+=h}if(this.dash)for(var d=0;d<i.positions.length/6;d++)i.positions[d*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude",value:function(t){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,a=i.startIndex,o=1;o<r;o++){var u=t[o-1],s=t[o],l=o<t.length-1?t[o+1]:null,h=this.simpleSegment(i,a,u,s,l);a+=h}if(this.dash)for(var d=0;d<i.positions.length/6;d++)i.positions[d*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"segment_gaode2",value:function(t,i,r,a,o,u,s,l){var h=0,d=t.indices,v=t.positions,y=t.normals,x=this.cap==="square",S=this.join==="bevel",M=ji([s[0],s[1]]),O=ji([u[0],u[1]]);Qc(ra,a,r);var H=0;if(this.dash&&(H=this.lineSegmentDistance(M,O),this.totalDistance+=H),this.normal||(this.normal=Ut(),Sl(this.normal,ra)),!this.started)if(this.started=!0,x){var W=Ut(),he=Ut();Rn(W,this.normal,ra),Rn(he,this.normal,ra),y.push(he[0],he[1],0),y.push(W[0],W[1],0),v.push(r[0],r[1],r[2]|0,this.totalDistance-H,-this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),v.push(r[0],r[1],r[2]|0,this.totalDistance-H,this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(v,y,r,this.normal,this.thickness,this.totalDistance-H);if(d.push(i+0,i+1,i+2),o){Up(a,o)&&Rn(o,a,qu(o,Ta(o,a,r))),Qc(Su,o,a);var ze=Zp(qc,Ut(),ra,Su,this.thickness),ft=(0,Dr.Z)(ze,2),gt=ft[0],Pt=ft[1],Mt=Ns(qc,this.normal)<0?-1:1,sr=S;if(!sr&&this.join==="miter"){var xr=gt;xr>this.miterLimit&&(sr=!0)}sr?(y.push(this.normal[0],this.normal[1],0),y.push(Pt[0],Pt[1],0),v.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Mt,a[2]|0),this.complex.indexes.push(this.currentIndex),v.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*Mt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,d.push.apply(d,(0,L.Z)(this.lastFlip!==-Mt?[i,i+2,i+3]:[i+2,i+1,i+3])),d.push(i+2,i+3,i+4),Sl(Dh,Su),Ur(this.normal,Dh),y.push(this.normal[0],this.normal[1],0),v.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Mt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,h+=3):(this.extrusions(v,y,a,Pt,gt,this.totalDistance),d.push.apply(d,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),Mt=-1,Ur(this.normal,Pt),h+=2),this.lastFlip=Mt}else{if(Sl(this.normal,ra),x){var ve=Ut(),Re=Ut();Kc(Re,ra,this.normal),Rn(ve,ra,this.normal),y.push(Re[0],Re[1],0),y.push(ve[0],ve[1],0),v.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),v.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(v,y,a,this.normal,this.thickness,this.totalDistance);d.push.apply(d,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),h+=2}return h}},{key:"simpleSegment",value:function(t,i,r,a,o){var u=0,s=t.indices,l=t.positions,h=t.normals,d=ji([a[0],a[1]]),v=ji([r[0],r[1]]);Qc(ra,d,v);var y=0;if(this.dash&&(y=this.lineSegmentDistance(d,v),this.totalDistance+=y),this.normal||(this.normal=Ut(),Sl(this.normal,ra)),this.started||(this.started=!0,this.extrusions(l,h,r,this.normal,this.thickness,this.totalDistance-y)),s.push(i+0,i+1,i+2),!o)Sl(this.normal,ra),this.extrusions(l,h,a,this.normal,this.thickness,this.totalDistance),s.push.apply(s,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),u+=2;else{var x=ji([o[0],o[1]]);Up(d,x)&&Rn(x,d,qu(x,Ta(x,d,v))),Qc(Su,x,d);var S=Zp(qc,Ut(),ra,Su,this.thickness),M=(0,Dr.Z)(S,2),O=M[0],H=M[1],W=Ns(qc,this.normal)<0?-1:1;this.extrusions(l,h,a,H,O,this.totalDistance),s.push.apply(s,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),W=-1,Ur(this.normal,H),u+=2,this.lastFlip=W}return u}},{key:"segment",value:function(t,i,r,a,o){var u=0,s=t.indices,l=t.positions,h=t.normals,d=this.cap==="square",v=this.join==="bevel",y=ji([a[0],a[1]]),x=ji([r[0],r[1]]);Qc(ra,y,x);var S=0;if(this.dash&&(S=this.lineSegmentDistance(y,x),this.totalDistance+=S),this.normal||(this.normal=Ut(),Sl(this.normal,ra)),!this.started)if(this.started=!0,d){var M=Ut(),O=Ut();Rn(M,this.normal,ra),Rn(O,this.normal,ra),h.push(O[0],O[1],0),h.push(M[0],M[1],0),l.push(r[0],r[1],r[2]|0,this.totalDistance-S,-this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),l.push(r[0],r[1],r[2]|0,this.totalDistance-S,this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,h,r,this.normal,this.thickness,this.totalDistance-S);if(s.push(i+0,i+1,i+2),o){var he=ji([o[0],o[1]]);Up(y,he)&&Rn(he,y,qu(he,Ta(he,y,x))),Qc(Su,he,y);var ve=Zp(qc,Ut(),ra,Su,this.thickness),Re=(0,Dr.Z)(ve,2),ze=Re[0],ft=Re[1],gt=Ns(qc,this.normal)<0?-1:1,Pt=v;if(!Pt&&this.join==="miter"){var Mt=ze;Mt>this.miterLimit&&(Pt=!0)}Pt?(h.push(this.normal[0],this.normal[1],0),h.push(ft[0],ft[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*gt,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*gt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s.push.apply(s,(0,L.Z)(this.lastFlip!==-gt?[i,i+2,i+3]:[i+2,i+1,i+3])),s.push(i+2,i+3,i+4),Sl(Dh,Su),Ur(this.normal,Dh),h.push(this.normal[0],this.normal[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*gt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,u+=3):(this.extrusions(l,h,a,ft,ze,this.totalDistance),s.push.apply(s,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),gt=-1,Ur(this.normal,ft),u+=2),this.lastFlip=gt}else{if(Sl(this.normal,ra),d){var H=Ut(),W=Ut();Kc(W,ra,this.normal),Rn(H,ra,this.normal),h.push(W[0],W[1],0),h.push(H[0],H[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,h,a,this.normal,this.thickness,this.totalDistance);s.push.apply(s,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),u+=2}return u}},{key:"extrusions",value:function(t,i,r,a,o,u){i.push(a[0],a[1],0),i.push(a[0],a[1],0),t.push(r[0],r[1],r[2]|0,u,-o,r[2]|0),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],r[2]|0,u,o,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,i){var r=i[0]-t[0],a=i[1]-t[1];return Math.sqrt(r*r+a*a)}}]),e}(),Bh=85.0511287798;function zp(e){var n=e.coordinates,t=e.originCoordinates,i=e.version,r=new Z0({dash:!0,join:"bevel"});if(i==="GAODE2.x"){var a=n;Array.isArray(a[0][0])||(a=[n]);var o=t;Array.isArray(o[0][0])||(o=[t]);for(var u=0;u<a.length;u++){var s=a[u],l=o[u];r.extrude_gaode2(s,l)}}else{var h=n;h[0]&&!Array.isArray(h[0][0])&&(h=[n]),h.forEach(function(v){r.extrude(v)})}var d=r.complex;return{vertices:d.positions,indices:d.indices,normals:d.normals,indexes:d.indexes,size:6}}function Zh(e){var n=Zo(e.coordinates);return{vertices:[].concat((0,L.Z)(n),(0,L.Z)(n),(0,L.Z)(n),(0,L.Z)(n)),indices:[0,1,2,2,3,0],size:n.length}}function Xd(e){var n=e.coordinates,t=Xe().flatten(n),i=t.vertices,r=t.dimensions,a=t.holes,o=Xe()(i,a,r);return{indices:o,vertices:i,size:r}}function Gp(e,n){var t=n;return n>Bh&&(t=Bh),n<-Bh&&(t=-Bh),[Math.PI*e/180+Math.PI,Math.PI-Math.log(Math.tan(Math.PI*.25+Math.PI*t/180*.5))]}function Hy(e,n){return[(e-Math.PI)*180/Math.PI,(Math.atan(Math.exp(Math.PI-n))-Math.PI*.25)*2*180/Math.PI]}var Yd=function(){var e=(0,st.Z)(q().mark(function n(t){var i,r,a,o,u,s,l,h,d;return q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return i=t.descriptors,r=t.features,a=t.enablePicking,o=t.iconMap,u={a_Color:ke,a_Position:Q,filter:Se,a_vertexId:ue,a_PickingColor:function(S){var M=S.id;return a?Eo(M):[0,0,0]},a_DistanceAndIndex:function(S,M,O,H,W,he){return he===void 0?[O[3],10]:[O[3],he]},a_Total_Distance:function(S,M,O){return[O[5]]},a_Size:function(S){var M=S.size,O=M===void 0?1:M;return Array.isArray(O)?[O[0],O[1]]:[O,0]},a_Normal:function(S,M,O,H,W){return W},a_Miter:function(S,M,O){return[O[4]]},a_iconMapUV:function(S){var M=S.texture,O=o[M]||{x:0,y:0},H=O.x,W=O.y;return[H,W]}},s={sizePerElement:0,elements:[]},l=0,h=[],d=3,r.forEach(function(x,S){var M=zp(x),O=M.indices,H=M.vertices,W=M.normals,he=M.size,ve=M.indexes;O.forEach(function(gt){h.push(gt+l)}),d=he;var Re=H.length/he;s.sizePerElement=d,s.elements.push({featureIdx:S,vertices:H,normals:W,offset:l}),l+=Re;for(var ze=function(Pt){var Mt=(W==null?void 0:W.slice(Pt*3,Pt*3+3))||[],sr=H.slice(Pt*he,Pt*he+he),xr=0;ve&&ve[Pt]!==void 0&&(xr=ve[Pt]),i.forEach(function(Br){if(Br&&u[Br.name]){var kn;(kn=Br.buffer.data).push.apply(kn,(0,L.Z)(u[Br.name](x,S,sr,Pt,Mt,xr)))}})},ft=0;ft<Re;ft++)ze(ft)}),y.abrupt("return",{descriptors:i,featureLayout:s,indices:h});case 8:case"end":return y.stop()}},n)}));return function(t){return e.apply(this,arguments)}}(),Kd=function(){var e=(0,st.Z)(q().mark(function n(t){var i,r,a,o,u,s,l,h,d;return q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return i=t.descriptors,r=t.features,a=t.enablePicking,o=t.shape2d,u={a_Color:ke,a_Position:Q,filter:Se,a_vertexId:ue,a_PickingColor:function(S){var M=S.id;return a?Eo(M):[0,0,0]},a_Shape:function(S){var M=S.shape,O=M===void 0?2:M,H=o.indexOf(O);return[H]},a_Extrude:function(S,M,O,H){var W=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],he=H%4*3;return[W[he],W[he+1],W[he+2]]},a_Size:function(S){var M=S.size,O=M===void 0?5:M;return Array.isArray(O)?[O[0]]:[O]}},s={sizePerElement:0,elements:[]},l=0,h=[],d=3,r.forEach(function(x,S){var M=Zh(x),O=M.indices,H=M.vertices,W=M.normals,he=M.size,ve=M.indexes;O.forEach(function(gt){h.push(gt+l)}),d=he;var Re=H.length/he;s.sizePerElement=d,s.elements.push({featureIdx:S,vertices:H,normals:W,offset:l}),l+=Re;for(var ze=function(Pt){var Mt=(W==null?void 0:W.slice(Pt*3,Pt*3+3))||[],sr=H.slice(Pt*he,Pt*he+he),xr=0;ve&&ve[Pt]!==void 0&&(xr=ve[Pt]),i.forEach(function(Br){if(Br&&u[Br.name]){var kn;(kn=Br.buffer.data).push.apply(kn,(0,L.Z)(u[Br.name](x,S,sr,Pt,Mt,xr)))}})},ft=0;ft<Re;ft++)ze(ft)}),y.abrupt("return",{descriptors:i,featureLayout:s,indices:h});case 8:case"end":return y.stop()}},n)}));return function(t){return e.apply(this,arguments)}}(),Vp=function(){var e=(0,st.Z)(q().mark(function n(t){var i,r,a,o,u,s,l,h;return q().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return i=t.descriptors,r=t.features,a=t.enablePicking,o={a_Color:ke,a_Position:Q,filter:Se,a_vertexId:ue,a_PickingColor:function(x){var S=x.id;return a?Eo(S):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,l=[],h=3,r.forEach(function(y,x){var S=Xd(y),M=S.indices,O=S.vertices,H=S.normals,W=S.size,he=S.indexes;M.forEach(function(ft){l.push(ft+s)}),h=W;var ve=O.length/W;u.sizePerElement=h,u.elements.push({featureIdx:x,vertices:O,normals:H,offset:s}),s+=ve;for(var Re=function(gt){var Pt=(H==null?void 0:H.slice(gt*3,gt*3+3))||[],Mt=O.slice(gt*W,gt*W+W),sr=0;he&&he[gt]!==void 0&&(sr=he[gt]),i.forEach(function(xr){if(xr&&o[xr.name]){var Br;(Br=xr.buffer.data).push.apply(Br,(0,L.Z)(o[xr.name](y,x,Mt,gt,Pt,sr)))}})},ze=0;ze<ve;ze++)Re(ze)}),v.abrupt("return",{descriptors:i,featureLayout:u,indices:l});case 8:case"end":return v.stop()}},n)}));return function(t){return e.apply(this,arguments)}}(),qd={pointFill:Kd,line:Yd,polygonFill:Vp},Hp=(0,b.Z)({},qd);function Qd(e){return Uh.apply(this,arguments)}function Uh(){return Uh=(0,st.Z)(q().mark(function e(n){var t,i;return q().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=n.workerType,i=n.data,!Hp[t]){a.next=3;break}return a.abrupt("return",Hp[t](i));case 3:return a.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(t,'" non-existent.'))));case 4:case"end":return a.stop()}},e)})),Uh.apply(this,arguments)}yt(Qd);var Jd=new Map;function U0(e,n){Jd.set(e,n)}function jy(e){var n=Jd.get(e);return n}var zh=`var L7=function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:E(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var h={};function p(){}function v(){}function d(){}var y={};c(y,a,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(k([])));m&&m!==e&&n.call(m,a)&&(y=m);var b=d.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){var r;o(this,"_invoke",{value:function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return I()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=A(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function A(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=d,o(b,"constructor",{value:d,configurable:!0}),o(d,"constructor",{value:v,configurable:!0}),v.displayName=c(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},x(w.prototype),c(w.prototype,u,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(b),c(b,s,"Generator"),c(b,a,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,s,"next",t)}function s(t){n(a,o,i,u,s,"throw",t)}u(void 0)}))}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return(e=b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function w(t,e){return t(e={exports:{}},e.exports),e.exports}var E,A,O=function(t){return t&&t.Math==Math&&t},S=O("object"==typeof globalThis&&globalThis)||O("object"==typeof window&&window)||O("object"==typeof self&&self)||O("object"==typeof x&&x)||function(){return this}()||Function("return this")(),T=Object.defineProperty,k=function(t,e){try{T(S,t,{value:e,configurable:!0,writable:!0})}catch(r){S[t]=e}return e},I=S["__core-js_shared__"]||k("__core-js_shared__",{}),j=w((function(t){(t.exports=function(t,e){return I[t]||(I[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.26.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"})})),P=function(t){try{return!!t()}catch(t){return!0}},_=!P((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),M=Function.prototype,L=M.call,R=_&&M.bind.bind(L,L),C=_?R:function(t){return function(){return L.apply(t,arguments)}},N=function(t){return null==t},D=TypeError,F=function(t){if(N(t))throw D("Can't call method on "+t);return t},W=Object,z=function(t){return W(F(t))},B=C({}.hasOwnProperty),U=Object.hasOwn||function(t,e){return B(z(t),e)},G=0,H=Math.random(),V=C(1..toString),q=function(t){return"Symbol("+(void 0===t?"":t)+")_"+V(++G+H,36)},Z="object"==typeof document&&document.all,Y={all:Z,IS_HTMLDDA:void 0===Z&&void 0!==Z},$=Y.all,K=Y.IS_HTMLDDA?function(t){return"function"==typeof t||t===$}:function(t){return"function"==typeof t},Q=function(t){return K(t)?t:void 0},X=function(t,e){return arguments.length<2?Q(S[t]):S[t]&&S[t][e]},J=X("navigator","userAgent")||"",tt=S.process,et=S.Deno,rt=tt&&tt.versions||et&&et.version,nt=rt&&rt.v8;nt&&(A=(E=nt.split("."))[0]>0&&E[0]<4?1:+(E[0]+E[1])),!A&&J&&(!(E=J.match(/Edge\\/(\\d+)/))||E[1]>=74)&&(E=J.match(/Chrome\\/(\\d+)/))&&(A=+E[1]);var ot=A,it=!!Object.getOwnPropertySymbols&&!P((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ot&&ot<41})),at=it&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ut=j("wks"),st=S.Symbol,ct=st&&st.for,ft=at?st:st&&st.withoutSetter||q,lt=function(t){if(!U(ut,t)||!it&&"string"!=typeof ut[t]){var e="Symbol."+t;it&&U(st,t)?ut[t]=st[t]:ut[t]=at&&ct?ct(e):ft(e)}return ut[t]},ht={};ht[lt("toStringTag")]="z";var pt="[object z]"===String(ht),vt=!P((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),dt=Y.all,yt=Y.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:K(t)||t===dt}:function(t){return"object"==typeof t?null!==t:K(t)},gt=S.document,mt=yt(gt)&&yt(gt.createElement),bt=function(t){return mt?gt.createElement(t):{}},xt=!vt&&!P((function(){return 7!=Object.defineProperty(bt("div"),"a",{get:function(){return 7}}).a})),wt=vt&&P((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Et=String,At=TypeError,Ot=function(t){if(yt(t))return t;throw At(Et(t)+" is not an object")},St=Function.prototype.call,Tt=_?St.bind(St):function(){return St.apply(St,arguments)},kt=C({}.isPrototypeOf),It=Object,jt=at?function(t){return"symbol"==typeof t}:function(t){var e=X("Symbol");return K(e)&&kt(e.prototype,It(t))},Pt=String,_t=function(t){try{return Pt(t)}catch(t){return"Object"}},Mt=TypeError,Lt=function(t){if(K(t))return t;throw Mt(_t(t)+" is not a function")},Rt=function(t,e){var r=t[e];return N(r)?void 0:Lt(r)},Ct=TypeError,Nt=TypeError,Dt=lt("toPrimitive"),Ft=function(t,e){if(!yt(t)||jt(t))return t;var r,n=Rt(t,Dt);if(n){if(void 0===e&&(e="default"),r=Tt(n,t,e),!yt(r)||jt(r))return r;throw Nt("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var r,n;if("string"===e&&K(r=t.toString)&&!yt(n=Tt(r,t)))return n;if(K(r=t.valueOf)&&!yt(n=Tt(r,t)))return n;if("string"!==e&&K(r=t.toString)&&!yt(n=Tt(r,t)))return n;throw Ct("Can't convert object to primitive value")}(t,e)},Wt=function(t){var e=Ft(t,"string");return jt(e)?e:e+""},zt=TypeError,Bt=Object.defineProperty,Ut=Object.getOwnPropertyDescriptor,Gt={f:vt?wt?function(t,e,r){if(Ot(t),e=Wt(e),Ot(r),"function"==typeof t&&"prototype"===e&&"value"in r&&"writable"in r&&!r.writable){var n=Ut(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return Bt(t,e,r)}:Bt:function(t,e,r){if(Ot(t),e=Wt(e),Ot(r),xt)try{return Bt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw zt("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},Ht=Function.prototype,Vt=vt&&Object.getOwnPropertyDescriptor,qt=U(Ht,"name"),Zt={EXISTS:qt,PROPER:qt&&"something"===function(){}.name,CONFIGURABLE:qt&&(!vt||vt&&Vt(Ht,"name").configurable)},Yt=C(Function.toString);K(I.inspectSource)||(I.inspectSource=function(t){return Yt(t)});var $t,Kt,Qt,Xt=I.inspectSource,Jt=S.WeakMap,te=K(Jt)&&/native code/.test(String(Jt)),ee=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},re=vt?function(t,e,r){return Gt.f(t,e,ee(1,r))}:function(t,e,r){return t[e]=r,t},ne=j("keys"),oe=function(t){return ne[t]||(ne[t]=q(t))},ie={},ae=S.TypeError,ue=S.WeakMap;if(te||I.state){var se=I.state||(I.state=new ue);se.get=se.get,se.has=se.has,se.set=se.set,$t=function(t,e){if(se.has(t))throw ae("Object already initialized");return e.facade=t,se.set(t,e),e},Kt=function(t){return se.get(t)||{}},Qt=function(t){return se.has(t)}}else{var ce=oe("state");ie[ce]=!0,$t=function(t,e){if(U(t,ce))throw ae("Object already initialized");return e.facade=t,re(t,ce,e),e},Kt=function(t){return U(t,ce)?t[ce]:{}},Qt=function(t){return U(t,ce)}}var fe={set:$t,get:Kt,has:Qt,enforce:function(t){return Qt(t)?Kt(t):$t(t,{})},getterFor:function(t){return function(e){var r;if(!yt(e)||(r=Kt(e)).type!==t)throw ae("Incompatible receiver, "+t+" required");return r}}},le=w((function(t){var e=Zt.CONFIGURABLE,r=fe.enforce,n=fe.get,o=Object.defineProperty,i=vt&&!P((function(){return 8!==o((function(){}),"length",{value:8}).length})),a=String(String).split("String"),u=t.exports=function(t,n,u){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\\(([^)]*)\\)/,"$1")+"]"),u&&u.getter&&(n="get "+n),u&&u.setter&&(n="set "+n),(!U(t,"name")||e&&t.name!==n)&&(vt?o(t,"name",{value:n,configurable:!0}):t.name=n),i&&u&&U(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&U(u,"constructor")&&u.constructor?vt&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var s=r(t);return U(s,"source")||(s.source=a.join("string"==typeof n?n:"")),t};Function.prototype.toString=u((function(){return K(this)&&n(this).source||Xt(this)}),"toString")})),he=function(t,e,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:e;if(K(r)&&le(r,i,n),n.global)o?t[e]=r:k(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:Gt.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},pe=C({}.toString),ve=C("".slice),de=function(t){return ve(pe(t),8,-1)},ye=lt("toStringTag"),ge=Object,me="Arguments"==de(function(){return arguments}()),be=pt?de:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=ge(t),ye))?r:me?de(e):"Object"==(n=de(e))&&K(e.callee)?"Arguments":n},xe=pt?{}.toString:function(){return"[object "+be(this)+"]"};pt||he(Object.prototype,"toString",xe,{unsafe:!0});var we={}.propertyIsEnumerable,Ee=Object.getOwnPropertyDescriptor,Ae={f:Ee&&!we.call({1:2},1)?function(t){var e=Ee(this,t);return!!e&&e.enumerable}:we},Oe=Object,Se=C("".split),Te=P((function(){return!Oe("z").propertyIsEnumerable(0)}))?function(t){return"String"==de(t)?Se(t,""):Oe(t)}:Oe,ke=function(t){return Te(F(t))},Ie=Object.getOwnPropertyDescriptor,je={f:vt?Ie:function(t,e){if(t=ke(t),e=Wt(e),xt)try{return Ie(t,e)}catch(t){}if(U(t,e))return ee(!Tt(Ae.f,t,e),t[e])}},Pe=Math.ceil,_e=Math.floor,Me=Math.trunc||function(t){var e=+t;return(e>0?_e:Pe)(e)},Le=function(t){var e=+t;return e!=e||0===e?0:Me(e)},Re=Math.max,Ce=Math.min,Ne=function(t,e){var r=Le(t);return r<0?Re(r+e,0):Ce(r,e)},De=Math.min,Fe=function(t){return t>0?De(Le(t),9007199254740991):0},We=function(t){return Fe(t.length)},ze=function(t){return function(e,r,n){var o,i=ke(e),a=We(i),u=Ne(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},Be={includes:ze(!0),indexOf:ze(!1)},Ue=Be.indexOf,Ge=C([].push),He=function(t,e){var r,n=ke(t),o=0,i=[];for(r in n)!U(ie,r)&&U(n,r)&&Ge(i,r);for(;e.length>o;)U(n,r=e[o++])&&(~Ue(i,r)||Ge(i,r));return i},Ve=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],qe=Ve.concat("length","prototype"),Ze={f:Object.getOwnPropertyNames||function(t){return He(t,qe)}},Ye={f:Object.getOwnPropertySymbols},$e=C([].concat),Ke=X("Reflect","ownKeys")||function(t){var e=Ze.f(Ot(t)),r=Ye.f;return r?$e(e,r(t)):e},Qe=function(t,e,r){for(var n=Ke(e),o=Gt.f,i=je.f,a=0;a<n.length;a++){var u=n[a];U(t,u)||r&&U(r,u)||o(t,u,i(e,u))}},Xe=/#|\\.prototype\\./,Je=function(t,e){var r=er[tr(t)];return r==nr||r!=rr&&(K(e)?P(e):!!e)},tr=Je.normalize=function(t){return String(t).replace(Xe,".").toLowerCase()},er=Je.data={},rr=Je.NATIVE="N",nr=Je.POLYFILL="P",or=Je,ir=je.f,ar=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?S:c?S[u]||k(u,{}):(S[u]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(a=ir(r,n))&&a.value:r[n],!or(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Qe(i,o)}(t.sham||o&&o.sham)&&re(i,"sham",!0),he(r,n,i,t)}},ur="process"==de(S.process),sr=String,cr=TypeError,fr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=C(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return Ot(r),function(t){if("object"==typeof t||K(t))return t;throw cr("Can't set "+sr(t)+" as a prototype")}(n),e?t(r,n):r.__proto__=n,r}}():void 0),lr=Gt.f,hr=lt("toStringTag"),pr=function(t,e,r){t&&!r&&(t=t.prototype),t&&!U(t,hr)&&lr(t,hr,{configurable:!0,value:e})},vr=lt("species"),dr=function(t){var e=X(t),r=Gt.f;vt&&e&&!e[vr]&&r(e,vr,{configurable:!0,get:function(){return this}})},yr=TypeError,gr=function(t,e){if(kt(e,t))return t;throw yr("Incorrect invocation")},mr=function(){},br=[],xr=X("Reflect","construct"),wr=/^\\s*(?:class|function)\\b/,Er=C(wr.exec),Ar=!wr.exec(mr),Or=function(t){if(!K(t))return!1;try{return xr(mr,br,t),!0}catch(t){return!1}},Sr=function(t){if(!K(t))return!1;switch(be(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ar||!!Er(wr,Xt(t))}catch(t){return!0}};Sr.sham=!0;var Tr,kr,Ir,jr,Pr=!xr||P((function(){var t;return Or(Or.call)||!Or(Object)||!Or((function(){t=!0}))||t}))?Sr:Or,_r=TypeError,Mr=function(t){if(Pr(t))return t;throw _r(_t(t)+" is not a constructor")},Lr=lt("species"),Rr=function(t,e){var r,n=Ot(t).constructor;return void 0===n||N(r=Ot(n)[Lr])?e:Mr(r)},Cr=Function.prototype,Nr=Cr.apply,Dr=Cr.call,Fr="object"==typeof Reflect&&Reflect.apply||(_?Dr.bind(Nr):function(){return Dr.apply(Nr,arguments)}),Wr=function(t){if("Function"===de(t))return C(t)},zr=Wr(Wr.bind),Br=function(t,e){return Lt(t),void 0===e?t:_?zr(t,e):function(){return t.apply(e,arguments)}},Ur=X("document","documentElement"),Gr=C([].slice),Hr=TypeError,Vr=function(t,e){if(t<e)throw Hr("Not enough arguments");return t},qr=/(?:ipad|iphone|ipod).*applewebkit/i.test(J),Zr=S.setImmediate,Yr=S.clearImmediate,$r=S.process,Kr=S.Dispatch,Qr=S.Function,Xr=S.MessageChannel,Jr=S.String,tn=0,en={};try{Tr=S.location}catch(t){}var rn=function(t){if(U(en,t)){var e=en[t];delete en[t],e()}},nn=function(t){return function(){rn(t)}},on=function(t){rn(t.data)},an=function(t){S.postMessage(Jr(t),Tr.protocol+"//"+Tr.host)};Zr&&Yr||(Zr=function(t){Vr(arguments.length,1);var e=K(t)?t:Qr(t),r=Gr(arguments,1);return en[++tn]=function(){Fr(e,void 0,r)},kr(tn),tn},Yr=function(t){delete en[t]},ur?kr=function(t){$r.nextTick(nn(t))}:Kr&&Kr.now?kr=function(t){Kr.now(nn(t))}:Xr&&!qr?(jr=(Ir=new Xr).port2,Ir.port1.onmessage=on,kr=Br(jr.postMessage,jr)):S.addEventListener&&K(S.postMessage)&&!S.importScripts&&Tr&&"file:"!==Tr.protocol&&!P(an)?(kr=an,S.addEventListener("message",on,!1)):kr="onreadystatechange"in bt("script")?function(t){Ur.appendChild(bt("script")).onreadystatechange=function(){Ur.removeChild(this),rn(t)}}:function(t){setTimeout(nn(t),0)});var un,sn,cn,fn,ln,hn,pn,vn,dn={set:Zr,clear:Yr},yn=/ipad|iphone|ipod/i.test(J)&&void 0!==S.Pebble,gn=/web0s(?!.*chrome)/i.test(J),mn=je.f,bn=dn.set,xn=S.MutationObserver||S.WebKitMutationObserver,wn=S.document,En=S.process,An=S.Promise,On=mn(S,"queueMicrotask"),Sn=On&&On.value;Sn||(un=function(){var t,e;for(ur&&(t=En.domain)&&t.exit();sn;){e=sn.fn,sn=sn.next;try{e()}catch(t){throw sn?fn():cn=void 0,t}}cn=void 0,t&&t.enter()},qr||ur||gn||!xn||!wn?!yn&&An&&An.resolve?((pn=An.resolve(void 0)).constructor=An,vn=Br(pn.then,pn),fn=function(){vn(un)}):ur?fn=function(){En.nextTick(un)}:(bn=Br(bn,S),fn=function(){bn(un)}):(ln=!0,hn=wn.createTextNode(""),new xn(un).observe(hn,{characterData:!0}),fn=function(){hn.data=ln=!ln}));var Tn=Sn||function(t){var e={fn:t,next:void 0};cn&&(cn.next=e),sn||(sn=e,fn()),cn=e},kn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},In=function(){this.head=null,this.tail=null};In.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var jn,Pn,_n,Mn=In,Ln=S.Promise,Rn="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Cn=!Rn&&!ur&&"object"==typeof window&&"object"==typeof document,Nn=(Ln&&Ln.prototype,lt("species")),Dn=!1,Fn=K(S.PromiseRejectionEvent),Wn={CONSTRUCTOR:or("Promise",(function(){var t=Xt(Ln),e=t!==String(Ln);if(!e&&66===ot)return!0;if(!ot||ot<51||!/native code/.test(t)){var r=new Ln((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Nn]=n,!(Dn=r.then((function(){}))instanceof n))return!0}return!e&&(Cn||Rn)&&!Fn})),REJECTION_EVENT:Fn,SUBCLASSING:Dn},zn=TypeError,Bn=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw zn("Bad Promise constructor");e=t,r=n})),this.resolve=Lt(e),this.reject=Lt(r)},Un={f:function(t){return new Bn(t)}},Gn=dn.set,Hn=Wn.CONSTRUCTOR,Vn=Wn.REJECTION_EVENT,qn=Wn.SUBCLASSING,Zn=fe.getterFor("Promise"),Yn=fe.set,$n=Ln&&Ln.prototype,Kn=Ln,Qn=$n,Xn=S.TypeError,Jn=S.document,to=S.process,eo=Un.f,ro=eo,no=!!(Jn&&Jn.createEvent&&S.dispatchEvent),oo=function(t){var e;return!(!yt(t)||!K(e=t.then))&&e},io=function(t,e){var r,n,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&fo(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(Xn("Promise-chain cycle")):(n=oo(r))?Tt(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},ao=function(t,e){t.notified||(t.notified=!0,Tn((function(){for(var r,n=t.reactions;r=n.get();)io(r,t);t.notified=!1,e&&!t.rejection&&so(t)})))},uo=function(t,e,r){var n,o;no?((n=Jn.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),S.dispatchEvent(n)):n={promise:e,reason:r},!Vn&&(o=S["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=S.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},so=function(t){Tt(Gn,S,(function(){var e,r=t.facade,n=t.value;if(co(t)&&(e=kn((function(){ur?to.emit("unhandledRejection",n,r):uo("unhandledrejection",r,n)})),t.rejection=ur||co(t)?2:1,e.error))throw e.value}))},co=function(t){return 1!==t.rejection&&!t.parent},fo=function(t){Tt(Gn,S,(function(){var e=t.facade;ur?to.emit("rejectionHandled",e):uo("rejectionhandled",e,t.value)}))},lo=function(t,e,r){return function(n){t(e,n,r)}},ho=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,ao(t,!0))},po=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Xn("Promise can't be resolved itself");var n=oo(e);n?Tn((function(){var r={done:!1};try{Tt(n,e,lo(po,r,t),lo(ho,r,t))}catch(e){ho(r,e,t)}})):(t.value=e,t.state=1,ao(t,!1))}catch(e){ho({done:!1},e,t)}}};if(Hn&&(Qn=(Kn=function(t){gr(this,Qn),Lt(t),Tt(jn,this);var e=Zn(this);try{t(lo(po,e),lo(ho,e))}catch(t){ho(e,t)}}).prototype,(jn=function(t){Yn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new Mn,rejection:!1,state:0,value:void 0})}).prototype=he(Qn,"then",(function(t,e){var r=Zn(this),n=eo(Rr(this,Kn));return r.parent=!0,n.ok=!K(t)||t,n.fail=K(e)&&e,n.domain=ur?to.domain:void 0,0==r.state?r.reactions.add(n):Tn((function(){io(n,r)})),n.promise})),Pn=function(){var t=new jn,e=Zn(t);this.promise=t,this.resolve=lo(po,e),this.reject=lo(ho,e)},Un.f=eo=function(t){return t===Kn||void 0===t?new Pn(t):ro(t)},K(Ln)&&$n!==Object.prototype)){_n=$n.then,qn||he($n,"then",(function(t,e){var r=this;return new Kn((function(t,e){Tt(_n,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete $n.constructor}catch(t){}fr&&fr($n,Qn)}ar({global:!0,constructor:!0,wrap:!0,forced:Hn},{Promise:Kn}),pr(Kn,"Promise",!1),dr("Promise");var vo={},yo=lt("iterator"),go=Array.prototype,mo=function(t){return void 0!==t&&(vo.Array===t||go[yo]===t)},bo=lt("iterator"),xo=function(t){if(!N(t))return Rt(t,bo)||Rt(t,"@@iterator")||vo[be(t)]},wo=TypeError,Eo=function(t,e){var r=arguments.length<2?xo(t):e;if(Lt(r))return Ot(Tt(r,t));throw wo(_t(t)+" is not iterable")},Ao=function(t,e,r){var n,o;Ot(t);try{if(!(n=Rt(t,"return"))){if("throw"===e)throw r;return r}n=Tt(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return Ot(n),r},Oo=TypeError,So=function(t,e){this.stopped=t,this.result=e},To=So.prototype,ko=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),v=!(!r||!r.INTERRUPTED),d=Br(e,f),y=function(t){return n&&Ao(n,"normal",t),new So(!0,t)},g=function(t){return l?(Ot(t),v?d(t[0],t[1],y):d(t[0],t[1])):v?d(t,y):d(t)};if(h)n=t.iterator;else if(p)n=t;else{if(!(o=xo(t)))throw Oo(_t(t)+" is not iterable");if(mo(o)){for(i=0,a=We(t);a>i;i++)if((u=g(t[i]))&&kt(To,u))return u;return new So(!1)}n=Eo(t,o)}for(s=h?t.next:n.next;!(c=Tt(s,n)).done;){try{u=g(c.value)}catch(t){Ao(n,"throw",t)}if("object"==typeof u&&u&&kt(To,u))return u}return new So(!1)},Io=lt("iterator"),jo=!1;try{var Po=0,_o={next:function(){return{done:!!Po++}},return:function(){jo=!0}};_o[Io]=function(){return this},Array.from(_o,(function(){throw 2}))}catch(t){}var Mo=function(t,e){if(!e&&!jo)return!1;var r=!1;try{var n={};n[Io]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Lo=Wn.CONSTRUCTOR||!Mo((function(t){Ln.all(t).then(void 0,(function(){}))}));ar({target:"Promise",stat:!0,forced:Lo},{all:function(t){var e=this,r=Un.f(e),n=r.resolve,o=r.reject,i=kn((function(){var r=Lt(e.resolve),i=[],a=0,u=1;ko(t,(function(t){var s=a++,c=!1;u++,Tt(r,e,t).then((function(t){c||(c=!0,i[s]=t,--u||n(i))}),o)})),--u||n(i)}));return i.error&&o(i.value),r.promise}});var Ro=Wn.CONSTRUCTOR,Co=Ln&&Ln.prototype;if(ar({target:"Promise",proto:!0,forced:Ro,real:!0},{catch:function(t){return this.then(void 0,t)}}),K(Ln)){var No=X("Promise").prototype.catch;Co.catch!==No&&he(Co,"catch",No,{unsafe:!0})}ar({target:"Promise",stat:!0,forced:Lo},{race:function(t){var e=this,r=Un.f(e),n=r.reject,o=kn((function(){var o=Lt(e.resolve);ko(t,(function(t){Tt(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),ar({target:"Promise",stat:!0,forced:Wn.CONSTRUCTOR},{reject:function(t){var e=Un.f(this);return Tt(e.reject,void 0,t),e.promise}});var Do=Wn.CONSTRUCTOR;X("Promise");function Fo(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}ar({target:"Promise",stat:!0,forced:Do},{resolve:function(t){return function(t,e){if(Ot(t),yt(e)&&e.constructor===t)return e;var r=Un.f(t);return(0,r.resolve)(e),r.promise}(this,t)}});var Wo="undefined"!=typeof window&&void 0!==window.orientation,zo=function(){function t(t,e){var r=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){r.resolve=t,r.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){Fo(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){Fo(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),Bo=new Map;function Uo(t){Fo(t.source&&!t.url||!t.source&&t.url);var e=Bo.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Go((e=t,"try {\\n  importScripts('"+e+"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}"));var e}(t.url),Bo.set(t.url,e)),t.source&&(e=Go(t.source),Bo.set(t.source,e))),Fo(e),e}function Go(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Ho(t,e,r){void 0===e&&(e=!0);var n=r||new Set;if(t){if(Vo(t))n.add(t);else if(Vo(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var o in t)Ho(t[o],e,n)}else;return void 0===r?Array.from(n):[]}function Vo(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var qo=function(){},Zo=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,r=t.source,n=t.url;Fo(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=qo,this.onError=function(t){return console.log(t)},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=qo,this.onError=qo,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||Ho(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=Uo({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(e){return console.error("worker "+t.name+", message error: "+e)},e},t}(),Yo=self&&self.__assign||function(){return(Yo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},$o=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},Ko=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Qo=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=Yo(Yo({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,r){return void 0===e&&(e=function(t,e,r){return t.done(r)}),void 0===r&&(r=function(t,e){return t.error(e)}),$o(this,void 0,void 0,(function(){var n,o=this;return Ko(this,(function(i){switch(i.label){case 0:return n=new Promise((function(n){return o.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),o})),this.startQueuedJob(),[4,n];case 1:return[2,i.sent()]}}))}))},t.prototype.startQueuedJob=function(){return $o(this,void 0,void 0,(function(){var t,e,r;return Ko(this,(function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),r=new zo(e.name,t),t.onMessage=function(t){return e.onMessage(r,t.type,t.payload)},t.onError=function(t){return e.onError(r,t)},e.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Zo({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return Wo?this.maxMobileConcurrency:this.maxConcurrency},t}(),Xo=self&&self.__assign||function(){return(Xo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Jo=self&&self.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ti={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},ei=(function(){function t(t){this.workerPools=new Map,this.props=Xo({},ti),this.setProps(t),this.workerPools=new Map}t.isSupported=function(){return Zo.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var r=Jo(this.workerPools.values()),n=r.next();!n.done;n=r.next()){n.value.destroy()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,r;this.props=Xo(Xo({},this.props),t);try{for(var n=Jo(this.workerPools.values()),o=n.next();!o.done;o=n.next()){o.value.setProps(this.getWorkerPoolProps())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,r=t.source,n=t.url,o=this.workerPools.get(e);return o||((o=new Qo({name:e,source:r,url:n})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,o)),o},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(),new Map),ri=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(ni(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=ei.get(t);e||(e=function(e){if(ni(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=ei.get(t);ei.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var r={source:"Worker thread",type:t,payload:e},n=Ho(e);self.postMessage(r,n)}},t}();function ni(t){var e=t.type,r=t.data;return"message"===e&&r&&"string"==typeof r.source&&"Main thread"===r.source}self&&self.__awaiter,self&&self.__generator;var oi,ii,ai=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,r){t._settlers.push({resolve:e,reject:r})}))},t}(),ui=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},si=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ci=self&&self.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},fi=0;function li(t,e){var r=this;if("undefined"!=typeof self){var n={process:hi};ri.onmessage=function(o,i){return ui(r,void 0,void 0,(function(){var r,a,u,s,c,f,l,h,p,v;return si(this,(function(d){switch(d.label){case 0:switch(d.trys.push([0,19,,20]),o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(i.input,i.options||{},n)];case 2:return r=d.sent(),ri.postMessage("done",{result:r}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");oi=new ai,ii=i.options||{},a=e(oi,ii,n),d.label=4;case 4:d.trys.push([4,9,10,15]),u=ci(a),d.label=5;case 5:return[4,u.next()];case 6:if((s=d.sent()).done)return[3,8];c=s.value,ri.postMessage("output-batch",{result:c}),d.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return f=d.sent(),p={error:f},[3,15];case 10:return d.trys.push([10,,13,14]),s&&!s.done&&(v=u.return)?[4,v.call(u)]:[3,12];case 11:d.sent(),d.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return ri.postMessage("done",{}),[3,18];case 16:return oi.push(i.input),[3,18];case 17:return oi.close(),[3,18];case 18:return[3,20];case 19:return l=d.sent(),h=l instanceof Error?l.message:"",ri.postMessage("error",{error:h}),[3,20];case 20:return[2]}}))}))}}}function hi(t,e){return void 0===e&&(e={}),new Promise((function(r,n){var o=fi++,i=function(t,e){if(e.id===o)switch(t){case"done":ri.removeEventListener(i),r(e.result);break;case"error":ri.removeEventListener(i),n(e.error)}};ri.addEventListener(i);var a={id:o,input:t,options:e};ri.postMessage("process",a)}))}self&&self.__awaiter,self&&self.__generator;var pi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},vi=bt("span").classList,di=vi&&vi.constructor&&vi.constructor.prototype,yi=di===Object.prototype?void 0:di,gi=Array.isArray||function(t){return"Array"==de(t)},mi=lt("species"),bi=Array,xi=function(t,e){return new(function(t){var e;return gi(t)&&(e=t.constructor,(Pr(e)&&(e===bi||gi(e.prototype))||yt(e)&&null===(e=e[mi]))&&(e=void 0)),void 0===e?bi:e}(t))(0===e?0:e)},wi=C([].push),Ei=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(s,c,f,l){for(var h,p,v=z(s),d=Te(v),y=Br(c,f),g=We(d),m=0,b=l||xi,x=e?b(s,g):r||a?b(s,0):void 0;g>m;m++)if((u||m in d)&&(p=y(h=d[m],m,v),t))if(e)x[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:wi(x,h)}else switch(t){case 4:return!1;case 7:wi(x,h)}return i?-1:n||o?o:x}},Ai={forEach:Ei(0),map:Ei(1),filter:Ei(2),some:Ei(3),every:Ei(4),find:Ei(5),findIndex:Ei(6),filterReject:Ei(7)},Oi=function(t,e){var r=[][t];return!!r&&P((function(){r.call(null,e||function(){return 1},1)}))},Si=Ai.forEach,Ti=Oi("forEach")?[].forEach:function(t){return Si(this,t,arguments.length>1?arguments[1]:void 0)},ki=function(t){if(t&&t.forEach!==Ti)try{re(t,"forEach",Ti)}catch(e){t.forEach=Ti}};for(var Ii in pi)pi[Ii]&&ki(S[Ii]&&S[Ii].prototype);ki(yi);var ji=function(t,e,r){var n=Wt(e);n in t?Gt.f(t,n,ee(0,r)):t[n]=r},Pi=lt("species"),_i=function(t){return ot>=51||!P((function(){var e=[];return(e.constructor={})[Pi]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},Mi=_i("slice"),Li=lt("species"),Ri=Array,Ci=Math.max;ar({target:"Array",proto:!0,forced:!Mi},{slice:function(t,e){var r,n,o,i=ke(this),a=We(i),u=Ne(t,a),s=Ne(void 0===e?a:e,a);if(gi(i)&&(r=i.constructor,(Pr(r)&&(r===Ri||gi(r.prototype))||yt(r)&&null===(r=r[Li]))&&(r=void 0),r===Ri||void 0===r))return Gr(i,u,s);for(n=new(void 0===r?Ri:r)(Ci(s-u,0)),o=0;u<s;u++,o++)u in i&&ji(n,o,i[u]);return n.length=o,n}});var Ni=Zt.EXISTS,Di=Gt.f,Fi=Function.prototype,Wi=C(Fi.toString),zi=/function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/,Bi=C(zi.exec);vt&&!Ni&&Di(Fi,"name",{configurable:!0,get:function(){try{return Bi(zi,Wi(this))[1]}catch(t){return""}}});var Ui,Gi=Object.keys||function(t){return He(t,Ve)},Hi={f:vt&&!wt?Object.defineProperties:function(t,e){Ot(t);for(var r,n=ke(e),o=Gi(e),i=o.length,a=0;i>a;)Gt.f(t,r=o[a++],n[r]);return t}},Vi=oe("IE_PROTO"),qi=function(){},Zi=function(t){return"<script>"+t+"<\\/script>"},Yi=function(t){t.write(Zi("")),t.close();var e=t.parentWindow.Object;return t=null,e},$i=function(){try{Ui=new ActiveXObject("htmlfile")}catch(t){}var t,e;$i="undefined"!=typeof document?document.domain&&Ui?Yi(Ui):((e=bt("iframe")).style.display="none",Ur.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Zi("document.F=Object")),t.close(),t.F):Yi(Ui);for(var r=Ve.length;r--;)delete $i.prototype[Ve[r]];return $i()};ie[Vi]=!0;var Ki=Object.create||function(t,e){var r;return null!==t?(qi.prototype=Ot(t),r=new qi,qi.prototype=null,r[Vi]=t):r=$i(),void 0===e?r:Hi.f(r,e)},Qi=Gt.f,Xi=lt("unscopables"),Ji=Array.prototype;null==Ji[Xi]&&Qi(Ji,Xi,{configurable:!0,value:Ki(null)});var ta,ea,ra,na=function(t){Ji[Xi][t]=!0},oa=!P((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),ia=oe("IE_PROTO"),aa=Object,ua=aa.prototype,sa=oa?aa.getPrototypeOf:function(t){var e=z(t);if(U(e,ia))return e[ia];var r=e.constructor;return K(r)&&e instanceof r?r.prototype:e instanceof aa?ua:null},ca=lt("iterator"),fa=!1;[].keys&&("next"in(ra=[].keys())?(ea=sa(sa(ra)))!==Object.prototype&&(ta=ea):fa=!0),(!yt(ta)||P((function(){var t={};return ta[ca].call(t)!==t})))&&(ta={}),K(ta[ca])||he(ta,ca,(function(){return this}));var la={IteratorPrototype:ta,BUGGY_SAFARI_ITERATORS:fa},ha=la.IteratorPrototype,pa=function(){return this},va=Zt.PROPER,da=Zt.CONFIGURABLE,ya=la.IteratorPrototype,ga=la.BUGGY_SAFARI_ITERATORS,ma=lt("iterator"),ba=function(){return this},xa=function(t,e,r,n,o,i,a){!function(t,e,r,n){var o=e+" Iterator";t.prototype=Ki(ha,{next:ee(+!n,r)}),pr(t,o,!1),vo[o]=pa}(r,e,n);var u,s,c,f=function(t){if(t===o&&d)return d;if(!ga&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",h=!1,p=t.prototype,v=p[ma]||p["@@iterator"]||o&&p[o],d=!ga&&v||f(o),y="Array"==e&&p.entries||v;if(y&&(u=sa(y.call(new t)))!==Object.prototype&&u.next&&(sa(u)!==ya&&(fr?fr(u,ya):K(u[ma])||he(u,ma,ba)),pr(u,l,!0)),va&&"values"==o&&v&&"values"!==v.name&&(da?re(p,"name","values"):(h=!0,d=function(){return Tt(v,this)})),o)if(s={values:f("values"),keys:i?d:f("keys"),entries:f("entries")},a)for(c in s)(ga||h||!(c in p))&&he(p,c,s[c]);else ar({target:e,proto:!0,forced:ga||h},s);return p[ma]!==d&&he(p,ma,d,{name:o}),vo[e]=d,s},wa=function(t,e){return{value:t,done:e}},Ea=Gt.f,Aa=fe.set,Oa=fe.getterFor("Array Iterator"),Sa=xa(Array,"Array",(function(t,e){Aa(this,{type:"Array Iterator",target:ke(t),index:0,kind:e})}),(function(){var t=Oa(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,wa(void 0,!0)):wa("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),Ta=vo.Arguments=vo.Array;if(na("keys"),na("values"),na("entries"),vt&&"values"!==Ta.name)try{Ea(Ta,"name",{value:"values"})}catch(t){}var ka,Ia,ja,Pa="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,_a=Gt.f,Ma=fe.enforce,La=fe.get,Ra=S.Int8Array,Ca=Ra&&Ra.prototype,Na=S.Uint8ClampedArray,Da=Na&&Na.prototype,Fa=Ra&&sa(Ra),Wa=Ca&&sa(Ca),za=Object.prototype,Ba=S.TypeError,Ua=lt("toStringTag"),Ga=q("TYPED_ARRAY_TAG"),Ha=Pa&&!!fr&&"Opera"!==be(S.opera),Va=!1,qa={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Za={BigInt64Array:8,BigUint64Array:8},Ya=function(t){var e=sa(t);if(yt(e)){var r=La(e);return r&&U(r,"TypedArrayConstructor")?r.TypedArrayConstructor:Ya(e)}},$a=function(t){if(!yt(t))return!1;var e=be(t);return U(qa,e)||U(Za,e)};for(ka in qa)(ja=(Ia=S[ka])&&Ia.prototype)?Ma(ja).TypedArrayConstructor=Ia:Ha=!1;for(ka in Za)(ja=(Ia=S[ka])&&Ia.prototype)&&(Ma(ja).TypedArrayConstructor=Ia);if((!Ha||!K(Fa)||Fa===Function.prototype)&&(Fa=function(){throw Ba("Incorrect invocation")},Ha))for(ka in qa)S[ka]&&fr(S[ka],Fa);if((!Ha||!Wa||Wa===za)&&(Wa=Fa.prototype,Ha))for(ka in qa)S[ka]&&fr(S[ka].prototype,Wa);if(Ha&&sa(Da)!==Wa&&fr(Da,Wa),vt&&!U(Wa,Ua))for(ka in Va=!0,_a(Wa,Ua,{get:function(){return yt(this)?this[Ga]:void 0}}),qa)S[ka]&&re(S[ka],Ga,ka);var Ka={NATIVE_ARRAY_BUFFER_VIEWS:Ha,TYPED_ARRAY_TAG:Va&&Ga,aTypedArray:function(t){if($a(t))return t;throw Ba("Target is not a typed array")},aTypedArrayConstructor:function(t){if(K(t)&&(!fr||kt(Fa,t)))return t;throw Ba(_t(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(vt){if(r)for(var o in qa){var i=S[o];if(i&&U(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}Wa[t]&&!r||he(Wa,t,r?e:Ha&&Ca[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(vt){if(fr){if(r)for(n in qa)if((o=S[n])&&U(o,t))try{delete o[t]}catch(t){}if(Fa[t]&&!r)return;try{return he(Fa,t,r?e:Ha&&Fa[t]||e)}catch(t){}}for(n in qa)!(o=S[n])||o[t]&&!r||he(o,t,e)}},getTypedArrayConstructor:Ya,isView:function(t){if(!yt(t))return!1;var e=be(t);return"DataView"===e||U(qa,e)||U(Za,e)},isTypedArray:$a,TypedArray:Fa,TypedArrayPrototype:Wa},Qa=Ka.NATIVE_ARRAY_BUFFER_VIEWS,Xa=S.ArrayBuffer,Ja=S.Int8Array,tu=!Qa||!P((function(){Ja(1)}))||!P((function(){new Ja(-1)}))||!Mo((function(t){new Ja,new Ja(null),new Ja(1.5),new Ja(t)}),!0)||P((function(){return 1!==new Ja(new Xa(2),1,void 0).length})),eu=function(t,e,r){for(var n in e)he(t,n,e[n],r);return t},ru=RangeError,nu=function(t){if(void 0===t)return 0;var e=Le(t),r=Fe(e);if(e!==r)throw ru("Wrong length or index");return r},ou=Array,iu=Math.abs,au=Math.pow,uu=Math.floor,su=Math.log,cu=Math.LN2,fu=function(t,e,r){var n,o,i,a=ou(r),u=8*r-e-1,s=(1<<u)-1,c=s>>1,f=23===e?au(2,-24)-au(2,-77):0,l=t<0||0===t&&1/t<0?1:0,h=0;for((t=iu(t))!=t||t===1/0?(o=t!=t?1:0,n=s):(n=uu(su(t)/cu),t*(i=au(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?f/i:f*au(2,1-c))*i>=2&&(n++,i/=2),n+c>=s?(o=0,n=s):n+c>=1?(o=(t*i-1)*au(2,e),n+=c):(o=t*au(2,c-1)*au(2,e),n=0));e>=8;)a[h++]=255&o,o/=256,e-=8;for(n=n<<e|o,u+=e;u>0;)a[h++]=255&n,n/=256,u-=8;return a[--h]|=128*l,a},lu=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,s=n-1,c=t[s--],f=127&c;for(c>>=7;u>0;)f=256*f+t[s--],u-=8;for(r=f&(1<<-u)-1,f>>=-u,u+=e;u>0;)r=256*r+t[s--],u-=8;if(0===f)f=1-a;else{if(f===i)return r?NaN:c?-1/0:1/0;r+=au(2,e),f-=a}return(c?-1:1)*r*au(2,f-e)},hu=function(t){for(var e=z(this),r=We(e),n=arguments.length,o=Ne(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Ne(i,r);a>o;)e[o++]=t;return e},pu=Array,vu=Math.max,du=function(t,e,r){for(var n=We(t),o=Ne(e,n),i=Ne(void 0===r?n:r,n),a=pu(vu(i-o,0)),u=0;o<i;o++,u++)ji(a,u,t[o]);return a.length=u,a},yu=Ze.f,gu=Gt.f,mu=Zt.PROPER,bu=Zt.CONFIGURABLE,xu=fe.get,wu=fe.set,Eu=S.ArrayBuffer,Au=Eu,Ou=Au&&Au.prototype,Su=S.DataView,Tu=Su&&Su.prototype,ku=Object.prototype,Iu=S.Array,ju=S.RangeError,Pu=C(hu),_u=C([].reverse),Mu=fu,Lu=lu,Ru=function(t){return[255&t]},Cu=function(t){return[255&t,t>>8&255]},Nu=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Du=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Fu=function(t){return Mu(t,23,4)},Wu=function(t){return Mu(t,52,8)},zu=function(t,e){gu(t.prototype,e,{get:function(){return xu(this)[e]}})},Bu=function(t,e,r,n){var o=nu(r),i=xu(t);if(o+e>i.byteLength)throw ju("Wrong index");var a=xu(i.buffer).bytes,u=o+i.byteOffset,s=du(a,u,u+e);return n?s:_u(s)},Uu=function(t,e,r,n,o,i){var a=nu(r),u=xu(t);if(a+e>u.byteLength)throw ju("Wrong index");for(var s=xu(u.buffer).bytes,c=a+u.byteOffset,f=n(+o),l=0;l<e;l++)s[c+l]=f[i?l:e-l-1]};if(Pa){var Gu=mu&&"ArrayBuffer"!==Eu.name;if(P((function(){Eu(1)}))&&P((function(){new Eu(-1)}))&&!P((function(){return new Eu,new Eu(1.5),new Eu(NaN),1!=Eu.length||Gu&&!bu})))Gu&&bu&&re(Eu,"name","ArrayBuffer");else{(Au=function(t){return gr(this,Ou),new Eu(nu(t))}).prototype=Ou;for(var Hu,Vu=yu(Eu),qu=0;Vu.length>qu;)(Hu=Vu[qu++])in Au||re(Au,Hu,Eu[Hu]);Ou.constructor=Au}fr&&sa(Tu)!==ku&&fr(Tu,ku);var Zu=new Su(new Au(2)),Yu=C(Tu.setInt8);Zu.setInt8(0,2147483648),Zu.setInt8(1,2147483649),!Zu.getInt8(0)&&Zu.getInt8(1)||eu(Tu,{setInt8:function(t,e){Yu(this,t,e<<24>>24)},setUint8:function(t,e){Yu(this,t,e<<24>>24)}},{unsafe:!0})}else Ou=(Au=function(t){gr(this,Ou);var e=nu(t);wu(this,{bytes:Pu(Iu(e),0),byteLength:e}),vt||(this.byteLength=e)}).prototype,Tu=(Su=function(t,e,r){gr(this,Tu),gr(t,Ou);var n=xu(t).byteLength,o=Le(e);if(o<0||o>n)throw ju("Wrong offset");if(o+(r=void 0===r?n-o:Fe(r))>n)throw ju("Wrong length");wu(this,{buffer:t,byteLength:r,byteOffset:o}),vt||(this.buffer=t,this.byteLength=r,this.byteOffset=o)}).prototype,vt&&(zu(Au,"byteLength"),zu(Su,"buffer"),zu(Su,"byteLength"),zu(Su,"byteOffset")),eu(Tu,{getInt8:function(t){return Bu(this,1,t)[0]<<24>>24},getUint8:function(t){return Bu(this,1,t)[0]},getInt16:function(t){var e=Bu(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Bu(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Du(Bu(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Du(Bu(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Lu(Bu(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Lu(Bu(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Uu(this,1,t,Ru,e)},setUint8:function(t,e){Uu(this,1,t,Ru,e)},setInt16:function(t,e){Uu(this,2,t,Cu,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Uu(this,2,t,Cu,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Uu(this,4,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Uu(this,4,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Uu(this,4,t,Fu,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Uu(this,8,t,Wu,e,arguments.length>2?arguments[2]:void 0)}});pr(Au,"ArrayBuffer"),pr(Su,"DataView");var $u={ArrayBuffer:Au,DataView:Su},Ku=Math.floor,Qu=Number.isInteger||function(t){return!yt(t)&&isFinite(t)&&Ku(t)===t},Xu=RangeError,Ju=RangeError,ts=function(t,e){var r=function(t){var e=Le(t);if(e<0)throw Xu("The argument can't be less than 0");return e}(t);if(r%e)throw Ju("Wrong offset");return r},es=C("".slice),rs=function(t){return"Big"===es(be(t),0,3)},ns=TypeError,os=function(t){var e=Ft(t,"number");if("number"==typeof e)throw ns("Can't convert number to bigint");return BigInt(e)},is=Ka.aTypedArrayConstructor,as=function(t){var e,r,n,o,i,a,u,s,c=Mr(this),f=z(t),l=arguments.length,h=l>1?arguments[1]:void 0,p=void 0!==h,v=xo(f);if(v&&!mo(v))for(s=(u=Eo(f,v)).next,f=[];!(a=Tt(s,u)).done;)f.push(a.value);for(p&&l>2&&(h=Br(h,arguments[2])),r=We(f),n=new(is(c))(r),o=rs(n),e=0;r>e;e++)i=p?h(f[e],e):f[e],n[e]=o?os(i):+i;return n},us=function(t,e,r){var n,o;return fr&&K(n=e.constructor)&&n!==r&&yt(o=n.prototype)&&o!==r.prototype&&fr(t,o),t},ss=w((function(t){var e=Ze.f,r=Ai.forEach,n=fe.get,o=fe.set,i=fe.enforce,a=Gt.f,u=je.f,s=Math.round,c=S.RangeError,f=$u.ArrayBuffer,l=f.prototype,h=$u.DataView,p=Ka.NATIVE_ARRAY_BUFFER_VIEWS,v=Ka.TYPED_ARRAY_TAG,d=Ka.TypedArray,y=Ka.TypedArrayPrototype,g=Ka.aTypedArrayConstructor,m=Ka.isTypedArray,b=function(t,e){g(t);for(var r=0,n=e.length,o=new t(n);n>r;)o[r]=e[r++];return o},x=function(t,e){a(t,e,{get:function(){return n(this)[e]}})},w=function(t){var e;return kt(l,t)||"ArrayBuffer"==(e=be(t))||"SharedArrayBuffer"==e},E=function(t,e){return m(t)&&!jt(e)&&e in t&&Qu(+e)&&e>=0},A=function(t,e){return e=Wt(e),E(t,e)?ee(2,t[e]):u(t,e)},O=function(t,e,r){return e=Wt(e),!(E(t,e)&&yt(r)&&U(r,"value"))||U(r,"get")||U(r,"set")||r.configurable||U(r,"writable")&&!r.writable||U(r,"enumerable")&&!r.enumerable?a(t,e,r):(t[e]=r.value,t)};vt?(p||(je.f=A,Gt.f=O,x(y,"buffer"),x(y,"byteOffset"),x(y,"byteLength"),x(y,"length")),ar({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:A,defineProperty:O}),t.exports=function(t,u,l){var g=t.match(/\\d+$/)[0]/8,x=t+(l?"Clamped":"")+"Array",E="get"+t,A="set"+t,O=S[x],T=O,k=T&&T.prototype,I={},j=function(t,e){a(t,e,{get:function(){return function(t,e){var r=n(t);return r.view[E](e*g+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var o=n(t);l&&(r=(r=s(r))<0?0:r>255?255:255&r),o.view[A](e*g+o.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};p?tu&&(T=u((function(t,e,r,n){return gr(t,k),us(yt(e)?w(e)?void 0!==n?new O(e,ts(r,g),n):void 0!==r?new O(e,ts(r,g)):new O(e):m(e)?b(T,e):Tt(as,T,e):new O(nu(e)),t,T)})),fr&&fr(T,d),r(e(O),(function(t){t in T||re(T,t,O[t])})),T.prototype=k):(T=u((function(t,e,r,n){gr(t,k);var i,a,u,s=0,l=0;if(yt(e)){if(!w(e))return m(e)?b(T,e):Tt(as,T,e);i=e,l=ts(r,g);var p=e.byteLength;if(void 0===n){if(p%g)throw c("Wrong length");if((a=p-l)<0)throw c("Wrong length")}else if((a=Fe(n)*g)+l>p)throw c("Wrong length");u=a/g}else u=nu(e),i=new f(a=u*g);for(o(t,{buffer:i,byteOffset:l,byteLength:a,length:u,view:new h(i)});s<u;)j(t,s++)})),fr&&fr(T,d),k=T.prototype=Ki(y)),k.constructor!==T&&re(k,"constructor",T),i(k).TypedArrayConstructor=T,v&&re(k,v,x);var P=T!=O;I[x]=T,ar({global:!0,constructor:!0,forced:P,sham:!p},I),"BYTES_PER_ELEMENT"in T||re(T,"BYTES_PER_ELEMENT",g),"BYTES_PER_ELEMENT"in k||re(k,"BYTES_PER_ELEMENT",g),dr(x)}):t.exports=function(){}}));ss("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0);var cs=TypeError,fs=function(t,e){if(!delete t[e])throw cs("Cannot delete property "+_t(e)+" of "+_t(t))},ls=Math.min,hs=C([].copyWithin||function(t,e){var r=z(this),n=We(r),o=Ne(t,n),i=Ne(e,n),a=arguments.length>2?arguments[2]:void 0,u=ls((void 0===a?n:Ne(a,n))-i,n-o),s=1;for(i<o&&o<i+u&&(s=-1,i+=u-1,o+=u-1);u-- >0;)i in r?r[o]=r[i]:fs(r,o),o+=s,i+=s;return r}),ps=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("copyWithin",(function(t,e){return hs(ps(this),t,e,arguments.length>2?arguments[2]:void 0)}));var vs=Ai.every,ds=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("every",(function(t){return vs(ds(this),t,arguments.length>1?arguments[1]:void 0)}));var ys=Ka.aTypedArray,gs=Ka.exportTypedArrayMethod,ms=C("".slice);gs("fill",(function(t){var e=arguments.length;ys(this);var r="Big"===ms(be(this),0,3)?os(t):+t;return Tt(hu,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),P((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var bs=Ka.aTypedArrayConstructor,xs=Ka.getTypedArrayConstructor,ws=function(t){return bs(Rr(t,xs(t)))},Es=function(t,e){return function(t,e){for(var r=0,n=We(e),o=new t(n);n>r;)o[r]=e[r++];return o}(ws(t),e)},As=Ai.filter,Os=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("filter",(function(t){var e=As(Os(this),t,arguments.length>1?arguments[1]:void 0);return Es(this,e)}));var Ss=Ai.find,Ts=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("find",(function(t){return Ss(Ts(this),t,arguments.length>1?arguments[1]:void 0)}));var ks=Ai.findIndex,Is=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("findIndex",(function(t){return ks(Is(this),t,arguments.length>1?arguments[1]:void 0)}));var js=Ai.forEach,Ps=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("forEach",(function(t){js(Ps(this),t,arguments.length>1?arguments[1]:void 0)}));var _s=Be.includes,Ms=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("includes",(function(t){return _s(Ms(this),t,arguments.length>1?arguments[1]:void 0)}));var Ls=Be.indexOf,Rs=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("indexOf",(function(t){return Ls(Rs(this),t,arguments.length>1?arguments[1]:void 0)}));var Cs=lt("iterator"),Ns=S.Uint8Array,Ds=C(Sa.values),Fs=C(Sa.keys),Ws=C(Sa.entries),zs=Ka.aTypedArray,Bs=Ka.exportTypedArrayMethod,Us=Ns&&Ns.prototype,Gs=!P((function(){Us[Cs].call([1])})),Hs=!!Us&&Us.values&&Us[Cs]===Us.values&&"values"===Us.values.name,Vs=function(){return Ds(zs(this))};Bs("entries",(function(){return Ws(zs(this))}),Gs),Bs("keys",(function(){return Fs(zs(this))}),Gs),Bs("values",Vs,Gs||!Hs,{name:"values"}),Bs(Cs,Vs,Gs||!Hs,{name:"values"});var qs=Ka.aTypedArray,Zs=Ka.exportTypedArrayMethod,Ys=C([].join);Zs("join",(function(t){return Ys(qs(this),t)}));var $s=Math.min,Ks=[].lastIndexOf,Qs=!!Ks&&1/[1].lastIndexOf(1,-0)<0,Xs=Oi("lastIndexOf"),Js=Qs||!Xs?function(t){if(Qs)return Fr(Ks,this,arguments)||0;var e=ke(this),r=We(e),n=r-1;for(arguments.length>1&&(n=$s(n,Le(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:Ks,tc=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("lastIndexOf",(function(t){var e=arguments.length;return Fr(Js,tc(this),e>1?[t,arguments[1]]:[t])}));var ec=Ai.map,rc=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("map",(function(t){return ec(rc(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(ws(t))(e)}))}));var nc=TypeError,oc=function(t){return function(e,r,n,o){Lt(r);var i=z(e),a=Te(i),u=We(i),s=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw nc("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(o=r(o,a[s],s,i));return o}},ic={left:oc(!1),right:oc(!0)},ac=ic.left,uc=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("reduce",(function(t){var e=arguments.length;return ac(uc(this),t,e,e>1?arguments[1]:void 0)}));var sc=ic.right,cc=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("reduceRight",(function(t){var e=arguments.length;return sc(cc(this),t,e,e>1?arguments[1]:void 0)}));var fc=Ka.aTypedArray,lc=Ka.exportTypedArrayMethod,hc=Math.floor;lc("reverse",(function(){for(var t,e=fc(this).length,r=hc(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this}));var pc=S.RangeError,vc=S.Int8Array,dc=vc&&vc.prototype,yc=dc&&dc.set,gc=Ka.aTypedArray,mc=Ka.exportTypedArrayMethod,bc=!P((function(){var t=new Uint8ClampedArray(2);return Tt(yc,t,{length:1,0:3},1),3!==t[1]})),xc=bc&&Ka.NATIVE_ARRAY_BUFFER_VIEWS&&P((function(){var t=new vc(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));mc("set",(function(t){gc(this);var e=ts(arguments.length>1?arguments[1]:void 0,1),r=z(t);if(bc)return Tt(yc,this,r,e);var n=this.length,o=We(r),i=0;if(o+e>n)throw pc("Wrong length");for(;i<o;)this[e+i]=r[i++]}),!bc||xc);var wc=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("slice",(function(t,e){for(var r=Gr(wc(this),t,e),n=ws(this),o=0,i=r.length,a=new n(i);i>o;)a[o]=r[o++];return a}),P((function(){new Int8Array(1).slice()})));var Ec=Ai.some,Ac=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("some",(function(t){return Ec(Ac(this),t,arguments.length>1?arguments[1]:void 0)}));var Oc=Math.floor,Sc=function(t,e){var r=t.length,n=Oc(r/2);return r<8?Tc(t,e):kc(t,Sc(du(t,0,n),e),Sc(du(t,n),e),e)},Tc=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},kc=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,u=0;a<o||u<i;)t[a+u]=a<o&&u<i?n(e[a],r[u])<=0?e[a++]:r[u++]:a<o?e[a++]:r[u++];return t},Ic=Sc,jc=J.match(/firefox\\/(\\d+)/i),Pc=!!jc&&+jc[1],_c=/MSIE|Trident/.test(J),Mc=J.match(/AppleWebKit\\/(\\d+)\\./),Lc=!!Mc&&+Mc[1],Rc=Ka.aTypedArray,Cc=Ka.exportTypedArrayMethod,Nc=S.Uint16Array,Dc=Nc&&Wr(Nc.prototype.sort),Fc=!(!Dc||P((function(){Dc(new Nc(2),null)}))&&P((function(){Dc(new Nc(2),{})}))),Wc=!!Dc&&!P((function(){if(ot)return ot<74;if(Pc)return Pc<67;if(_c)return!0;if(Lc)return Lc<602;var t,e,r=new Nc(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(Dc(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));Cc("sort",(function(t){return void 0!==t&&Lt(t),Wc?Dc(this,t):Ic(Rc(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!Wc||Fc);var zc=Ka.aTypedArray;(0,Ka.exportTypedArrayMethod)("subarray",(function(t,e){var r=zc(this),n=r.length,o=Ne(t,n);return new(ws(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,Fe((void 0===e?n:Ne(e,n))-o))}));var Bc=S.Int8Array,Uc=Ka.aTypedArray,Gc=Ka.exportTypedArrayMethod,Hc=[].toLocaleString,Vc=!!Bc&&P((function(){Hc.call(new Bc(1))}));Gc("toLocaleString",(function(){return Fr(Hc,Vc?Gr(Uc(this)):Uc(this),Gr(arguments))}),P((function(){return[1,2].toLocaleString()!=new Bc([1,2]).toLocaleString()}))||!P((function(){Bc.prototype.toLocaleString.call([1,2])})));var qc=Ka.exportTypedArrayMethod,Zc=S.Uint8Array,Yc=Zc&&Zc.prototype||{},$c=[].toString,Kc=C([].join);P((function(){$c.call({})}))&&($c=function(){return Kc(this)});var Qc=Yc.toString!=$c;qc("toString",$c,Qc),ar({target:"Array",proto:!0},{fill:hu}),na("fill");var Xc,Jc,tf=String,ef=function(t){if("Symbol"===be(t))throw TypeError("Cannot convert a Symbol value to a string");return tf(t)},rf=function(){var t=Ot(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},nf=S.RegExp,of=P((function(){var t=nf("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),af=of||P((function(){return!nf("a","y").sticky})),uf={BROKEN_CARET:of||P((function(){var t=nf("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:af,UNSUPPORTED_Y:of},sf=S.RegExp,cf=P((function(){var t=sf(".","s");return!(t.dotAll&&t.exec("\\n")&&"s"===t.flags)})),ff=S.RegExp,lf=P((function(){var t=ff("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),hf=fe.get,pf=j("native-string-replace",String.prototype.replace),vf=RegExp.prototype.exec,df=vf,yf=C("".charAt),gf=C("".indexOf),mf=C("".replace),bf=C("".slice),xf=(Jc=/b*/g,Tt(vf,Xc=/a/,"a"),Tt(vf,Jc,"a"),0!==Xc.lastIndex||0!==Jc.lastIndex),wf=uf.BROKEN_CARET,Ef=void 0!==/()??/.exec("")[1];(xf||Ef||wf||cf||lf)&&(df=function(t){var e,r,n,o,i,a,u,s=this,c=hf(s),f=ef(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,e=Tt(df,l,f),s.lastIndex=l.lastIndex,e;var h=c.groups,p=wf&&s.sticky,v=Tt(rf,s),d=s.source,y=0,g=f;if(p&&(v=mf(v,"y",""),-1===gf(v,"g")&&(v+="g"),g=bf(f,s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\\n"!==yf(f,s.lastIndex-1))&&(d="(?: "+d+")",g=" "+g,y++),r=new RegExp("^(?:"+d+")",v)),Ef&&(r=new RegExp("^"+d+"$(?!\\\\s)",v)),xf&&(n=s.lastIndex),o=Tt(vf,p?r:s,g),p?o?(o.input=bf(o.input,y),o[0]=bf(o[0],y),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:xf&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),Ef&&o&&o.length>1&&Tt(pf,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=a=Ki(null),i=0;i<h.length;i++)a[(u=h[i])[0]]=o[u[1]];return o});var Af=df;ar({target:"RegExp",proto:!0,forced:/./.exec!==Af},{exec:Af});var Of,Sf=lt("species"),Tf=RegExp.prototype,kf=function(t,e,r,n){var o=lt(t),i=!P((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!P((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[Sf]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return e=!0,null},r[o](""),!e}));if(!i||!a||r){var u=Wr(/./[o]),s=e(o,""[t],(function(t,e,r,n,o){var a=Wr(t),s=e.exec;return s===Af||s===Tf.exec?i&&!o?{done:!0,value:u(e,r,n)}:{done:!0,value:a(r,e,n)}:{done:!1}}));he(String.prototype,t,s[0]),he(Tf,o,s[1])}n&&re(Tf[o],"sham",!0)},If=C("".charAt),jf=C("".charCodeAt),Pf=C("".slice),_f=function(t){return function(e,r){var n,o,i=ef(F(e)),a=Le(r),u=i.length;return a<0||a>=u?t?"":void 0:(n=jf(i,a))<55296||n>56319||a+1===u||(o=jf(i,a+1))<56320||o>57343?t?If(i,a):n:t?Pf(i,a,a+2):o-56320+(n-55296<<10)+65536}},Mf={codeAt:_f(!1),charAt:_f(!0)},Lf=Mf.charAt,Rf=function(t,e,r){return e+(r?Lf(t,e).length:1)},Cf=Math.floor,Nf=C("".charAt),Df=C("".replace),Ff=C("".slice),Wf=/\\$([$&'\`]|\\d{1,2}|<[^>]*>)/g,zf=/\\$([$&'\`]|\\d{1,2})/g,Bf=function(t,e,r,n,o,i){var a=r+t.length,u=n.length,s=zf;return void 0!==o&&(o=z(o),s=Wf),Df(i,s,(function(i,s){var c;switch(Nf(s,0)){case"$":return"$";case"&":return t;case"\`":return Ff(e,0,r);case"'":return Ff(e,a);case"<":c=o[Ff(s,1,-1)];break;default:var f=+s;if(0===f)return i;if(f>u){var l=Cf(f/10);return 0===l?i:l<=u?void 0===n[l-1]?Nf(s,1):n[l-1]+Nf(s,1):i}c=n[f-1]}return void 0===c?"":c}))},Uf=TypeError,Gf=function(t,e){var r=t.exec;if(K(r)){var n=Tt(r,t,e);return null!==n&&Ot(n),n}if("RegExp"===de(t))return Tt(Af,t,e);throw Uf("RegExp#exec called on incompatible receiver")},Hf=lt("replace"),Vf=Math.max,qf=Math.min,Zf=C([].concat),Yf=C([].push),$f=C("".indexOf),Kf=C("".slice),Qf="$0"==="a".replace(/./,"$0"),Xf=!!/./[Hf]&&""===/./[Hf]("a","$0");function Jf(t){this.message=t}kf("replace",(function(t,e,r){var n=Xf?"$":"$0";return[function(t,r){var n=F(this),o=N(t)?void 0:Rt(t,Hf);return o?Tt(o,t,n,r):Tt(e,ef(n),t,r)},function(t,o){var i=Ot(this),a=ef(t);if("string"==typeof o&&-1===$f(o,n)&&-1===$f(o,"$<")){var u=r(e,i,a,o);if(u.done)return u.value}var s=K(o);s||(o=ef(o));var c=i.global;if(c){var f=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Gf(i,a);if(null===h)break;if(Yf(l,h),!c)break;""===ef(h[0])&&(i.lastIndex=Rf(a,Fe(i.lastIndex),f))}for(var p,v="",d=0,y=0;y<l.length;y++){for(var g=ef((h=l[y])[0]),m=Vf(qf(Le(h.index),a.length),0),b=[],x=1;x<h.length;x++)Yf(b,void 0===(p=h[x])?p:String(p));var w=h.groups;if(s){var E=Zf([g],b,m,a);void 0!==w&&Yf(E,w);var A=ef(Fr(o,void 0,E))}else A=Bf(g,a,m,b,w,o);m>=d&&(v+=Kf(a,d,m)+A,d=m+g.length)}return v+Kf(a,d)}]}),!!P((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!Qf||Xf),Jf.prototype=new Error,Jf.prototype.name="InvalidCharacterError",ar({global:!0,forced:S.globalThis!==S},{globalThis:S}),Of="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,r){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window,"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:Of.devicePixelRatio;var tl=TypeError,el=Object.getOwnPropertyDescriptor,rl=vt&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(gi(t)&&!el(t,"length").writable)throw tl("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},nl=TypeError,ol=function(t){if(t>9007199254740991)throw nl("Maximum allowed index exceeded");return t},il=_i("splice"),al=Math.max,ul=Math.min;ar({target:"Array",proto:!0,forced:!il},{splice:function(t,e){var r,n,o,i,a,u,s=z(this),c=We(s),f=Ne(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-f):(r=l-2,n=ul(al(Le(e),0),c-f)),ol(c+r-n),o=xi(s,n),i=0;i<n;i++)(a=f+i)in s&&ji(o,i,s[a]);if(o.length=n,r<n){for(i=f;i<c-n;i++)u=i+r,(a=i+n)in s?s[u]=s[a]:fs(s,u);for(i=c;i>c-n+r;i--)fs(s,i-1)}else if(r>n)for(i=c-n;i>f;i--)u=i+r-1,(a=i+n-1)in s?s[u]=s[a]:fs(s,u);for(i=0;i<r;i++)s[i+f]=arguments[i+2];return rl(s,c-n+r),o}});var sl=u((function t(e,r){i(this,t),s(this,"cancelBubble",void 0),s(this,"cancelable",void 0),s(this,"target",void 0),s(this,"currentTarget",void 0),s(this,"preventDefault",void 0),s(this,"stopPropagation",void 0),s(this,"type",void 0),s(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()})),cl=Object.assign,fl=Object.defineProperty,ll=C([].concat),hl=!cl||P((function(){if(vt&&1!==cl({b:1},cl(fl({},"a",{enumerable:!0,get:function(){fl(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=cl({},t)[r]||"abcdefghijklmnopqrst"!=Gi(cl({},e)).join("")}))?function(t,e){for(var r=z(t),n=arguments.length,o=1,i=Ye.f,a=Ae.f;n>o;)for(var u,s=Te(arguments[o++]),c=i?ll(Gi(s),i(s)):Gi(s),f=c.length,l=0;f>l;)u=c[l++],vt&&!Tt(a,s,u)||(r[u]=s[u]);return r}:cl;ar({target:"Object",stat:!0,arity:2,forced:Object.assign!==hl},{assign:hl});var pl=Ai.findIndex,vl=!0;"findIndex"in[]&&Array(1).findIndex((function(){vl=!1})),ar({target:"Array",proto:!0,forced:vl},{findIndex:function(t){return pl(this,t,arguments.length>1?arguments[1]:void 0)}}),na("findIndex");var dl=Mf.charAt,yl=fe.set,gl=fe.getterFor("String Iterator");xa(String,"String",(function(t){yl(this,{type:"String Iterator",string:ef(t),index:0})}),(function(){var t,e=gl(this),r=e.string,n=e.index;return n>=r.length?wa(void 0,!0):(t=dl(r,n),e.index+=t.length,wa(t,!1))}));var ml=Ze.f,bl="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],xl={f:function(t){return bl&&"Window"==de(t)?function(t){try{return ml(t)}catch(t){return du(bl)}}(t):ml(ke(t))}},wl=P((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),El=Object.isExtensible,Al=P((function(){El(1)}))||wl?function(t){return!!yt(t)&&((!wl||"ArrayBuffer"!=de(t))&&(!El||El(t)))}:El,Ol=!P((function(){return Object.isExtensible(Object.preventExtensions({}))})),Sl=w((function(t){var e=Gt.f,r=!1,n=q("meta"),o=0,i=function(t){e(t,n,{value:{objectID:"O"+o++,weakData:{}}})},a=t.exports={enable:function(){a.enable=function(){},r=!0;var t=Ze.f,e=C([].splice),o={};o[n]=1,t(o).length&&(Ze.f=function(r){for(var o=t(r),i=0,a=o.length;i<a;i++)if(o[i]===n){e(o,i,1);break}return o},ar({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:xl.f}))},fastKey:function(t,e){if(!yt(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!U(t,n)){if(!Al(t))return"F";if(!e)return"E";i(t)}return t[n].objectID},getWeakData:function(t,e){if(!U(t,n)){if(!Al(t))return!0;if(!e)return!1;i(t)}return t[n].weakData},onFreeze:function(t){return Ol&&r&&Al(t)&&!U(t,n)&&i(t),t}};ie[n]=!0})),Tl=(Sl.enable,Sl.fastKey,Sl.getWeakData,Sl.onFreeze,function(t,e,r){var n=-1!==t.indexOf("Map"),o=-1!==t.indexOf("Weak"),i=n?"set":"add",a=S[t],u=a&&a.prototype,s=a,c={},f=function(t){var e=C(u[t]);he(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!yt(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return o&&!yt(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!yt(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(or(t,!K(a)||!(o||u.forEach&&!P((function(){(new a).entries().next()})))))s=r.getConstructor(e,t,n,i),Sl.enable();else if(or(t,!0)){var l=new s,h=l[i](o?{}:-0,1)!=l,p=P((function(){l.has(1)})),v=Mo((function(t){new a(t)})),d=!o&&P((function(){for(var t=new a,e=5;e--;)t[i](e,e);return!t.has(-0)}));v||((s=e((function(t,e){gr(t,u);var r=us(new a,t,s);return N(e)||ko(e,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=s),(p||d)&&(f("delete"),f("has"),n&&f("get")),(d||h)&&f(i),o&&u.clear&&delete u.clear}return c[t]=s,ar({global:!0,constructor:!0,forced:s!=a},c),pr(s,t),o||r.setStrong(s,t,n),s}),kl=Sl.getWeakData,Il=fe.set,jl=fe.getterFor,Pl=Ai.find,_l=Ai.findIndex,Ml=C([].splice),Ll=0,Rl=function(t){return t.frozen||(t.frozen=new Cl)},Cl=function(){this.entries=[]},Nl=function(t,e){return Pl(t.entries,(function(t){return t[0]===e}))};Cl.prototype={get:function(t){var e=Nl(this,t);if(e)return e[1]},has:function(t){return!!Nl(this,t)},set:function(t,e){var r=Nl(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=_l(this.entries,(function(e){return e[0]===t}));return~e&&Ml(this.entries,e,1),!!~e}};var Dl,Fl={getConstructor:function(t,e,r,n){var o=t((function(t,o){gr(t,i),Il(t,{type:e,id:Ll++,frozen:void 0}),N(o)||ko(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=jl(e),u=function(t,e,r){var n=a(t),o=kl(Ot(e),!0);return!0===o?Rl(n).set(e,r):o[n.id]=r,t};return eu(i,{delete:function(t){var e=a(this);if(!yt(t))return!1;var r=kl(t);return!0===r?Rl(e).delete(t):r&&U(r,e.id)&&delete r[e.id]},has:function(t){var e=a(this);if(!yt(t))return!1;var r=kl(t);return!0===r?Rl(e).has(t):r&&U(r,e.id)}}),eu(i,r?{get:function(t){var e=a(this);if(yt(t)){var r=kl(t);return!0===r?Rl(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return u(this,t,e)}}:{add:function(t){return u(this,t,!0)}}),o}},Wl=fe.enforce,zl=!S.ActiveXObject&&"ActiveXObject"in S,Bl=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Ul=Tl("WeakMap",Bl,Fl);if(te&&zl){Dl=Fl.getConstructor(Bl,"WeakMap",!0),Sl.enable();var Gl=Ul.prototype,Hl=C(Gl.delete),Vl=C(Gl.has),ql=C(Gl.get),Zl=C(Gl.set);eu(Gl,{delete:function(t){if(yt(t)&&!Al(t)){var e=Wl(this);return e.frozen||(e.frozen=new Dl),Hl(this,t)||e.frozen.delete(t)}return Hl(this,t)},has:function(t){if(yt(t)&&!Al(t)){var e=Wl(this);return e.frozen||(e.frozen=new Dl),Vl(this,t)||e.frozen.has(t)}return Vl(this,t)},get:function(t){if(yt(t)&&!Al(t)){var e=Wl(this);return e.frozen||(e.frozen=new Dl),Vl(this,t)?ql(this,t):e.frozen.get(t)}return ql(this,t)},set:function(t,e){if(yt(t)&&!Al(t)){var r=Wl(this);r.frozen||(r.frozen=new Dl),Vl(this,t)?Zl(this,t,e):r.frozen.set(t,e)}else Zl(this,t,e);return this}})}var Yl=lt("iterator"),$l=lt("toStringTag"),Kl=Sa.values,Ql=function(t,e){if(t){if(t[Yl]!==Kl)try{re(t,Yl,Kl)}catch(e){t[Yl]=Kl}if(t[$l]||re(t,$l,e),pi[e])for(var r in Sa)if(t[r]!==Sa[r])try{re(t,r,Sa[r])}catch(e){t[r]=Sa[r]}}};for(var Xl in pi)Ql(S[Xl]&&S[Xl].prototype,Xl);Ql(yi,"DOMTokenList");var Jl,th,eh,rh,nh=new WeakMap,oh=function(){function t(){i(this,t),nh.set(this,{})}return u(t,[{key:"addEventListener",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=nh.get(this);n||(n={}),n[t]||(n[t]=[]),n[t].push(e),nh.set(this,n),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,e){var r=nh.get(this);if(r){var n=r[t];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===e){n.splice(o,1);break}}}},{key:"dispatchEvent",value:function(t){var e=nh.get(this)[t.type];if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),ih=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),t.className="",t.children=[],t}return u(r,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"childNodes",void 0),t.childNodes=[],t}return u(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),r}(oh));if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var ah=my.getSystemInfoSync();Jl=ah.screenWidth,th=ah.screenHeight,eh=ah.windowWidth,rh=ah.windowHeight}else{var uh=Of.innerWidth,sh=Of.innerHeight;Jl=uh,th=sh,eh=uh,rh=sh}var ch={width:Jl,height:th,availWidth:eh,availHeight:rh,availLeft:0,availTop:0},fh=ch.availWidth,lh=ch.availHeight,hh={style:[]};function ph(t,e){var r,n;"parentNode"in t||(r=0===e?function(){return null}:1===e?function(){return hh}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:r}));"parentElement"in t||(n=0===e?function(){return null}:1===e?function(){return hh}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:n}))}function vh(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:fh+"px",height:lh+"px",margin:"0px",padding:"0px"})}function dh(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=fh,t.clientHeight=lh),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function yh(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=fh,t.offsetHeight=lh)}function gh(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=fh,t.scrollHeight=lh)}function mh(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function bh(){}var xh=function(t){c(r,t);var e=v(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),s(h(t),"focus",void 0),s(h(t),"blur",void 0),s(h(t),"insertBefore",void 0),s(h(t),"appendChild",void 0),s(h(t),"removeChild",void 0),s(h(t),"remove",void 0),s(h(t),"innerHTML",void 0),s(h(t),"tagName",void 0),t.className="",t.children=[],t.focus=bh,t.blur=bh,t.insertBefore=bh,t.appendChild=bh,t.removeChild=bh,t.remove=bh,t.innerHTML="",t.tagName=n.toUpperCase(),ph(h(t),o),vh(h(t)),mh(h(t)),dh(h(t)),yh(h(t)),gh(h(t)),t}return u(r)}(ih),wh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"video")}return u(r)}(function(t){c(r,t);var e=v(r);function r(t){return i(this,r),e.call(this,t)}return u(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(xh)),Eh={};function Ah(){return Eh}var Oh=u((function t(){i(this,t);var e=Ah(),r=e.createImage&&e.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=t.prototype),ph(r),mh(r),Object.assign(r,{addEventListener:function(t,e){r["on".concat(t)]=e.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r})),Sh={href:"",protocol:"",host:""},Th=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"body",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,r){}},{key:"dispatchEvent",value:function(t){}}]),r}(xh),kh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"html",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),r}(xh),Ih={},jh={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Sh,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new Oh:"video"===t?new wh:new xh(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,r){Ih[t]||(Ih[t]=[]),Ih[t].push(e)},removeEventListener:function(t,e){var r=Ih[t];if(r&&r.length>0)for(var n=r.length;n--;n>0)if(r[n]===e){r.splice(n,1);break}},dispatchEvent:function(t){var e=t.type,r=Ih[e];if(r)for(var n=0;n<r.length;n++)r[n](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new sl(t)}};jh.documentElement=new kh,jh.head=new xh("head"),jh.body=new Th,kf("match",(function(t,e,r){return[function(e){var r=F(this),n=N(e)?void 0:Rt(e,t);return n?Tt(n,e,r):new RegExp(e)[t](ef(r))},function(t){var n=Ot(this),o=ef(t),i=r(e,n,o);if(i.done)return i.value;if(!n.global)return Gf(n,o);var a=n.unicode;n.lastIndex=0;for(var u,s=[],c=0;null!==(u=Gf(n,o));){var f=ef(u[0]);s[c]=f,""===f&&(n.lastIndex=Rf(o,Fe(n.lastIndex),a)),c++}return 0===c?null:s}]}));var Ph,_h,Mh=lt("isConcatSpreadable"),Lh=ot>=51||!P((function(){var t=[];return t[Mh]=!1,t.concat()[0]!==t})),Rh=_i("concat"),Ch=function(t){if(!yt(t))return!1;var e=t[Mh];return void 0!==e?!!e:gi(t)};if(ar({target:"Array",proto:!0,arity:1,forced:!Lh||!Rh},{concat:function(t){var e,r,n,o,i,a=z(this),u=xi(a,0),s=0;for(e=-1,n=arguments.length;e<n;e++)if(Ch(i=-1===e?a:arguments[e]))for(o=We(i),ol(s+o),r=0;r<o;r++,s++)r in i&&ji(u,s,i[r]);else ol(s+1),ji(u,s++,i);return u.length=s,u}}),"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Nh=my.getSystemInfoSync();Ph=Nh.system,Nh.platform,Nh.language}else{var Dh={versions:(_h=Of.navigator.userAgent,{trident:_h.indexOf("Trident")>-1,presto:_h.indexOf("Presto")>-1,webKit:_h.indexOf("AppleWebKit")>-1,gecko:_h.indexOf("Gecko")>-1&&-1===_h.indexOf("KHTML"),mobile:!!_h.match(/AppleWebKit.*Mobile.*/),ios:!!_h.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),android:_h.indexOf("Android")>-1||_h.indexOf("Linux")>-1,iPhone:_h.indexOf("iPhone")>-1,iPad:_h.indexOf("iPad")>-1,webApp:-1===_h.indexOf("Safari"),weixin:_h.indexOf("MicroMessenger")>-1,qq:" qq"===_h.match(/\\sQQ/i)}),language:(Of.navigator.browserLanguage||Of.navigator.language).toLowerCase()};Dh.versions.android?"android":Dh.versions.trident?"IE":Dh.versions.presto?"Opera":Dh.versions.webKit?"webKit":Dh.versions.gecko?"Firefox":Dh.versions.mobile?"mobile":Dh.versions.ios?"ios":Dh.versions.iPhone?"iPhone":Dh.versions.iPad?"ipad":Dh.versions.webApp?"webApp":Dh.versions.weixin?"weixin":Dh.versions.qq&&"qq",Ph=Of.navigator.userAgent,Dh.language}Ph.toLowerCase().indexOf("android");ss("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var Fh=Gt.f,Wh=Sl.fastKey,zh=fe.set,Bh=fe.getterFor;Tl("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,r,n){var o=t((function(t,o){gr(t,i),zh(t,{type:e,index:Ki(null),first:void 0,last:void 0,size:0}),vt||(t.size=0),N(o)||ko(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Bh(e),u=function(t,e,r){var n,o,i=a(t),u=s(t,e);return u?u.value=r:(i.last=u={index:o=Wh(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=u),n&&(n.next=u),vt?i.size++:t.size++,"F"!==o&&(i.index[o]=u)),t},s=function(t,e){var r,n=a(t),o=Wh(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return eu(i,{clear:function(){for(var t=a(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,vt?t.size=0:this.size=0},delete:function(t){var e=a(this),r=s(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),vt?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=a(this),n=Br(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),eu(i,r?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),vt&&Fh(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=Bh(e),i=Bh(n);xa(t,e,(function(t,e){zh(this,{type:n,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?wa("keys"==e?r.key:"values"==e?r.value:[r.key,r.value],!1):(t.target=void 0,wa(void 0,!0))}),r?"entries":"values",!r,!0),dr(e)}});var Uh=C([].join),Gh=Te!=Object,Hh=Oi("join",",");ar({target:"Array",proto:!0,forced:Gh||!Hh},{join:function(t){return Uh(ke(this),void 0===t?",":t)}});var Vh=Ai.map,qh=_i("map");ar({target:"Array",proto:!0,forced:!qh},{map:function(t){return Vh(this,t,arguments.length>1?arguments[1]:void 0)}});var Zh=P((function(){Gi(1)}));ar({target:"Object",stat:!0,forced:Zh},{keys:function(t){return Gi(z(t))}});var Yh=new Map,$h=new Map,Kh=new Map,Qh=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"onabort",void 0),s(h(t),"onerror",void 0),s(h(t),"onload",void 0),s(h(t),"onloadstart",void 0),s(h(t),"onprogress",void 0),s(h(t),"ontimeout",void 0),s(h(t),"onloadend",void 0),s(h(t),"onreadystatechange",void 0),s(h(t),"readyState",void 0),s(h(t),"response",void 0),s(h(t),"responseText",void 0),s(h(t),"_responseType",void 0),s(h(t),"responseXML",void 0),s(h(t),"status",void 0),s(h(t),"statusText",void 0),s(h(t),"upload",void 0),s(h(t),"withCredentials",void 0),s(h(t),"timeout",void 0),s(h(t),"_url",void 0),s(h(t),"_method",void 0),t.onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,Yh.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return u(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=Kh.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=$h.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\\n")}},{key:"getResponseHeader",value:function(t){return $h.get("responseHeader")[t]}},{key:"open",value:function(t,e,r){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var r=Yh.get("requestHeader");r[t]=e,Yh.set("requestHeader",r)}},{key:"addEventListener",value:function(t,e){var r=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||r,e.call(r,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),r}(oh);s(Qh,"UNSEND",void 0),s(Qh,"OPENED",void 0),s(Qh,"HEADERS_RECEIVED",void 0),s(Qh,"LOADING",void 0),s(Qh,"DONE",void 0),Qh.UNSEND=0,Qh.OPENED=1,Qh.HEADERS_RECEIVED=2,Qh.LOADING=3,Qh.DONE=4;var Xh="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,Jh="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),tp=(Xh||Jh)&&!1;tp||Of.XMLHttpRequest,tp||Of.location;function ep(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}var rp=Ai.filter,np=_i("filter");function op(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}function ip(t,e,r){return 2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}function ap(t){return t.filter?[1]:[0]}function up(t,e){return[e]}ar({target:"Array",proto:!0,forced:!np},{filter:function(t){return rp(this,t,arguments.length>1?arguments[1]:void 0)}});var sp=fp,cp=fp;function fp(t,e,r){r=r||2;var n,o,i,a,u,s,c,f=e&&e.length,l=f?e[0]*r:t.length,h=lp(t,0,l,r,!0),p=[];if(!h||h.next===h.prev)return p;if(f&&(h=function(t,e,r,n){var o,i,a,u,s,c=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,u=o<i-1?e[o+1]*n:t.length,(s=lp(t,a,u,n,!1))===s.next&&(s.steiner=!0),c.push(Ep(s));for(c.sort(mp),o=0;o<c.length;o++)r=bp(c[o],r);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var v=r;v<l;v+=r)(u=t[v])<n&&(n=u),(s=t[v+1])<o&&(o=s),u>i&&(i=u),s>a&&(a=s);c=0!==(c=Math.max(i-n,a-o))?32767/c:0}return pp(h,p,r,n,o,c,0),p}function lp(t,e,r,n,o){var i,a;if(o===Cp(t,e,r,n)>0)for(i=e;i<r;i+=n)a=Mp(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=Mp(i,t[i],t[i+1],a);return a&&Tp(a,a.next)&&(Lp(a),a=a.next),a}function hp(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Tp(n,n.next)&&0!==Sp(n.prev,n,n.next))n=n.next;else{if(Lp(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function pp(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{0===o.z&&(o.z=wp(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,u,s,c=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(o=r,r=r.nextZ,u--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(t,n,o,i);for(var u,s,c=t;t.prev!==t.next;)if(u=t.prev,s=t.next,i?dp(t,n,o,i):vp(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(s.i/r|0),Lp(t),t=s.next,c=s.next;else if((t=s)===c){a?1===a?pp(t=yp(hp(t),e,r),e,r,n,o,i,2):2===a&&gp(t,e,r,n,o,i):pp(hp(t),e,r,n,o,i,1);break}}}function vp(t){var e=t.prev,r=t,n=t.next;if(Sp(e,r,n)>=0)return!1;for(var o=e.x,i=r.x,a=n.x,u=e.y,s=r.y,c=n.y,f=o<i?o<a?o:a:i<a?i:a,l=u<s?u<c?u:c:s<c?s:c,h=o>i?o>a?o:a:i>a?i:a,p=u>s?u>c?u:c:s>c?s:c,v=n.next;v!==e;){if(v.x>=f&&v.x<=h&&v.y>=l&&v.y<=p&&Ap(o,u,i,s,a,c,v.x,v.y)&&Sp(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function dp(t,e,r,n){var o=t.prev,i=t,a=t.next;if(Sp(o,i,a)>=0)return!1;for(var u=o.x,s=i.x,c=a.x,f=o.y,l=i.y,h=a.y,p=u<s?u<c?u:c:s<c?s:c,v=f<l?f<h?f:h:l<h?l:h,d=u>s?u>c?u:c:s>c?s:c,y=f>l?f>h?f:h:l>h?l:h,g=wp(p,v,e,r,n),m=wp(d,y,e,r,n),b=t.prevZ,x=t.nextZ;b&&b.z>=g&&x&&x.z<=m;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ap(u,f,s,l,c,h,b.x,b.y)&&Sp(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ap(u,f,s,l,c,h,x.x,x.y)&&Sp(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;b&&b.z>=g;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ap(u,f,s,l,c,h,b.x,b.y)&&Sp(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=m;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ap(u,f,s,l,c,h,x.x,x.y)&&Sp(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function yp(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!Tp(o,i)&&kp(o,n,n.next,i)&&Pp(o,i)&&Pp(i,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(i.i/r|0),Lp(n),Lp(n.next),n=t=i),n=n.next}while(n!==t);return hp(n)}function gp(t,e,r,n,o,i){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&Op(a,u)){var s=_p(a,u);return a=hp(a,a.next),s=hp(s,s.next),pp(a,e,r,n,o,i,0),void pp(s,e,r,n,o,i,0)}u=u.next}a=a.next}while(a!==t)}function mp(t,e){return t.x-e.x}function bp(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=o&&u>a&&(a=u,r=n.x<n.next.x?n:n.next,u===o))return r}n=n.next}while(n!==e);if(!r)return null;var s,c=r,f=r.x,l=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=f&&o!==n.x&&Ap(i<l?o:a,i,f,l,i<l?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),Pp(n,t)&&(s<h||s===h&&(n.x>r.x||n.x===r.x&&xp(r,n)))&&(r=n,h=s)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var n=_p(r,t);return hp(n,n.next),hp(r,r.next)}function xp(t,e){return Sp(t.prev,t,e.prev)<0&&Sp(e.next,t,t.next)<0}function wp(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ep(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Ap(t,e,r,n,o,i,a,u){return(o-a)*(e-u)>=(t-a)*(i-u)&&(t-a)*(n-u)>=(r-a)*(e-u)&&(r-a)*(i-u)>=(o-a)*(n-u)}function Op(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&kp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(Pp(t,e)&&Pp(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Sp(t.prev,t,e.prev)||Sp(t,e.prev,e))||Tp(t,e)&&Sp(t.prev,t,t.next)>0&&Sp(e.prev,e,e.next)>0)}function Sp(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Tp(t,e){return t.x===e.x&&t.y===e.y}function kp(t,e,r,n){var o=jp(Sp(t,e,r)),i=jp(Sp(t,e,n)),a=jp(Sp(r,n,t)),u=jp(Sp(r,n,e));return o!==i&&a!==u||(!(0!==o||!Ip(t,r,e))||(!(0!==i||!Ip(t,n,e))||(!(0!==a||!Ip(r,t,n))||!(0!==u||!Ip(r,e,n)))))}function Ip(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function jp(t){return t>0?1:t<0?-1:0}function Pp(t,e){return Sp(t.prev,t,t.next)<0?Sp(t,e,t.next)>=0&&Sp(t,t.prev,e)>=0:Sp(t,e,t.prev)<0||Sp(t,t.next,e)<0}function _p(t,e){var r=new Rp(t.i,t.x,t.y),n=new Rp(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function Mp(t,e,r,n){var o=new Rp(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Lp(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Rp(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cp(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}fp.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Cp(t,0,i,r));if(o)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(Cp(t,c,f,r))}var l=0;for(u=0;u<n.length;u+=3){var h=n[u]*r,p=n[u+1]*r,v=n[u+2]*r;l+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},fp.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},sp.default=cp;var Np=C(1..valueOf),Dp=C("".replace),Fp="[\\t\\n\\v\\f\\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\\u2028\\u2029\\ufeff]",Wp=RegExp("^"+Fp+Fp+"*"),zp=RegExp(Fp+Fp+"*$"),Bp=function(t){return function(e){var r=ef(F(e));return 1&t&&(r=Dp(r,Wp,"")),2&t&&(r=Dp(r,zp,"")),r}},Up={start:Bp(1),end:Bp(2),trim:Bp(3)},Gp=Ze.f,Hp=je.f,Vp=Gt.f,qp=Up.trim,Zp=S.Number,Yp=Zp.prototype,$p=S.TypeError,Kp=C("".slice),Qp=C("".charCodeAt),Xp=function(t){var e=Ft(t,"number");return"bigint"==typeof e?e:Jp(e)},Jp=function(t){var e,r,n,o,i,a,u,s,c=Ft(t,"number");if(jt(c))throw $p("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=qp(c),43===(e=Qp(c,0))||45===e){if(88===(r=Qp(c,2))||120===r)return NaN}else if(48===e){switch(Qp(c,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=(i=Kp(c,2)).length,u=0;u<a;u++)if((s=Qp(i,u))<48||s>o)return NaN;return parseInt(i,n)}return+c};if(or("Number",!Zp(" 0o1")||!Zp("0b1")||Zp("+0x1"))){for(var tv,ev=function(t){var e=arguments.length<1?0:Zp(Xp(t)),r=this;return kt(Yp,r)&&P((function(){Np(r)}))?us(Object(e),r,ev):e},rv=vt?Gp(Zp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),nv=0;rv.length>nv;nv++)U(Zp,tv=rv[nv])&&!U(ev,tv)&&Vp(ev,tv,Hp(Zp,tv));ev.prototype=Yp,Yp.constructor=ev,he(S,"Number",ev,{constructor:!0})}var ov=RangeError,iv=RangeError,av=String,uv=Math.floor,sv=C((function(t){var e=ef(F(this)),r="",n=Le(t);if(n<0||n==1/0)throw ov("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r})),cv=C("".slice),fv=C(1..toFixed),lv=function(t,e,r){return 0===e?r:e%2==1?lv(t,e-1,r*t):lv(t*t,e/2,r)},hv=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=uv(o/1e7)},pv=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=uv(n/e),n=n%e*1e7},vv=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=av(t[e]);r=""===r?n:r+sv("0",7-n.length)+n}return r},dv=P((function(){return"0.000"!==fv(8e-5,3)||"1"!==fv(.9,0)||"1.25"!==fv(1.255,2)||"1000000000000000128"!==fv(0xde0b6b3a7640080,0)}))||!P((function(){fv({})}));function yv(t){return"number"==typeof t}function gv(t){var e=Math.max(Math.min(85.0511287798,t[1]),-85.0511287798),r=Math.PI/180,n=t[0]*r,o=e*r;o=Math.log(Math.tan(Math.PI/4+o/2));return n=(256<<20)*(.5/Math.PI*n+.5),o=(256<<20)*(-.5/Math.PI*o+(r=.5)),[Math.floor(n),Math.floor(o)]}ar({target:"Number",proto:!0,forced:dv},{toFixed:function(t){var e,r,n,o,i=Np(this),a=Le(t),u=[0,0,0,0,0,0],s="",c="0";if(a<0||a>20)throw iv("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return av(i);if(i<0&&(s="-",i=-i),i>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(i*lv(2,69,1))-69)<0?i*lv(2,-e,1):i/lv(2,e,1),r*=4503599627370496,(e=52-e)>0){for(hv(u,0,r),n=a;n>=7;)hv(u,1e7,0),n-=7;for(hv(u,lv(10,n,1),0),n=e-1;n>=23;)pv(u,1<<23),n-=23;pv(u,1<<n),hv(u,1,1),pv(u,2),c=vv(u)}else hv(u,0,r),hv(u,1<<-e,0),c=vv(u)+sv("0",a);return c=a>0?s+((o=c.length)<=a?"0."+sv("0",a-o)+c:cv(c,0,o-a)+"."+cv(c,o-a)):s+c}});var mv,bv=/"/g,xv=C("".replace);ar({target:"String",proto:!0,forced:(mv="sub",P((function(){var t=""[mv]('"');return t!==t.toLowerCase()||t.split('"').length>3})))},{sub:function(){return t="sub",e="",r="",n=ef(F(this)),o="<"+t,""!==e&&(o+=" "+e+'="'+xv(ef(r),bv,"&quot;")+'"'),o+">"+n+"</"+t+">";var t,e,r,n,o}});var wv=RegExp.prototype,Ev=Zt.PROPER,Av=RegExp.prototype.toString,Ov=P((function(){return"/a/b"!=Av.call({source:"a",flags:"b"})})),Sv=Ev&&"toString"!=Av.name;(Ov||Sv)&&he(RegExp.prototype,"toString",(function(){var t=Ot(this);return"/"+ef(t.source)+"/"+ef(function(t){var e=t.flags;return void 0!==e||"flags"in wv||U(t,"flags")||!kt(wv,t)?e:Tt(rf,t)}(t))}),{unsafe:!0});var Tv="undefined"!=typeof Float32Array?Float32Array:Array;function kv(){var t=new Tv(2);return Tv!=Float32Array&&(t[0]=0,t[1]=0),t}function Iv(t,e){var r=new Tv(2);return r[0]=t,r[1]=e,r}function jv(t,e){return t[0]=e[0],t[1]=e[1],t}function Pv(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function _v(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function Mv(t,e){var r=e[0],n=e[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Lv(t,e){return t[0]*e[0]+t[1]*e[1]}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Rv,Cv=_v,Nv=(Rv=kv(),kv()),Dv=(kv(),kv()),Fv=kv(),Wv=kv();function zv(t,e,r,n,o){return Pv(t,r,n),Mv(t,t),[o/Lv(e=Iv(-t[1],t[0]),Iv(-r[1],r[0])),e]}function Bv(t,e){return function(t,e,r){return t[0]=e,t[1]=r,t}(t,-e[1],e[0])}function Uv(t,e,r){return Cv(t,e,r),Mv(t,t),t}function Gv(t,e){return t[0]===e[0]&&t[1]===e[1]}var Hv=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),s(this,"complex",void 0),s(this,"join",void 0),s(this,"cap",void 0),s(this,"miterLimit",void 0),s(this,"thickness",void 0),s(this,"normal",void 0),s(this,"lastFlip",-1),s(this,"miter",Iv(0,0)),s(this,"started",!1),s(this,"dash",!1),s(this,"totalDistance",0),s(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return u(t,[{key:"extrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.segment_gaode2(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.simpleSegment(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.segment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.simpleSegment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,r,n,o,i,a,u){var s=0,c=t.indices,f=t.positions,l=t.normals,h="square"===this.cap,p="bevel"===this.join,v=gv([a[0],a[1]]),g=gv([i[0],i[1]]);Uv(Dv,n,r);var m=0;if(this.dash&&(m=this.lineSegmentDistance(v,g),this.totalDistance+=m),this.normal||(this.normal=kv(),Bv(this.normal,Dv)),!this.started)if(this.started=!0,h){var b=kv(),x=kv();Pv(b,this.normal,Dv),Pv(x,this.normal,Dv),l.push(x[0],x[1],0),l.push(b[0],b[1],0),f.push(r[0],r[1],0|r[2],this.totalDistance-m,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),f.push(r[0],r[1],0|r[2],this.totalDistance-m,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,r,this.normal,this.thickness,this.totalDistance-m);if(c.push(e+0,e+1,e+2),o){Gv(n,o)&&Pv(o,n,Mv(o,_v(o,n,r))),Uv(Fv,o,n);var w=d(zv(Wv,kv(),Dv,Fv,this.thickness),2),E=w[0],A=w[1],O=Lv(Wv,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)E>this.miterLimit&&(S=!0);S?(l.push(this.normal[0],this.normal[1],0),l.push(A[0],A[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,y(this.lastFlip!==-O?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),Bv(Nv,Fv),jv(this.normal,Nv),l.push(this.normal[0],this.normal[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(f,l,n,A,E,this.totalDistance),c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),O=-1,jv(this.normal,A),s+=2),this.lastFlip=O}else{if(Bv(this.normal,Dv),h){var T=kv(),k=kv();Cv(k,Dv,this.normal),Pv(T,Dv,this.normal),l.push(k[0],k[1],0),l.push(T[0],T[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,n,this.normal,this.thickness,this.totalDistance);c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),s+=2}return s}},{key:"simpleSegment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c=gv([n[0],n[1]]),f=gv([r[0],r[1]]);Uv(Dv,c,f);var l=0;if(this.dash&&(l=this.lineSegmentDistance(c,f),this.totalDistance+=l),this.normal||(this.normal=kv(),Bv(this.normal,Dv)),this.started||(this.started=!0,this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-l)),a.push(e+0,e+1,e+2),o){var h=gv([o[0],o[1]]);Gv(c,h)&&Pv(h,c,Mv(h,_v(h,c,f))),Uv(Fv,h,c);var p=d(zv(Wv,kv(),Dv,Fv,this.thickness),2),v=p[0],g=p[1];Lv(Wv,this.normal);this.extrusions(u,s,n,g,v,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,jv(this.normal,g),i+=2,this.lastFlip=-1}else Bv(this.normal,Dv),this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2;return i}},{key:"segment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c="square"===this.cap,f="bevel"===this.join,l=gv([n[0],n[1]]),h=gv([r[0],r[1]]);Uv(Dv,l,h);var p=0;if(this.dash&&(p=this.lineSegmentDistance(l,h),this.totalDistance+=p),this.normal||(this.normal=kv(),Bv(this.normal,Dv)),!this.started)if(this.started=!0,c){var v=kv(),g=kv();Pv(v,this.normal,Dv),Pv(g,this.normal,Dv),s.push(g[0],g[1],0),s.push(v[0],v[1],0),u.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),u.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),o){var m=gv([o[0],o[1]]);Gv(l,m)&&Pv(m,l,Mv(m,_v(m,l,h))),Uv(Fv,m,l);var b=d(zv(Wv,kv(),Dv,Fv,this.thickness),2),x=b[0],w=b[1],E=Lv(Wv,this.normal)<0?-1:1,A=f;if(!A&&"miter"===this.join)x>this.miterLimit&&(A=!0);A?(s.push(this.normal[0],this.normal[1],0),s.push(w[0],w[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,y(this.lastFlip!==-E?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),Bv(Nv,Fv),jv(this.normal,Nv),s.push(this.normal[0],this.normal[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,i+=3):(this.extrusions(u,s,n,w,x,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),E=-1,jv(this.normal,w),i+=2),this.lastFlip=E}else{if(Bv(this.normal,Dv),c){var O=kv(),S=kv();Cv(S,Dv,this.normal),Pv(O,Dv,this.normal),s.push(S[0],S[1],0),s.push(O[0],O[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance);a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2}return i}},{key:"extrusions",value:function(t,e,r,n,o,i){e.push(n[0],n[1],0),e.push(n[0],n[1],0),t.push(r[0],r[1],0|r[2],i,-o,0|r[2]),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],0|r[2],i,o,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}}]),t}();function Vv(t){var e=t.coordinates,r=t.originCoordinates,n=t.version,o=new Hv({dash:!0,join:"bevel"});if("GAODE2.x"===n){var i=e;Array.isArray(i[0][0])||(i=[e]);var a=r;Array.isArray(a[0][0])||(a=[r]);for(var u=0;u<i.length;u++){var s=i[u],c=a[u];o.extrude_gaode2(s,c)}}else{var f=e;f[0]&&!Array.isArray(f[0][0])&&(f=[e]),f.forEach((function(t){o.extrude(t)}))}var l=o.complex;return{vertices:l.positions,indices:l.indices,normals:l.normals,indexes:l.indexes,size:6}}function qv(t){var e=function(t){if(yv(t[0]))return t;if(yv(t[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(yv(t[0][0][0])){var e=0,r=0,n=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],r+=t[1],n++}))})),[e/n,r/n,0]}throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}(t.coordinates);return{vertices:[].concat(y(e),y(e),y(e),y(e)),indices:[0,1,2,2,3,0],size:e.length}}function Zv(t){var e=t.coordinates,r=sp.flatten(e),n=r.vertices,o=r.dimensions,i=r.holes;return{indices:sp(n,i,o),vertices:n,size:o}}var Yv=function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.iconMap,u={a_Color:op,a_Position:ip,filter:ap,a_vertexId:up,a_PickingColor:function(t){var e=t.id;return i?ep(e):[0,0,0]},a_DistanceAndIndex:function(t,e,r,n,o,i){return void 0===i?[r[3],10]:[r[3],i]},a_Total_Distance:function(t,e,r){return[r[5]]},a_Size:function(t){var e=t.size,r=void 0===e?1:e;return Array.isArray(r)?[r[0],r[1]]:[r,0]},a_Normal:function(t,e,r,n,o){return o},a_Miter:function(t,e,r){return[r[4]]},a_iconMapUV:function(t){var e=t.texture,r=a[e]||{x:0,y:0};return[r.x,r.y]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Vv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size,p=r.indexes;o.forEach((function(t){f.push(t+c)})),l=h;var v=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=v;for(var d=function(r){var o=(null==a?void 0:a.slice(3*r,3*r+3))||[],s=i.slice(r*h,r*h+h),c=0;p&&void 0!==p[r]&&(c=p[r]),n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,s,r,o,c)))}))},g=0;g<v;g++)d(g)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$v={pointFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.shape2d,u={a_Color:op,a_Position:ip,filter:ap,a_vertexId:up,a_PickingColor:function(t){var e=t.id;return i?ep(e):[0,0,0]},a_Shape:function(t){var e=t.shape,r=void 0===e?2:e;return[a.indexOf(r)]},a_Extrude:function(t,e,r,n){var o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],i=n%4*3;return[o[i],o[i+1],o[i+2]]},a_Size:function(t){var e=t.size,r=void 0===e?5:e;return Array.isArray(r)?[r[0]]:[r]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=qv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size;o.forEach((function(t){f.push(t+c)})),l=h;var p=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=p;for(var v=function(r){var o=[],a=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,a,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),line:Yv,polygonFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a={a_Color:op,a_Position:ip,filter:ap,a_vertexId:up,a_PickingColor:function(t){var e=t.id;return i?ep(e):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,c=[],f=3,o.forEach((function(t,e){var r=Zv(t),o=r.indices,i=r.vertices,l=r.normals,h=r.size;o.forEach((function(t){c.push(t+s)})),f=h;var p=i.length/h;u.sizePerElement=f,u.elements.push({featureIdx:e,vertices:i,normals:l,offset:s}),s+=p;for(var v=function(r){var o=[],u=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&a[n.name]&&(i=n.buffer.data).push.apply(i,y(a[n.name](t,e,u,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:u,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Kv=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},$v);function Qv(t){return Xv.apply(this,arguments)}function Xv(){return(Xv=o(r().mark((function t(e){var n,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,o=e.data,!Kv[n]){t.next=3;break}return t.abrupt("return",Kv[n](o));case 3:return t.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(n,'" non-existent.'))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return li(Qv),t.WorkerSourceMap=$v,t.createWorker=li,t.worker=Qv,t}({});
`,bl="l7-worker",z0=3,G0=!0;function jp(e){U0(bl,e)}function ev(){var e=getWorkerSource(bl);if(!e)throw new Error("get worker failed by workerName: ".concat(bl,"."));return e}function Wy(e,n){return Wp.apply(this,arguments)}function Wp(){return Wp=_asyncToGenerator(_regeneratorRuntime.mark(function e(n,t){var i,r,a,o,u;return _regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i=ev(),r=WorkerFarm.getWorkerFarm({maxConcurrency:z0,reuseWorkers:G0}),a=r.getWorkerPool({name:bl,source:i}),l.next=5,a.startJob(bl,function(h,d,v){return h.done(v)});case 5:return o=l.sent,o.postMessage("process",{input:{workerType:n,data:t}}),l.next=9,o.result;case 9:return u=l.sent,l.abrupt("return",u.result);case 11:case"end":return l.stop()}},e)})),Wp.apply(this,arguments)}jp(zh);function tv(e,n){var t=n.extent,i=t===void 0?[121.168,30.2828,121.384,30.4219]:t,r=new Promise(function(o){e instanceof HTMLImageElement||Fc(e)?o([e]):V0(e,function(u){o(u)})}),a={originData:e,images:r,_id:1,dataArray:[{_id:0,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]};return a}function V0(e,n){var t=e,i=[];if(typeof t=="string")K({url:t},function(o,u){u&&(i.push(u),n(i))});else{var r=t.length,a=0;t.forEach(function(o){K({url:o},function(u,s){a++,s&&i.push(s),a===r&&n(i)})})}return tv}var H0=D(38929),j0=D(3614),W0=D.n(j0),rv=function(){function e(n,t,i,r){(0,ot.Z)(this,e),(0,R.Z)(this,"vectorLayerCache",{}),this.x=t,this.y=i,this.z=r,this.vectorTile=new H0.VectorTile(new(W0())(n))}return(0,at.Z)(e,[{key:"getTileData",value:function(t){if(!t||!this.vectorTile.layers[t])return[];if(this.vectorLayerCache[t])return this.vectorLayerCache[t];var i=this.vectorTile.layers[t];if(Array.isArray(i.features))return this.vectorLayerCache[t]=i.features,i.features;for(var r=[],a=0;a<i.length;a++){var o=i.feature(a),u=o.toGeoJSON(this.x,this.y,this.z);r.push((0,b.Z)((0,b.Z)({},u),{},{properties:(0,b.Z)({id:u.id},u.properties)}))}return this.vectorLayerCache[t]=r,r}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),$0={tileSize:256,minZoom:0,maxZoom:Infinity,zoomOffset:0,warp:!0},X0=function(){var e=(0,st.Z)(q().mark(function n(t,i,r,a,o){var u;return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return u=ut(t,i),l.abrupt("return",new Promise(function(h){if(o)o({x:r.x,y:r.y,z:r.z},function(v,y){if(v||!y)h(void 0);else{var x=new rv(y,r.x,r.y,r.z);h(x)}});else{var d=ro((0,b.Z)((0,b.Z)({},a),{},{url:u}),function(v,y){if(v||!y)h(void 0);else{var x=new rv(y,r.x,r.y,r.z);h(x)}});r.xhrCancel=function(){return d.abort()}}}));case 2:case"end":return l.stop()}},n)}));return function(t,i,r,a,o){return e.apply(this,arguments)}}();function Y0(e,n){var t=Array.isArray(e)?e[0]:e,i=function(o,u){return X0(t,o,u,n==null?void 0:n.requestParameters,n==null?void 0:n.getCustomData)},r=(0,b.Z)((0,b.Z)((0,b.Z)({},$0),n),{},{getTileData:i});return{data:t,dataArray:[],tilesetOptions:r,isTile:!0}}function K0(e,n,t){switch(e){case"+":return n+t;case"-":return n-t;case"*":return n*t;case"/":return n/t;case"%":return n%t;case"^":return Math.pow(n,t);case"abs":return Math.abs(n);case"floor":return Math.floor(n);case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"sin":return Math.sin(n);case"cos":return Math.cos(n);case"atan":return t===-1?Math.atan(n):Math.atan2(n,t);case"min":return Math.min(n,t);case"max":return Math.max(n,t);case"log10":return Math.log(n);case"log2":return Math.log2(n);default:return console.warn("Calculate symbol err! Return default 0"),0}}function lo(e,n){for(var t=n[0],i=t.width,r=t.height,a=n.map(function(y){return y.rasterData}),o=i*r,u=[],s=JSON.stringify(e),l=0;l<o;l++){var h=JSON.parse(s),d=nv(h,a,l);if(typeof d=="number")u.push(d);else{var v=Ds(h);u.push(v)}}return u}function nv(e,n,t){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return n[e[1]][t]}catch(i){return console.warn("Raster Data err!"),0}e.map(function(i,r){if(Array.isArray(i)&&i.length>0)switch(i[0]){case"band":try{e[r]=n[i[1]][t]}catch(a){console.warn("Raster Data err!"),e[r]=0}break;default:nv(i,n,t)}})}function q0(e){var n=(0,Dr.Z)(e,3),t=n[0],i=n[1],r=i===void 0?-1:i,a=n[2],o=a===void 0?-1:a;if(t===void 0)return console.warn("Express err!"),["+",0,0];var u=t.replace(/\s+/g,"");return[u,r,o]}function Ds(e){var n=q0(e),t=n[0],i=n[1],r=n[2];return Array.isArray(i)&&(i=Ds(e[1])),Array.isArray(r)&&(r=Ds(e[2])),K0(t,i,r)}var Mn={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:Q0}};function Q0(e,n){for(var t=e[0].rasterData,i=e[1].rasterData,r=e[2].rasterData,a=[],o=(n==null?void 0:n.countCut)||[2,98],u=(0,Dr.Z)(o,2),s=u[0],l=u[1],h=(n==null?void 0:n.RMinMax)||za(t,s,l),d=(n==null?void 0:n.GMinMax)||za(i,s,l),v=(n==null?void 0:n.BMinMax)||za(r,s,l),y=0;y<t.length;y++)a.push(Math.max(0,t[y]-h[0])),a.push(Math.max(0,i[y]-d[0])),a.push(Math.max(0,r[y]-v[0]));return{rasterData:a,rMinMax:h,gMinMax:d,bMinMax:v}}function za(e,n,t){var i=e.slice().sort(function(u,s){return u-s}),r=i.length,a=i[Math.ceil(r*n/100)],o=i[Math.ceil(r*t/100)];return[a,o]}function zi(e,n,t){return $p.apply(this,arguments)}function $p(){return $p=(0,st.Z)(q().mark(function e(n,t,i){var r,a,o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(n.length!==0){d.next=2;break}return d.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return d.next=4,Promise.all(n.map(function(v){var y=v.data,x=v.bands,S=x===void 0?[0]:x;return t(y,S)}));case 4:r=d.sent,a=[],r.forEach(function(v){Array.isArray(v)?a.push.apply(a,(0,L.Z)(v)):a.push(v)}),o=a[0],u=o.width,s=o.height,d.t0=(0,Oo.Z)(i),d.next=d.t0==="function"?11:d.t0==="object"?13:15;break;case 11:return l=i(a),d.abrupt("break",16);case 13:return Array.isArray(i)?l={rasterData:lo(i,a)}:l=El(i,a),d.abrupt("break",16);case 15:l={rasterData:a[0].rasterData};case 16:return d.abrupt("return",(0,b.Z)((0,b.Z)({},l),{},{width:u,height:s}));case 17:case"end":return d.stop()}},e)})),$p.apply(this,arguments)}function El(e,n){var t=Mn[e.type];if(t.type==="function")return t.method(n,e==null?void 0:e.options);if(t.type==="operation")return e.type==="rgb"?J0(t.expression,n):{rasterData:lo(t.expression,n)}}function J0(e,n){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var t=lo(e.r||["band",0],n),i=lo(e.g||["band",0],n),r=lo(e.b||["band",0],n);return[t,i,r]}function Xp(e,n,t,i){return Yp.apply(this,arguments)}function Yp(){return Yp=(0,st.Z)(q().mark(function e(n,t,i,r){var a;return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,zi(n,t,i);case 2:a=u.sent,r(null,{data:a});case 4:case"end":return u.stop()}},e)})),Yp.apply(this,arguments)}function em(e,n){return e.map(function(t){return t[n]*1})}function tm(e){return e===void 0?!1:!Array.isArray(e)&&e.data!==void 0}function iv(e){return Array.isArray(e)?e.length===0?!1:!!tm(e[0]):!1}function av(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function Bs(e,n){var t=n.extent,i=n.width,r=n.height,a=n.min,o=n.max,u=n.format,s=n.operation,l,h,d;if(u===void 0||av(e))l=Array.from(e),h=i,d=r;else{var v=Array.isArray(e)?e:[e];l=zi(v,u,s)}var y={_id:1,dataArray:[{_id:1,data:l,width:h,height:d,min:a,max:o,coordinates:[[t[0],t[1]],[t[2],t[3]]]}]};return y}var rm=D(28660),pr=D(86700),Gi=D(84879),qe={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),IDebugService:Symbol.for("IDebugService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},ov=D(31745),nm=D.n(ov);function uv(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=im(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function im(e,n){if(!!e){if(typeof e=="string")return sv(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return sv(e,n)}}function sv(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var Wf=30;function am(e){var n=e.characterSet,t=e.getFontWidth,i=e.fontHeight,r=e.buffer,a=e.maxCanvasWidth,o=e.mapping,u=o===void 0?{}:o,s=e.xOffset,l=s===void 0?0:s,h=e.yOffset,d=h===void 0?0:h,v=0,y=l;Array.from(n).forEach(function(S,M){if(!u[S]){var O=t(S,M);y+Wf>a&&(y=0,v++),u[S]={x:y,y:d+v*Wf,width:Wf,height:Wf,advance:O},y+=Wf}});var x=i+r*2;return{mapping:u,xOffset:y,yOffset:d+v*x,canvasHeight:Gh(d+(v+1)*x)}}function lv(e,n,t){var i=0,r=0,a=0,o=[],u={},s=uv(e),l;try{for(s.s();!(l=s.n()).done;){var h=l.value;if(!u[h.id]){var d=h.size;i+d+n>t&&(Jc(u,o,r),i=0,r=a+r+n,a=0,o=[]),o.push({icon:h,xOffset:i}),i=i+d+n,a=Math.max(a,d)}}}catch(y){s.e(y)}finally{s.f()}o.length>0&&Jc(u,o,r);var v=Gh(a+r+n);return{mapping:u,canvasHeight:v}}function Jc(e,n,t){var i=uv(n),r;try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.icon,u=a.xOffset;e[o.id]=(0,b.Z)((0,b.Z)({},o),{},{x:u,y:t,image:o.image,width:o.width,height:o.height})}}catch(s){i.e(s)}finally{i.f()}}function Gh(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var cv,Kp;function $f(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Go(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function Go(e,n){if(!!e){if(typeof e=="string")return lc(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return lc(e,n)}}function lc(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function om(e){var n=um();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function um(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var sm=vv(),lm="sans-serif",cm="normal",fv=24,Zs=3,Pn=.25,hv=8,Vo=1024,pv=1,dv=1,si=3,$y=null;function vv(){for(var e=[],n=32;n<128;n++)e.push(String.fromCharCode(n));return e}function Xf(e,n,t,i){e.font="".concat(i," ").concat(t,"px ").concat(n),e.fillStyle="black",e.textBaseline="middle"}function mv(e,n){for(var t=0;t<e.length;t++)n.data[4*t+3]=e[t]}var fm=(cv=(0,pr.b2)(),cv(Kp=function(e){(0,Ot.Z)(t,e);var n=om(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"fontAtlas",void 0),(0,R.Z)((0,pe.Z)(i),"iconFontMap",void 0),(0,R.Z)((0,pe.Z)(i),"iconFontGlyphs",{}),(0,R.Z)((0,pe.Z)(i),"fontOptions",void 0),(0,R.Z)((0,pe.Z)(i),"key",void 0),(0,R.Z)((0,pe.Z)(i),"cache",new ga(si)),i}return(0,at.Z)(t,[{key:"scale",get:function(){return dv}},{key:"canvas",get:function(){var r=this.cache.get(this.key);return r&&r.data}},{key:"mapping",get:function(){var r=this.cache.get(this.key);return r&&r.mapping||{}}},{key:"getCanvasByKey",value:function(r){var a=this.cache.get(r);return a&&a.data}},{key:"getMappingByKey",value:function(r){var a=this.cache.get(r);return a&&a.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:lm,fontWeight:cm,characterSet:sm,fontSize:fv,buffer:Zs,sdf:!0,cutoff:Pn,radius:hv,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(r){var a=this;r.forEach(function(o){a.iconFontGlyphs[o.name]=o.unicode})}},{key:"addIconFont",value:function(r,a){this.iconFontMap.set(r,a)}},{key:"getIconFontKey",value:function(r){return this.iconFontMap.get(r)||r}},{key:"getGlyph",value:function(r){return this.iconFontGlyphs[r]?String.fromCharCode(parseInt(this.iconFontGlyphs[r],16)):""}},{key:"setFontOptions",value:function(r){this.fontOptions=(0,b.Z)((0,b.Z)({},this.fontOptions),r),this.key=this.getKey();var a=this.getNewChars(this.key,this.fontOptions.characterSet),o=this.cache.get(this.key);if(!(o&&a.length===0)){var u=this.generateFontAtlas(this.key,a,o);this.fontAtlas=u,this.cache.set(this.key,u)}}},{key:"addFontFace",value:function(r,a){var o=this,u=document.createElement("style");u.type="text/css",u.innerText=`
        @font-face{
            font-family: '`.concat(r,`';
            src: url('`).concat(a,`') format('woff2'),
            url('`).concat(a,`') format('woff'),
            url('`).concat(a,`') format('truetype');
        }`),u.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(r),"L7text"),document.fonts.ready.then(function(){o.emit("fontloaded",{fontFamily:r})})}catch(s){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(s)}},document.getElementsByTagName("head")[0].appendChild(u)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(r,a,o){var u=this.fontOptions,s=u.fontFamily,l=u.fontWeight,h=u.fontSize,d=u.buffer,v=u.sdf,y=u.radius,x=u.cutoff,S=u.iconfont,M=o&&o.data;M||(M=In.document.createElement("canvas"),M.width=Vo);var O=M.getContext("2d",{willReadFrequently:!0});Xf(O,s,h,l);var H=am((0,b.Z)({getFontWidth:function(na){return O.measureText(na).width},fontHeight:h*dv,buffer:d,characterSet:a,maxCanvasWidth:Vo},o&&{mapping:o.mapping,xOffset:o.xOffset,yOffset:o.yOffset})),W=H.mapping,he=H.canvasHeight,ve=H.xOffset,Re=H.yOffset,ze=O.getImageData(0,0,M.width,M.height);if(M.height=he,O.putImageData(ze,0,0),Xf(O,s,h,l),v){var ft=new(nm())(h,d,y,x,s,l),gt=O.getImageData(0,0,ft.size,ft.size),Pt=$f(a),Mt;try{for(Pt.s();!(Mt=Pt.n()).done;){var sr=Mt.value;if(S){var xr=String.fromCharCode(parseInt(sr.replace("&#x","").replace(";",""),16)),Br=ft.draw(xr);mv(Br,gt)}else mv(ft.draw(sr),gt);O.putImageData(gt,W[sr].x,W[sr].y)}}catch(vi){Pt.e(vi)}finally{Pt.f()}}else{var kn=$f(a),Oi;try{for(kn.s();!(Oi=kn.n()).done;){var xi=Oi.value;O.fillText(xi,W[xi].x,W[xi].y+h*pv)}}catch(vi){kn.e(vi)}finally{kn.f()}}return{xOffset:ve,yOffset:Re,mapping:W,data:M,width:M.width,height:M.height}}},{key:"getKey",value:function(){var r=this.fontOptions,a=r.fontFamily,o=r.fontWeight;return"".concat(a,"_").concat(o)}},{key:"getNewChars",value:function(r,a){var o=this.cache.get(r);if(!o)return a;var u=[],s=o.mapping,l=new Set(Object.keys(s)),h=new Set(a);return h.forEach(function(d){l.has(d)||u.push(d)}),u}}]),t}(Wi.EventEmitter))||Kp),gv,yv;function hm(e){var n=pm();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function pm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var dm=3,_v=1024,Yf=64,vm=(gv=(0,pr.b2)(),gv(yv=function(e){(0,Ot.Z)(t,e);var n=hm(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"canvasHeight",128),(0,R.Z)((0,pe.Z)(i),"texture",void 0),(0,R.Z)((0,pe.Z)(i),"canvas",void 0),(0,R.Z)((0,pe.Z)(i),"iconData",void 0),(0,R.Z)((0,pe.Z)(i),"iconMap",void 0),(0,R.Z)((0,pe.Z)(i),"ctx",void 0),(0,R.Z)((0,pe.Z)(i),"loadingImageCount",0),i}return(0,at.Z)(t,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=In.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var i=(0,st.Z)(q().mark(function a(o,u){var s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return s=new Image,this.loadingImageCount++,this.hasImage(o)?console.warn("Image Id already exists"):this.iconData.push({id:o,size:Yf}),this.updateIconMap(),d.next=6,this.loadImage(u);case 6:s=d.sent,l=this.iconData.find(function(v){return v.id===o}),l&&(l.image=s,l.width=s.width,l.height=s.height),this.update();case 10:case"end":return d.stop()}},a,this)}));function r(a,o){return i.apply(this,arguments)}return r}()},{key:"addImageMini",value:function(r,a,o){var u=this,s=o.getSceneConfig().canvas,l=s.createImage();if(this.loadingImageCount++,this.hasImage(r))throw new Error("Image Id already exists");this.iconData.push({id:r,size:Yf}),this.updateIconMap(),this.loadImageMini(a,s).then(function(h){l=h;var d=u.iconData.find(function(v){return v.id===r});d&&(d.image=l,d.width=l.width,d.height=l.height),u.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(r){return this.iconMap.hasOwnProperty(r)}},{key:"removeImage",value:function(r){this.hasImage(r)&&(this.iconData=this.iconData.filter(function(a){return a.id!==r}),delete this.iconMap[r],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(r){return new Promise(function(a,o){if(r instanceof HTMLImageElement){a(r);return}var u=new Image;u.crossOrigin="anonymous",u.onload=function(){a(u)},u.onerror=function(){o(new Error("Could not load image at "+r))},u.src=r instanceof File?URL.createObjectURL(r):r})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var r=this;this.canvas.width=_v,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(a){var o=r.iconMap[a],u=o.x,s=o.y,l=o.image,h=o.width,d=h===void 0?64:h,v=o.height,y=v===void 0?64:v,x=Math.max(d,y),S=x/Yf,M=y/S,O=d/S;l&&r.ctx.drawImage(l,u+(Yf-O)/2,s+(Yf-M)/2,O,M)})}},{key:"updateIconMap",value:function(){var r=lv(this.iconData,dm,_v),a=r.mapping,o=r.canvasHeight;this.iconMap=a,this.canvasHeight=o}},{key:"loadImageMini",value:function(r,a){return new Promise(function(o,u){var s=a.createImage();s.crossOrigin="anonymous",s.onload=function(){o(s)},s.onerror=function(){u(new Error("Could not load image at "+r))},s.src=r})}}]),t}(Wi.EventEmitter))||yv);function Ro(){var e=new Ht(16);return Ht!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function xv(e){var n=new Ht(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function mm(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function Vh(e,n,t,i,r,a,o,u,s,l,h,d,v,y,x,S){var M=new Ht(16);return M[0]=e,M[1]=n,M[2]=t,M[3]=i,M[4]=r,M[5]=a,M[6]=o,M[7]=u,M[8]=s,M[9]=l,M[10]=h,M[11]=d,M[12]=v,M[13]=y,M[14]=x,M[15]=S,M}function gm(e,n,t,i,r,a,o,u,s,l,h,d,v,y,x,S,M){return e[0]=n,e[1]=t,e[2]=i,e[3]=r,e[4]=a,e[5]=o,e[6]=u,e[7]=s,e[8]=l,e[9]=h,e[10]=d,e[11]=v,e[12]=y,e[13]=x,e[14]=S,e[15]=M,e}function Hh(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ym(e,n){if(e===n){var t=n[1],i=n[2],r=n[3],a=n[6],o=n[7],u=n[11];e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=t,e[6]=n[9],e[7]=n[13],e[8]=i,e[9]=a,e[11]=n[14],e[12]=r,e[13]=o,e[14]=u}else e[0]=n[0],e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=n[1],e[5]=n[5],e[6]=n[9],e[7]=n[13],e[8]=n[2],e[9]=n[6],e[10]=n[10],e[11]=n[14],e[12]=n[3],e[13]=n[7],e[14]=n[11],e[15]=n[15];return e}function jh(e,n){var t=n[0],i=n[1],r=n[2],a=n[3],o=n[4],u=n[5],s=n[6],l=n[7],h=n[8],d=n[9],v=n[10],y=n[11],x=n[12],S=n[13],M=n[14],O=n[15],H=t*u-i*o,W=t*s-r*o,he=t*l-a*o,ve=i*s-r*u,Re=i*l-a*u,ze=r*l-a*s,ft=h*S-d*x,gt=h*M-v*x,Pt=h*O-y*x,Mt=d*M-v*S,sr=d*O-y*S,xr=v*O-y*M,Br=H*xr-W*sr+he*Mt+ve*Pt-Re*gt+ze*ft;return Br?(Br=1/Br,e[0]=(u*xr-s*sr+l*Mt)*Br,e[1]=(r*sr-i*xr-a*Mt)*Br,e[2]=(S*ze-M*Re+O*ve)*Br,e[3]=(v*Re-d*ze-y*ve)*Br,e[4]=(s*Pt-o*xr-l*gt)*Br,e[5]=(t*xr-r*Pt+a*gt)*Br,e[6]=(M*he-x*ze-O*W)*Br,e[7]=(h*ze-v*he+y*W)*Br,e[8]=(o*sr-u*Pt+l*ft)*Br,e[9]=(i*Pt-t*sr-a*ft)*Br,e[10]=(x*Re-S*he+O*H)*Br,e[11]=(d*he-h*Re-y*H)*Br,e[12]=(u*gt-o*Mt-s*ft)*Br,e[13]=(t*Mt-i*gt+r*ft)*Br,e[14]=(S*W-x*ve-M*H)*Br,e[15]=(h*ve-d*W+v*H)*Br,e):null}function _m(e,n){var t=n[0],i=n[1],r=n[2],a=n[3],o=n[4],u=n[5],s=n[6],l=n[7],h=n[8],d=n[9],v=n[10],y=n[11],x=n[12],S=n[13],M=n[14],O=n[15];return e[0]=u*(v*O-y*M)-d*(s*O-l*M)+S*(s*y-l*v),e[1]=-(i*(v*O-y*M)-d*(r*O-a*M)+S*(r*y-a*v)),e[2]=i*(s*O-l*M)-u*(r*O-a*M)+S*(r*l-a*s),e[3]=-(i*(s*y-l*v)-u*(r*y-a*v)+d*(r*l-a*s)),e[4]=-(o*(v*O-y*M)-h*(s*O-l*M)+x*(s*y-l*v)),e[5]=t*(v*O-y*M)-h*(r*O-a*M)+x*(r*y-a*v),e[6]=-(t*(s*O-l*M)-o*(r*O-a*M)+x*(r*l-a*s)),e[7]=t*(s*y-l*v)-o*(r*y-a*v)+h*(r*l-a*s),e[8]=o*(d*O-y*S)-h*(u*O-l*S)+x*(u*y-l*d),e[9]=-(t*(d*O-y*S)-h*(i*O-a*S)+x*(i*y-a*d)),e[10]=t*(u*O-l*S)-o*(i*O-a*S)+x*(i*l-a*u),e[11]=-(t*(u*y-l*d)-o*(i*y-a*d)+h*(i*l-a*u)),e[12]=-(o*(d*M-v*S)-h*(u*M-s*S)+x*(u*v-s*d)),e[13]=t*(d*M-v*S)-h*(i*M-r*S)+x*(i*v-r*d),e[14]=-(t*(u*M-s*S)-o*(i*M-r*S)+x*(i*s-r*u)),e[15]=t*(u*v-s*d)-o*(i*v-r*d)+h*(i*s-r*u),e}function ya(e){var n=e[0],t=e[1],i=e[2],r=e[3],a=e[4],o=e[5],u=e[6],s=e[7],l=e[8],h=e[9],d=e[10],v=e[11],y=e[12],x=e[13],S=e[14],M=e[15],O=n*o-t*a,H=n*u-i*a,W=n*s-r*a,he=t*u-i*o,ve=t*s-r*o,Re=i*s-r*u,ze=l*x-h*y,ft=l*S-d*y,gt=l*M-v*y,Pt=h*S-d*x,Mt=h*M-v*x,sr=d*M-v*S;return O*sr-H*Mt+W*Pt+he*gt-ve*ft+Re*ze}function Ri(e,n,t){var i=n[0],r=n[1],a=n[2],o=n[3],u=n[4],s=n[5],l=n[6],h=n[7],d=n[8],v=n[9],y=n[10],x=n[11],S=n[12],M=n[13],O=n[14],H=n[15],W=t[0],he=t[1],ve=t[2],Re=t[3];return e[0]=W*i+he*u+ve*d+Re*S,e[1]=W*r+he*s+ve*v+Re*M,e[2]=W*a+he*l+ve*y+Re*O,e[3]=W*o+he*h+ve*x+Re*H,W=t[4],he=t[5],ve=t[6],Re=t[7],e[4]=W*i+he*u+ve*d+Re*S,e[5]=W*r+he*s+ve*v+Re*M,e[6]=W*a+he*l+ve*y+Re*O,e[7]=W*o+he*h+ve*x+Re*H,W=t[8],he=t[9],ve=t[10],Re=t[11],e[8]=W*i+he*u+ve*d+Re*S,e[9]=W*r+he*s+ve*v+Re*M,e[10]=W*a+he*l+ve*y+Re*O,e[11]=W*o+he*h+ve*x+Re*H,W=t[12],he=t[13],ve=t[14],Re=t[15],e[12]=W*i+he*u+ve*d+Re*S,e[13]=W*r+he*s+ve*v+Re*M,e[14]=W*a+he*l+ve*y+Re*O,e[15]=W*o+he*h+ve*x+Re*H,e}function cc(e,n,t){var i=t[0],r=t[1],a=t[2],o,u,s,l,h,d,v,y,x,S,M,O;return n===e?(e[12]=n[0]*i+n[4]*r+n[8]*a+n[12],e[13]=n[1]*i+n[5]*r+n[9]*a+n[13],e[14]=n[2]*i+n[6]*r+n[10]*a+n[14],e[15]=n[3]*i+n[7]*r+n[11]*a+n[15]):(o=n[0],u=n[1],s=n[2],l=n[3],h=n[4],d=n[5],v=n[6],y=n[7],x=n[8],S=n[9],M=n[10],O=n[11],e[0]=o,e[1]=u,e[2]=s,e[3]=l,e[4]=h,e[5]=d,e[6]=v,e[7]=y,e[8]=x,e[9]=S,e[10]=M,e[11]=O,e[12]=o*i+h*r+x*a+n[12],e[13]=u*i+d*r+S*a+n[13],e[14]=s*i+v*r+M*a+n[14],e[15]=l*i+y*r+O*a+n[15]),e}function ef(e,n,t){var i=t[0],r=t[1],a=t[2];return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=n[7]*r,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=n[11]*a,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function xm(e,n,t,i){var r=i[0],a=i[1],o=i[2],u=Math.hypot(r,a,o),s,l,h,d,v,y,x,S,M,O,H,W,he,ve,Re,ze,ft,gt,Pt,Mt,sr,xr,Br,kn;return u<Et?null:(u=1/u,r*=u,a*=u,o*=u,s=Math.sin(t),l=Math.cos(t),h=1-l,d=n[0],v=n[1],y=n[2],x=n[3],S=n[4],M=n[5],O=n[6],H=n[7],W=n[8],he=n[9],ve=n[10],Re=n[11],ze=r*r*h+l,ft=a*r*h+o*s,gt=o*r*h-a*s,Pt=r*a*h-o*s,Mt=a*a*h+l,sr=o*a*h+r*s,xr=r*o*h+a*s,Br=a*o*h-r*s,kn=o*o*h+l,e[0]=d*ze+S*ft+W*gt,e[1]=v*ze+M*ft+he*gt,e[2]=y*ze+O*ft+ve*gt,e[3]=x*ze+H*ft+Re*gt,e[4]=d*Pt+S*Mt+W*sr,e[5]=v*Pt+M*Mt+he*sr,e[6]=y*Pt+O*Mt+ve*sr,e[7]=x*Pt+H*Mt+Re*sr,e[8]=d*xr+S*Br+W*kn,e[9]=v*xr+M*Br+he*kn,e[10]=y*xr+O*Br+ve*kn,e[11]=x*xr+H*Br+Re*kn,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)}function tf(e,n,t){var i=Math.sin(t),r=Math.cos(t),a=n[4],o=n[5],u=n[6],s=n[7],l=n[8],h=n[9],d=n[10],v=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=a*r+l*i,e[5]=o*r+h*i,e[6]=u*r+d*i,e[7]=s*r+v*i,e[8]=l*r-a*i,e[9]=h*r-o*i,e[10]=d*r-u*i,e[11]=v*r-s*i,e}function Wh(e,n,t){var i=Math.sin(t),r=Math.cos(t),a=n[0],o=n[1],u=n[2],s=n[3],l=n[8],h=n[9],d=n[10],v=n[11];return n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=a*r-l*i,e[1]=o*r-h*i,e[2]=u*r-d*i,e[3]=s*r-v*i,e[8]=a*i+l*r,e[9]=o*i+h*r,e[10]=u*i+d*r,e[11]=s*i+v*r,e}function $h(e,n,t){var i=Math.sin(t),r=Math.cos(t),a=n[0],o=n[1],u=n[2],s=n[3],l=n[4],h=n[5],d=n[6],v=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=a*r+l*i,e[1]=o*r+h*i,e[2]=u*r+d*i,e[3]=s*r+v*i,e[4]=l*r-a*i,e[5]=h*r-o*i,e[6]=d*r-u*i,e[7]=v*r-s*i,e}function Sv(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function bv(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=n[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Sm(e,n,t){var i=t[0],r=t[1],a=t[2],o=Math.hypot(i,r,a),u,s,l;return o<Et?null:(o=1/o,i*=o,r*=o,a*=o,u=Math.sin(n),s=Math.cos(n),l=1-s,e[0]=i*i*l+s,e[1]=r*i*l+a*u,e[2]=a*i*l-r*u,e[3]=0,e[4]=i*r*l-a*u,e[5]=r*r*l+s,e[6]=a*r*l+i*u,e[7]=0,e[8]=i*a*l+r*u,e[9]=r*a*l-i*u,e[10]=a*a*l+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function bm(e,n){var t=Math.sin(n),i=Math.cos(n);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Em(e,n){var t=Math.sin(n),i=Math.cos(n);return e[0]=i,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ev(e,n){var t=Math.sin(n),i=Math.cos(n);return e[0]=i,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qp(e,n,t){var i=n[0],r=n[1],a=n[2],o=n[3],u=i+i,s=r+r,l=a+a,h=i*u,d=i*s,v=i*l,y=r*s,x=r*l,S=a*l,M=o*u,O=o*s,H=o*l;return e[0]=1-(y+S),e[1]=d+H,e[2]=v-O,e[3]=0,e[4]=d-H,e[5]=1-(h+S),e[6]=x+M,e[7]=0,e[8]=v+O,e[9]=x-M,e[10]=1-(h+y),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Am(e,n){var t=new Ht(3),i=-n[0],r=-n[1],a=-n[2],o=n[3],u=n[4],s=n[5],l=n[6],h=n[7],d=i*i+r*r+a*a+o*o;return d>0?(t[0]=(u*o+h*i+s*a-l*r)*2/d,t[1]=(s*o+h*r+l*i-u*a)*2/d,t[2]=(l*o+h*a+u*r-s*i)*2/d):(t[0]=(u*o+h*i+s*a-l*r)*2,t[1]=(s*o+h*r+l*i-u*a)*2,t[2]=(l*o+h*a+u*r-s*i)*2),qp(e,n,t),e}function Tm(e,n){return e[0]=n[12],e[1]=n[13],e[2]=n[14],e}function Av(e,n){var t=n[0],i=n[1],r=n[2],a=n[4],o=n[5],u=n[6],s=n[8],l=n[9],h=n[10];return e[0]=Math.hypot(t,i,r),e[1]=Math.hypot(a,o,u),e[2]=Math.hypot(s,l,h),e}function Cm(e,n){var t=new Ht(3);Av(t,n);var i=1/t[0],r=1/t[1],a=1/t[2],o=n[0]*i,u=n[1]*r,s=n[2]*a,l=n[4]*i,h=n[5]*r,d=n[6]*a,v=n[8]*i,y=n[9]*r,x=n[10]*a,S=o+h+x,M=0;return S>0?(M=Math.sqrt(S+1)*2,e[3]=.25*M,e[0]=(d-y)/M,e[1]=(v-s)/M,e[2]=(u-l)/M):o>h&&o>x?(M=Math.sqrt(1+o-h-x)*2,e[3]=(d-y)/M,e[0]=.25*M,e[1]=(u+l)/M,e[2]=(v+s)/M):h>x?(M=Math.sqrt(1+h-o-x)*2,e[3]=(v-s)/M,e[0]=(u+l)/M,e[1]=.25*M,e[2]=(d+y)/M):(M=Math.sqrt(1+x-o-h)*2,e[3]=(u-l)/M,e[0]=(v+s)/M,e[1]=(d+y)/M,e[2]=.25*M),e}function rf(e,n,t,i){var r=n[0],a=n[1],o=n[2],u=n[3],s=r+r,l=a+a,h=o+o,d=r*s,v=r*l,y=r*h,x=a*l,S=a*h,M=o*h,O=u*s,H=u*l,W=u*h,he=i[0],ve=i[1],Re=i[2];return e[0]=(1-(x+M))*he,e[1]=(v+W)*he,e[2]=(y-H)*he,e[3]=0,e[4]=(v-W)*ve,e[5]=(1-(d+M))*ve,e[6]=(S+O)*ve,e[7]=0,e[8]=(y+H)*Re,e[9]=(S-O)*Re,e[10]=(1-(d+x))*Re,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function wm(e,n,t,i,r){var a=n[0],o=n[1],u=n[2],s=n[3],l=a+a,h=o+o,d=u+u,v=a*l,y=a*h,x=a*d,S=o*h,M=o*d,O=u*d,H=s*l,W=s*h,he=s*d,ve=i[0],Re=i[1],ze=i[2],ft=r[0],gt=r[1],Pt=r[2],Mt=(1-(S+O))*ve,sr=(y+he)*ve,xr=(x-W)*ve,Br=(y-he)*Re,kn=(1-(v+O))*Re,Oi=(M+H)*Re,xi=(x+W)*ze,vi=(M-H)*ze,na=(1-(v+S))*ze;return e[0]=Mt,e[1]=sr,e[2]=xr,e[3]=0,e[4]=Br,e[5]=kn,e[6]=Oi,e[7]=0,e[8]=xi,e[9]=vi,e[10]=na,e[11]=0,e[12]=t[0]+ft-(Mt*ft+Br*gt+xi*Pt),e[13]=t[1]+gt-(sr*ft+kn*gt+vi*Pt),e[14]=t[2]+Pt-(xr*ft+Oi*gt+na*Pt),e[15]=1,e}function Mm(e,n){var t=n[0],i=n[1],r=n[2],a=n[3],o=t+t,u=i+i,s=r+r,l=t*o,h=i*o,d=i*u,v=r*o,y=r*u,x=r*s,S=a*o,M=a*u,O=a*s;return e[0]=1-d-x,e[1]=h+O,e[2]=v-M,e[3]=0,e[4]=h-O,e[5]=1-l-x,e[6]=y+S,e[7]=0,e[8]=v+M,e[9]=y-S,e[10]=1-l-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Rm(e,n,t,i,r,a,o){var u=1/(t-n),s=1/(r-i),l=1/(a-o);return e[0]=a*2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*s,e[6]=0,e[7]=0,e[8]=(t+n)*u,e[9]=(r+i)*s,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e}function Tv(e,n,t,i,r){var a=1/Math.tan(n/2),o;return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,r!=null&&r!==Infinity?(o=1/(i-r),e[10]=(r+i)*o,e[14]=2*r*i*o):(e[10]=-1,e[14]=-2*i),e}var Qp=Tv;function Cv(e,n,t,i,r){var a=1/Math.tan(n/2),o;return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,r!=null&&r!==Infinity?(o=1/(i-r),e[10]=r*o,e[14]=r*i*o):(e[10]=-1,e[14]=-i),e}function wv(e,n,t,i){var r=Math.tan(n.upDegrees*Math.PI/180),a=Math.tan(n.downDegrees*Math.PI/180),o=Math.tan(n.leftDegrees*Math.PI/180),u=Math.tan(n.rightDegrees*Math.PI/180),s=2/(o+u),l=2/(r+a);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-((o-u)*s*.5),e[9]=(r-a)*l*.5,e[10]=i/(t-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*t/(t-i),e[15]=0,e}function Mv(e,n,t,i,r,a,o){var u=1/(n-t),s=1/(i-r),l=1/(a-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(n+t)*u,e[13]=(r+i)*s,e[14]=(o+a)*l,e[15]=1,e}var Lm=Mv;function Pm(e,n,t,i,r,a,o){var u=1/(n-t),s=1/(i-r),l=1/(a-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=l,e[11]=0,e[12]=(n+t)*u,e[13]=(r+i)*s,e[14]=a*l,e[15]=1,e}function Rv(e,n,t,i){var r,a,o,u,s,l,h,d,v,y,x=n[0],S=n[1],M=n[2],O=i[0],H=i[1],W=i[2],he=t[0],ve=t[1],Re=t[2];return Math.abs(x-he)<Et&&Math.abs(S-ve)<Et&&Math.abs(M-Re)<Et?Hh(e):(h=x-he,d=S-ve,v=M-Re,y=1/Math.hypot(h,d,v),h*=y,d*=y,v*=y,r=H*v-W*d,a=W*h-O*v,o=O*d-H*h,y=Math.hypot(r,a,o),y?(y=1/y,r*=y,a*=y,o*=y):(r=0,a=0,o=0),u=d*o-v*a,s=v*r-h*o,l=h*a-d*r,y=Math.hypot(u,s,l),y?(y=1/y,u*=y,s*=y,l*=y):(u=0,s=0,l=0),e[0]=r,e[1]=u,e[2]=h,e[3]=0,e[4]=a,e[5]=s,e[6]=d,e[7]=0,e[8]=o,e[9]=l,e[10]=v,e[11]=0,e[12]=-(r*x+a*S+o*M),e[13]=-(u*x+s*S+l*M),e[14]=-(h*x+d*S+v*M),e[15]=1,e)}function Im(e,n,t,i){var r=n[0],a=n[1],o=n[2],u=i[0],s=i[1],l=i[2],h=r-t[0],d=a-t[1],v=o-t[2],y=h*h+d*d+v*v;y>0&&(y=1/Math.sqrt(y),h*=y,d*=y,v*=y);var x=s*v-l*d,S=l*h-u*v,M=u*d-s*h;return y=x*x+S*S+M*M,y>0&&(y=1/Math.sqrt(y),x*=y,S*=y,M*=y),e[0]=x,e[1]=S,e[2]=M,e[3]=0,e[4]=d*M-v*S,e[5]=v*x-h*M,e[6]=h*S-d*x,e[7]=0,e[8]=h,e[9]=d,e[10]=v,e[11]=0,e[12]=r,e[13]=a,e[14]=o,e[15]=1,e}function Om(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function km(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Fm(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e[4]=n[4]+t[4],e[5]=n[5]+t[5],e[6]=n[6]+t[6],e[7]=n[7]+t[7],e[8]=n[8]+t[8],e[9]=n[9]+t[9],e[10]=n[10]+t[10],e[11]=n[11]+t[11],e[12]=n[12]+t[12],e[13]=n[13]+t[13],e[14]=n[14]+t[14],e[15]=n[15]+t[15],e}function Lv(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e[4]=n[4]-t[4],e[5]=n[5]-t[5],e[6]=n[6]-t[6],e[7]=n[7]-t[7],e[8]=n[8]-t[8],e[9]=n[9]-t[9],e[10]=n[10]-t[10],e[11]=n[11]-t[11],e[12]=n[12]-t[12],e[13]=n[13]-t[13],e[14]=n[14]-t[14],e[15]=n[15]-t[15],e}function Nm(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e[4]=n[4]*t,e[5]=n[5]*t,e[6]=n[6]*t,e[7]=n[7]*t,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=n[11]*t,e[12]=n[12]*t,e[13]=n[13]*t,e[14]=n[14]*t,e[15]=n[15]*t,e}function Dm(e,n,t,i){return e[0]=n[0]+t[0]*i,e[1]=n[1]+t[1]*i,e[2]=n[2]+t[2]*i,e[3]=n[3]+t[3]*i,e[4]=n[4]+t[4]*i,e[5]=n[5]+t[5]*i,e[6]=n[6]+t[6]*i,e[7]=n[7]+t[7]*i,e[8]=n[8]+t[8]*i,e[9]=n[9]+t[9]*i,e[10]=n[10]+t[10]*i,e[11]=n[11]+t[11]*i,e[12]=n[12]+t[12]*i,e[13]=n[13]+t[13]*i,e[14]=n[14]+t[14]*i,e[15]=n[15]+t[15]*i,e}function Bm(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]&&e[9]===n[9]&&e[10]===n[10]&&e[11]===n[11]&&e[12]===n[12]&&e[13]===n[13]&&e[14]===n[14]&&e[15]===n[15]}function Jp(e,n){var t=e[0],i=e[1],r=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],h=e[8],d=e[9],v=e[10],y=e[11],x=e[12],S=e[13],M=e[14],O=e[15],H=n[0],W=n[1],he=n[2],ve=n[3],Re=n[4],ze=n[5],ft=n[6],gt=n[7],Pt=n[8],Mt=n[9],sr=n[10],xr=n[11],Br=n[12],kn=n[13],Oi=n[14],xi=n[15];return Math.abs(t-H)<=Et*Math.max(1,Math.abs(t),Math.abs(H))&&Math.abs(i-W)<=Et*Math.max(1,Math.abs(i),Math.abs(W))&&Math.abs(r-he)<=Et*Math.max(1,Math.abs(r),Math.abs(he))&&Math.abs(a-ve)<=Et*Math.max(1,Math.abs(a),Math.abs(ve))&&Math.abs(o-Re)<=Et*Math.max(1,Math.abs(o),Math.abs(Re))&&Math.abs(u-ze)<=Et*Math.max(1,Math.abs(u),Math.abs(ze))&&Math.abs(s-ft)<=Et*Math.max(1,Math.abs(s),Math.abs(ft))&&Math.abs(l-gt)<=Et*Math.max(1,Math.abs(l),Math.abs(gt))&&Math.abs(h-Pt)<=Et*Math.max(1,Math.abs(h),Math.abs(Pt))&&Math.abs(d-Mt)<=Et*Math.max(1,Math.abs(d),Math.abs(Mt))&&Math.abs(v-sr)<=Et*Math.max(1,Math.abs(v),Math.abs(sr))&&Math.abs(y-xr)<=Et*Math.max(1,Math.abs(y),Math.abs(xr))&&Math.abs(x-Br)<=Et*Math.max(1,Math.abs(x),Math.abs(Br))&&Math.abs(S-kn)<=Et*Math.max(1,Math.abs(S),Math.abs(kn))&&Math.abs(M-Oi)<=Et*Math.max(1,Math.abs(M),Math.abs(Oi))&&Math.abs(O-xi)<=Et*Math.max(1,Math.abs(O),Math.abs(xi))}var Zm=Ri,Um=Lv,Pv,Iv,zm=(Pv=(0,pr.b2)(),Pv(Iv=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"viewport",void 0),(0,R.Z)(this,"overridedViewProjectionMatrix",void 0),(0,R.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,R.Z)(this,"jitteredProjectionMatrix",void 0),(0,R.Z)(this,"viewMatrixInverse",void 0),(0,R.Z)(this,"cameraPosition",void 0)}return(0,at.Z)(e,[{key:"init",value:function(){}},{key:"update",value:function(t){this.viewport=t,this.viewMatrixInverse=Ro(),jh(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var t=this.viewport.getCenter(),i=(0,Dr.Z)(t,2),r=i[0],a=i[1];return[r,a]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(t,i){return this.viewport.projectFlat(t,i)}},{key:"setViewProjectionMatrix",value:function(t){this.overridedViewProjectionMatrix=t}},{key:"jitterProjectionMatrix",value:function(t,i){var r=Sv(Ro(),[t,i,0]);this.jitteredProjectionMatrix=Ri(Ro(),r,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Ri(Ro(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||Iv),Us;(function(e){e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom"})(Us||(Us={}));var Ov,kv;function Gm(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Vm(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function Vm(e,n){if(!!e){if(typeof e=="string")return Fv(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Fv(e,n)}}function Fv(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var Hm={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},ed=(Ov=(0,pr.b2)(),Ov(kv=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"container",void 0),(0,R.Z)(this,"controlCorners",void 0),(0,R.Z)(this,"controlContainer",void 0),(0,R.Z)(this,"scene",void 0),(0,R.Z)(this,"mapsService",void 0),(0,R.Z)(this,"controls",[]),(0,R.Z)(this,"unAddControls",[])}return(0,at.Z)(e,[{key:"init",value:function(t,i){this.container=t.container,this.scene=i,this.mapsService=i.get(qe.IMapService),this.initControlPos()}},{key:"addControl",value:function(t,i){var r=i.get(qe.IMapService);r.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}},{key:"getControlByName",value:function(t){return this.controls.find(function(i){return i.controlOption.name===t})}},{key:"removeControl",value:function(t){var i=this.controls.indexOf(t);return i>-1&&this.controls.splice(i,1),t.remove(),this}},{key:"addControls",value:function(){var t=this;this.unAddControls.forEach(function(i){i.addTo(t.scene),t.controls.push(i)}),this.unAddControls=[]}},{key:"destroy",value:function(){var t=Gm(this.controls),i;try{for(t.s();!(i=t.n()).done;){var r=i.value;r.remove()}}catch(a){t.e(a)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var t=this.controlCorners={},i="l7-",r=this.controlContainer=bn("div",i+"control-container",this.container);function a(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],s=u.map(function(l){return i+l}).join(" ");t[u.filter(function(l){return!["row","column"].includes(l)}).join("")]=bn("div",s,r)}function o(u){var s=u.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,L.Z)(s),[Hm[u]])}Object.values(Us).forEach(function(u){a(o(u))}),this.checkCornerOverlap()}},{key:"clearControlPos",value:function(){for(var t in this.controlCorners)this.controlCorners[t]&&va(this.controlCorners[t]);this.controlContainer&&va(this.controlContainer)}},{key:"checkCornerOverlap",value:function(){var t=this,i=window.MutationObserver;if(!!i)for(var r=0,a=Object.keys(this.controlCorners);r<a.length;r++){var o=a[r],u=o.match(/^(top|bottom)(left|right)$/);u&&function(){var s=(0,Dr.Z)(u,3),l=s[1],h=s[2],d=t.controlCorners["".concat(l).concat(h)],v=new i(function(y){var x=(0,Dr.Z)(y,1),S=x[0].target;d&&(d.style[l]=S.clientHeight+"px")});v.observe(t.controlCorners["".concat(h).concat(l)],{childList:!0,attributes:!0})}()}}}]),e}())||kv),td,rd,jm=(td=(0,pr.b2)(),td(rd=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"container",void 0),(0,R.Z)(this,"scene",void 0),(0,R.Z)(this,"mapsService",void 0),(0,R.Z)(this,"markers",[]),(0,R.Z)(this,"markerLayers",[]),(0,R.Z)(this,"unAddMarkers",[]),(0,R.Z)(this,"unAddMarkerLayers",[])}return(0,at.Z)(e,[{key:"addMarkerLayer",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}},{key:"removeMarkerLayer",value:function(t){t.destroy(),this.markerLayers.indexOf(t);var i=this.markerLayers.indexOf(t);i>-1&&this.markerLayers.splice(i,1)}},{key:"addMarker",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}},{key:"addMarkers",value:function(){var t=this;this.unAddMarkers.forEach(function(i){i.addTo(t.scene),t.markers.push(i)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var t=this;this.unAddMarkerLayers.forEach(function(i){t.markerLayers.push(i),i.addTo(t.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(t){t.remove(),this.markers.indexOf(t);var i=this.markers.indexOf(t);i>-1&&this.markers.splice(i,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(qe.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(t){t.remove()}),this.markers=[],this.markerLayers.forEach(function(t){t.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(t){t.destroy()}}]),e}())||rd),Nv,Dv,nd=(Nv=(0,pr.b2)(),Nv(Dv=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"scene",void 0),(0,R.Z)(this,"mapsService",void 0),(0,R.Z)(this,"popups",[]),(0,R.Z)(this,"unAddPopups",[])}return(0,at.Z)(e,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(t){t!=null&&t.isOpen()&&t.remove();var i=this.popups.indexOf(t);i>-1&&this.popups.splice(i,1);var r=this.unAddPopups.indexOf(t);r>-1&&this.unAddPopups.splice(r,1)}},{key:"destroy",value:function(){this.popups.forEach(function(t){return t.remove()})}},{key:"addPopup",value:function(t){var i=this;t&&t.getOptions().autoClose&&[].concat((0,L.Z)(this.popups),(0,L.Z)(this.unAddPopups)).forEach(function(r){r.getOptions().autoClose&&i.removePopup(r)}),this.isMarkerReady?(t.addTo(this.scene),this.popups.push(t)):this.unAddPopups.push(t),t.on("close",function(){i.removePopup(t)})}},{key:"initPopup",value:function(){var t=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(i){t.addPopup(i),t.unAddPopups=[]})}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(qe.IMapService)}}]),e}())||Dv),Qu;(function(e){e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none"})(Qu||(Qu={}));var zs;(function(e){e.MULTIPLE="MULTIPLE",e.SINGLE="SINGLE"})(zs||(zs={}));var nf;(function(e){e.AND="and",e.OR="or"})(nf||(nf={}));var $n;(function(e){e.INIT="init",e.UPDATE="update"})($n||($n={}));var id={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Wm=id,Bv,Zv,$m={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,isMini:!1,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},ad={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:nf.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Xm=(Bv=(0,pr.b2)(),Bv(Zv=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"sceneConfigCache",{}),(0,R.Z)(this,"layerConfigCache",{}),(0,R.Z)(this,"layerAttributeConfigCache",{})}return(0,at.Z)(e,[{key:"getSceneConfig",value:function(t){return this.sceneConfigCache[t]}},{key:"getSceneWarninfo",value:function(t){return Wm[t]}},{key:"setSceneConfig",value:function(t,i){this.sceneConfigCache[t]=(0,b.Z)((0,b.Z)({},$m),i)}},{key:"getLayerConfig",value:function(t){return this.layerConfigCache[t]}},{key:"setLayerConfig",value:function(t,i,r){this.layerConfigCache[i]=(0,b.Z)({},(0,Rr.merge)({},this.sceneConfigCache[t],ad,r))}},{key:"getAttributeConfig",value:function(t){return this.layerAttributeConfigCache[t]}},{key:"setAttributeConfig",value:function(t,i){this.layerAttributeConfigCache[t]=(0,b.Z)((0,b.Z)({},this.layerAttributeConfigCache[t]),i)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||Zv);function En(e,n,t,i){!t||Object.defineProperty(e,n,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(i):void 0})}function An(e,n,t,i,r){var a={};return Object.keys(i).forEach(function(o){a[o]=i[o]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=t.slice().reverse().reduce(function(o,u){return u(e,n,o)||o},a),r&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,n,a),a=null),a}function Uv(){var e=new Ht(4);return Ht!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Xy(e){var n=new glMatrix.ARRAY_TYPE(4);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function Ym(e,n,t,i){var r=new Ht(4);return r[0]=e,r[1]=n,r[2]=t,r[3]=i,r}function Km(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}function Yy(e,n,t,i,r){return e[0]=n,e[1]=t,e[2]=i,e[3]=r,e}function Ky(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e}function qy(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e}function zv(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e[3]=n[3]*t[3],e}function Gv(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e[3]=n[3]/t[3],e}function Qy(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e[3]=Math.ceil(n[3]),e}function Jy(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e[3]=Math.floor(n[3]),e}function e_(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e[3]=Math.min(n[3],t[3]),e}function t_(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e[3]=Math.max(n[3],t[3]),e}function r_(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e[3]=Math.round(n[3]),e}function qm(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e}function n_(e,n,t,i){return e[0]=n[0]+t[0]*i,e[1]=n[1]+t[1]*i,e[2]=n[2]+t[2]*i,e[3]=n[3]+t[3]*i,e}function i_(e,n){var t=n[0]-e[0],i=n[1]-e[1],r=n[2]-e[2],a=n[3]-e[3];return Math.hypot(t,i,r,a)}function a_(e,n){var t=n[0]-e[0],i=n[1]-e[1],r=n[2]-e[2],a=n[3]-e[3];return t*t+i*i+r*r+a*a}function o_(e){var n=e[0],t=e[1],i=e[2],r=e[3];return Math.hypot(n,t,i,r)}function u_(e){var n=e[0],t=e[1],i=e[2],r=e[3];return n*n+t*t+i*i+r*r}function s_(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=-n[3],e}function l_(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e[3]=1/n[3],e}function c_(e,n){var t=n[0],i=n[1],r=n[2],a=n[3],o=t*t+i*i+r*r+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=t*o,e[1]=i*o,e[2]=r*o,e[3]=a*o,e}function f_(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]}function h_(e,n,t,i){var r=t[0]*i[1]-t[1]*i[0],a=t[0]*i[2]-t[2]*i[0],o=t[0]*i[3]-t[3]*i[0],u=t[1]*i[2]-t[2]*i[1],s=t[1]*i[3]-t[3]*i[1],l=t[2]*i[3]-t[3]*i[2],h=n[0],d=n[1],v=n[2],y=n[3];return e[0]=d*l-v*s+y*u,e[1]=-(h*l)+v*o-y*a,e[2]=h*s-d*o+y*r,e[3]=-(h*u)+d*a-v*r,e}function p_(e,n,t,i){var r=n[0],a=n[1],o=n[2],u=n[3];return e[0]=r+i*(t[0]-r),e[1]=a+i*(t[1]-a),e[2]=o+i*(t[2]-o),e[3]=u+i*(t[3]-u),e}function d_(e,n){n=n||1;var t,i,r,a,o,u;do t=glMatrix.RANDOM()*2-1,i=glMatrix.RANDOM()*2-1,o=t*t+i*i;while(o>=1);do r=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,u=r*r+a*a;while(u>=1);var s=Math.sqrt((1-o)/u);return e[0]=n*t,e[1]=n*i,e[2]=n*r*s,e[3]=n*a*s,e}function od(e,n,t){var i=n[0],r=n[1],a=n[2],o=n[3];return e[0]=t[0]*i+t[4]*r+t[8]*a+t[12]*o,e[1]=t[1]*i+t[5]*r+t[9]*a+t[13]*o,e[2]=t[2]*i+t[6]*r+t[10]*a+t[14]*o,e[3]=t[3]*i+t[7]*r+t[11]*a+t[15]*o,e}function v_(e,n,t){var i=n[0],r=n[1],a=n[2],o=t[0],u=t[1],s=t[2],l=t[3],h=l*i+u*a-s*r,d=l*r+s*i-o*a,v=l*a+o*r-u*i,y=-o*i-u*r-s*a;return e[0]=h*l+y*-o+d*-s-v*-u,e[1]=d*l+y*-u+v*-o-h*-s,e[2]=v*l+y*-s+h*-u-d*-o,e[3]=n[3],e}function m_(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function c(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function f(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]}function m(e,n){var t=e[0],i=e[1],r=e[2],a=e[3],o=n[0],u=n[1],s=n[2],l=n[3];return Math.abs(t-o)<=glMatrix.EPSILON*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(i-u)<=glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(r-s)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-l)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))}var A=null,B=null,te=null,Me=null,Ze=null,ct=null,Yt=null,qt=function(){var e=Uv();return function(n,t,i,r,a,o){var u,s;for(t||(t=4),i||(i=0),r?s=Math.min(r*t+i,n.length):s=n.length,u=i;u<s;u+=t)e[0]=n[u],e[1]=n[u+1],e[2]=n[u+2],e[3]=n[u+3],a(e,e,o),n[u]=e[0],n[u+1]=e[1],n[u+2]=e[2],n[u+3]=e[3];return n}}(),ur=Math.PI/180,Fr=512,qr=4003e4;function hn(e){var n=e.latitude,t=n===void 0?0:n,i=e.zoom,r=i===void 0?0:i,a=e.scale,o=e.highPrecision,u=o===void 0?!1:o,s=e.flipY,l=s===void 0?!1:s;a=a!==void 0?a:Math.pow(2,r);var h={},d=Fr*a,v=Math.cos(t*ur),y=d/360,x=y/v,S=d/qr/v;if(h.pixelsPerMeter=[S,-S,S],h.metersPerPixel=[1/S,-1/S,1/S],h.pixelsPerDegree=[y,-x,S],h.degreesPerPixel=[1/y,-1/x,1/S],u){var M=ur*Math.tan(t*ur)/v,O=y*M/2,H=d/qr*M,W=H/x*S;h.pixelsPerDegree2=[0,-O,H],h.pixelsPerMeter2=[W,0,W],l&&(h.pixelsPerDegree2[1]=-h.pixelsPerDegree2[1],h.pixelsPerMeter2[1]=-h.pixelsPerMeter2[1])}return l&&(h.pixelsPerMeter[1]=-h.pixelsPerMeter[1],h.metersPerPixel[1]=-h.metersPerPixel[1],h.pixelsPerDegree[1]=-h.pixelsPerDegree[1],h.degreesPerPixel[1]=-h.degreesPerPixel[1]),h}var mn;(function(e){e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2"})(mn||(mn={}));var un={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},Bn,Vn,Lo,wa,Po,Ji=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],bu=(Bn=(0,pr.b2)(),Vn=(0,pr.f3)(qe.ICameraService),Bn(Lo=(wa=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"needRefresh",!0),En(this,"cameraService",Po,this),(0,R.Z)(this,"coordinateSystem",void 0),(0,R.Z)(this,"viewportCenter",void 0),(0,R.Z)(this,"viewportCenterProjection",void 0),(0,R.Z)(this,"pixelsPerDegree",void 0),(0,R.Z)(this,"pixelsPerDegree2",void 0),(0,R.Z)(this,"pixelsPerMeter",void 0)}return(0,at.Z)(e,[{key:"refresh",value:function(t){var i=this.cameraService.getZoom(),r=this.cameraService.getZoomScale(),a=t||this.cameraService.getCenter(),o=hn({latitude:a[1],zoom:i}),u=o.pixelsPerMeter,s=o.pixelsPerDegree;this.viewportCenter=a,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=u,this.pixelsPerDegree=s,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===mn.LNGLAT||this.coordinateSystem===mn.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===mn.LNGLAT_OFFSET?this.calculateLnglatOffset(a,i):this.coordinateSystem===mn.P20_OFFSET&&this.calculateLnglatOffset(a,i,r,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(t){this.coordinateSystem=t}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(t,i,r,a){var o=hn({latitude:t[1],zoom:i,scale:r,flipY:a,highPrecision:!0}),u=o.pixelsPerMeter,s=o.pixelsPerDegree,l=o.pixelsPerDegree2,h=this.cameraService.getViewMatrix(),d=this.cameraService.getProjectionMatrix(),v=Ri([],d,h),y=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,i));this.viewportCenterProjection=od([],[y[0],y[1],0,1],v),h=this.cameraService.getViewMatrixUncentered()||h,v=Ri([],d,h),v=Ri([],v,Ji),this.cameraService.setViewProjectionMatrix(v),this.pixelsPerMeter=u,this.pixelsPerDegree=s,this.pixelsPerDegree2=l}}]),e}(),Po=An(wa.prototype,"cameraService",[Vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wa))||Lo),Ju,ud;function gA(e){var n=yA();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function yA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _A=(Ju=(0,pr.b2)(),Ju(ud=function(e){(0,Ot.Z)(t,e);var n=gA(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"renderMap",new Map),(0,R.Z)((0,pe.Z)(i),"enable",!1),(0,R.Z)((0,pe.Z)(i),"renderEnable",!1),(0,R.Z)((0,pe.Z)(i),"cacheLogs",{}),i}return(0,at.Z)(t,[{key:"setEnable",value:function(r){this.enable=!!r}},{key:"log",value:function(r,a){var o=this;if(!!this.enable){var u=r.split("."),s=null;u.forEach(function(l,h){s!==null?(s[l]||(s[l]={}),h!==u.length-1&&(s=s[l])):(o.cacheLogs[l]||(o.cacheLogs[l]={}),h!==u.length-1&&(s=o.cacheLogs[l])),h===u.length-1&&(s[l]=(0,b.Z)((0,b.Z)({time:Date.now()},s[l]),a))})}}},{key:"getLog",value:function(r){var a=this;switch((0,Oo.Z)(r)){case"string":return this.cacheLogs[r];case"object":return r.map(function(o){return a.cacheLogs[o]}).filter(function(o){return o!==void 0});case"undefined":return this.cacheLogs}}},{key:"removeLog",value:function(r){delete this.cacheLogs[r]}},{key:"generateRenderUid",value:function(){return this.renderEnable?ec():""}},{key:"renderDebug",value:function(r){this.renderEnable=r}},{key:"renderStart",value:function(r){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(r)||{};this.renderMap.set(r,(0,b.Z)((0,b.Z)({},a),{},{renderUid:r,renderStart:Date.now()}))}}},{key:"renderEnd",value:function(r){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(r);if(a){var o=a.renderStart,u=Date.now();this.emit("renderEnd",(0,b.Z)((0,b.Z)({},a),{},{renderEnd:u,renderDuration:u-o})),this.renderMap.delete(r)}}}},{key:"destroy",value:function(){this.cacheLogs=null,this.renderMap.clear()}}]),t}(Wi.EventEmitter))||ud),xA=D(20396),sd=D.n(xA),co;(function(e){e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag"})(co||(co={}));var g_,y_,__,Qm,x_;function SA(e){var n=bA();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function bA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var EA={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},AA=(g_=(0,pr.b2)(),y_=(0,pr.f3)(qe.IMapService),g_(__=(Qm=function(e){(0,Ot.Z)(t,e);var n=SA(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"indragging",!1),En((0,pe.Z)(i),"mapService",x_,(0,pe.Z)(i)),(0,R.Z)((0,pe.Z)(i),"hammertime",void 0),(0,R.Z)((0,pe.Z)(i),"lastClickTime",0),(0,R.Z)((0,pe.Z)(i),"lastClickXY",[-1,-1]),(0,R.Z)((0,pe.Z)(i),"clickTimer",void 0),(0,R.Z)((0,pe.Z)(i),"$containter",void 0),(0,R.Z)((0,pe.Z)(i),"onDrag",function(u){var s=i.interactionEvent(u);s.type=EA[s.type],s.type==="dragging"?i.indragging=!0:i.indragging=!1,i.emit(co.Drag,s)}),(0,R.Z)((0,pe.Z)(i),"onHammer",function(u){u.srcEvent.stopPropagation();var s=i.interactionEvent(u);i.emit(co.Hover,s)}),(0,R.Z)((0,pe.Z)(i),"onTouch",function(u){var s=u.touches[0];i.onHover({x:s.pageX,y:s.pageY,type:"touch"})}),(0,R.Z)((0,pe.Z)(i),"onHover",function(u){var s=u.clientX,l=u.clientY,h=s,d=l,v=u.type,y=i.mapService.getMapContainer();if(y)if(Ba)h=h-y.left-0,d=d-y.top-0;else{var x=y.getBoundingClientRect(),S=x.top,M=x.left;h=h-M-y.clientLeft,d=d-S-y.clientTop}var O=i.mapService.containerToLngLat([h,d]);if(v==="click"){if(!Ba&&"ontouchstart"in document.documentElement)return;i.isDoubleTap(h,d,O);return}if(v==="touch"){i.isDoubleTap(h,d,O);return}v!=="click"&&v!=="dblclick"&&i.emit(co.Hover,{x:h,y:d,lngLat:O,type:v,target:u})}),i}return(0,at.Z)(t,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(co.Hover)}},{key:"triggerHover",value:function(r){var a=r.x,o=r.y;this.emit(co.Hover,{x:a,y:o})}},{key:"triggerSelect",value:function(r){this.emit(co.Select,{featureId:r})}},{key:"triggerActive",value:function(r){this.emit(co.Active,{featureId:r})}},{key:"handleMiniEvent",value:function(r){this.onHover({clientX:r.touches[0].pageX,clientY:r.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var r=this.mapService.getMapContainer();if(r)if(Ba)In.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var a=new(sd()).Manager(r);a.add(new(sd()).Tap({event:"dblclick",taps:2})),a.add(new(sd()).Tap({event:"click"})),a.add(new(sd()).Pan({threshold:0,pointers:0})),a.add(new(sd()).Press({})),a.on("dblclick click",this.onHammer),a.on("panstart panmove panend pancancel",this.onDrag),r.addEventListener("mousemove",this.onHover),r.addEventListener("mousedown",this.onHover,!0),r.addEventListener("mouseup",this.onHover),r.addEventListener("contextmenu",this.onHover),this.hammertime=a}}},{key:"removeEventListenerOnMap",value:function(){if(Ba)In.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var r=this.mapService.getMapContainer();r&&(r.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),r.removeEventListener("mousedown",this.onHover),r.removeEventListener("mouseup",this.onHover),r.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(r){var a=r.type,o=r.pointerType,u,s;o==="touch"?(s=Math.floor(r.pointers[0].clientY),u=Math.floor(r.pointers[0].clientX)):(s=Math.floor(r.srcEvent.y),u=Math.floor(r.srcEvent.x));var l=this.mapService.getMapContainer();if(l){var h=l.getBoundingClientRect(),d=h.top,v=h.left;u-=v,s-=d}var y=this.mapService.containerToLngLat([u,s]);return{x:u,y:s,lngLat:y,type:a,target:r.srcEvent}}},{key:"isDoubleTap",value:function(r,a,o){var u=this,s=new Date().getTime(),l="click";s-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-r)<10&&Math.abs(this.lastClickXY[1]-a)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),l="dblclick",this.emit(co.Hover,{x:r,y:a,lngLat:o,type:l})):(this.lastClickTime=s,this.lastClickXY=[r,a],this.clickTimer=setTimeout(function(){l="click",u.emit(co.Hover,{x:r,y:a,lngLat:o,type:l})},400))}}]),t}(Vc()),x_=An(Qm.prototype,"mapService",[y_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qm))||__),TA=0;function CA(e){if(Ba)return null;var n=e;if(typeof e=="string"&&(n=document.getElementById(e)),n){var t=document.createElement("div");return t.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,t.id="l7-scene-".concat(TA++),t.classList.add("l7-scene"),n.appendChild(t),t}return null}function wA(e){var n,t=!0;if((e==null||(n=e.target)===null||n===void 0?void 0:n.target)instanceof HTMLElement)for(var i,r=e==null||(i=e.target)===null||i===void 0?void 0:i.target;r;){var a,o=Array.from(r.classList);if(o.includes("l7-marker")||o.includes("l7-popup")){t=!1;break}r=(a=r)===null||a===void 0?void 0:a.parentElement}return t}var N;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(N||(N={}));var S_,b_,E_,A_,T_,C_,w_,Kf,M_,R_,L_,P_,I_,MA=(S_=(0,pr.b2)(),b_=(0,pr.f3)(qe.IMapService),E_=(0,pr.f3)(qe.IRendererService),A_=(0,pr.f3)(qe.IGlobalConfigService),T_=(0,pr.f3)(qe.IInteractionService),C_=(0,pr.f3)(qe.ILayerService),S_(w_=(Kf=function(){function e(){var n=this;(0,ot.Z)(this,e),(0,R.Z)(this,"pickedColors",void 0),(0,R.Z)(this,"pickedTileLayers",[]),En(this,"mapService",M_,this),En(this,"rendererService",R_,this),En(this,"configService",L_,this),En(this,"interactionService",P_,this),En(this,"layerService",I_,this),(0,R.Z)(this,"pickingFBO",void 0),(0,R.Z)(this,"width",0),(0,R.Z)(this,"height",0),(0,R.Z)(this,"alreadyInPicking",!1),(0,R.Z)(this,"pickBufferScale",1),(0,R.Z)(this,"pickFromPickingFBO",function(t,i){var r=i.x,a=i.y,o=i.lngLat,u=i.type,s=i.target,l=!1,h=n.rendererService,d=h.readPixels,v=h.getContainer,y=n.getContainerSize(v()),x=y.width,S=y.height;x*=bi,S*=bi;var M=t.getLayerConfig(),O=M.enableHighlight,H=M.enableSelect,W=r*bi,he=a*bi;if(W>x-1*bi||W<0||he>S-1*bi||he<0)return!1;var ve=d({x:Math.floor(W/n.pickBufferScale),y:Math.floor((S-(a+1)*bi)/n.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:n.pickingFBO});if(n.pickedColors=ve,ve[0]!==0||ve[1]!==0||ve[2]!==0){var Re=Bo(ve),ze=t.layerPickService.getFeatureById(Re);Re!==t.getCurrentPickId()&&u==="mousemove"&&(u="mouseenter");var ft={x:r,y:a,type:u,lngLat:o,featureId:Re,feature:ze,target:s};ze&&(l=!0,t.setCurrentPickId(Re),n.triggerHoverOnLayer(t,ft))}else{var gt={x:r,y:a,lngLat:o,type:t.getCurrentPickId()!==null&&u==="mousemove"?"mouseout":"un"+u,featureId:null,target:s,feature:null};n.triggerHoverOnLayer(t,(0,b.Z)((0,b.Z)({},gt),{},{type:"unpick"})),n.triggerHoverOnLayer(t,gt),t.setCurrentPickId(null)}if(O&&t.layerPickService.highlightPickedFeature(ve),H&&u==="click"&&(ve==null?void 0:ve.toString())!==[0,0,0,0].toString()){var Pt=Bo(ve);t.getCurrentSelectedId()===null||Pt!==t.getCurrentSelectedId()?(t.layerPickService.selectFeature(ve),t.setCurrentSelectedId(Pt)):(t.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),t.setCurrentSelectedId(null))}return l})}return(0,at.Z)(e,[{key:"init",value:function(t){var i=this.rendererService,r=i.createTexture2D,a=i.createFramebuffer,o=i.getContainer,u=this.getContainerSize(o()),s=u.width,l=u.height;s*=bi,l*=bi,this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,this.pickingFBO=a({color:r({width:Math.round(s/this.pickBufferScale),height:Math.round(l/this.pickBufferScale),wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE})}),this.interactionService.on(co.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var n=(0,st.Z)(q().mark(function i(r,a,o){var u=this,s,l,h;return q().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:s=this.rendererService,l=s.useFramebuffer,h=s.clear,this.resizePickingFBO(),l(this.pickingFBO,function(){h({framebuffer:u.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),r.hooks.beforePickingEncode.call(),r.renderModels({ispick:!0}),r.hooks.afterPickingEncode.call();var y=u.pickBox(r,a);o(y)});case 3:case"end":return v.stop()}},i,this)}));function t(i,r,a){return n.apply(this,arguments)}return t}()},{key:"pickBox",value:function(t,i){var r=this,a=i.map(function(Pt){var Mt=Pt<0?0:Pt;return Math.floor(Mt*bi/r.pickBufferScale)}),o=(0,Dr.Z)(a,4),u=o[0],s=o[1],l=o[2],h=o[3],d=this.rendererService,v=d.readPixels,y=d.getContainer,x=this.getContainerSize(y()),S=x.width,M=x.height;if(S*=bi,M*=bi,u>(S-1)*bi/this.pickBufferScale||l<0||s>(M-1)*bi/this.pickBufferScale||h<0)return[];for(var O=Math.min(S/this.pickBufferScale,l)-u,H=Math.min(M/this.pickBufferScale,h)-s,W=v({x:u,y:Math.floor(M/this.pickBufferScale-(h+1)),width:O,height:H,data:new Uint8Array(O*H*4),framebuffer:this.pickingFBO}),he=[],ve={},Re=0;Re<W.length/4;Re=Re+1){var ze=W.slice(Re*4,Re*4+4),ft=Bo(ze);if(ft!==-1&&!ve[ft]){var gt=t.layerPickService.getFeatureById(ft);he.push((0,b.Z)((0,b.Z)({},gt),{},{pickedFeatureIdx:ft})),ve[ft]=!0}}return he}},{key:"handleCursor",value:function(t,i){var r=t.getLayerConfig(),a=r.cursor,o=a===void 0?"":a,u=r.cursorEnabled;if(u){var s=this.mapService.version,l=s==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),h=l==null?void 0:l.style.getPropertyValue("cursor");i==="unmousemove"&&h!==""?l==null||l.style.setProperty("cursor",""):i==="mousemove"&&(l==null||l.style.setProperty("cursor",o))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(t){return t.getContext?{width:t.width/bi,height:t.height/bi}:t.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var n=(0,st.Z)(q().mark(function i(r){return q().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(!this.layerService.needPick(r.type)||!this.isPickingAllLayer())){o.next=2;break}return o.abrupt("return");case 2:return this.alreadyInPicking=!0,o.next=5,this.pickingLayers(r);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return o.stop()}},i,this)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var t=this.rendererService.getContainer,i=this.getContainerSize(t()),r=i.width,a=i.height;r*=bi,a*=bi,(this.width!==r||this.height!==a)&&(this.pickingFBO.resize({width:Math.round(r/this.pickBufferScale),height:Math.round(a/this.pickBufferScale)}),this.width=r,this.height=a)}},{key:"pickingLayers",value:function(){var n=(0,st.Z)(q().mark(function i(r){var a=this,o,u,s;return q().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:o=this.rendererService,u=o.useFramebuffer,s=o.clear,this.resizePickingFBO(),u(this.pickingFBO,function(){var d=a.layerService.getRenderList();d.filter(function(v){return v.needPick(r.type)}).reverse().some(function(v){s({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),v.layerPickService.pickRender(r);var y=a.pickFromPickingFBO(v,r);return a.layerService.pickedLayerId=y?+v.id:-1,y&&!v.getLayerConfig().enablePropagation})});case 3:case"end":return h.stop()}},i,this)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"triggerHoverOnLayer",value:function(t,i){wA(i)&&(this.handleCursor(t,i.type),t.emit(i.type,i))}}]),e}(),M_=An(Kf.prototype,"mapService",[b_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R_=An(Kf.prototype,"rendererService",[E_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L_=An(Kf.prototype,"configService",[A_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P_=An(Kf.prototype,"interactionService",[T_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I_=An(Kf.prototype,"layerService",[C_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kf))||w_),RA=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,ot.Z)(this,e),(0,R.Z)(this,"autoStart",void 0),(0,R.Z)(this,"startTime",0),(0,R.Z)(this,"oldTime",0),(0,R.Z)(this,"running",!1),(0,R.Z)(this,"elapsedTime",0),this.autoStart=n}return(0,at.Z)(e,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var i=(typeof performance=="undefined"?Date:performance).now();t=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=t}return t}}]),e}(),O_,k_,F_,N_,D_,ld,B_,Z_,U_;function Jm(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=LA(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function LA(e,n){if(!!e){if(typeof e=="string")return z_(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return z_(e,n)}}function z_(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function PA(e){var n=IA();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function IA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var OA=(O_=(0,pr.b2)(),k_=(0,pr.f3)(qe.IRendererService),F_=(0,pr.f3)(qe.IMapService),N_=(0,pr.f3)(qe.IDebugService),O_(D_=(ld=function(e){(0,Ot.Z)(t,e);var n=PA(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"pickedLayerId",-1),(0,R.Z)((0,pe.Z)(i),"clock",new RA),(0,R.Z)((0,pe.Z)(i),"alreadyInRendering",!1),(0,R.Z)((0,pe.Z)(i),"layers",[]),(0,R.Z)((0,pe.Z)(i),"layerList",[]),(0,R.Z)((0,pe.Z)(i),"layerRenderID",void 0),(0,R.Z)((0,pe.Z)(i),"sceneInited",!1),(0,R.Z)((0,pe.Z)(i),"animateInstanceCount",0),(0,R.Z)((0,pe.Z)(i),"shaderPicking",!0),(0,R.Z)((0,pe.Z)(i),"enableRender",!0),En((0,pe.Z)(i),"renderService",B_,(0,pe.Z)(i)),En((0,pe.Z)(i),"mapService",Z_,(0,pe.Z)(i)),En((0,pe.Z)(i),"debugService",U_,(0,pe.Z)(i)),(0,R.Z)((0,pe.Z)(i),"reRender",(0,Rr.throttle)(function(){i.renderLayers()},32)),(0,R.Z)((0,pe.Z)(i),"throttleRenderLayers",(0,Rr.throttle)(function(){i.renderLayers()},16)),i}return(0,at.Z)(t,[{key:"needPick",value:function(r){return this.layerList.some(function(a){return a.needPick(r)})}},{key:"add",value:function(r){var a=this;this.layers.push(r),this.sceneInited&&r.init().then(function(){a.renderLayers()})}},{key:"addMask",value:function(r){var a=this;this.sceneInited&&r.init().then(function(){a.renderLayers()})}},{key:"initLayers",value:function(){var i=(0,st.Z)(q().mark(function a(){var o=this;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var l=(0,st.Z)(q().mark(function h(d){return q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d.startInit){y.next=4;break}return y.next=3,d.init();case 3:o.updateLayerRenderList();case 4:case"end":return y.stop()}},h)}));return function(h){return l.apply(this,arguments)}}());case 2:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(r){return this.layers.find(function(a){return a.id===r})}},{key:"getLayerByName",value:function(r){return this.layers.find(function(a){return a.name===r})}},{key:"remove",value:function(){var i=(0,st.Z)(q().mark(function a(o,u){var s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:u?(s=u.layerChildren.indexOf(o),s>-1&&u.layerChildren.splice(s,1)):(l=this.layers.indexOf(o),l>-1&&this.layers.splice(l,1)),o.destroy(),this.reRender(),this.emit("layerChange",this.layers);case 4:case"end":return d.stop()}},a,this)}));function r(a,o){return i.apply(this,arguments)}return r}()},{key:"removeAllLayers",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:this.destroy(),this.reRender();case 2:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"setEnableRender",value:function(r){this.enableRender=r}},{key:"renderLayers",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d;return q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){y.next=2;break}return y.abrupt("return");case 2:this.updateLayerRenderList(),o=this.debugService.generateRenderUid(),this.debugService.renderStart(o),this.alreadyInRendering=!0,this.clear(),u=Jm(this.layerList),y.prev=8,u.s();case 10:if((s=u.n()).done){y.next=23;break}if(l=s.value,h=l.getLayerConfig(),d=h.enableMask,l.masks.filter(function(x){return x.inited}).length>0&&d&&this.renderMask(l.masks),!l.getLayerConfig().enableMultiPassRenderer){y.next=19;break}return y.next=17,l.renderMultiPass();case 17:y.next=21;break;case 19:return y.next=21,l.render();case 21:y.next=10;break;case 23:y.next=28;break;case 25:y.prev=25,y.t0=y.catch(8),u.e(y.t0);case 28:return y.prev=28,u.f(),y.finish(28);case 31:this.debugService.renderEnd(o),this.alreadyInRendering=!1;case 33:case"end":return y.stop()}},a,this,[[8,25,28,31]])}));function r(){return i.apply(this,arguments)}return r}()},{key:"renderMask",value:function(r){var a=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});var o=r.length>1?zs.MULTIPLE:zs.SINGLE,u=Jm(r),s;try{for(u.s();!(s=u.n()).done;){var l=s.value;l.render({isStencil:!0,stencilType:o,stencilIndex:a++})}}catch(h){u.e(h)}finally{u.f()}}},{key:"beforeRenderData",value:function(){var i=(0,st.Z)(q().mark(function a(o){var u;return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,o.hooks.beforeRenderData.promise();case 2:u=l.sent,u&&this.renderLayers();case 4:case"end":return l.stop()}},a,this)}));function r(a){return i.apply(this,arguments)}return r}()},{key:"renderTileLayerMask",value:function(r){var a=0,o=r.getLayerConfig(),u=o.enableMask,s=u===void 0?!0:u,l=r.tileMask?1:0,h=r.masks.filter(function(S){return S.inited});l=l+(s?h.length:1);var d=l>1?zs.MULTIPLE:zs.SINGLE;if((r.tileMask||h.length&&s)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),h.length&&s){var v=Jm(h),y;try{for(v.s();!(y=v.n()).done;){var x=y.value;x.render({isStencil:!0,stencilType:d,stencilIndex:a++})}}catch(S){v.e(S)}finally{v.f()}}r.tileMask&&r.tileMask.render({isStencil:!0,stencilType:d,stencilIndex:a++,stencilOperation:nf.OR})}},{key:"renderTileLayer",value:function(){var i=(0,st.Z)(q().mark(function a(o){return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.renderTileLayerMask(o),!o.getLayerConfig().enableMultiPassRenderer){s.next=6;break}return s.next=4,o.renderMultiPass();case 4:s.next=8;break;case 6:return s.next=8,o.render();case 8:case"end":return s.stop()}},a,this)}));function r(a){return i.apply(this,arguments)}return r}()},{key:"updateLayerRenderList",value:function(){var r=this;this.layerList=[],this.layers.filter(function(a){return a.inited}).filter(function(a){return a.isVisible()}).sort(function(a,o){return a.zIndex-o.zIndex}).forEach(function(a){r.layerList.push(a)})}},{key:"destroy",value:function(){this.layers.forEach(function(r){r.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++==0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount==0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var r=wn(this.mapService.bgColor);this.renderService.clear({color:r,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=In.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){In.cancelAnimationFrame(this.layerRenderID)}}]),t}(Wi.EventEmitter),B_=An(ld.prototype,"renderService",[k_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z_=An(ld.prototype,"mapService",[F_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U_=An(ld.prototype,"debugService",[N_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ld))||D_),es=D(81253),kA=function(){function e(n){var t=this;(0,ot.Z)(this,e),(0,R.Z)(this,"name",void 0),(0,R.Z)(this,"type",void 0),(0,R.Z)(this,"scale",void 0),(0,R.Z)(this,"descriptor",void 0),(0,R.Z)(this,"featureBufferLayout",[]),(0,R.Z)(this,"needRescale",!1),(0,R.Z)(this,"needRemapping",!1),(0,R.Z)(this,"needRegenerateVertices",!1),(0,R.Z)(this,"featureRange",{startIndex:0,endIndex:Infinity}),(0,R.Z)(this,"vertexAttribute",void 0),(0,R.Z)(this,"defaultCallback",function(i){if(i.length===0){var r;return((r=t.scale)===null||r===void 0?void 0:r.defaultValues)||[]}return i.map(function(a,o){var u,s=(u=t.scale)===null||u===void 0?void 0:u.scalers[o].func,l=s(a);return l})}),this.setProps(n)}return(0,at.Z)(e,[{key:"setProps",value:function(t){Object.assign(this,t)}},{key:"mapping",value:function(t){var i;if((i=this.scale)!==null&&i!==void 0&&i.callback){var r,a=(r=this.scale)===null||r===void 0?void 0:r.callback.apply(r,(0,L.Z)(t));if(!(0,Rr.isNil)(a))return[a]}return this.defaultCallback(t)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),FA=["buffer","update","name"],NA=["buffer","update","name"],cd,G_,V_,H_,eg,j_,DA=(cd={},(0,R.Z)(cd,N.FLOAT,4),(0,R.Z)(cd,N.UNSIGNED_BYTE,1),(0,R.Z)(cd,N.UNSIGNED_SHORT,2),cd),BA=(G_=(0,pr.b2)(),V_=(0,pr.f3)(qe.IRendererService),G_(H_=(eg=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"attributesAndIndices",void 0),En(this,"rendererService",j_,this),(0,R.Z)(this,"attributes",[]),(0,R.Z)(this,"triangulation",void 0),(0,R.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,at.Z)(e,[{key:"registerStyleAttribute",value:function(t){var i=this.getLayerStyleAttribute(t.name||"");return i?i.setProps(t):(i=new kA(t),this.attributes.push(i)),i}},{key:"unRegisterStyleAttribute",value:function(t){var i=this.attributes.findIndex(function(r){return r.name===t});i>-1&&this.attributes.splice(i,1)}},{key:"updateScaleAttribute",value:function(t){this.attributes.forEach(function(i){var r,a=i.name,o=(r=i.scale)===null||r===void 0?void 0:r.field;(t[a]||o&&t[o])&&(i.needRescale=!0,i.needRemapping=!0,i.needRegenerateVertices=!0)})}},{key:"updateStyleAttribute",value:function(t,i,r){var a=this.getLayerStyleAttribute(t);a||(a=this.registerStyleAttribute((0,b.Z)((0,b.Z)({},i),{},{name:t})));var o=i.scale;o&&a&&(a.scale=o,a.needRescale=!0,a.needRemapping=!0,a.needRegenerateVertices=!0,r&&r.featureRange&&(a.featureRange=r.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(t){return this.attributes.find(function(i){return i.name===t})}},{key:"getLayerAttributeScale",value:function(t){var i,r=this.getLayerStyleAttribute(t),a=r==null||(i=r.scale)===null||i===void 0?void 0:i.scalers;return a&&a[0]?a[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(t,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,u=this.attributes.find(function(ve){return ve.name===t});if(u&&u.descriptor){var s=u.descriptor,l=s.update,h=s.buffer,d=s.size,v=d===void 0?0:d,y=DA[h.type||N.FLOAT];if(l){var x=this.featureLayout,S=x.elements,M=x.sizePerElement,O=S.slice(r,a);if(!O.length)return;var H=O[0].offset,W=H*v*y,he=O.map(function(ve,Re){for(var ze=ve.featureIdx,ft=ve.vertices,gt=ve.normals,Pt=ft.length/M,Mt=[],sr=0;sr<Pt;sr++){var xr=gt?gt.slice(sr*3,sr*3+3):[];Mt.push.apply(Mt,(0,L.Z)(l(i[ze],ze,ft.slice(sr*M,sr*M+M),Re,xr)))}return Mt}).reduce(function(ve,Re){return ve.push.apply(ve,(0,L.Z)(Re)),ve},[]);u.vertexAttribute.updateBuffer({data:he,offset:W}),o==null||o.emit("legend:".concat(t),{type:t,attr:u})}}}},{key:"createAttributesAndIndices",value:function(t,i,r){var a=this;this.featureLayout={sizePerElement:0,elements:[]},i&&(this.triangulation=i);var o=this.attributes.map(function(O){return O.resetDescriptor(),O.descriptor}),u=0,s=0,l=[],h=3;t.forEach(function(O,H){var W=a.triangulation(O,r),he=W.indices,ve=W.vertices,Re=W.normals,ze=W.size,ft=W.indexes,gt=W.count;typeof gt=="number"&&(s+=gt),he.forEach(function(xr){l.push(xr+u)}),h=ze;var Pt=ve.length/ze;a.featureLayout.sizePerElement=h,a.featureLayout.elements.push({featureIdx:H,vertices:ve,normals:Re,offset:u}),u+=Pt;for(var Mt=function(Br){var kn=(Re==null?void 0:Re.slice(Br*3,Br*3+3))||[],Oi=ve.slice(Br*ze,Br*ze+ze),xi=0;ft&&ft[Br]!==void 0&&(xi=ft[Br]),o.forEach(function(vi,na){if(vi&&vi.update){var is;(is=vi.buffer.data).push.apply(is,(0,L.Z)(vi.update(O,H,Oi,Br,kn,xi)))}})},sr=0;sr<Pt;sr++)Mt(sr)});var d=this.rendererService,v=d.createAttribute,y=d.createBuffer,x=d.createElements,S={};o.forEach(function(O,H){if(O){var W=O.buffer,he=O.update,ve=O.name,Re=(0,es.Z)(O,FA),ze=v((0,b.Z)({buffer:y(W)},Re));S[O.name||""]=ze,a.attributes[H].vertexAttribute=ze}});var M=x({data:l,type:N.UNSIGNED_INT,count:l.length});return this.attributesAndIndices={attributes:S,elements:M,count:s},this.attributesAndIndices}},{key:"createAttributes",value:function(t,i){var r=this;this.featureLayout={sizePerElement:0,elements:[]},i&&(this.triangulation=i);var a=this.attributes.map(function(y){return y.resetDescriptor(),y.descriptor}),o=0,u=[],s=3;t.forEach(function(y,x){var S=r.triangulation(y),M=S.indices,O=S.vertices,H=S.normals,W=S.size,he=S.indexes;M.forEach(function(ft){u.push(ft+o)}),s=W;var ve=O.length/W;r.featureLayout.sizePerElement=s,r.featureLayout.elements.push({featureIdx:x,vertices:O,normals:H,offset:o}),o+=ve;for(var Re=function(gt){var Pt=(H==null?void 0:H.slice(gt*3,gt*3+3))||[],Mt=O.slice(gt*W,gt*W+W),sr=0;he&&he[gt]!==void 0&&(sr=he[gt]),a.forEach(function(xr,Br){if(xr&&xr.update){var kn;(kn=xr.buffer.data).push.apply(kn,(0,L.Z)(xr.update(y,x,Mt,gt,Pt,sr)))}})},ze=0;ze<ve;ze++)Re(ze)});var l=this.rendererService,h=l.createAttribute,d=l.createBuffer,v={};return a.forEach(function(y,x){if(y){var S=y.buffer,M=y.update,O=y.name,H=(0,es.Z)(y,NA),W=h((0,b.Z)({buffer:d(S)},H));v[y.name||""]=W,r.attributes[x].vertexAttribute=W}}),{attributes:v}}},{key:"clearAllAttributes",value:function(){var t;this.attributes.forEach(function(i){i.vertexAttribute&&i.vertexAttribute.destroy()}),(t=this.attributesAndIndices)===null||t===void 0||t.elements.destroy(),this.attributes=[]}}]),e}(),j_=An(eg.prototype,"rendererService",[V_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eg))||H_),tg=D(34155);function rg(e,n,t,i){function r(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function u(h){try{l(i.next(h))}catch(d){o(d)}}function s(h){try{l(i.throw(h))}catch(d){o(d)}}function l(h){h.done?a(h.value):r(h.value).then(u,s)}l((i=i.apply(e,n||[])).next())})}function ng(e,n){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(l){return function(h){return s([l,h])}}function s(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=l[0]&2?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=n.call(e,t)}catch(h){l=[6,h],r=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Vv(e,n){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var i=t.call(e),r,a=[],o;try{for(;(n===void 0||n-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(u){o={error:u}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return a}function Hv(e,n,t){if(t||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return e.concat(a||Array.prototype.slice.call(n))}function ig(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ag={exports:{}},jv={exports:{}},fd={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;function t(i){return i&&typeof i.length=="number"&&i.length>=0&&i.length%1==0}e.exports=n.default})(fd,fd.exports);var iu={},og={exports:{}},ug={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return function(){for(var i=[],r=arguments.length;r--;)i[r]=arguments[r];var a=i.pop();return t.call(this,i,a)}},e.exports=n.default})(ug,ug.exports);var af={};Object.defineProperty(af,"__esModule",{value:!0}),af.fallback=W_,af.wrap=$_;var ZA=af.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,UA=af.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,zA=af.hasNextTick=typeof tg=="object"&&typeof tg.nextTick=="function";function W_(e){setTimeout(e,0)}function $_(e){return function(n){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];return e(function(){return n.apply(void 0,t)})}}var hd;ZA?hd=queueMicrotask:UA?hd=setImmediate:zA?hd=tg.nextTick:hd=W_,af.default=$_(hd),function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var t=ug.exports,i=u(t),r=af,a=u(r),o=iu;function u(d){return d&&d.__esModule?d:{default:d}}function s(d){return(0,o.isAsync)(d)?function(){for(var v=[],y=arguments.length;y--;)v[y]=arguments[y];var x=v.pop(),S=d.apply(this,v);return l(S,x)}:(0,i.default)(function(v,y){var x;try{x=d.apply(this,v)}catch(S){return y(S)}if(x&&typeof x.then=="function")return l(x,y);y(null,x)})}function l(d,v){return d.then(function(y){h(v,null,y)},function(y){h(v,y&&y.message?y:new Error(y))})}function h(d,v,y){try{d(v,y)}catch(x){(0,a.default)(function(S){throw S},x)}}e.exports=n.default}(og,og.exports),Object.defineProperty(iu,"__esModule",{value:!0}),iu.isAsyncIterable=iu.isAsyncGenerator=iu.isAsync=void 0;var GA=og.exports,VA=HA(GA);function HA(e){return e&&e.__esModule?e:{default:e}}function X_(e){return e[Symbol.toStringTag]==="AsyncFunction"}function jA(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function WA(e){return typeof e[Symbol.asyncIterator]=="function"}function $A(e){if(typeof e!="function")throw new Error("expected a function");return X_(e)?(0,VA.default)(e):e}iu.default=$A,iu.isAsync=X_,iu.isAsyncGenerator=jA,iu.isAsyncIterable=WA;var qf={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;function t(i,r){if(r===void 0&&(r=i.length),!r)throw new Error("arity is undefined");function a(){for(var o=this,u=[],s=arguments.length;s--;)u[s]=arguments[s];return typeof u[r-1]=="function"?i.apply(this,u):new Promise(function(l,h){u[r-1]=function(d){for(var v=[],y=arguments.length-1;y-- >0;)v[y]=arguments[y+1];if(d)return h(d);l(v.length>1?v:v[0])},i.apply(o,u)})}return a}e.exports=n.default})(qf,qf.exports),function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=fd.exports,i=s(t),r=iu,a=s(r),o=qf.exports,u=s(o);function s(l){return l&&l.__esModule?l:{default:l}}n.default=(0,u.default)(function(l,h,d){var v=(0,i.default)(h)?[]:{};l(h,function(y,x,S){(0,a.default)(y)(function(M){for(var O,H=[],W=arguments.length-1;W-- >0;)H[W]=arguments[W+1];H.length<2&&(O=H,H=O[0]),v[x]=H,S(M)})},function(y){return d(y,v)})},3),e.exports=n.default}(jv,jv.exports);var sg={exports:{}},Wv={exports:{}},lg={exports:{}},pd={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;function t(i){function r(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];if(i!==null){var u=i;i=null,u.apply(this,a)}}return Object.assign(r,i),r}e.exports=n.default})(pd,pd.exports);var cg={exports:{}},fg={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()},e.exports=n.default})(fg,fg.exports),function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=h;var t=fd.exports,i=o(t),r=fg.exports,a=o(r);function o(d){return d&&d.__esModule?d:{default:d}}function u(d){var v=-1,y=d.length;return function(){return++v<y?{value:d[v],key:v}:null}}function s(d){var v=-1;return function(){var x=d.next();return x.done?null:(v++,{value:x.value,key:v})}}function l(d){var v=d?Object.keys(d):[],y=-1,x=v.length;return function S(){var M=v[++y];return M==="__proto__"?S():y<x?{value:d[M],key:M}:null}}function h(d){if((0,i.default)(d))return u(d);var v=(0,a.default)(d);return v?s(v):l(d)}e.exports=n.default}(cg,cg.exports);var dd={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;function t(i){return function(){for(var r=[],a=arguments.length;a--;)r[a]=arguments[a];if(i===null)throw new Error("Callback was already called.");var o=i;i=null,o.apply(this,r)}}e.exports=n.default})(dd,dd.exports);var hg={exports:{}},vd={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t={};n.default=t,e.exports=n.default})(vd,vd.exports),function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var t=vd.exports,i=r(t);function r(o){return o&&o.__esModule?o:{default:o}}function a(o,u,s,l){var h=!1,d=!1,v=!1,y=0,x=0;function S(){y>=u||v||h||(v=!0,o.next().then(function(H){var W=H.value,he=H.done;if(!(d||h)){if(v=!1,he){h=!0,y<=0&&l(null);return}y++,s(W,x,M),x++,S()}}).catch(O))}function M(H,W){if(y-=1,!d){if(H)return O(H);if(H===!1){h=!0,d=!0;return}if(W===i.default||h&&y<=0)return h=!0,l(null);S()}}function O(H){d||(v=!1,h=!0,l(H))}S()}e.exports=n.default}(hg,hg.exports),function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=pd.exports,i=y(t),r=cg.exports,a=y(r),o=dd.exports,u=y(o),s=iu,l=hg.exports,h=y(l),d=vd.exports,v=y(d);function y(x){return x&&x.__esModule?x:{default:x}}n.default=function(x){return function(S,M,O){if(O=(0,i.default)(O),x<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!S)return O(null);if((0,s.isAsyncGenerator)(S))return(0,h.default)(S,x,M,O);if((0,s.isAsyncIterable)(S))return(0,h.default)(S[Symbol.asyncIterator](),x,M,O);var H=(0,a.default)(S),W=!1,he=!1,ve=0,Re=!1;function ze(gt,Pt){if(!he)if(ve-=1,gt)W=!0,O(gt);else if(gt===!1)W=!0,he=!0;else{if(Pt===v.default||W&&ve<=0)return W=!0,O(null);Re||ft()}}function ft(){for(Re=!0;ve<x&&!W;){var gt=H();if(gt===null){W=!0,ve<=0&&O(null);return}ve+=1,M(gt.value,gt.key,(0,u.default)(ze))}Re=!1}ft()}},e.exports=n.default}(lg,lg.exports),function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=lg.exports,i=s(t),r=iu,a=s(r),o=qf.exports,u=s(o);function s(h){return h&&h.__esModule?h:{default:h}}function l(h,d,v,y){return(0,i.default)(d)(h,(0,a.default)(v),y)}n.default=(0,u.default)(l,4),e.exports=n.default}(Wv,Wv.exports),function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Wv.exports,i=o(t),r=qf.exports,a=o(r);function o(s){return s&&s.__esModule?s:{default:s}}function u(s,l,h){return(0,i.default)(s,1,l,h)}n.default=(0,a.default)(u,3),e.exports=n.default}(sg,sg.exports),function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=u;var t=jv.exports,i=o(t),r=sg.exports,a=o(r);function o(s){return s&&s.__esModule?s:{default:s}}function u(s,l){return(0,i.default)(a.default,s,l)}e.exports=n.default}(ag,ag.exports);var $v=ig(ag.exports),Al=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var n=arguments,t=[],i=0;i<arguments.length;i++)t[i]=n[i];return this.args=t,$v(this.tasks)},e.prototype.tap=function(n,t){var i=this;this.tasks.push(function(r){t.apply(void 0,Hv([],Vv(i.args),!1)),r(null,n)})},e}(),pg={exports:{}},dg={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=fd.exports,i=M(t),r=vd.exports,a=M(r),o=Wv.exports,u=M(o),s=pd.exports,l=M(s),h=dd.exports,d=M(h),v=iu,y=M(v),x=qf.exports,S=M(x);function M(he){return he&&he.__esModule?he:{default:he}}function O(he,ve,Re){Re=(0,l.default)(Re);var ze=0,ft=0,gt=he.length,Pt=!1;gt===0&&Re(null);function Mt(sr,xr){sr===!1&&(Pt=!0),Pt!==!0&&(sr?Re(sr):(++ft===gt||xr===a.default)&&Re(null))}for(;ze<gt;ze++)ve(he[ze],ze,(0,d.default)(Mt))}function H(he,ve,Re){return(0,u.default)(he,Infinity,ve,Re)}function W(he,ve,Re){var ze=(0,i.default)(he)?O:H;return ze(he,(0,y.default)(ve),Re)}n.default=(0,S.default)(W,3),e.exports=n.default})(dg,dg.exports),function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=u;var t=dg.exports,i=o(t),r=jv.exports,a=o(r);function o(s){return s&&s.__esModule?s:{default:s}}function u(s,l){return(0,a.default)(i.default,s,l)}e.exports=n.default}(pg,pg.exports);var XA=ig(pg.exports),aF=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return XA(this.tasks)},e.prototype.tapPromise=function(n,t){var i=this;this.tasks.push(function(r){return rg(i,void 0,void 0,function(){return ng(this,function(a){switch(a.label){case 0:return[4,t()];case 1:return a.sent(),r(null,n),[2]}})})})},e}(),vg={exports:{}};(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=pd.exports,i=h(t),r=dd.exports,a=h(r),o=iu,u=h(o),s=qf.exports,l=h(s);function h(v){return v&&v.__esModule?v:{default:v}}function d(v,y){if(y=(0,i.default)(y),!Array.isArray(v))return y(new Error("First argument to waterfall must be an array of functions"));if(!v.length)return y();var x=0;function S(O){var H=(0,u.default)(v[x++]);H.apply(void 0,O.concat([(0,a.default)(M)]))}function M(O){for(var H=[],W=arguments.length-1;W-- >0;)H[W]=arguments[W+1];if(O!==!1){if(O||x===v.length)return y.apply(void 0,[O].concat(H));S(H)}}S([])}n.default=(0,l.default)(d),e.exports=n.default})(vg,vg.exports);var Y_=ig(vg.exports),oF=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return Y_(this.tasks)},e.prototype.tap=function(n,t){this.tasks.length===0?this.tasks.push(function(i){var r=t();i(r?null:!1,r)}):this.tasks.push(function(i,r){var a=t.apply(void 0,Hv([],Vv(i),!1));r(a?null:!1,n)})},e}(),K_=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return $v(this.tasks)},e.prototype.tap=function(n,t){this.tasks.push(function(i){var r=t();i(r,n)})},e}(),YA=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var n=arguments,t=[],i=0;i<arguments.length;i++)t[i]=n[i];return this.args=t,$v(this.tasks)},e.prototype.tapPromise=function(n,t){var i=this;this.tasks.push(function(r){return rg(i,void 0,void 0,function(){return ng(this,function(a){switch(a.label){case 0:return[4,t.apply(void 0,Hv([],Vv(this.args),!1))];case 1:return a.sent(),r(null,n),[2]}})})})},e}(),KA=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var n=arguments,t=[],i=0;i<arguments.length;i++)t[i]=n[i];return this.args=t,$v(this.tasks)},e.prototype.tapPromise=function(n,t){var i=this;this.tasks.push(function(r){return rg(i,void 0,void 0,function(){var a;return ng(this,function(o){switch(o.label){case 0:return[4,t.apply(void 0,Hv([],Vv(this.args),!1))];case 1:return a=o.sent(),r(a,n),[2]}})})})},e}(),qA=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return Y_(this.tasks)},e.prototype.tapPromise=function(n,t){this.tasks.length===0?this.tasks.push(function(i){t().then(function(r){i(null,r)})}):this.tasks.push(function(i,r){t(i).then(function(a){r(null,a)})})},e}(),q_=D(67709),QA=D.n(q_),Q_,J_,e1,t1,r1,n1,i1,a1,o1,u1,s1,l1,c1,f1,h1,p1,d1,v1,Ga,m1,g1,y1,_1,x1,S1,b1,E1,A1,T1,C1,w1,M1,R1,L1,P1;function JA(e){var n=eT();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function eT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tT=(Q_=(0,pr.b2)(),J_=(0,pr.f3)(qe.SceneID),e1=(0,pr.f3)(qe.IIconService),t1=(0,pr.f3)(qe.IFontService),r1=(0,pr.f3)(qe.IControlService),n1=(0,pr.f3)(qe.IGlobalConfigService),i1=(0,pr.f3)(qe.IMapService),a1=(0,pr.f3)(qe.ICoordinateSystemService),o1=(0,pr.f3)(qe.IRendererService),u1=(0,pr.f3)(qe.ILayerService),s1=(0,pr.f3)(qe.IDebugService),l1=(0,pr.f3)(qe.ICameraService),c1=(0,pr.f3)(qe.IInteractionService),f1=(0,pr.f3)(qe.IPickingService),h1=(0,pr.f3)(qe.IShaderModuleService),p1=(0,pr.f3)(qe.IMarkerService),d1=(0,pr.f3)(qe.IPopupService),Q_(v1=(Ga=function(e){(0,Ot.Z)(t,e);var n=JA(t);function t(){var i;return(0,ot.Z)(this,t),i=n.call(this),(0,R.Z)((0,pe.Z)(i),"destroyed",!1),(0,R.Z)((0,pe.Z)(i),"loaded",!1),En((0,pe.Z)(i),"id",m1,(0,pe.Z)(i)),En((0,pe.Z)(i),"iconService",g1,(0,pe.Z)(i)),En((0,pe.Z)(i),"fontService",y1,(0,pe.Z)(i)),En((0,pe.Z)(i),"controlService",_1,(0,pe.Z)(i)),En((0,pe.Z)(i),"configService",x1,(0,pe.Z)(i)),En((0,pe.Z)(i),"map",S1,(0,pe.Z)(i)),En((0,pe.Z)(i),"coordinateSystemService",b1,(0,pe.Z)(i)),En((0,pe.Z)(i),"rendererService",E1,(0,pe.Z)(i)),En((0,pe.Z)(i),"layerService",A1,(0,pe.Z)(i)),En((0,pe.Z)(i),"debugService",T1,(0,pe.Z)(i)),En((0,pe.Z)(i),"cameraService",C1,(0,pe.Z)(i)),En((0,pe.Z)(i),"interactionService",w1,(0,pe.Z)(i)),En((0,pe.Z)(i),"pickingService",M1,(0,pe.Z)(i)),En((0,pe.Z)(i),"shaderModuleService",R1,(0,pe.Z)(i)),En((0,pe.Z)(i),"markerService",L1,(0,pe.Z)(i)),En((0,pe.Z)(i),"popupService",P1,(0,pe.Z)(i)),(0,R.Z)((0,pe.Z)(i),"inited",!1),(0,R.Z)((0,pe.Z)(i),"initPromise",void 0),(0,R.Z)((0,pe.Z)(i),"rendering",!1),(0,R.Z)((0,pe.Z)(i),"$container",void 0),(0,R.Z)((0,pe.Z)(i),"canvas",void 0),(0,R.Z)((0,pe.Z)(i),"markerContainer",void 0),(0,R.Z)((0,pe.Z)(i),"hooks",void 0),(0,R.Z)((0,pe.Z)(i),"handleWindowResized",function(){i.emit("resize"),i.$container&&(i.initContainer(),ma(),i.coordinateSystemService.needRefresh=!0,i.render())}),(0,R.Z)((0,pe.Z)(i),"handleMapCameraChanged",function(r){i.cameraService.update(r),i.render()}),i.hooks={init:new YA},i}return(0,at.Z)(t,[{key:"init",value:function(r){var a=this;this.configService.setSceneConfig(this.id,r),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,st.Z)(q().mark(function o(){return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a.debugService.log("map.mapInitStart",{type:a.map.version}),s.next=3,new Promise(function(l){a.map.onCameraChanged(function(h){a.cameraService.init(),a.cameraService.update(h),l()}),a.map.init()});case 3:a.map.onCameraChanged(a.handleMapCameraChanged),a.map.addMarkerContainer(),a.markerService.addMarkers(),a.markerService.addMarkerLayers(),a.popupService.initPopup(),a.interactionService.init(),a.interactionService.on(co.Drag,a.addSceneEvent.bind(a));case 10:case"end":return s.stop()}},o)}))),this.hooks.init.tapPromise("initRenderer",(0,st.Z)(q().mark(function o(){var u,s;return q().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(u=a.map.getOverlayContainer(),u?a.$container=u:a.$container=CA(a.configService.getSceneConfig(a.id).id||""),!a.$container){h.next=13;break}return a.canvas=bn("canvas","",a.$container),a.setCanvas(),h.next=7,a.rendererService.init(a.canvas,a.configService.getSceneConfig(a.id),r.gl);case 7:a.registerContextLost(),a.initContainer(),QA()(a.$container,a.handleWindowResized),In.matchMedia&&((s=In.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||s===void 0||s.addListener(a.handleWindowResized)),h.next=14;break;case 13:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 14:a.pickingService.init(a.id);case 15:case"end":return h.stop()}},o)}))),this.render()}},{key:"registerContextLost",value:function(){var r=this,a=this.rendererService.getCanvas();a&&a.addEventListener("webglcontextlost",function(){return r.emit("webglcontextlost")})}},{key:"initMiniScene",value:function(r){var a=this;this.configService.setSceneConfig(this.id,r),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,st.Z)(q().mark(function o(){return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,new Promise(function(l){a.map.onCameraChanged(function(h){a.cameraService.init(),a.cameraService.update(h),a.map.version!=="GAODE2.x"&&l()}),a.map.initMiniMap()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.interactionService.init(),a.interactionService.on(co.Drag,a.addSceneEvent.bind(a));case 5:case"end":return s.stop()}},o)}))),this.hooks.init.tapPromise("initRenderer",(0,st.Z)(q().mark(function o(){var u;return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(u=r.canvas,a.$container=u||null,!a.$container){l.next=7;break}return l.next=5,a.rendererService.init(r.canvas,a.configService.getSceneConfig(a.id),void 0);case 5:l.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:a.pickingService.init(a.id);case 9:case"end":return l.stop()}},o)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(r){this.layerService.sceneService=this,this.layerService.add(r)}},{key:"addMask",value:function(r){this.layerService.sceneService=this,this.layerService.addMask(r)}},{key:"render",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(this.rendering||this.destroyed)){u.next=2;break}return u.abrupt("return");case 2:if(this.rendering=!0,this.inited){u.next=16;break}return u.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),u.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,u.next=20;break;case 16:return u.next=18,this.layerService.initLayers();case 18:return u.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"addFontFace",value:function(r,a){this.fontService.addFontFace(r,a)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(){var i=(0,st.Z)(q().mark(function a(o){var u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return s=(u=this.$container)===null||u===void 0?void 0:u.getElementsByTagName("canvas")[0],d.next=3,this.render();case 3:return l=o==="jpg"?s==null?void 0:s.toDataURL("image/jpeg"):s==null?void 0:s.toDataURL("image/png"),d.abrupt("return",l);case 5:case"end":return d.stop()}},a,this)}));function r(a){return i.apply(this,arguments)}return r}()},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var r=this.$container.parentElement;r!==null&&(this.markerContainer=bn("div","l7-marker-container",r))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var r=this,a,o;if(!this.inited){this.destroyed=!0;return}if((0,q_.unbind)(this.$container,this.handleWindowResized),In.matchMedia){var u;(u=In.matchMedia("screen and (min-resolution: 2dppx)"))===null||u===void 0||u.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var s;(s=r.$container)===null||s===void 0||s.removeChild(r.canvas),r.canvas=null,r.rendererService.destroy()}),(a=this.$container)===null||a===void 0||(o=a.parentNode)===null||o===void 0||o.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var r,a,o=bi,u=((r=this.$container)===null||r===void 0?void 0:r.clientWidth)||400,s=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,l=this.canvas;l&&(l.width=u*o,l.height=s*o),this.rendererService.viewport({x:0,y:0,width:o*u,height:o*s})}},{key:"setCanvas",value:function(){var r,a,o=bi,u=((r=this.$container)===null||r===void 0?void 0:r.clientWidth)||400,s=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,l=this.canvas;l.width=u*o,l.height=s*o,l.style.width="100%",l.style.height="100%"}},{key:"addSceneEvent",value:function(r){this.emit(r.type,r)}}]),t}(Wi.EventEmitter),m1=An(Ga.prototype,"id",[J_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g1=An(Ga.prototype,"iconService",[e1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y1=An(Ga.prototype,"fontService",[t1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_1=An(Ga.prototype,"controlService",[r1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x1=An(Ga.prototype,"configService",[n1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S1=An(Ga.prototype,"map",[i1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b1=An(Ga.prototype,"coordinateSystemService",[a1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E1=An(Ga.prototype,"rendererService",[o1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A1=An(Ga.prototype,"layerService",[u1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T1=An(Ga.prototype,"debugService",[s1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C1=An(Ga.prototype,"cameraService",[l1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w1=An(Ga.prototype,"interactionService",[c1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M1=An(Ga.prototype,"pickingService",[f1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R1=An(Ga.prototype,"shaderModuleService",[h1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L1=An(Ga.prototype,"markerService",[p1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P1=An(Ga.prototype,"popupService",[d1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ga))||v1);function rT(e){var n=0;switch(e){case"vec2":case"ivec2":n=2;break;case"vec3":case"ivec3":n=3;break;case"vec4":case"ivec4":case"mat2":n=4;break;case"mat3":n=9;break;case"mat4":n=16;break;default:}return n}var nT=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function mg(e){var n={};return e=e.replace(nT,function(t,i,r){var a=r.split(":"),o=a[0].trim(),u="";switch(a.length>1&&(u=a[1].trim()),i){case"bool":u=u==="true";break;case"float":case"int":u=Number(u);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":u?u=u.replace("[","").replace("]","").split(",").reduce(function(s,l){return s.push(Number(l.trim())),s},[]):u=new Array(rT(i)).fill(0);break;default:}return n[o]=u,"uniform ".concat(i," ").concat(o,`;
`)}),{content:e,uniforms:n}}var I1,O1,k1="#define PI 3.14159265359",iT=`#ifdef USE_ATTRIBUTE_OPACITY
  attribute float a_Opacity;
#endif

#ifdef USE_ATTRIBUTE_OFFSETS
  attribute vec2 a_Offsets;
#endif

#ifdef USE_ATTRIBUTE_STROKE
  attribute vec4 a_Stroke;
#endif`,aT=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,oT=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,uT=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,sT=`float opacity = u_opacity;

#ifdef USE_ATTRIBUTE_OPACITY
    opacity = a_Opacity;
#endif`,lT=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,cT=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,fT=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,hT=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel * u_FocalDistance ;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * 2.0 *  u_FocalDistance;;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,pT=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,dT=/precision\s+(high|low|medium)p\s+float/,vT=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,mT=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,gT=/void\s+main\s*\([^)]*\)\s*\{\n?/,uF=/}\n?[^{}]*$/,yT=(I1=(0,pr.b2)(),I1(O1=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"moduleCache",{}),(0,R.Z)(this,"rawContentCache",{})}return(0,at.Z)(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:k1,fs:k1}),this.registerModule("decode",{vs:aT,fs:""}),this.registerModule("projection",{vs:hT,fs:""}),this.registerModule("project",{vs:fT,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:pT}),this.registerModule("lighting",{vs:uT,fs:""}),this.registerModule("light",{vs:oT,fs:""}),this.registerModule("picking",{vs:cT,fs:lT}),this.registerModule("commom_attr_vert",{vs:iT,fs:""}),this.registerModule("opacity_attr_vert",{vs:sT,fs:""})}},{key:"registerModule",value:function(t,i){var r=i.vs,a=i.fs,o=i.uniforms,u=i.inject,s=mg(r),l=s.content,h=s.uniforms,d=mg(a),v=d.content,y=d.uniforms;this.rawContentCache[t]={fs:v,inject:u,uniforms:(0,b.Z)((0,b.Z)((0,b.Z)({},h),y),o),vs:l}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var i=this,r=this.rawContentCache[t].vs,a=this.rawContentCache[t].fs,o=this.rawContentCache[t].inject,u={};o!=null&&o["vs:#decl"]&&(r=(o==null?void 0:o["vs:#decl"])+r,u=mg(o==null?void 0:o["vs:#decl"]).uniforms),o!=null&&o["vs:#main-start"]&&(r=r.replace(gT,function(M){return M+(o==null?void 0:o["vs:#main-start"])}));var s=this.processModule(r,[],"vs"),l=s.content,h=s.includeList,d=this.processModule(a,[],"fs"),v=d.content,y=d.includeList,x="",S=(0,Rr.uniq)(h.concat(y).concat(t)).reduce(function(M,O){return(0,b.Z)((0,b.Z)({},M),i.rawContentCache[O].uniforms)},(0,b.Z)({},u));return dT.test(v)||(x=x+vT),x=x+v,this.moduleCache[t]={fs:x.trim(),uniforms:S,vs:l.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,i,r){var a=this,o=t.replace(mT,function(u,s){var l=s.split(" "),h=l[0].replace(/"/g,"");if(i.indexOf(h)>-1)return"";var d=a.rawContentCache[h][r];i.push(h);var v=a.processModule(d,i,r),y=v.content;return y});return{content:o,includeList:i}}},{key:"injectDefines",value:function(t){var i=Object.keys(t).reduce(function(r,a){return r+"#define ".concat(a.toUpperCase()," ").concat(t[a],`;
`)},`
`);return i}}]),e}())||O1);function _T(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=(0,be.Z)(e),e!==null););return e}function Hn(){return typeof Reflect!="undefined"&&Reflect.get?Hn=Reflect.get.bind():Hn=function(n,t,i){var r=_T(n,t);if(!!r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?n:i):a.value}},Hn.apply(this,arguments)}var of;(function(e){e.Normal="normal",e.PostProcessing="post-processing"})(of||(of={}));var F1,N1,Xv=(F1=(0,pr.b2)(),F1(N1=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"shaderModuleService",void 0),(0,R.Z)(this,"rendererService",void 0),(0,R.Z)(this,"cameraService",void 0),(0,R.Z)(this,"mapService",void 0),(0,R.Z)(this,"interactionService",void 0),(0,R.Z)(this,"layerService",void 0),(0,R.Z)(this,"config",void 0)}return(0,at.Z)(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return of.Normal}},{key:"init",value:function(t,i){this.config=i,this.rendererService=t.getContainer().get(qe.IRendererService),this.cameraService=t.getContainer().get(qe.ICameraService),this.mapService=t.getContainer().get(qe.IMapService),this.interactionService=t.getContainer().get(qe.IInteractionService),this.layerService=t.getContainer().get(qe.ILayerService),this.shaderModuleService=t.getContainer().get(qe.IShaderModuleService)}},{key:"render",value:function(t){}}]),e}())||N1),D1,B1;function xT(e){var n=ST();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function ST(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var bT=(D1=(0,pr.b2)(),D1(B1=function(e){(0,Ot.Z)(t,e);var n=xT(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(r,a){Hn((0,be.Z)(t.prototype),"init",this).call(this,r,a)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),t}(Xv))||B1),Z1,U1,z1,gg,G1;function ET(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=AT(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function AT(e,n){if(!!e){if(typeof e=="string")return V1(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return V1(e,n)}}function V1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var TT=(Z1=(0,pr.b2)(),U1=(0,pr.f3)(qe.IPostProcessor),Z1(z1=(gg=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"passes",[]),En(this,"postProcessor",G1,this),(0,R.Z)(this,"layer",void 0),(0,R.Z)(this,"renderFlag",void 0),(0,R.Z)(this,"width",0),(0,R.Z)(this,"height",0)}return(0,at.Z)(e,[{key:"setLayer",value:function(t){this.layer=t}},{key:"setRenderFlag",value:function(t){this.renderFlag=t}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var n=(0,st.Z)(q().mark(function i(){var r,a,o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=ET(this.passes),s.prev=1,r.s();case 3:if((a=r.n()).done){s.next=9;break}return o=a.value,s.next=7,o.render(this.layer);case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),r.e(s.t0);case 14:return s.prev=14,r.f(),s.finish(14);case 17:return s.next=19,this.postProcessor.render(this.layer);case 19:case"end":return s.stop()}},i,this,[[1,11,14,17]])}));function t(){return n.apply(this,arguments)}return t}()},{key:"resize",value:function(t,i){(this.width!==t||this.height!==i)&&(this.postProcessor.resize(t,i),this.width=t,this.height=i)}},{key:"add",value:function(t,i){t.getType()===of.PostProcessing?this.postProcessor.add(t,this.layer,i):(t.init(this.layer,i),this.passes.push(t))}},{key:"insert",value:function(t,i,r){t.init(this.layer,i),this.passes.splice(r,0,t)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),G1=An(gg.prototype,"postProcessor",[U1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gg))||z1),H1,j1;function CT(e){var n=wT();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function wT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var MT=(H1=(0,pr.b2)(),H1(j1=function(e){(0,Ot.Z)(t,e);var n=CT(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"pickingFBO",void 0),(0,R.Z)((0,pe.Z)(i),"layer",void 0),(0,R.Z)((0,pe.Z)(i),"width",0),(0,R.Z)((0,pe.Z)(i),"height",0),(0,R.Z)((0,pe.Z)(i),"alreadyInRendering",!1),(0,R.Z)((0,pe.Z)(i),"pickFromPickingFBO",function(u){var s=u.x,l=u.y,h=u.lngLat,d=u.type;if(!(!i.layer.isVisible()||!i.layer.needPick(d))){var v=i.rendererService,y=v.getViewportSize,x=v.readPixels,S=v.useFramebuffer,M=y(),O=M.width,H=M.height,W=i.layer.getLayerConfig(),he=W.enableHighlight,ve=W.enableSelect,Re=s*bi,ze=l*bi;if(!(Re>O||Re<0||ze>H||ze<0)){var ft;S(i.pickingFBO,function(){var gt;if(ft=x({x:Math.round(Re),y:Math.round(H-(l+1)*bi),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:i.pickingFBO}),ft[0]!==0||ft[1]!==0||ft[2]!==0){var Pt=Bo(ft),Mt=i.layer.getSource().getFeatureById(Pt),sr={x:s,y:l,type:d,lngLat:h,featureId:Pt,feature:Mt};Mt&&(i.layer.setCurrentPickId(Pt),i.triggerHoverOnLayer(sr))}else{var xr={x:s,y:l,lngLat:h,type:i.layer.getCurrentPickId()===null?"un"+d:"mouseout",featureId:null,feature:null};i.triggerHoverOnLayer((0,b.Z)((0,b.Z)({},xr),{},{type:"unpick"})),i.triggerHoverOnLayer(xr),i.layer.setCurrentPickId(null)}he&&i.highlightPickedFeature(ft),ve&&d==="click"&&((gt=ft)===null||gt===void 0?void 0:gt.toString())!==[0,0,0,0].toString()&&i.selectFeature(ft)})}}}),i}return(0,at.Z)(t,[{key:"getType",value:function(){return of.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(r,a){Hn((0,be.Z)(t.prototype),"init",this).call(this,r,a),this.layer=r;var o=this.rendererService,u=o.createTexture2D,s=o.createFramebuffer,l=o.getViewportSize,h=l(),d=h.width,v=h.height;this.pickingFBO=s({color:u({width:d,height:v,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE})}),this.interactionService.on(co.Hover,this.pickFromPickingFBO),this.interactionService.on(co.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(co.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(r){var a=this;if(!this.alreadyInRendering){var o=this.rendererService,u=o.getViewportSize,s=o.useFramebuffer,l=o.clear,h=u(),d=h.width,v=h.height;this.alreadyInRendering=!0,(this.width!==d||this.height!==v)&&(this.pickingFBO.resize({width:d,height:v}),this.width=d,this.height=v),s(this.pickingFBO,function(){l({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var y=a.layer.multiPassRenderer.getRenderFlag();a.layer.multiPassRenderer.setRenderFlag(!1),r.hooks.beforePickingEncode.call(),r.render(),r.hooks.afterPickingEncode.call(),a.layer.multiPassRenderer.setRenderFlag(y),a.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(r){this.layer.emit(r.type,r)}},{key:"highlightPickedFeature",value:function(r){var a=(0,Dr.Z)(r,3),o=a[0],u=a[1],s=a[2];this.layer.hooks.beforeHighlight.call([o,u,s]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(r){var a=(0,Dr.Z)(r,3),o=a[0],u=a[1],s=a[2];this.layer.hooks.beforeSelect.call([o,u,s]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(r){var a=r.featureId,o=Eo(a);this.selectFeature(new Uint8Array(o))}},{key:"highlightFeatureHandle",value:function(r){var a=r.featureId,o=Eo(a);this.highlightPickedFeature(new Uint8Array(o))}}]),t}(Xv))||j1),W1,$1,X1,yg,Y1,RT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,fc=(W1=(0,pr.b2)(),$1=(0,pr.f3)(qe.IShaderModuleService),W1(X1=(yg=function(){function e(){(0,ot.Z)(this,e),En(this,"shaderModuleService",Y1,this),(0,R.Z)(this,"rendererService",void 0),(0,R.Z)(this,"config",void 0),(0,R.Z)(this,"quad",RT),(0,R.Z)(this,"enabled",!0),(0,R.Z)(this,"renderToScreen",!1),(0,R.Z)(this,"model",void 0),(0,R.Z)(this,"name",void 0),(0,R.Z)(this,"optionsToUpdate",{})}return(0,at.Z)(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"getType",value:function(){return of.PostProcessing}},{key:"init",value:function(t,i){this.config=i,this.rendererService=t.getContainer().get(qe.IRendererService),this.shaderModuleService=t.getContainer().get(qe.IShaderModuleService);var r=this.rendererService,a=r.createAttribute,o=r.createBuffer,u=r.createModel,s=this.setupShaders(),l=s.vs,h=s.fs,d=s.uniforms;this.model=u({vs:l,fs:h,attributes:{a_Position:a({buffer:o({data:[-4,-4,4,-4,0,4],type:N.FLOAT}),size:2})},uniforms:(0,b.Z)((0,b.Z)({u_Texture:null},d),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(t,i){var r=this,a=t.multiPassRenderer.getPostProcessor(),o=this.rendererService,u=o.useFramebuffer,s=o.getViewportSize,l=o.clear,h=s(),d=h.width,v=h.height;u(this.renderToScreen?null:a.getWriteFBO(),function(){l({framebuffer:a.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var y=(0,b.Z)({u_BloomFinal:0,u_Texture:a.getReadFBO(),u_ViewportSize:[d,v]},r.convertOptionsToUniforms(r.optionsToUpdate));i&&(y.u_BloomFinal=1,y.u_Texture2=i),r.model.draw({uniforms:y})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"setRenderToScreen",value:function(t){this.renderToScreen=t}},{key:"updateOptions",value:function(t){this.optionsToUpdate=(0,b.Z)((0,b.Z)({},this.optionsToUpdate),t)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(t){var i={};return Object.keys(t).forEach(function(r){(0,Rr.isNil)(t[r])||(i["u_".concat((0,Rr.upperFirst)((0,Rr.camelCase)(r)))]=t[r])}),i}}]),e}(),Y1=An(yg.prototype,"shaderModuleService",[$1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yg))||X1),K1,q1;function LT(e){var n=PT();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function PT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var IT=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,OT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,kT=(K1=(0,pr.b2)(),K1(q1=function(e){(0,Ot.Z)(t,e);var n=LT(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:OT,fs:IT});var r=this.shaderModuleService.getModule("blur-pass"),a=r.vs,o=r.fs,u=r.uniforms,s=this.rendererService.getViewportSize(),l=s.width,h=s.height;return{vs:a,fs:o,uniforms:(0,b.Z)((0,b.Z)({},u),{},{u_ViewportSize:[l,h]})}}},{key:"convertOptionsToUniforms",value:function(r){var a={};return(0,Rr.isNil)(r.bloomRadius)||(a.u_radius=r.bloomRadius),(0,Rr.isNil)(r.bloomIntensity)||(a.u_intensity=r.bloomIntensity),(0,Rr.isNil)(r.bloomBaseRadio)||(a.u_baseRadio=r.bloomBaseRadio),a}}]),t}(fc))||q1),Q1,J1;function FT(e){var n=NT();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function NT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DT=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,BT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ZT=(Q1=(0,pr.b2)(),Q1(J1=function(e){(0,Ot.Z)(t,e);var n=FT(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:BT,fs:DT});var r=this.shaderModuleService.getModule("blur-pass"),a=r.vs,o=r.fs,u=r.uniforms,s=this.rendererService.getViewportSize(),l=s.width,h=s.height;return{vs:a,fs:o,uniforms:(0,b.Z)((0,b.Z)({},u),{},{u_ViewportSize:[l,h]})}}},{key:"convertOptionsToUniforms",value:function(r){var a={};return(0,Rr.isNil)(r.blurRadius)||(a.u_BlurDir=[r.blurRadius,0]),a}}]),t}(fc))||J1),ex,tx;function UT(e){var n=zT();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function zT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var GT=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,VT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,HT=(ex=(0,pr.b2)(),ex(tx=function(e){(0,Ot.Z)(t,e);var n=UT(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:VT,fs:GT});var r=this.shaderModuleService.getModule("blur-pass"),a=r.vs,o=r.fs,u=r.uniforms,s=this.rendererService.getViewportSize(),l=s.width,h=s.height;return{vs:a,fs:o,uniforms:(0,b.Z)((0,b.Z)({},u),{},{u_ViewportSize:[l,h]})}}},{key:"convertOptionsToUniforms",value:function(r){var a={};return(0,Rr.isNil)(r.blurRadius)||(a.u_BlurDir=[0,r.blurRadius]),a}}]),t}(fc))||tx),rx,nx;function jT(e){var n=WT();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function WT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $T=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,XT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,YT=(rx=(0,pr.b2)(),rx(nx=function(e){(0,Ot.Z)(t,e);var n=jT(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:XT,fs:$T});var r=this.shaderModuleService.getModule("colorhalftone-pass"),a=r.vs,o=r.fs,u=r.uniforms,s=this.rendererService.getViewportSize(),l=s.width,h=s.height;return{vs:a,fs:o,uniforms:(0,b.Z)((0,b.Z)({},u),{},{u_ViewportSize:[l,h]})}}}]),t}(fc))||nx),ix,ax;function KT(e){var n=qT();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function qT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var QT=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,JT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,eC=(ix=(0,pr.b2)(),ix(ax=function(e){(0,Ot.Z)(t,e);var n=KT(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:JT,fs:QT}),this.shaderModuleService.getModule("copy-pass")}}]),t}(fc))||ax),ox,ux;function tC(e){var n=rC();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function rC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nC=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,iC=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,aC=(ox=(0,pr.b2)(),ox(ux=function(e){(0,Ot.Z)(t,e);var n=tC(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:iC,fs:nC});var r=this.shaderModuleService.getModule("hexagonalpixelate-pass"),a=r.vs,o=r.fs,u=r.uniforms,s=this.rendererService.getViewportSize(),l=s.width,h=s.height;return{vs:a,fs:o,uniforms:(0,b.Z)((0,b.Z)({},u),{},{u_ViewportSize:[l,h]})}}}]),t}(fc))||ux),sx,lx;function oC(e){var n=uC();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function uC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var sC=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,lC=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,cC=(sx=(0,pr.b2)(),sx(lx=function(e){(0,Ot.Z)(t,e);var n=oC(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:lC,fs:sC});var r=this.shaderModuleService.getModule("ink-pass"),a=r.vs,o=r.fs,u=r.uniforms,s=this.rendererService.getViewportSize(),l=s.width,h=s.height;return{vs:a,fs:o,uniforms:(0,b.Z)((0,b.Z)({},u),{},{u_ViewportSize:[l,h]})}}}]),t}(fc))||lx),cx,fx;function fC(e){var n=hC();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function hC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pC=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,dC=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,vC=(cx=(0,pr.b2)(),cx(fx=function(e){(0,Ot.Z)(t,e);var n=fC(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:dC,fs:pC}),this.shaderModuleService.getModule("noise-pass")}}]),t}(fc))||fx),hx,px;function mC(e){var n=gC();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function gC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yC=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,_C=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,xC=(hx=(0,pr.b2)(),hx(px=function(e){(0,Ot.Z)(t,e);var n=mC(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:yC,fs:_C}),this.shaderModuleService.getModule("sepia-pass")}}]),t}(fc))||px),dx,vx,mx,gx,Xh,yx,SC=(dx=(0,pr.b2)(),vx=(0,pr.f3)(qe.IRendererService),mx=(0,pr.zY)(),dx(gx=(Xh=function(){function e(){(0,ot.Z)(this,e),En(this,"rendererService",yx,this),(0,R.Z)(this,"passes",[]),(0,R.Z)(this,"readFBO",void 0),(0,R.Z)(this,"writeFBO",void 0)}return(0,at.Z)(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var t=this.rendererService,i=t.getViewportSize,r=t.createTexture2D,a=i(),o=a.width,u=a.height;return r({x:0,y:0,width:o,height:u,copy:!0})}},{key:"getReadFBOTex",value:function(){var t=this,i=this.rendererService.useFramebuffer;return new Promise(function(r){i(t.readFBO,(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r(t.getCurrentFBOTex());case 1:case"end":return u.stop()}},a)})))})}},{key:"renderBloomPass",value:function(){var n=(0,st.Z)(q().mark(function i(r,a){var o,u;return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.getReadFBOTex();case 2:o=l.sent,u=0;case 4:if(!(u<4)){l.next=11;break}return l.next=7,a.render(r,o);case 7:this.swap(),u++,l.next=4;break;case 11:case"end":return l.stop()}},i,this)}));function t(i,r){return n.apply(this,arguments)}return t}()},{key:"render",value:function(){var n=(0,st.Z)(q().mark(function i(r){var a,o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:a=0;case 1:if(!(a<this.passes.length)){s.next=15;break}if(o=this.passes[a],o.setRenderToScreen(this.isLastEnabledPass(a)),o.getName()!=="bloom"){s.next=9;break}return s.next=7,this.renderBloomPass(r,o);case 7:s.next=12;break;case 9:return s.next=11,o.render(r);case 11:a!==this.passes.length-1&&this.swap();case 12:a++,s.next=1;break;case 15:case"end":return s.stop()}},i,this)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"resize",value:function(t,i){this.readFBO.resize({width:t,height:i}),this.writeFBO.resize({width:t,height:i})}},{key:"add",value:function(t,i,r){t.init(i,r),this.passes.push(t)}},{key:"insert",value:function(t,i,r,a){t.init(r,a),this.passes.splice(i,0,t)}},{key:"getPostProcessingPassByName",value:function(t){return this.passes.find(function(i){return i.getName()===t})}},{key:"init",value:function(){var t=this.rendererService,i=t.createFramebuffer,r=t.createTexture2D;this.readFBO=i({color:r({width:1,height:1,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE})}),this.writeFBO=i({color:r({width:1,height:1,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(t){for(var i=t+1;i<this.passes.length;i++)if(this.passes[i].isEnabled())return!1;return!0}},{key:"swap",value:function(){var t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}]),e}(),yx=An(Xh.prototype,"rendererService",[vx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An(Xh.prototype,"init",[mx],Object.getOwnPropertyDescriptor(Xh.prototype,"init"),Xh.prototype),Xh))||gx),_x,xx;function bC(e){var n=EC();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function EC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var AC=(_x=(0,pr.b2)(),_x(xx=function(e){(0,Ot.Z)(t,e);var n=bC(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getType",value:function(){return of.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(r,a){Hn((0,be.Z)(t.prototype),"init",this).call(this,r,a)}},{key:"render",value:function(r){var a=this.rendererService,o=a.useFramebuffer,u=a.clear,s=r.multiPassRenderer.getPostProcessor().getReadFBO();o(s,function(){u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:s}),r.multiPassRenderer.setRenderFlag(!1),r.models.forEach(function(l){l.draw({uniforms:r.layerModel.getUninforms()})}),r.multiPassRenderer.setRenderFlag(!0)})}}]),t}(Xv))||xx),Sx,bx,Ex,_g,Ax;function TC(e){var n=CC();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function CC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var wC=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,Tx=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,MC=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function Cx(e,n){for(var t=0,i=1/n,r=e;r>0;)t=t+i*(r%n),r=Math.floor(r/n),i=i/n;return t}var RC=1,LC=(Sx=(0,pr.b2)(),bx=(0,pr.f3)(qe.IShaderModuleService),Sx(Ex=(_g=function(e){(0,Ot.Z)(t,e);var n=TC(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),En((0,pe.Z)(i),"shaderModuleService",Ax,(0,pe.Z)(i)),(0,R.Z)((0,pe.Z)(i),"haltonSequence",[]),(0,R.Z)((0,pe.Z)(i),"accumulatingId",0),(0,R.Z)((0,pe.Z)(i),"frame",0),(0,R.Z)((0,pe.Z)(i),"timer",void 0),(0,R.Z)((0,pe.Z)(i),"sampleRenderTarget",void 0),(0,R.Z)((0,pe.Z)(i),"prevRenderTarget",void 0),(0,R.Z)((0,pe.Z)(i),"outputRenderTarget",void 0),(0,R.Z)((0,pe.Z)(i),"copyRenderTarget",void 0),(0,R.Z)((0,pe.Z)(i),"blendModel",void 0),(0,R.Z)((0,pe.Z)(i),"outputModel",void 0),(0,R.Z)((0,pe.Z)(i),"copyModel",void 0),i}return(0,at.Z)(t,[{key:"getType",value:function(){return of.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(r,a){Hn((0,be.Z)(t.prototype),"init",this).call(this,r,a);var o=this.rendererService,u=o.createFramebuffer,s=o.createTexture2D;this.sampleRenderTarget=u({color:s({width:1,height:1,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE})}),this.prevRenderTarget=u({color:s({width:1,height:1,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE})}),this.outputRenderTarget=u({color:s({width:1,height:1,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE})}),this.copyRenderTarget=u({color:s({width:1,height:1,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE})});for(var l=0;l<30;l++)this.haltonSequence.push([Cx(l,2),Cx(l,3)]);this.blendModel=this.createTriangleModel("blend-pass",wC),this.outputModel=this.createTriangleModel("copy-pass",Tx,{blend:{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE_MINUS_SRC_ALPHA,srcAlpha:N.ONE,dstAlpha:N.ONE_MINUS_SRC_ALPHA},equation:{rgb:N.FUNC_ADD,alpha:N.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Tx)}},{key:"render",value:function(r){var a=this,o=this.rendererService,u=o.clear,s=o.getViewportSize,l=o.useFramebuffer,h=s(),d=h.width,v=h.height;this.sampleRenderTarget.resize({width:d,height:v}),this.prevRenderTarget.resize({width:d,height:v}),this.outputRenderTarget.resize({width:d,height:v}),this.copyRenderTarget.resize({width:d,height:v}),this.resetFrame(),this.stopAccumulating();var y=r.multiPassRenderer.getPostProcessor().getReadFBO();l(y,function(){u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:y}),r.multiPassRenderer.setRenderFlag(!1),r.render(),r.multiPassRenderer.setRenderFlag(!0)});var x=function S(M){!a.accumulatingId||M!==a.accumulatingId||a.isFinished()||(a.doRender(r),In.requestAnimationFrame(function(){S(M)}))};this.accumulatingId=RC++,this.timer=In.setTimeout(function(){x(a.accumulatingId)},50)}},{key:"doRender",value:function(r){var a=this,o=this.rendererService,u=o.clear,s=o.getViewportSize,l=o.useFramebuffer,h=s(),d=h.width,v=h.height,y=r.getLayerConfig(),x=y.jitterScale,S=x===void 0?1:x,M=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((M[0]*2-1)/d*S,(M[1]*2-1)/v*S),r.multiPassRenderer.setRenderFlag(!1),r.hooks.beforeRender.call(),l(this.sampleRenderTarget,function(){u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:a.sampleRenderTarget}),r.render()}),r.hooks.afterRender.call(),r.multiPassRenderer.setRenderFlag(!0);var O=r.getLayerConfig();l(this.outputRenderTarget,function(){a.blendModel.draw({uniforms:{u_opacity:O.opacity||1,u_MixRatio:a.frame===0?1:.9,u_Diffuse1:a.sampleRenderTarget,u_Diffuse2:a.frame===0?r.multiPassRenderer.getPostProcessor().getReadFBO():a.prevRenderTarget}})}),this.frame===0&&u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(l(this.copyRenderTarget,function(){a.outputModel.draw({uniforms:{u_Texture:a.outputRenderTarget}})}),l(r.multiPassRenderer.getPostProcessor().getReadFBO(),function(){a.copyModel.draw({uniforms:{u_Texture:a.copyRenderTarget}})}),r.multiPassRenderer.getPostProcessor().render(r));var H=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=H,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,In.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(r,a,o){this.shaderModuleService.registerModule(r,{vs:MC,fs:a});var u=this.shaderModuleService.getModule(r),s=u.vs,l=u.fs,h=u.uniforms,d=this.rendererService,v=d.createAttribute,y=d.createBuffer,x=d.createModel;return x((0,b.Z)({vs:s,fs:l,attributes:{a_Position:v({buffer:y({data:[-4,-4,4,-4,0,4],type:N.FLOAT}),size:2})},uniforms:(0,b.Z)({},h),depth:{enable:!1},count:3},o))}}]),t}(Xv),Ax=An(_g.prototype,"shaderModuleService",[bx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_g))||Ex),md=new pr.W2;md.bind(qe.IGlobalConfigService).to(Xm).inSingletonScope(),(0,pr.GW)((0,pr.b2)(),Wi.EventEmitter),md.bind(qe.IEventEmitter).to(Wi.EventEmitter);var Mx=(0,Gi.Z)(md,!1),xg=function(n){var t=Mx.lazyInject(n);return function(i,r,a){t.call(this,i,r),a&&(a.initializer=function(){return i[r]})}},sF=function(n){var t=Mx.lazyMultiInject(n);return function(i,r,a){t.call(this,i,r),a&&(a.initializer=function(){return i[r]})}},au=md,PC=0;function IC(){var e=new pr.W2;return e.parent=md,e.bind(qe.SceneID).toConstantValue("".concat(PC++)),e.bind(qe.IShaderModuleService).to(yT).inSingletonScope(),e.bind(qe.ILayerService).to(OA).inSingletonScope(),e.bind(qe.IDebugService).to(_A).inSingletonScope(),e.bind(qe.ISceneService).to(tT).inSingletonScope(),e.bind(qe.ICameraService).to(zm).inSingletonScope(),e.bind(qe.ICoordinateSystemService).to(bu).inSingletonScope(),e.bind(qe.IInteractionService).to(AA).inSingletonScope(),e.bind(qe.IPickingService).to(MA).inSingletonScope(),e.bind(qe.IControlService).to(ed).inSingletonScope(),e.bind(qe.IMarkerService).to(jm).inSingletonScope(),e.bind(qe.IIconService).to(vm).inSingletonScope(),e.bind(qe.IFontService).to(fm).inSingletonScope(),e.bind(qe.IPopupService).to(nd).inSingletonScope(),e.bind(qe.INormalPass).to(bT).whenTargetNamed("clear"),e.bind(qe.INormalPass).to(MT).whenTargetNamed("pixelPicking"),e.bind(qe.INormalPass).to(AC).whenTargetNamed("render"),e.bind(qe.INormalPass).to(LC).whenTargetNamed("taa"),e.bind(qe.IFactoryNormalPass).toFactory(function(n){return function(t){return n.container.getNamed(qe.INormalPass,t)}}),e.bind(qe.IPostProcessingPass).to(eC).whenTargetNamed("copy"),e.bind(qe.IPostProcessingPass).to(kT).whenTargetNamed("bloom"),e.bind(qe.IPostProcessingPass).to(ZT).whenTargetNamed("blurH"),e.bind(qe.IPostProcessingPass).to(HT).whenTargetNamed("blurV"),e.bind(qe.IPostProcessingPass).to(vC).whenTargetNamed("noise"),e.bind(qe.IPostProcessingPass).to(xC).whenTargetNamed("sepia"),e.bind(qe.IPostProcessingPass).to(YT).whenTargetNamed("colorHalftone"),e.bind(qe.IPostProcessingPass).to(aC).whenTargetNamed("hexagonalPixelate"),e.bind(qe.IPostProcessingPass).to(cC).whenTargetNamed("ink"),e.bind(qe.IFactoryPostProcessingPass).toFactory(function(n){return function(t){var i=n.container.getNamed(qe.IPostProcessingPass,t);return i.setName(t),i}}),e}function gd(e){var n=new pr.W2;return n.parent=e,n.bind(qe.IStyleAttributeService).to(BA).inSingletonScope(),n.bind(qe.IMultiPassRenderer).to(TT).inSingletonScope(),n.bind(qe.IPostProcessor).to(SC).inSingletonScope(),n}var OC=null;function lF(e){return OC.indexOf(e)}var kC=2,cF=4,FC=64,fF=128,NC=256,DC=512,hF=8192,pF=16384,dF=32768,BC=null,Rx=131072,vF=262144,ZC=524288,mF=1048576,UC=2097152,gF=4194304,zC=8388608,GC=16777216,VC=null;function Yv(e,n){return e=clamp(Math.floor(e),0,255),n=clamp(Math.floor(n),0,255),256*e+n}function yF(e){var n=e.color,t=e.radius,i=e.tileX,r=e.tileY,a=e.shape,o=e.opacity,u=e.stroke,s=e.strokeWidth,l=e.strokeOpacity,h=[],d=[],v=[],y=[Yv(n[0],n[1]),Yv(n[2],n[3])],x=[Yv(u[0],u[1]),Yv(u[2],u[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(S){var M=_slicedToArray(S,2),O=M[0],H=M[1];h.push([].concat(y,[(O+1)*zC+(H+1)*UC+getShapeIndex(a)*Rx+t,(i+512)*ZC+(r+512)*FC])),d.push([].concat(x,[s,l])),v.push([o,0,0,0])}),{packedBuffer:h,packedBuffer2:d,packedBuffer3:v}}function _F(e,n){if(e===0&&!n)return 0;if(e===1&&n)return 4294967295;var t=n?1:0,i=Math.floor(e*127);return i*VC+t*GC+i*Rx+t*BC+i*DC+t*NC+i*kC+t}var Qf={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},ca={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"},pi;(function(e){e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging"})(pi||(pi={}));var uf;(function(e){e.CONSTANT="constant",e.VARIABLE="variable"})(uf||(uf={}));var Ar;(function(e){e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform"})(Ar||(Ar={}));var Lx=["mapload","mapchange","mapAfterFrameChange"],Kv=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],Ma;(function(e){e.IMAGE="image",e.CUSTOMIMAGE="customImage",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb",e.TERRAINRGB="terrainRGB",e.CUSTOMRGB="customRGB",e.CUSTOMARRAYBUFFER="customArrayBuffer",e.CUSTOMTERRAINRGB="customTerrainRGB"})(Ma||(Ma={}));var HC=function(){var e=(0,st.Z)(q().mark(function n(t,i,r,a){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",new Promise(function(s,l){i({x:t.x,y:t.y,z:t.z},function(h,d){if(h||d.length===0){l(h);return}d&&Xp([{data:d,bands:[0]}],r,a,function(v,y){v?l(v):y&&s(y)})})}));case 1:case"end":return u.stop()}},n)}));return function(t,i,r,a){return e.apply(this,arguments)}}(),jC=function(){var e=(0,st.Z)(q().mark(function n(t,i){return q().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(o,u){i({x:t.x,y:t.y,z:t.z},function(s,l){if(s||!l){u(s);return}l instanceof ArrayBuffer?_s(l,function(h,d){h&&u(h),o(d)}):l instanceof HTMLImageElement?o(l):u(s)})}));case 1:case"end":return a.stop()}},n)}));return function(t,i){return e.apply(this,arguments)}}();function WC(e,n){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(t){return ut(t,n)}):e.map(function(t){return{url:ut(t.url,n),bands:t.bands||[0]}}):ut(e,n)}function $C(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(n){return{url:n,bands:[0]}}):e}function Px(e,n){e.xhrCancel=function(){n.map(function(t){t.abort()})}}var XC=function(){var e=(0,st.Z)(q().mark(function n(t,i,r,a,o){var u,s,l,h,d,v;return q().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(u=$C(i.url),!(u.length>1)){x.next=15;break}return x.next=4,YC(u,i);case 4:if(s=x.sent,l=s.rasterFiles,h=s.xhrList,d=s.errList,Px(t,h),!(d.length>0)){x.next=12;break}return r(d,null),x.abrupt("return");case 12:Xp(l,a,o,r),x.next=17;break;case 15:v=ro(i,function(S,M){if(S)r(S);else if(M){var O=[{data:M,bands:u[0].bands}];Xp(O,a,o,r)}}),Px(t,[v]);case 17:case"end":return x.stop()}},n)}));return function(t,i,r,a,o){return e.apply(this,arguments)}}();function YC(e,n){return Sg.apply(this,arguments)}function Sg(){return Sg=(0,st.Z)(q().mark(function e(n,t){var i,r,a,o,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:i=[],r=[],a=[],o=0;case 4:if(!(o<n.length)){S.next=20;break}return u=n[o],s=(0,b.Z)((0,b.Z)({},t),{},{url:u.url}),l=u.bands,S.next=10,ys((0,b.Z)((0,b.Z)({},s),{},{type:"arrayBuffer"}));case 10:h=S.sent,d=h.err,v=h.data,y=h.xhr,d&&a.push(d),r.push(y),i.push({data:v,bands:l});case 17:o++,S.next=4;break;case 20:return S.abrupt("return",{rasterFiles:i,xhrList:r,errList:a});case 21:case"end":return S.stop()}},e)})),Sg.apply(this,arguments)}var KC=function(){var e=(0,st.Z)(q().mark(function n(t,i,r,a,o){var u;return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return u={url:WC(t,i)},l.abrupt("return",new Promise(function(h,d){XC(r,u,function(v,y){v?d(v):y&&h(y)},a,o)}));case 2:case"end":return l.stop()}},n)}));return function(t,i,r,a,o){return e.apply(this,arguments)}}(),Ix=function(){var e=(0,st.Z)(q().mark(function n(t,i,r,a){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return u=Array.isArray(t)?t[0]:t,a.wmtsOptions?(s=(a==null?void 0:a.getURLFromTemplate)||Tt,o=s(u,(0,b.Z)((0,b.Z)({},i),a.wmtsOptions))):(l=(a==null?void 0:a.getURLFromTemplate)||ut,o=l(u,i)),d.abrupt("return",new Promise(function(v,y){var x,S=K({url:o,type:(a==null||(x=a.requestParameters)===null||x===void 0?void 0:x.type)||"arrayBuffer"},function(M,O){M?y(M):O&&v(O)},a.transformResponse);r.xhrCancel=function(){return S.abort()}}));case 3:case"end":return d.stop()}},n)}));return function(t,i,r,a){return e.apply(this,arguments)}}(),Ox=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},qC={tileSize:256,minZoom:0,maxZoom:Infinity,zoomOffset:0,warp:!0},xF=[Ma.ARRAYBUFFER,Ma.RGB];function QC(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function JC(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(QC(e))throw new Error("tile server url is error");var t=(n==null?void 0:n.dataType)||Ma.IMAGE;t===Ma.RGB&&(t=Ma.ARRAYBUFFER);var i=function(o,u){switch(t){case Ma.IMAGE:return Ix(e,o,u,n);case Ma.CUSTOMIMAGE:case Ma.CUSTOMTERRAINRGB:return jC(u,n==null?void 0:n.getCustomData);case Ma.ARRAYBUFFER:return KC(e,o,u,(n==null?void 0:n.format)||Ox,n==null?void 0:n.operation);case Ma.CUSTOMARRAYBUFFER:case Ma.CUSTOMRGB:return HC(u,n==null?void 0:n.getCustomData,(n==null?void 0:n.format)||Ox,n==null?void 0:n.operation);default:return Ix(e,o,u,n)}},r=(0,b.Z)((0,b.Z)((0,b.Z)({},qC),n),{},{getTileData:i});return{data:e,dataArray:[],tilesetOptions:r,isTile:!0}}var e3=["extent","min","max","width","height","format","operation"];function t3(e,n){var t=n.extent,i=n.min,r=n.max,a=n.width,o=n.height,u=n.format,s=n.operation,l=(0,es.Z)(n,e3),h;if(u===void 0||av(e))h=Array.from(e);else{var d=Array.isArray(e)?e:[e];h=zi(d,u,s)}var v={_id:1,dataArray:[(0,b.Z)((0,b.Z)({_id:1,data:h,width:a,height:o},l),{},{min:i,max:r,coordinates:[[t[0],t[1]],[t[2],t[3]]]})]};return v}var r3={tileSize:256,minZoom:0,maxZoom:Infinity,zoomOffset:0},n3=function(){var e=(0,st.Z)(q().mark(function n(t){return q().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(a){var o=(0,Dr.Z)(t.bounds,4),u=o[0],s=o[1],l=o[2],h=o[3],d={layers:{testTile:{features:[{type:"Feature",properties:{key:t.x+"/"+t.y+"/"+t.z,x:(u+l)/2,y:(s+h)/2},geometry:{type:"LineString",coordinates:[[l,h],[l,s],[u,s],[u,s]]}}]}}};a(d)}));case 1:case"end":return r.stop()}},n)}));return function(t){return e.apply(this,arguments)}}();function i3(e,n){var t=function(a){return n3(a)},i=(0,b.Z)((0,b.Z)((0,b.Z)({},r3),n),{},{getTileData:t});return{data:e,dataArray:[],tilesetOptions:i,isTile:!0}}var a3=D(69848),kx=D.n(a3);function Fx(e,n){var t=n.radius,i=t===void 0?40:t,r=n.maxZoom,a=r===void 0?18:r,o=n.minZoom,u=o===void 0?0:o,s=n.zoom,l=s===void 0?2:s;if(e.pointIndex){var h=e.pointIndex.getClusters(e.extent,Math.floor(l));return e.dataArray=o3(h),e}var d=new(kx())({radius:i,minZoom:u,maxZoom:a}),v={type:"FeatureCollection",features:[]};return v.features=e.dataArray.map(function(y){return{type:"Feature",geometry:{type:"Point",coordinates:y.coordinates},properties:(0,b.Z)({},y)}}),d.load(v.features),d}function o3(e){return e.map(function(n,t){return(0,b.Z)({coordinates:n.geometry.coordinates,_id:t+1},n.properties)})}function u3(e){if(e.length===0)throw new Error("max requires at least one data point");for(var n=e[0],t=1;t<e.length;t++)e[t]>n&&(n=e[t]);return n}function s3(e){if(e.length===0)throw new Error("min requires at least one data point");for(var n=e[0],t=1;t<e.length;t++)e[t]<n&&(n=e[t]);return n}function Nx(e){if(e.length===0)return 0;for(var n=e[0],t=0,i,r=1;r<e.length;r++)i=n+e[r]*1,Math.abs(n)>=Math.abs(e[r])?t+=n-i+e[r]:t+=e[r]-i+n,n=i;return n+t*1}function l3(e){if(e.length===0)throw new Error("mean requires at least one data point");return Nx(e)/e.length}var c3={min:s3,max:u3,mean:l3,sum:Nx};function f3(e){var n=h3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function h3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function p3(e,n){if(Array.isArray(n))return n}var v3=function(e){(0,Ot.Z)(t,e);var n=f3(t);function t(i,r){var a;return(0,ot.Z)(this,t),a=n.call(this),(0,R.Z)((0,pe.Z)(a),"type","source"),(0,R.Z)((0,pe.Z)(a),"isTile",!1),(0,R.Z)((0,pe.Z)(a),"inited",!1),(0,R.Z)((0,pe.Z)(a),"hooks",{init:new Al}),(0,R.Z)((0,pe.Z)(a),"parser",{type:"geojson"}),(0,R.Z)((0,pe.Z)(a),"transforms",[]),(0,R.Z)((0,pe.Z)(a),"cluster",!1),(0,R.Z)((0,pe.Z)(a),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,R.Z)((0,pe.Z)(a),"invalidExtent",!1),(0,R.Z)((0,pe.Z)(a),"dataArrayChanged",!1),(0,R.Z)((0,pe.Z)(a),"cfg",{autoRender:!0}),a.originData=i,a.initCfg(r),a.init().then(function(){a.inited=!0,a.emit("update",{type:"inited"})}),a}return(0,at.Z)(t,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(r){return this.clusterIndex.getClusters(this.caculClusterExtent(2),r)}},{key:"getClustersLeaves",value:function(r){return this.clusterIndex.getLeaves(r,Infinity)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(r){var a=this,o=this.clusterOptions,u=o.method,s=u===void 0?"sum":u,l=o.field,h=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(r));this.clusterOptions.zoom=r,h.forEach(function(d){d.id||(d.properties.point_count=1)}),(l||(0,Rr.isFunction)(s))&&(h=h.map(function(d){var v=d.id;if(v){var y=a.clusterIndex.getLeaves(v,Infinity),x=y.map(function(O){return O.properties}),S;if((0,Rr.isString)(s)&&l){var M=em(x,l);S=c3[s](M)}(0,Rr.isFunction)(s)&&(S=s(x)),d.properties.stat=S}else d.properties.point_count=1;return d})),this.data=se("geojson")({type:"FeatureCollection",features:h}),this.executeTrans()}},{key:"getFeatureById",value:function(r){var a=this.parser,o=a.type,u=o===void 0?"geojson":o,s=a.geometry;if(u==="geojson"&&!this.cluster){var l=r<this.originData.features.length?this.originData.features[r]:"null",h=(0,Rr.cloneDeep)(l);if(h!=null&&h.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var d=this.data.dataArray.find(function(v){return v._id===r});h.properties=d}return h}else return u==="json"&&s?this.data.dataArray.find(function(v){return v._id===r}):r<this.data.dataArray.length?this.data.dataArray[r]:"null"}},{key:"updateFeaturePropertiesById",value:function(r,a){this.data.dataArray=this.data.dataArray.map(function(o){return o._id===r?(0,b.Z)((0,b.Z)({},o),a):o}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(r,a){var o=this.data.dataArray.find(function(u){return u[r]===a});return o==null?void 0:o._id}},{key:"setData",value:function(r,a){var o=this;this.originData=r,this.dataArrayChanged=!1,this.initCfg(a),this.init().then(function(){o.emit("update",{type:"update"})})}},{key:"reloadAllTile",value:function(){var r;(r=this.tileset)===null||r===void 0||r.reloadAll()}},{key:"reloadTilebyId",value:function(r,a,o){var u;(u=this.tileset)===null||u===void 0||u.reloadTileById(r,a,o)}},{key:"reloadTileByLnglat",value:function(r,a,o){var u;(u=this.tileset)===null||u===void 0||u.reloadTileByLnglat(r,a,o)}},{key:"getTileExtent",value:function(r,a){var o;return(o=this.tileset)===null||o===void 0?void 0:o.getTileExtent(r,a)}},{key:"getTileByZXY",value:function(r,a,o){var u;return(u=this.tileset)===null||u===void 0?void 0:u.getTileByZXY(r,a,o)}},{key:"reloadTileByExtent",value:function(r,a){var o;(o=this.tileset)===null||o===void 0||o.reloadTileByExtent(r,a)}},{key:"destroy",value:function(){var r;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(r=this.tileset)===null||r===void 0||r.destroy()}},{key:"processData",value:function(){var i=(0,st.Z)(q().mark(function a(){var o=this;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise(function(l,h){try{o.excuteParser(),o.initCluster(),o.executeTrans(),l({})}catch(d){h(d)}}));case 1:case"end":return s.stop()}},a)}));function r(){return i.apply(this,arguments)}return r}()},{key:"initCfg",value:function(r){this.cfg=(0,Rr.mergeWith)(this.cfg,r,p3);var a=this.cfg;a&&(a.parser&&(this.parser=a.parser),a.transforms&&(this.transforms=a.transforms),this.cluster=a.cluster||!1,a.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,b.Z)((0,b.Z)({},this.clusterOptions),a.clusterOptions)))}},{key:"init",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.inited=!1,u.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"excuteParser",value:function(){var r=this.parser,a=r.type||"geojson",o=se(a);this.data=o(this.originData,r),this.tileset=this.initTileset(),!r.cancelExtent&&(this.extent=Wu(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(r){this.center=[(r[0]+r[2])/2,(r[1]+r[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var r=this.data.tilesetOptions;if(!!r){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(r),this.tileset;var a=new me((0,b.Z)({},r));return a}}},{key:"executeTrans",value:function(){var r=this,a=this.transforms;a.forEach(function(o){var u=o.type,s=ye(u)(r.data,o);Object.assign(r.data,s)})}},{key:"initCluster",value:function(){if(!!this.cluster){var r=this.clusterOptions||{};this.clusterIndex=Fx(this.data,r)}}},{key:"caculClusterExtent",value:function(r){var a=[[-Infinity,-Infinity],[Infinity,Infinity]];return this.invalidExtent||(a=Ms(Ea(this.extent),r)),a[0].concat(a[1])}}]),t}(Wi.EventEmitter);function m3(e,n){var t=n.callback;return t&&(e.dataArray=e.dataArray.filter(t)),e}function Dx(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=g3(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function g3(e,n){if(!!e){if(typeof e=="string")return Bx(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Bx(e,n)}}function Bx(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var bg=6378e3;function y3(e,n){var t=e.dataArray,i=n.size,r=i===void 0?10:i,a=r/(2*Math.PI*bg)*(256<<20)/2,o=_3(t,r),u=o.gridHash,s=o.gridOffset,l=E3(u,s,n);return{yOffset:a,xOffset:a,radius:a,type:"grid",dataArray:l}}function _3(e,n){var t=Infinity,i=-Infinity,r,a=Dx(e),o;try{for(a.s();!(o=a.n()).done;){var u=o.value;r=u.coordinates[1],Number.isFinite(r)&&(t=r<t?r:t,i=r>i?r:i)}}catch(W){a.e(W)}finally{a.f()}var s=(t+i)/2,l=x3(n,s);if(l.xOffset<=0||l.yOffset<=0)return{gridHash:{},gridOffset:l};var h={},d=Dx(e),v;try{for(d.s();!(v=d.n()).done;){var y=v.value,x=y.coordinates[1],S=y.coordinates[0];if(Number.isFinite(x)&&Number.isFinite(S)){var M=Math.floor((x+90)/l.yOffset),O=Math.floor((S+180)/l.xOffset),H="".concat(M,"-").concat(O);h[H]=h[H]||{count:0,points:[]},h[H].count+=1,h[H].points.push(y)}}}catch(W){d.e(W)}finally{d.f()}return{gridHash:h,gridOffset:l}}function x3(e,n){var t=S3(e),i=b3(n,e);return{yOffset:t,xOffset:i}}function S3(e){return e/bg*(180/Math.PI)}function b3(e,n){return n/bg*(180/Math.PI)/Math.cos(e*Math.PI/180)}function E3(e,n,t){return Object.keys(e).reduce(function(i,r,a){var o=r.split("-"),u=parseInt(o[0],10),s=parseInt(o[1],10),l={};if(t.field&&t.method){var h=Gc(e[r].points,t.field);l[t.method]=Uo[t.method](h)}return Object.assign(l,{_id:a,coordinates:ji([-180+n.xOffset*(s+.5),-90+n.yOffset*(u+.5)]),rawData:e[r].points,count:e[r].count}),i.push(l),i},[])}var Yh=Math.PI/3,A3=[0,Yh,2*Yh,3*Yh,4*Yh,5*Yh];function T3(e){return e[0]}function C3(e){return e[1]}function w3(){var e=0,n=0,t=1,i=1,r=T3,a=C3,o,u,s;function l(d){var v={},y=[],x,S=d.length;for(x=0;x<S;++x)if(!(isNaN(O=+r.call(null,M=d[x],x,d))||isNaN(H=+a.call(null,M,x,d)))){var M,O,H,W=Math.round(H=H/s),he=Math.round(O=O/u-(W&1)/2),ve=H-W;if(Math.abs(ve)*3>1){var Re=O-he,ze=he+(O<he?-1:1)/2,ft=W+(H<W?-1:1),gt=O-ze,Pt=H-ft;Re*Re+ve*ve>gt*gt+Pt*Pt&&(he=ze+(W&1?1:-1)/2,W=ft)}var Mt=he+"-"+W,sr=v[Mt];sr?sr.push(M):(y.push(sr=v[Mt]=[M]),sr.x=(he+(W&1)/2)*u,sr.y=W*s)}return y}function h(d){var v=0,y=0;return A3.map(function(x){var S=Math.sin(x)*d,M=-Math.cos(x)*d,O=S-v,H=M-y;return v=S,y=M,[O,H]})}return l.hexagon=function(d){return"m"+h(d==null?o:+d).join("l")+"z"},l.centers=function(){for(var d=[],v=Math.round(n/s),y=Math.round(e/u),x=v*s;x<i+o;x+=s,++v)for(var S=y*u+(v&1)*u/2;S<t+u/2;S+=u)d.push([S,x]);return d},l.mesh=function(){var d=h(o).slice(0,4).join("l");return l.centers().map(function(v){return"M"+v+"m"+d}).join("")},l.x=function(d){return arguments.length?(r=d,l):r},l.y=function(d){return arguments.length?(a=d,l):a},l.radius=function(d){return arguments.length?(o=+d,u=o*2*Math.sin(Yh),s=o*1.5,l):o},l.size=function(d){return arguments.length?(e=n=0,t=+d[0],i=+d[1],l):[t-e,i-n]},l.extent=function(d){return arguments.length?(e=+d[0][0],n=+d[0][1],t=+d[1][0],i=+d[1][1],l):[[e,n],[t,i]]},l.radius(1)}var M3=6378e3;function R3(e,n){var t=e.dataArray,i=n.size,r=i===void 0?10:i,a=n.method,o=a===void 0?"sum":a,u=r/(2*Math.PI*M3)*(256<<20)/2,s=t.map(function(v){var y=ji(v.coordinates),x=(0,Dr.Z)(y,2),S=x[0],M=x[1];return(0,b.Z)((0,b.Z)({},v),{},{coordinates:[S,M]})}),l=w3().radius(u).x(function(v){return v.coordinates[0]}).y(function(v){return v.coordinates[1]}),h=l(s),d={dataArray:h.map(function(v,y){var x;if(n.field&&o){var S=Gc(v,n.field);v[o]=Uo[o](S)}return x={},(0,R.Z)(x,n.method,v[o]),(0,R.Z)(x,"count",v.length),(0,R.Z)(x,"rawData",v),(0,R.Z)(x,"coordinates",[v.x,v.y]),(0,R.Z)(x,"_id",y),x}),radius:u,xOffset:u,yOffset:u,type:"hexagon"};return d}function L3(e,n){var t=n.sourceField,i=n.targetField,r=n.data,a={};return r.forEach(function(o){a[o[t]]=o}),e.dataArray=e.dataArray.map(function(o){var u=o[i];return(0,b.Z)((0,b.Z)({},o),a[u])}),e}function P3(e,n){var t=n.callback;return t&&(e.dataArray=e.dataArray.map(t)),e}le("rasterTile",JC),le("mvt",Y0),le("geojsonvt",yi),le("testTile",i3),le("geojson",Vs),le("image",tv),le("csv",Pu),le("json",aa),le("raster",Bs),le("rasterRgb",t3),Ce("cluster",Fx),Ce("filter",m3),Ce("join",L3),Ce("map",P3),Ce("grid",y3),Ce("hexagon",R3);var Eg=v3;function I3(e){var n=O3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function O3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Zx=function(e){(0,Ot.Z)(t,e);var n=I3(t);function t(i){var r;return(0,ot.Z)(this,t),r=n.call(this),(0,R.Z)((0,pe.Z)(r),"added",!1),(0,R.Z)((0,pe.Z)(r),"eventHandle",function(a){r.polyfillEvent(a),r.emit(a.type,{target:a,data:r.markerOption.extData,lngLat:r.lngLat})}),r.markerOption=(0,b.Z)((0,b.Z)({},r.getDefault()),i),ru(["update","onMove","onMapClick"],(0,pe.Z)(r)),r.init(),r}return(0,at.Z)(t,[{key:"getMarkerLayerContainerSize",value:function(){}},{key:"getDefault",value:function(){return{element:void 0,anchor:Vu.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(r){this.scene=r,this.mapsService=r.get(qe.IMapService),this.sceneSerive=r.get(qe.ISceneService);var a=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(a),this.registerMarkerEvent(a),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();var r=this.markerOption.element;return r&&va(r),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(r){return this.lngLat=r,Array.isArray(r)&&(this.lngLat={lng:r[0],lat:r[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(r){var a=this;if(!this.added)return this.once("added",function(){a.setElement(r)}),this;var o=this.markerOption.element;return o&&va(o),this.markerOption.element=r,this.init(),this.mapsService.getMarkerContainer().appendChild(r),this.registerMarkerEvent(r),this.update(),this}},{key:"openPopup",value:function(){var r=this;if(!this.added)return this.once("added",function(){r.openPopup()}),this;var a=this.popup;return a?(a.isOpen()||a.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var r=this;this.added||this.once("added",function(){r.closePopup()});var a=this.popup;return a&&a.remove(),this}},{key:"setPopup",value:function(r){return this.popup=r,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var r=this.popup;if(r)r.isOpen()?r.remove():r.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(r){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(r){this.markerOption.extData=r}},{key:"update",value:function(){if(!!this.mapsService){var r=this.markerOption,a=r.element,o=r.anchor;this.updatePosition(),$l(a,"".concat(da[o]))}}},{key:"onMapClick",value:function(r){var a=this.markerOption.element;this.popup&&a&&this.togglePopup()}},{key:"getCurrentContainerSize",value:function(){var r=this.mapsService.getContainer();return{containerHeight:(r==null?void 0:r.scrollHeight)||0,containerWidth:(r==null?void 0:r.scrollWidth)||0,bounds:this.mapsService.getBounds()}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var r=this.markerOption,a=r.element,o=r.offsets,u=this.lngLat,s=u.lng,l=u.lat,h=this.mapsService.lngLatToContainer([s,l]);if(a){a.style.display="block",a.style.whiteSpace="nowrap";var d=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize(),v=d.containerHeight,y=d.containerWidth,x=d.bounds;if(!x)return;if(Math.abs(x[0][0])>180||Math.abs(x[1][0])>180){if(h.x>y){var S=this.mapsService.lngLatToContainer([s-360,l]);h.x=S.x}if(h.x<0){var M=this.mapsService.lngLatToContainer([s+360,l]);h.x=M.x}}(h.x>y||h.x<0||h.y>v||h.y<0)&&(a.style.display="none"),a.style.left=h.x+o[0]+"px",a.style.top=h.y-o[1]+"px"}}}},{key:"init",value:function(){var r=this,a=this.markerOption.element,o=this.markerOption,u=o.color,s=o.anchor;if(!a){this.defaultMarker=!0,a=bn("div"),this.markerOption.element=a;var l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height","48px"),l.setAttributeNS(null,"width","48px"),l.setAttributeNS(null,"viewBox","0 0 1024 1024");var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),h.setAttributeNS(null,"fill",u),l.appendChild(h),a.appendChild(l)}ei(a,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(d){var v,y,x=((v=r.markerOption)===null||v===void 0?void 0:v.style)&&((y=r.markerOption)===null||y===void 0?void 0:y.style[d]);a&&(a.style[d]=x)}),On(a,s,"marker")}},{key:"registerMarkerEvent",value:function(r){r.addEventListener("click",this.onMapClick),r.addEventListener("mousemove",this.eventHandle),r.addEventListener("click",this.eventHandle),r.addEventListener("mousedown",this.eventHandle),r.addEventListener("mouseup",this.eventHandle),r.addEventListener("dblclick",this.eventHandle),r.addEventListener("contextmenu",this.eventHandle),r.addEventListener("mouseover",this.eventHandle),r.addEventListener("mouseout",this.eventHandle),r.addEventListener("touchstart",this.eventHandle),r.addEventListener("touchend",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var r=this.getElement();r.removeEventListener("click",this.onMapClick),r.removeEventListener("mousemove",this.eventHandle),r.removeEventListener("click",this.eventHandle),r.removeEventListener("mousedown",this.eventHandle),r.removeEventListener("mouseup",this.eventHandle),r.removeEventListener("dblclick",this.eventHandle),r.removeEventListener("contextmenu",this.eventHandle),r.removeEventListener("mouseover",this.eventHandle),r.removeEventListener("mouseout",this.eventHandle),r.removeEventListener("touchstart",this.eventHandle),r.removeEventListener("touchend",this.eventHandle)}},{key:"polyfillEvent",value:function(r){!this.mapsService||this.mapsService.version!=="GAODE2.x"||cl()||(r.type==="touchstart"&&(this.touchStartTime=Date.now()),r.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:r,data:this.markerOption.extData,lngLat:this.lngLat}))}},{key:"addDragHandler",value:function(r){return null}},{key:"onUp",value:function(r){throw new Error("Method not implemented.")}}]),t}(Wi.EventEmitter);function k3(e){var n=F3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function F3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var SF=function(e){(0,Ot.Z)(t,e);var n=k3(t);function t(i){var r,a;return(0,ot.Z)(this,t),a=n.call(this),(0,R.Z)((0,pe.Z)(a),"markers",[]),(0,R.Z)((0,pe.Z)(a),"points",[]),(0,R.Z)((0,pe.Z)(a),"clusterMarkers",[]),a.markerLayerOption=(0,Rr.merge)(a.getDefault(),i),ru(["update"],(0,pe.Z)(a)),a.zoom=((r=a.markerLayerOption.clusterOption)===null||r===void 0?void 0:r.zoom)||-99,a}return(0,at.Z)(t,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(r){return this.scene=r,this.mapsService=r.get(qe.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}},{key:"setContainerSize",value:function(){if(!!this.mapsService){var r=this.mapsService.getContainer();this.containerSize={containerWidth:(r==null?void 0:r.scrollWidth)||0,containerHeight:(r==null?void 0:r.scrollHeight)||0,bounds:this.mapsService.getBounds()}}}},{key:"getContainerSize",value:function(){return this.containerSize}},{key:"addMarker",value:function(r){var a=this.markerLayerOption.cluster;if(r.getMarkerLayerContainerSize=this.getContainerSize.bind(this),a&&(this.addPoint(r,this.markers.length),this.mapsService)){var o=this.mapsService.getZoom(),u=this.mapsService.getBounds();this.bbox=Ms(u,.5),this.zoom=Math.floor(o),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(r)}},{key:"removeMarker",value:function(r){this.markers.indexOf(r);var a=this.markers.indexOf(r);a>-1&&this.markers.splice(a,1)}},{key:"hide",value:function(){this.markers.map(function(r){r.getElement().style.opacity="0"}),this.clusterMarkers.map(function(r){r.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(r){r.getElement().style.opacity="1"}),this.clusterMarkers.map(function(r){r.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var r=this.markerLayerOption.cluster;return r?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var r=this;this.getMarkers().forEach(function(a){a.addTo(r.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(r){r.remove()}),this.clusterMarkers.forEach(function(r){r.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}},{key:"addPoint",value:function(r,a){var o=r.getLnglat(),u=o.lng,s=o.lat,l={geometry:{type:"Point",coordinates:[u,s]},properties:(0,b.Z)((0,b.Z)({},r.getExtData()),{},{marker_id:a})};this.points.push(l),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var r=this.markerLayerOption.clusterOption,a=r.radius,o=r.minZoom,u=o===void 0?0:o,s=r.maxZoom;this.clusterIndex=new(kx())({radius:a,minZoom:u,maxZoom:s}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(r,a){var o=this,u=r[0].concat(r[1]),s=this.clusterIndex.getClusters(u,a);this.clusterMarkers.forEach(function(l){l.remove()}),this.clusterMarkers=[],s.forEach(function(l){var h,d=o.markerLayerOption.clusterOption,v=d.field,y=d.method;if((h=l.properties)!==null&&h!==void 0&&h.cluster_id){var x,S=o.getLeaves((x=l.properties)===null||x===void 0?void 0:x.cluster_id);if(l.properties.clusterData=S,v&&y){var M=S==null?void 0:S.map(function(ve){var Re=(0,R.Z)({},v,ve.properties[v]);return Re}),O=Gc(M,v),H=zf(y,O),W="point_"+y;l.properties[W]=H.toFixed(2)}}var he=o.clusterMarker(l);o.clusterMarkers.push(he),he.addTo(o.scene)})}},{key:"getLeaves",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return r?this.clusterIndex.getLeaves(r,a,o):null}},{key:"clusterMarker",value:function(r){var a=this.markerLayerOption.clusterOption,o=a,u=o.element,s=u===void 0?this.generateElement.bind(this):u,l=new Zx({element:s(r)}).setLnglat({lng:r.geometry.coordinates[0],lat:r.geometry.coordinates[1]});return l}},{key:"normalMarker",value:function(r){var a=r.properties.marker_id;return this.markers[a]}},{key:"update",value:function(){if(!!this.mapsService&&this.markers.length!==0){var r=this.mapsService.getZoom(),a=this.mapsService.getBounds();(!this.bbox||Math.abs(r-this.zoom)>=1||!kf(this.bbox,a))&&(this.bbox=Ms(a,.5),this.zoom=Math.floor(r),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(r){var a=bn("div","l7-marker-cluster"),o=bn("div","",a),u=bn("span","",o),s=this.markerLayerOption.clusterOption,l=s.field,h=s.method;r.properties.point_count=r.properties.point_count||1;var d=l&&h?r.properties["point_"+h]||r.properties[l]:r.properties.point_count;return u.textContent=d,a}}]),t}(Wi.EventEmitter),bF=D(4157);function N3(e){var n=D3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function D3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Kh=function(e){(0,Ot.Z)(t,e);var n=N3(t);function t(i){var r;return(0,ot.Z)(this,t),r=n.call(this),t.controlCount++,r.controlOption=(0,b.Z)((0,b.Z)({},r.getDefault(i)),i||{}),r}return(0,at.Z)(t,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(r){var a=this.getDefault(r);Object.entries(r).forEach(function(o){var u=(0,Dr.Z)(o,2),s=u[0],l=u[1];l===void 0&&(r[s]=a[s])}),"position"in r&&this.setPosition(r.position),"className"in r&&this.setClassName(r.className),"style"in r&&this.setStyle(r.style),this.controlOption=(0,b.Z)((0,b.Z)({},this.controlOption),r)}},{key:"addTo",value:function(r){this.mapsService=r.get(qe.IMapService),this.renderService=r.get(qe.IRendererService),this.layerService=r.get(qe.ILayerService),this.controlService=r.get(qe.IControlService),this.configService=r.get(qe.IGlobalConfigService),this.scene=r.get(qe.ISceneService),this.sceneContainer=r,this.isShow=!0,this.container=this.onAdd(),ei(this.container,"l7-control");var a=this.controlOption,o=a.className,u=a.style;return o&&this.setClassName(o),u&&this.setStyle(u),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;va(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return bn("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var r=this.container;tu(r,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var r=this.container;ei(r,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(r){return{position:Us.TOPRIGHT,name:"".concat(t.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(r){if(this.mapsService&&r&&r.screenX>0&&r.screenY>0){var a=this.mapsService.getContainer();a!==null&&a.focus()}}},{key:"setPosition",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Us.TOPLEFT,a=this.controlService;return a&&a.removeControl(this),this.controlOption.position=r,a&&a.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(r){var a=this.container,o=this.controlOption.className;o&&tu(a,o),r&&ei(a,r)}},{key:"setStyle",value:function(r){var a=this.container;r?a.setAttribute("style",r):a.removeAttribute("style")}},{key:"insertContainer",value:function(){var r=this.controlOption.position,a=this.container;if(r instanceof Element)r.appendChild(a);else{var o=this.controlService.controlCorners[r];["bottomleft","bottomright","righttop","rightbottom"].includes(r)?o.insertBefore(a,o.firstChild):o.appendChild(a)}}},{key:"checkUpdateOption",value:function(r,a){return a.some(function(o){return o in r})}}]),t}(Vc());(0,R.Z)(Kh,"controlCount",0);function B3(e){var n=Z3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Z3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qv=function(e){(0,Ot.Z)(t,e);var n=B3(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"isDisable",!1),i}return(0,at.Z)(t,[{key:"setIsDisable",value:function(r){if(this.isDisable=r,r){var a;(a=this.button)===null||a===void 0||a.setAttribute("disabled","true")}else{var o;(o=this.button)===null||o===void 0||o.removeAttribute("disabled")}}},{key:"createButton",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return bn("button","l7-button-control ".concat(r))}},{key:"onAdd",value:function(){this.button=this.createButton(),this.isDisable=!1;var r=this.controlOption,a=r.title,o=r.btnText,u=r.btnIcon;return this.setBtnTitle(a),this.setBtnText(o),this.setBtnIcon(u),this.button}},{key:"onRemove",value:function(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}},{key:"setOptions",value:function(r){var a=r.title,o=r.btnText,u=r.btnIcon;this.checkUpdateOption(r,["title"])&&this.setBtnTitle(a),this.checkUpdateOption(r,["btnIcon"])&&this.setBtnIcon(u),this.checkUpdateOption(r,["btnText"])&&this.setBtnText(o),Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r)}},{key:"setBtnTitle",value:function(r){var a;(a=this.button)===null||a===void 0||a.setAttribute("title",r!=null?r:"")}},{key:"setBtnIcon",value:function(r){if(this.buttonIcon&&va(this.buttonIcon),r){var a,o=(a=this.button)===null||a===void 0?void 0:a.firstChild;if(o){var u;(u=this.button)===null||u===void 0||u.insertBefore(r,o)}else{var s;(s=this.button)===null||s===void 0||s.appendChild(r)}this.buttonIcon=r}}},{key:"setBtnText",value:function(r){if(!!this.button)if(tu(this.button,"l7-button-control--row"),tu(this.button,"l7-button-control--column"),r){var a=this.buttonText;if(!a){var o;a=bn("div","l7-button-control__text"),(o=this.button)===null||o===void 0||o.appendChild(a),this.buttonText=a}a.innerText=r,ei(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!r&&this.buttonText&&(va(this.buttonText),this.buttonText=void 0)}}]),t}(Kh);function U3(e){var n=z3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function z3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ux=function(e){(0,Ot.Z)(t,e);var n=U3(t);function t(i,r){var a;return(0,ot.Z)(this,t),a=n.call(this),(0,R.Z)((0,pe.Z)(a),"isShow",!1),(0,R.Z)((0,pe.Z)(a),"timeout",null),(0,R.Z)((0,pe.Z)(a),"show",function(){return a.isShow||!a.contentDOM.innerHTML||(a.resetPopperPosition(),tu(a.popperDOM,"l7-popper-hide"),a.isShow=!0,a.option.unique&&t.conflictPopperList.forEach(function(o){o!==(0,pe.Z)(a)&&o.isShow&&o.hide()}),a.emit("show")),(0,pe.Z)(a)}),(0,R.Z)((0,pe.Z)(a),"hide",function(){return a.isShow&&(ei(a.popperDOM,"l7-popper-hide"),a.isShow=!1,a.emit("hide")),(0,pe.Z)(a)}),(0,R.Z)((0,pe.Z)(a),"setHideTimeout",function(){a.timeout||(a.timeout=window.setTimeout(function(){!a.isShow||(a.hide(),a.timeout=null)},300))}),(0,R.Z)((0,pe.Z)(a),"clearHideTimeout",function(){a.timeout&&(window.clearTimeout(a.timeout),a.timeout=null)}),(0,R.Z)((0,pe.Z)(a),"onBtnClick",function(){a.isShow?a.hide():a.show()}),(0,R.Z)((0,pe.Z)(a),"onBtnMouseLeave",function(){a.setHideTimeout()}),(0,R.Z)((0,pe.Z)(a),"onBtnMouseMove",function(){a.clearHideTimeout(),!a.isShow&&a.show()}),a.button=i,a.option=r,a.init(),r.unique&&t.conflictPopperList.push((0,pe.Z)(a)),a}return(0,at.Z)(t,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(r){typeof r=="string"?this.contentDOM.innerHTML=r:r instanceof HTMLElement&&(Es(this.contentDOM),this.contentDOM.appendChild(r)),this.content=r}},{key:"init",value:function(){var r=this.option.trigger;this.popperDOM=this.createPopper(),r==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),va(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var r={},a=this.option,o=a.container,u=a.offset,s=u===void 0?[0,0]:u,l=a.placement,h=(0,Dr.Z)(s,2),d=h[0],v=h[1],y=this.button.getBoundingClientRect(),x=o.getBoundingClientRect(),S=Oc(y,x),M=S.left,O=S.right,H=S.top,W=S.bottom,he=!1,ve=!1;/^(left|right)/.test(l)?(l.includes("left")?r.right="".concat(y.width+O,"px"):l.includes("right")&&(r.left="".concat(y.width+M,"px")),l.includes("start")?r.top="".concat(H,"px"):l.includes("end")?r.bottom="".concat(W,"px"):(r.top="".concat(H+y.height/2,"px"),ve=!0,r.transform="translate(".concat(d,"px, calc(").concat(v,"px - 50%))"))):/^(top|bottom)/.test(l)&&(l.includes("top")?r.bottom="".concat(y.height+W,"px"):l.includes("bottom")&&(r.top="".concat(y.height+H,"px")),l.includes("start")?r.left="".concat(M,"px"):l.includes("end")?r.right="".concat(O,"px"):(r.left="".concat(M+y.width/2,"px"),he=!0,r.transform="translate(calc(".concat(d,"px - 50%), ").concat(v,"px)"))),r.transform="translate(calc(".concat(d,"px - ").concat(he?"50%":"0%","), calc(").concat(v,"px - ").concat(ve?"50%":"0%",")");var Re=l.split("-");Re.length&&ei(this.popperDOM,Re.map(function(ze){return"l7-popper-".concat(ze)}).join(" ")),Ic(this.popperDOM,bs(r))}},{key:"createPopper",value:function(){var r=this.option,a=r.container,o=r.className,u=o===void 0?"":o,s=r.content,l=bn("div","l7-popper l7-popper-hide ".concat(u)),h=bn("div","l7-popper-content"),d=bn("div","l7-popper-arrow");return l.appendChild(h),l.appendChild(d),a.appendChild(l),this.popperDOM=l,this.contentDOM=h,s&&this.setContent(s),l}}]),t}(Wi.EventEmitter);(0,R.Z)(Ux,"conflictPopperList",[]);function G3(e){var n=V3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function V3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var H3={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},j3=function(e){(0,Ot.Z)(t,e);var n=G3(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getPopper",value:function(){return this.popper}},{key:"hide",value:function(){this.popper.hide(),Hn((0,be.Z)(t.prototype),"hide",this).call(this)}},{key:"getDefault",value:function(r){var a,o=Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r),u=(a=r==null?void 0:r.position)!==null&&a!==void 0?a:o.position;return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{popperPlacement:u instanceof Element?"bottom":H3[u],popperTrigger:"click"})}},{key:"onAdd",value:function(){var r=Hn((0,be.Z)(t.prototype),"onAdd",this).call(this);return this.initPopper(),r}},{key:"onRemove",value:function(){this.popper.destroy()}},{key:"initPopper",value:function(){var r=this,a=this.controlOption,o=a.popperClassName,u=a.popperPlacement,s=a.popperTrigger,l=this.mapsService.getMapContainer();return this.popper=new Ux(this.button,{className:o,placement:u,trigger:s,container:l,unique:!0}),this.popper.on("show",function(){r.emit("popperShow",r)}).on("hide",function(){r.emit("popperHide",r)}),this.popper}},{key:"setOptions",value:function(r){if(Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r),this.checkUpdateOption(r,["popperPlacement","popperTrigger","popperClassName"])){var a=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(a)}}}]),t}(qv);function W3(e){var n=$3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function $3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hc;(function(e){e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index"})(hc||(hc={}));var zx=function(e){(0,Ot.Z)(t,e);var n=W3(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"selectValue",[]),(0,R.Z)((0,pe.Z)(i),"createNormalOption",function(u){var s=i.selectValue.includes(u.value),l=bn("div","l7-select-control-item ".concat(s?hc.ActiveOptionClassName:""));i.getIsMultiple()&&l.appendChild(i.createCheckbox(s)),u.icon&&l.appendChild(u.icon);var h=bn("span");return h.innerText=u.text,l.appendChild(h),l}),(0,R.Z)((0,pe.Z)(i),"onItemClick",function(u){if(i.getIsMultiple()){var s=i.selectValue.findIndex(function(l){return l===u.value});s>-1?i.selectValue.splice(s,1):i.selectValue=[].concat((0,L.Z)(i.selectValue),[u.value])}else i.selectValue=[u.value];i.setSelectValue(i.selectValue)}),i}return(0,at.Z)(t,[{key:"setOptions",value:function(r){Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r);var a=r.options;a&&this.popper.setContent(this.getPopperContent(a))}},{key:"onAdd",value:function(){var r=Hn((0,be.Z)(t.prototype),"onAdd",this).call(this),a=this.controlOption.defaultValue;return a&&(this.selectValue=this.transSelectValue(a)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),r}},{key:"getSelectValue",value:function(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}},{key:"setSelectValue",value:function(r){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=this.transSelectValue(r);this.optionDOMList.forEach(function(s){var l=s.getAttribute(hc.OptionValueAttrKey),h=a.getIsMultiple()?s.querySelector("input[type=checkbox]"):void 0;u.includes(l)?(ei(s,hc.ActiveOptionClassName),h&&kc(h,!0)):(tu(s,hc.ActiveOptionClassName),h&&kc(h,!1))}),this.selectValue=u,o&&this.emit("selectChange",this.getIsMultiple()?u:u[0])}},{key:"getIsMultiple",value:function(){return!1}},{key:"getPopperContent",value:function(r){var a=this,o=this.isImageOptions(),u=bn("div",o?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&ei(u,"l7-select-control--multiple");var s=r.map(function(l,h){var d=o?a.createImageOption(l):a.createNormalOption(l);return d.setAttribute(hc.OptionValueAttrKey,l.value),d.setAttribute(hc.OptionIndexAttrKey,window.String(h)),d.addEventListener("click",a.onItemClick.bind(a,l)),d});return u.append.apply(u,(0,L.Z)(s)),this.optionDOMList=s,u}},{key:"createImageOption",value:function(r){var a=this.selectValue.includes(r.value),o=bn("div","l7-select-control-item ".concat(a?hc.ActiveOptionClassName:"")),u=bn("img");u.setAttribute("src",r.img),As(u),o.appendChild(u);var s=bn("div","l7-select-control-item-row");this.getIsMultiple()&&o.appendChild(this.createCheckbox(a));var l=bn("span");return l.innerText=r.text,s.appendChild(l),o.appendChild(s),o}},{key:"createCheckbox",value:function(r){var a=bn("input");return a.setAttribute("type","checkbox"),r&&kc(a,!0),a}},{key:"isImageOptions",value:function(){return!!this.controlOption.options.find(function(r){return r.img})}},{key:"transSelectValue",value:function(r){return Array.isArray(r)?r:[r]}}]),t}(j3),pc=function(n){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("l7-iconfont"),t.setAttribute("aria-hidden","true");var i=document.createElementNS("http://www.w3.org/2000/svg","use");return i.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(n)),t.appendChild(i),t};function X3(e){var n=Y3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Y3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var K3=function(e){(0,Ot.Z)(t,e);var n=X3(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"onClick",(0,st.Z)(q().mark(function u(){var s;return q().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(s=i.controlOption.onExport,s!=null){h.next=5;break}h.next=10;break;case 5:return h.t0=s,h.next=8,i.getImage();case 8:h.t1=h.sent,(0,h.t0)(h.t1);case 10:case"end":return h.stop()}},u)}))),(0,R.Z)((0,pe.Z)(i),"mergeImage",(0,st.Z)(q().mark(function u(){var s,l,h,d,v,y,x,S,M,O,H,W,he,ve,Re=arguments;return q().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:for(h=i.controlOption.imageType,d=(s=(l=i.mapsService.getContainer())===null||l===void 0?void 0:l.getBoundingClientRect())!==null&&s!==void 0?s:{},v=d.width,y=v===void 0?0:v,x=d.height,S=x===void 0?0:x,M=document.createElement("canvas"),M.width=y,M.height=S,O=M.getContext("2d"),H=Re.length,W=new Array(H),he=0;he<H;he++)W[he]=Re[he];return ft.next=9,Promise.all(W.map(function(gt){return new Promise(function(Pt){var Mt=new Image;Mt.onload=function(){Pt(Mt)},Mt.src=gt})}));case 9:return ve=ft.sent,ve.forEach(function(gt){O==null||O.drawImage(gt,0,0,y,S)}),ft.abrupt("return",M.toDataURL("image/".concat(h)));case 12:case"end":return ft.stop()}},u)}))),i}return(0,at.Z)(t,[{key:"onAdd",value:function(){var r=Hn((0,be.Z)(t.prototype),"onAdd",this).call(this);return r.addEventListener("click",this.onClick),r}},{key:"getDefault",value:function(r){return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:pc("l7-icon-export-picture"),imageType:"png"})}},{key:"getImage",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u;return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.mapsService.exportMap("png");case 2:return o=l.sent,l.next=5,this.scene.exportPng("png");case 5:return u=l.sent,l.abrupt("return",this.mergeImage.apply(this,(0,L.Z)([o,u].filter(function(h){return h}))));case 7:case"end":return l.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()}]),t}(qv);function Gx(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=q3(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function q3(e,n){if(!!e){if(typeof e=="string")return Vx(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Vx(e,n)}}function Vx(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var Hx=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],dc=function(){if(typeof document=="undefined")return!1;var e=Hx[0],n={},t=Gx(Hx),i;try{for(t.s();!(i=t.n()).done;){var r=i.value,a=r==null?void 0:r[1];if(a in document){var o=Gx(r.entries()),u;try{for(o.s();!(u=o.n()).done;){var s=(0,Dr.Z)(u.value,2),l=s[0],h=s[1];n[e[l]]=h}}catch(d){o.e(d)}finally{o.f()}return n}}}catch(d){t.e(d)}finally{t.f()}return!1}(),jx={change:dc.fullscreenchange,error:dc.fullscreenerror},Eu={request:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,t=arguments.length>1?arguments[1]:void 0;return new Promise(function(i,r){var a=function u(){Eu.off("change",u),i()};Eu.on("change",a);var o=n[dc.requestFullscreen](t);o instanceof Promise&&o.then(a).catch(r)})},exit:function(){return new Promise(function(n,t){if(!Eu.isFullscreen){n();return}var i=function a(){Eu.off("change",a),n()};Eu.on("change",i);var r=document[dc.exitFullscreen]();r instanceof Promise&&r.then(i).catch(t)})},toggle:function(n,t){return Eu.isFullscreen?Eu.exit():Eu.request(n,t)},onchange:function(n){Eu.on("change",n)},onerror:function(n){Eu.on("error",n)},on:function(n,t){var i=jx[n];i&&document.addEventListener(i,t,!1)},off:function(n,t){var i=jx[n];i&&document.removeEventListener(i,t,!1)},raw:dc};Object.defineProperties(Eu,{isFullscreen:{get:function(){return Boolean(document[dc.fullscreenElement])}},element:{enumerable:!0,get:function(){var n;return(n=document[dc.fullscreenElement])!==null&&n!==void 0?n:void 0}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[dc.fullscreenEnabled])}}}),dc||(Eu={isEnabled:!1});var Ag=Eu;function Q3(e){var n=J3();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function J3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ew=function(e){(0,Ot.Z)(t,e);var n=Q3(t);function t(i){var r;return(0,ot.Z)(this,t),r=n.call(this,i),(0,R.Z)((0,pe.Z)(r),"isFullscreen",!1),(0,R.Z)((0,pe.Z)(r),"toggleFullscreen",(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!Ag.isEnabled){u.next=3;break}return u.next=3,Ag.toggle(r.mapContainer);case 3:case"end":return u.stop()}},a)}))),(0,R.Z)((0,pe.Z)(r),"onClick",function(){r.toggleFullscreen()}),(0,R.Z)((0,pe.Z)(r),"onFullscreenChange",function(){r.isFullscreen=!!document.fullscreenElement;var a=r.controlOption,o=a.btnText,u=a.btnIcon,s=a.title,l=a.exitBtnText,h=a.exitBtnIcon,d=a.exitTitle;r.isFullscreen?(r.setBtnTitle(d),r.setBtnText(l),r.setBtnIcon(h)):(r.setBtnTitle(s),r.setBtnText(o),r.setBtnIcon(u)),r.emit("fullscreenChange",r.isFullscreen)}),Ag.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316"),r}return(0,at.Z)(t,[{key:"setOptions",value:function(r){var a=r.exitBtnText,o=r.exitBtnIcon,u=r.exitTitle;this.isFullscreen&&(this.checkUpdateOption(r,["exitBtnIcon"])&&this.setBtnIcon(o),this.checkUpdateOption(r,["exitBtnText"])&&this.setBtnText(a),this.checkUpdateOption(r,["exitTitle"])&&this.setBtnTitle(u)),Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r)}},{key:"onAdd",value:function(){var r=Hn((0,be.Z)(t.prototype),"onAdd",this).call(this);return r.addEventListener("click",this.onClick),this.mapContainer=Za(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),r}},{key:"onRemove",value:function(){Hn((0,be.Z)(t.prototype),"onRemove",this).call(this),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}},{key:"getDefault",value:function(r){return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{title:"\u5168\u5C4F",btnIcon:pc("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:pc("l7-icon-exit-fullscreen")})}}]),t}(qv);function tw(e){var n=rw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function rw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nw=function(e){(0,Ot.Z)(t,e);var n=tw(t);function t(i){var r;return(0,ot.Z)(this,t),r=n.call(this,i),(0,R.Z)((0,pe.Z)(r),"getGeoLocation",function(){return new Promise(function(a,o){window.navigator.geolocation.getCurrentPosition(function(u){var s=u.coords,l=s!=null?s:{},h=l.longitude,d=l.latitude;!(0,Rr.isNaN)(h)&&!(0,Rr.isNaN)(d)?a([h,d]):o()},function(u){o(u)})})}),(0,R.Z)((0,pe.Z)(r),"onClick",(0,st.Z)(q().mark(function a(){var o,u,s;return q().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(window.navigator.geolocation){h.next=2;break}return h.abrupt("return");case 2:return o=r.controlOption.transform,h.next=5,r.getGeoLocation();case 5:if(u=h.sent,s=r.mapsService.getZoom(),h.t0=r.mapsService,h.t1=s>15?s:15,!o){h.next=15;break}return h.next=12,o(u);case 12:h.t2=h.sent,h.next=16;break;case 15:h.t2=u;case 16:h.t3=h.t2,h.t0.setZoomAndCenter.call(h.t0,h.t1,h.t3);case 18:case"end":return h.stop()}},a)}))),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D"),r}return(0,at.Z)(t,[{key:"getDefault",value:function(r){return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{title:"\u5B9A\u4F4D",btnIcon:pc("l7-icon-reposition")})}},{key:"onAdd",value:function(){var r=Hn((0,be.Z)(t.prototype),"onAdd",this).call(this);return r.addEventListener("click",this.onClick),r}}]),t}(qv);function iw(e){var n=aw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function aw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Wx=function(e){(0,Ot.Z)(t,e);var n=iw(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"onLayerChange",function(){var u;(u=i.controlOption.layers)!==null&&u!==void 0&&u.length||(i.selectValue=i.getLayerVisible(),i.setOptions({options:i.getLayerOptions()}))}),(0,R.Z)((0,pe.Z)(i),"onLayerVisibleChane",function(){i.setSelectValue(i.getLayerVisible())}),(0,R.Z)((0,pe.Z)(i),"onSelectChange",function(){i.layers.forEach(function(u){var s=i.selectValue.includes(u.name),l=u.isVisible();s&&!l&&u.show(),!s&&l&&u.hide()})}),i}return(0,at.Z)(t,[{key:"layers",get:function(){var r=this.layerService,a=this.controlOption.layers;if(Array.isArray(a)&&a.length){var o=[];return a.forEach(function(u){if(u instanceof Object&&o.push(u),typeof u=="string"){var s=r.getLayer(u)||r.getLayerByName(u);s&&o.push(s)}}),o}return r.getLayers()||[]}},{key:"getDefault",value:function(r){return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:pc("l7-icon-layer"),options:[]})}},{key:"getLayerVisible",value:function(){return this.layers.filter(function(r){return r.isVisible()}).map(function(r){return r.name})}},{key:"getLayerOptions",value:function(){return this.layers.map(function(r){return{text:r.name,value:r.name}})}},{key:"setOptions",value:function(r){var a=this.checkUpdateOption(r,["layers"]);Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r),a&&(this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}},{key:"onAdd",value:function(){var r;return(r=this.controlOption.options)!==null&&r!==void 0&&r.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),Hn((0,be.Z)(t.prototype),"onAdd",this).call(this)}},{key:"onRemove",value:function(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}},{key:"getIsMultiple",value:function(){return!0}}]),t}(zx);function ow(e){var n=uw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function uw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $x=function(e){(0,Ot.Z)(t,e);var n=ow(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getDefault",value:function(){return{position:Us.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var r=bn("div","l7-control-logo");return this.setLogoContent(r),r}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(r){Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r),this.checkUpdateOption(r,["img","href"])&&(Es(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(r){var a=this.controlOption,o=a.href,u=a.img,s=bn("img");if(s.setAttribute("src",u),s.setAttribute("aria-label","AntV logo"),As(s),o){var l=bn("a","l7-control-logo-link");l.target="_blank",l.href=o,l.rel="noopener nofollow",l.setAttribute("rel","noopener nofollow"),l.appendChild(s),r.appendChild(l)}else r.appendChild(s)}}]),t}(Kh),sw={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},lw={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};function cw(e){var n=fw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function fw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hw=function(e){(0,Ot.Z)(t,e);var n=cw(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"onMapThemeChange",function(){i.mapsService.setMapStyle(i.selectValue[0])}),i}return(0,at.Z)(t,[{key:"getDefault",value:function(r){return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:pc("l7-icon-color"),options:[]})}},{key:"getStyleOptions",value:function(){var r=this.mapsService.getType()==="mapbox"?lw:sw;return Object.entries(this.mapsService.getMapStyleConfig()).filter(function(a){var o=(0,Dr.Z)(a,2),u=o[0],s=o[1];return typeof s=="string"&&u!=="blank"}).map(function(a){var o,u=(0,Dr.Z)(a,2),s=u[0],l=u[1],h=(o=r[s])!==null&&o!==void 0?o:{},d=h.text,v=h.img;return{text:d!=null?d:s,value:l,img:v,key:s}})}},{key:"getMapStyle",value:function(){return this.mapsService.getMapStyle()}},{key:"onAdd",value:function(){var r,a=this;if((r=this.controlOption.options)!==null&&r!==void 0&&r.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var o,u,s=this.controlOption.defaultValue;this.controlOption.defaultValue=(o=(u=this.controlOption.options.find(function(h){return h.key===s}))===null||u===void 0?void 0:u.value)!==null&&o!==void 0?o:s}else{var l=this.getMapStyle();l?this.controlOption.defaultValue=l:this.mapsService.map.once("styledata",function(){var h=a.mapsService.getMapStyle();a.controlOption.defaultValue=h,a.setSelectValue(h,!1)})}return this.on("selectChange",this.onMapThemeChange),Hn((0,be.Z)(t.prototype),"onAdd",this).call(this)}},{key:"getIsMultiple",value:function(){return!1}}]),t}(zx);function pw(e){var n=dw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function dw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vw=function(e){(0,Ot.Z)(t,e);var n=pw(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"location",[0,0]),(0,R.Z)((0,pe.Z)(i),"onMouseMove",function(u){var s=i.location,l=u.lngLat||u.lnglat,h=i.controlOption.transform;l&&(s=[l.lng,l.lat]),i.location=s,h&&(s=h(s)),i.insertLocation2HTML(s),i.emit("locationChange",s)}),i}return(0,at.Z)(t,[{key:"getLocation",value:function(){return this.location}},{key:"getDefault",value:function(r){return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{position:Us.BOTTOMLEFT,transform:function(o){var u=(0,Dr.Z)(o,2),s=u[0],l=u[1];return[+(+s).toFixed(6),+(+l).toFixed(6)]}})}},{key:"onAdd",value:function(){var r=bn("div","l7-control-mouse-location");return r.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),r}},{key:"onRemove",value:function(){this.mapsService.off("mousemove",this.onMouseMove)}},{key:"insertLocation2HTML",value:function(r){this.container.innerText=r.join(", ")}}]),t}(Kh);function mw(e){var n=gw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function gw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yw=function(e){(0,Ot.Z)(t,e);var n=mw(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"update",function(){var u=i.mapsService,s=i.controlOption.maxWidth,l=u.getSize()[1]/2,h=u.containerToLngLat([0,l]),d=u.containerToLngLat([s,l]),v=Ql([h.lng,h.lat],[d.lng,d.lat]);i.updateScales(v)}),i}return(0,at.Z)(t,[{key:"getDefault",value:function(r){return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{name:"scale",position:Us.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}},{key:"onAdd",value:function(){var r="l7-control-scale",a=bn("div",r);this.resetScaleLines(a);var o=this.controlOption.updateWhenIdle;return this.mapsService.on(o?"moveend":"mapmove",this.update),this.mapsService.on(o?"zoomend":"zoomchange",this.update),a}},{key:"onRemove",value:function(){var r=this.controlOption.updateWhenIdle;this.mapsService.off(r?"zoomend":"zoomchange",this.update),this.mapsService.off(r?"moveend":"mapmove",this.update)}},{key:"setOptions",value:function(r){Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r),this.checkUpdateOption(r,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}},{key:"updateScales",value:function(r){var a=this.controlOption,o=a.metric,u=a.imperial;o&&r&&this.updateMetric(r),u&&r&&this.updateImperial(r)}},{key:"resetScaleLines",value:function(r){Es(r);var a=this.controlOption,o=a.metric,u=a.imperial,s=a.maxWidth,l=a.lockWidth;l&&Ic(r,"width: ".concat(s,"px")),o&&(this.mScale=bn("div","l7-control-scale-line",r)),u&&(this.iScale=bn("div","l7-control-scale-line",r)),this.update()}},{key:"updateScale",value:function(r,a,o){var u=this.controlOption.maxWidth;r.style.width=Math.round(u*o)+"px",r.innerHTML=a}},{key:"getRoundNum",value:function(r){var a=Math.pow(10,(Math.floor(r)+"").length-1),o=r/a;return o=o>=10?10:o>=5?5:o>=3?3:o>=2?2:1,a*o}},{key:"updateMetric",value:function(r){var a=this.getRoundNum(r),o=a<1e3?a+" m":a/1e3+" km";this.updateScale(this.mScale,o,a/r)}},{key:"updateImperial",value:function(r){var a=r*3.2808399,o,u,s;a>5280?(o=a/5280,u=this.getRoundNum(o),this.updateScale(this.iScale,u+" mi",u/o)):(s=this.getRoundNum(a),this.updateScale(this.iScale,s+" ft",s/a))}}]),t}(Kh);function _w(e){var n=xw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function xw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Sw=function(e){(0,Ot.Z)(t,e);var n=_w(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"zoomIn",function(){!i.disabled&&i.mapsService.getZoom()<i.mapsService.getMaxZoom()&&i.mapsService.zoomIn()}),(0,R.Z)((0,pe.Z)(i),"zoomOut",function(){!i.disabled&&i.mapsService.getZoom()>i.mapsService.getMinZoom()&&i.mapsService.zoomOut()}),(0,R.Z)((0,pe.Z)(i),"updateDisabled",function(){var u=i.mapsService;i.zoomInButton.removeAttribute("disabled"),i.zoomOutButton.removeAttribute("disabled"),(i.disabled||u.getZoom()<=u.getMinZoom())&&i.zoomOutButton.setAttribute("disabled","true"),(i.disabled||u.getZoom()>=u.getMaxZoom())&&i.zoomInButton.setAttribute("disabled","true")}),i}return(0,at.Z)(t,[{key:"getDefault",value:function(r){return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{position:Us.BOTTOMRIGHT,name:"zoom",zoomInText:pc("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:pc("l7-icon-narrow"),zoomOutTitle:"Zoom out"})}},{key:"setOptions",value:function(r){Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r),this.checkUpdateOption(r,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle"])&&this.resetButtonGroup(this.container)}},{key:"onAdd",value:function(){var r=bn("div","l7-control-zoom");return this.resetButtonGroup(r),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),r}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"resetButtonGroup",value:function(r){Es(r),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",r,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",r,this.zoomOut),this.updateDisabled()}},{key:"createButton",value:function(r,a,o,u,s){var l=bn("button",o,u);return typeof r=="string"?l.innerHTML=r:l.append(r),l.title=a,l.addEventListener("click",s),l}}]),t}(Kh);function bw(e){var n=Ew();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Ew(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Tg=function(e){(0,Ot.Z)(t,e);var n=bw(t);function t(i){var r;(0,ot.Z)(this,t),r=n.call(this),(0,R.Z)((0,pe.Z)(r),"isShow",!0),(0,R.Z)((0,pe.Z)(r),"onMouseMove",function(o){var u,s=r.mapsService.getMapContainer(),l=(u=s==null?void 0:s.getBoundingClientRect())!==null&&u!==void 0?u:{},h=l.left,d=h===void 0?0:h,v=l.top,y=v===void 0?0:v;r.setPopupPosition(o.clientX-d,o.clientY-y)}),(0,R.Z)((0,pe.Z)(r),"updateLngLatPosition",function(){if(!(!r.mapsService||r.popupOption.followCursor)){var o=r.lngLat,u=o.lng,s=o.lat,l=r.mapsService.lngLatToContainer([u,s]),h=l.x,d=l.y;r.setPopupPosition(h,d)}}),(0,R.Z)((0,pe.Z)(r),"onKeyDown",function(o){o.keyCode===27&&r.remove()}),(0,R.Z)((0,pe.Z)(r),"onCloseButtonClick",function(o){o.stopPropagation&&o.stopPropagation(),r.hide()}),(0,R.Z)((0,pe.Z)(r),"update",function(){var o=!!r.lngLat,u=r.popupOption,s=u.className,l=u.style,h=u.maxWidth,d=u.anchor,v=u.stopPropagation;if(!(!r.mapsService||!o||!r.content)){var y=r.mapsService.getMarkerContainer();if(!r.container&&y&&(r.container=bn("div","l7-popup ".concat(s!=null?s:""," ").concat(r.isShow?"":"l7-popup-hide"),y),l&&r.container.setAttribute("style",l),r.tip=bn("div","l7-popup-tip",r.container),r.container.appendChild(r.content),v&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(M){r.container.addEventListener(M,function(O){O.stopPropagation()})}),r.container.style.whiteSpace="nowrap"),r.updateLngLatPosition(),$l(r.container,"".concat(da[d])),On(r.container,d,"popup"),h){var x=r.container.getBoundingClientRect(),S=x.width;S>parseFloat(h)&&(r.container.style.width=h)}else r.container.style.removeProperty("width")}}),r.popupOption=(0,b.Z)((0,b.Z)({},r.getDefault(i!=null?i:{})),i);var a=r.popupOption.lngLat;return a&&(r.lngLat=a),r}return(0,at.Z)(t,[{key:"lngLat",get:function(){var r;return(r=this.popupOption.lngLat)!==null&&r!==void 0?r:{lng:0,lat:0}},set:function(r){this.popupOption.lngLat=r}},{key:"getIsShow",value:function(){return this.isShow}},{key:"addTo",value:function(r){this.mapsService=r.get(qe.IMapService),this.sceneService=r.get(qe.ISceneService),this.layerService=r.get(qe.ILayerService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=r,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();var a=this.popupOption,o=a.html,u=a.text,s=a.title;return o?this.setHTML(o):u&&this.setText(u),s&&this.setTitle(s),this.emit("open"),this}},{key:"remove",value:function(){if(!!(this!==null&&this!==void 0&&this.isOpen()))return this.content&&va(this.content),this.container&&(va(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}},{key:"getOptions",value:function(){return this.popupOption}},{key:"setOptions",value:function(r){return this.show(),this.popupOption=(0,b.Z)((0,b.Z)({},this.popupOption),r),this.checkUpdateOption(r,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","className","style","lngLat","offsets"])&&(this.container&&(va(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(r,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(r,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(r,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(r,["html"])&&r.html?this.setHTML(r.html):this.checkUpdateOption(r,["text"])&&r.text&&this.setText(r.text),this.checkUpdateOption(r,["lngLat"])&&r.lngLat&&this.setLnglat(r.lngLat),this}},{key:"open",value:function(){return this.addTo(this.scene),this}},{key:"close",value:function(){return this.remove(),this}},{key:"show",value:function(){if(!this.isShow)return this.container&&tu(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}},{key:"hide",value:function(){if(!!this.isShow)return this.container&&ei(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}},{key:"setHTML",value:function(r){return this.popupOption.html=r,this.setDOMContent(r)}},{key:"setText",value:function(r){return this.popupOption.text=r,this.setDOMContent(window.document.createTextNode(r))}},{key:"setTitle",value:function(r){this.show(),this.popupOption.title=r,r?(this.contentTitle||(this.contentTitle=bn("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),Es(this.contentTitle),Hu(this.contentTitle,r)):this.contentTitle&&(va(this.contentTitle),this.contentTitle=void 0)}},{key:"panToPopup",value:function(){var r=this.lngLat,a=r.lng,o=r.lat;return this.popupOption.autoPan&&this.mapsService.panTo([a,o]),this}},{key:"setLngLat",value:function(r){return this.setLnglat(r)}},{key:"setLnglat",value:function(r){var a=this;return this.show(),this.lngLat=r,Array.isArray(r)&&(this.lngLat={lng:r[0],lat:r[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(function(){a.panToPopup()},0),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setMaxWidth",value:function(r){return this.popupOption.maxWidth=r,this.update(),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"getDefault",value:function(r){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:Vu.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}},{key:"setDOMContent",value:function(r){return this.show(),this.createContent(),Hu(this.contentPanel,r),this.update(),this}},{key:"updateCloseOnClick",value:function(r){var a=this,o=this.mapsService;o&&(o==null||o.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!r&&requestAnimationFrame(function(){o==null||o.on("click",a.onCloseButtonClick)}))}},{key:"updateCloseOnEsc",value:function(r){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!r&&window.addEventListener("keydown",this.onKeyDown)}},{key:"updateFollowCursor",value:function(r){var a,o=(a=this.mapsService)===null||a===void 0?void 0:a.getContainer();o&&(o==null||o.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!r&&(o==null||o.addEventListener("mousemove",this.onMouseMove)))}},{key:"createContent",value:function(){var r=this;if(this.content&&va(this.content),this.contentTitle=void 0,this.content=bn("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){var a=pc("l7-icon-guanbi");ei(a,"l7-popup-close-button"),this.content.appendChild(a),this.popupOption.closeButtonOffsets&&(a.style.right=this.popupOption.closeButtonOffsets[0]+"px",a.style.top=this.popupOption.closeButtonOffsets[1]+"px"),a.setAttribute("aria-label","Close popup"),a.addEventListener("click",function(){r.hide()}),this.closeButton=a}else this.closeButton=void 0;this.contentPanel=bn("div","l7-popup-content__panel",this.content)}},{key:"setPopupPosition",value:function(r,a){if(this.container){var o=this.popupOption.offsets;this.container.style.left=r+o[0]+"px",this.container.style.top=a-o[1]+"px"}}},{key:"checkUpdateOption",value:function(r,a){return a.some(function(o){return o in r})}}]),t}(Wi.EventEmitter);function Aw(e){var n=Tw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Tw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var EF=function(e){(0,Ot.Z)(t,e);var n=Aw(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"layerConfigMap",new WeakMap),i}return(0,at.Z)(t,[{key:"layerConfigItems",get:function(){var r,a=this.popupOption,o=a.config,u=a.items;return(r=o!=null?o:u)!==null&&r!==void 0?r:[]}},{key:"addTo",value:function(r){return Hn((0,be.Z)(t.prototype),"addTo",this).call(this,r),this.bindLayerEvent(),this.hide(),this}},{key:"remove",value:function(){return Hn((0,be.Z)(t.prototype),"remove",this).call(this),this.unbindLayerEvent(),this}},{key:"setOptions",value:function(r){return this.unbindLayerEvent(),Hn((0,be.Z)(t.prototype),"setOptions",this).call(this,r),this.bindLayerEvent(),this}},{key:"getDefault",value:function(r){var a=r.trigger==="click";return(0,b.Z)((0,b.Z)({},Hn((0,be.Z)(t.prototype),"getDefault",this).call(this,r)),{},{trigger:"hover",followCursor:!a,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!1,autoClose:!1,closeOnEsc:!1})}},{key:"bindLayerEvent",value:function(){var r=this,a=this.popupOption.trigger;this.layerConfigItems.forEach(function(o){var u,s=r.getLayerByConfig(o);if(!!s){var l=(0,b.Z)({},o);if(a==="hover"){var h=r.onLayerMouseMove.bind(r,s),d=r.onLayerMouseOut.bind(r,s);l.onMouseMove=h,l.onMouseOut=d,s==null||s.on("mousemove",h),s==null||s.on("mouseout",d)}else{var v=r.onLayerClick.bind(r,s);l.onClick=v,s==null||s.on("click",v)}var y=s==null||(u=s.getSource)===null||u===void 0?void 0:u.call(s),x=r.onSourceUpdate.bind(r,s);y==null||y.on("update",x),l.onSourceUpdate=x,r.layerConfigMap.set(s,l)}})}},{key:"unbindLayerEvent",value:function(){var r=this;this.layerConfigItems.forEach(function(a){var o=r.getLayerByConfig(a),u=o&&r.layerConfigMap.get(o);if(!!u){var s=u.onMouseMove,l=u.onMouseOut,h=u.onClick,d=u.onSourceUpdate;if(s&&o.off("mousemove",s),l&&o.off("mouseout",l),h&&o.off("click",h),d){var v;o==null||(v=o.getSource())===null||v===void 0||v.off("update",d)}}})}},{key:"onLayerMouseMove",value:function(r,a){if(!this.isSameFeature(r,a.featureId)){var o=this.getLayerInfoFrag(r,a),u=o.title,s=o.content;this.setDOMContent(s),this.setTitle(u),this.displayFeatureInfo={layer:r,featureId:a.featureId},this.show()}}},{key:"onLayerMouseOut",value:function(r,a){this.displayFeatureInfo=void 0,this.isShow&&this.hide()}},{key:"onLayerClick",value:function(r,a){if(this.isShow&&this.isSameFeature(r,a.featureId))this.hide();else{var o=this.getLayerInfoFrag(r,a),u=o.title,s=o.content;this.setDOMContent(s),this.setLnglat(a.lngLat),this.setTitle(u),this.displayFeatureInfo={layer:r,featureId:a.featureId},this.show()}}},{key:"onSourceUpdate",value:function(r){this.hide(),this.displayFeatureInfo=void 0}},{key:"getLayerInfoFrag",value:function(r,a){var o=this.layerConfigMap.get(r),u,s=document.createDocumentFragment();if(o){var l=a.feature;l.type==="Feature"&&"properties"in l&&"geometry"in l&&(l=l.properties);var h=o.title,d=o.fields,v=o.customContent;if(h){u=document.createDocumentFragment();var y=h instanceof Function?h(l):h;Hu(u,y)}if(v){var x=v instanceof Function?v(l):v;Hu(s,x)}else d!=null&&d.length&&(d==null||d.forEach(function(S){var M,O,H=typeof S=="string"?{field:S}:S,W=H.field,he=H.formatField,ve=H.formatValue,Re=H.getValue,ze=bn("div","l7-layer-popup__row"),ft=Re?Re(a.feature):(0,Rr.get)(l,W),gt=(M=he instanceof Function?he(W,l):he)!==null&&M!==void 0?M:W,Pt=(O=ve instanceof Function?ve(ft,l):ve)!==null&&O!==void 0?O:ft,Mt=bn("span","l7-layer-popup__key",ze);Hu(Mt,gt),Hu(Mt,document.createTextNode("\uFF1A"));var sr=bn("span","l7-layer-popup__value",ze);Array.isArray(Pt)&&Pt.every(function(xr){return!(xr instanceof Object)})&&(Pt=Pt.map(function(xr){return String(xr)}).join(",")),Hu(sr,Pt),s.appendChild(ze)}))}return{title:u,content:s}}},{key:"getLayerByConfig",value:function(r){var a=r.layer;if(a instanceof Object)return a;if(typeof a=="string")return this.layerService.getLayer(a)||this.layerService.getLayerByName(a)}},{key:"isSameFeature",value:function(r,a){var o=this.displayFeatureInfo;return o&&r===o.layer&&a===o.featureId}}]),t}(Tg);function Cw(e,n){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,i=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||i)&&(n||(n=document),!!n)){var r=n.head||n.getElementsByTagName("head")[0];if(!r){r=n.createElement("head");var a=n.body||n.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(r,a):n.documentElement.appendChild(r)}var o=n.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(n.createTextNode(e)),r.appendChild(o),o}}Cw(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 800;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  height: 24px;
  line-height: 24px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 16px;
  font-size: 12px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  height: 14px;
  width: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  padding: 12px 12px 0 12px;
  width: 474px;
  height: 320px;
  overflow: auto;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-select-control--image .l7-select-control-item {
  margin-right: 12px;
  border-radius: 2px;
  overflow: hidden;
  border: 1px solid #fff;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: calc((100% - 36px) / 3);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  margin-bottom: 12px;
  position: relative;
  font-size: 12px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 142px;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  right: 0;
  top: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control--image .l7-select-control-item:nth-child(3n) {
  margin-right: 0;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  overflow: hidden;
}
.l7-control-zoom .l7-button-control {
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
  border-radius: 0;
  font-size: 16px;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:first-child {
  border-bottom: 1px solid #f0f0f0;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var sf,Xx=(sf={},(0,R.Z)(sf,Qu.additive,{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE,srcAlpha:1,dstAlpha:1}}),(0,R.Z)(sf,Qu.none,{enable:!1}),(0,R.Z)(sf,Qu.normal,{enable:!0,func:{srcRGB:N.SRC_ALPHA,dstRGB:N.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,R.Z)(sf,Qu.subtractive,{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE,srcAlpha:N.ZERO,dstAlpha:N.ONE_MINUS_SRC_COLOR},equation:{rgb:N.FUNC_SUBTRACT,alpha:N.FUNC_SUBTRACT}}),(0,R.Z)(sf,Qu.max,{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE},equation:{rgb:N.MAX_EXT}}),(0,R.Z)(sf,Qu.min,{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE},equation:{rgb:N.MIN_EXT}}),sf),Au;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFUALT="DEFUALTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL"})(Au||(Au={}));function ww(e,n){var t=[n[0]-e[0],n[1]-e[1]],i=Ff(t),r=[e[0]+i[0]*1e-4,e[1]+i[1]*1e-4];return r}function Mw(e,n,t){if(e.length>0&&n.version===Au["GAODE2.x"]){var i=t.coordCenter;typeof e[0].coordinates[0]=="number"?e.filter(function(r){return!r.originCoordinates}).map(function(r){r.version=Au["GAODE2.x"],r.originCoordinates=(0,Rr.cloneDeep)(r.coordinates),r.coordinates=n.coordToAMap2RelativeCoordinates(r.coordinates,i)}):e.filter(function(r){return!r.originCoordinates}).map(function(r){r.version=Au["GAODE2.x"],r.originCoordinates=(0,Rr.cloneDeep)(r.coordinates),r.coordinates=n.coordToAMap2RelativeCoordinates(r.coordinates,i)})}}function Rw(e,n){e.length>0&&n.version===Au.SIMPLE&&e.map(function(t){t.simpleCoordinate||(t.coordinates=Lw(t.coordinates,n),t.simpleCoordinate=!0)})}function Lw(e,n){if(typeof e[0]=="number")return n.simpleMapCoord.unproject(e);if(e[0]&&e[0][0]instanceof Array){var t=[];return e.map(function(r){var a=[];r.map(function(o){a.push(n.simpleMapCoord.unproject(o))}),t.push(a)}),t}else{var i=[];return e.map(function(r){i.push(n.simpleMapCoord.unproject(r))}),i}}function Pw(e,n){var t;if(!e.scale)return[];var i=(e==null||(t=e.scale)===null||t===void 0?void 0:t.scalers)||[],r=[];i.forEach(function(o){var u,s=o.field;(n.hasOwnProperty(s)||((u=e.scale)===null||u===void 0?void 0:u.type)==="variable")&&r.push(n[s])});var a=e.mapping?e.mapping(r):[];return a}function Iw(e,n,t,i,r){var a=r==null?void 0:r.getLayerConfig(),o=a.arrow,u=o===void 0?{enable:!1}:o,s=n.map(function(l){var h={id:l._id,coordinates:l.coordinates};if(e.filter(function(y){return y.scale!==void 0}).forEach(function(y){var x=Pw(y,l);y.needRemapping=!1,y.name==="color"&&(x=x.map(function(S){return wn(S)})),h[y.name]=Array.isArray(x)&&x.length===1?x[0]:x,y.name==="shape"&&(h.shape=t.getIconFontKey(h[y.name]))}),h.shape==="line"&&u.enable){var d=h.coordinates,v=ww(d[0],d[1]);h.coordinates.splice(1,0,v,v)}return h});return Mw(s,i,r),Rw(s,i),s}function Ow(e,n,t,i,r,a){var o=new Eg(r,a),u=i.getLayerStyleAttributes()||[],s=o.data.dataArray,l=s,h=Iw(u,l,n,t,e);return o.destroy(),h}function Yx(e){return e.map(function(n){return typeof n=="string"&&(n=[n,{}]),n})}function Kx(e,n,t,i){var r=e.multiPassRenderer,a=e.getLayerConfig(),o=a.enableTAA;return o?r.add(i("taa")):r.add(i("render")),Yx(n).forEach(function(u){var s=(0,Dr.Z)(u,2),l=s[0],h=s[1];r.add(t(l),h)}),r.add(t("copy")),r}var kw=function(){function e(n){(0,ot.Z)(this,e),this.layer=n}return(0,at.Z)(e,[{key:"pickRender",value:function(t){var i=this.layer.getContainer(),r=i.get(qe.ILayerService),a=this.layer;if(a.tileLayer)return a.tileLayer.pickRender(t);a.hooks.beforePickingEncode.call(),r.renderTileLayerMask(a),a.renderModels({ispick:!0}),a.hooks.afterPickingEncode.call()}},{key:"pick",value:function(t,i){var r=this.layer.getContainer(),a=r.get(qe.IPickingService);return t.type==="RasterLayer"?this.pickRasterLayer(t,i):(this.pickRender(i),a.pickFromPickingFBO(t,i))}},{key:"pickRasterLayer",value:function(t,i,r){var a=this.layer.getContainer(),o=a.get(qe.IPickingService),u=a.get(qe.IMapService),s=this.layer.getSource().extent,l=Ts(i.lngLat,s),h={x:i.x,y:i.y,type:i.type,lngLat:i.lngLat,target:i,rasterValue:null},d=r||t;if(l){var v=this.readRasterValue(t,s,u,i.x,i.y);return h.rasterValue=v,o.triggerHoverOnLayer(d,h),!0}else return h.type=i.type==="mousemove"?"mouseout":"un"+i.type,o.triggerHoverOnLayer(d,(0,b.Z)((0,b.Z)({},h),{},{type:"unpick"})),o.triggerHoverOnLayer(d,h),!1}},{key:"readRasterValue",value:function(t,i,r,a,o){var u=t.getSource().data.dataArray[0],s=(0,Dr.Z)(i,4),l=s[0],h=l===void 0?0:l,d=s[1],v=d===void 0?0:d,y=s[2],x=y===void 0?10:y,S=s[3],M=S===void 0?-10:S,O=r.lngLatToContainer([h,v]),H=r.lngLatToContainer([x,M]),W=H.x-O.x,he=O.y-H.y,ve=[(a-O.x)/W,(o-H.y)/he],Re=u.width||1,ze=u.height||1,ft=Math.floor(ve[0]*Re),gt=Math.floor(ve[1]*ze),Pt=Math.max(0,gt-1)*Re+ft,Mt=u.data[Pt];return Mt}},{key:"selectFeature",value:function(t){var i=this.layer,r=(0,Dr.Z)(t,3),a=r[0],o=r[1],u=r[2];i.hooks.beforeSelect.call([a,o,u])}},{key:"highlightPickedFeature",value:function(t){var i=(0,Dr.Z)(t,3),r=i[0],a=i[1],o=i[2];this.layer.hooks.beforeHighlight.call([r,a,o])}},{key:"getFeatureById",value:function(t){return this.layer.getSource().getFeatureById(t)}}]),e}(),Fw=function(){function e(n){(0,ot.Z)(this,e),this.layer=n;var t=this.layer.getContainer();this.rendererService=t.get(qe.IRendererService)}return(0,at.Z)(e,[{key:"getColorTexture",value:function(t,i){var r=this.getTextureKey(t,i);return this.key===r?this.colorTexture:(this.createColorTexture(t,i),this.key=r,this.colorTexture)}},{key:"createColorTexture",value:function(t,i){var r=this.rendererService.createTexture2D,a=this.getColorRampBar(t,i),o=r({data:new Uint8Array(a.data),width:a.width,height:a.height,flipY:!1});return this.colorTexture=o,o}},{key:"setColorTexture",value:function(t,i,r){this.key=this.getTextureKey(i,r),this.colorTexture=t}},{key:"destroy",value:function(){var t;(t=this.colorTexture)===null||t===void 0||t.destroy()}},{key:"getColorRampBar",value:function(t,i){switch(t.type){case"cat":return Hl(t);case"quantize":return vu(t);case"custom":return ol(t,i);case"linear":return Th(t,i);default:return Rf(t)}}},{key:"getTextureKey",value:function(t,i){var r;return"".concat(t.colors.join("_"),"_").concat(t==null||(r=t.positions)===null||r===void 0?void 0:r.join("_"),"_").concat(t.type,"_").concat(i==null?void 0:i.join("_"))}}]),e}(),Nw=["passes"],Dw=["moduleName","vertexShader","fragmentShader","inject","triangulation","segmentNumber"],qx,Cg,Qx;function Bw(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Zw(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function Zw(e,n){if(!!e){if(typeof e=="string")return Jx(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Jx(e,n)}}function Jx(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function Uw(e){var n=zw();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function zw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eS=0,lf=(qx=xg(qe.IGlobalConfigService),Cg=function(e){(0,Ot.Z)(t,e);var n=Uw(t);function t(){var i,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,ot.Z)(this,t),i=n.call(this),(0,R.Z)((0,pe.Z)(i),"id","".concat(eS++)),(0,R.Z)((0,pe.Z)(i),"name","".concat(eS)),(0,R.Z)((0,pe.Z)(i),"visible",!0),(0,R.Z)((0,pe.Z)(i),"zIndex",0),(0,R.Z)((0,pe.Z)(i),"inited",!1),(0,R.Z)((0,pe.Z)(i),"layerModelNeedUpdate",!1),(0,R.Z)((0,pe.Z)(i),"pickedFeatureID",null),(0,R.Z)((0,pe.Z)(i),"selectedFeatureID",null),(0,R.Z)((0,pe.Z)(i),"styleNeedUpdate",!1),(0,R.Z)((0,pe.Z)(i),"forceRender",!1),(0,R.Z)((0,pe.Z)(i),"clusterZoom",0),(0,R.Z)((0,pe.Z)(i),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,R.Z)((0,pe.Z)(i),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,R.Z)((0,pe.Z)(i),"hooks",{init:new KA,afterInit:new K_,beforeRender:new K_,beforeRenderData:new qA,afterRender:new Al,beforePickingEncode:new Al,afterPickingEncode:new Al,beforeHighlight:new Al(["pickedColor"]),afterHighlight:new Al,beforeSelect:new Al(["pickedColor"]),afterSelect:new Al,beforeDestroy:new Al,afterDestroy:new Al}),(0,R.Z)((0,pe.Z)(i),"models",[]),(0,R.Z)((0,pe.Z)(i),"startInit",!1),(0,R.Z)((0,pe.Z)(i),"layerChildren",[]),(0,R.Z)((0,pe.Z)(i),"masks",[]),En((0,pe.Z)(i),"configService",Qx,(0,pe.Z)(i)),(0,R.Z)((0,pe.Z)(i),"animateOptions",{enable:!1}),(0,R.Z)((0,pe.Z)(i),"currentPickId",null),(0,R.Z)((0,pe.Z)(i),"encodeStyleAttribute",{}),(0,R.Z)((0,pe.Z)(i),"enableEncodeStyles",[]),(0,R.Z)((0,pe.Z)(i),"pendingStyleAttributes",[]),(0,R.Z)((0,pe.Z)(i),"scaleOptions",{}),(0,R.Z)((0,pe.Z)(i),"animateStatus",!1),(0,R.Z)((0,pe.Z)(i),"isDestroyed",!1),(0,R.Z)((0,pe.Z)(i),"encodeDataLength",0),(0,R.Z)((0,pe.Z)(i),"sourceEvent",function(){i.dataState.dataSourceNeedUpdate=!0;var a=i.getLayerConfig();a&&a.autoFit&&i.fitBounds(a.fitBoundsOptions);var o=i.layerSource.getSourceCfg().autoRender;o&&i.reRender()}),i.name=r.name||i.id,i.zIndex=r.zIndex||0,i.rawConfig=r,i}return(0,at.Z)(t,[{key:"addMask",value:function(r){this.masks.push(r),this.enableMask()}},{key:"removeMask",value:function(r){var a=this.masks.indexOf(r);a>-1&&this.masks.splice(a,1)}},{key:"disableMask",value:function(){this.updateLayerConfig({enableMask:!1})}},{key:"enableMask",value:function(){this.updateLayerConfig({enableMask:!0})}},{key:"addMaskLayer",value:function(r){this.masks.push(r)}},{key:"removeMaskLayer",value:function(r){var a=this.masks.indexOf(r);a>-1&&this.masks.splice(a,1),r.destroy()}},{key:"getAttribute",value:function(r){return this.styleAttributeService.getLayerStyleAttribute(r)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(r){var a=this;if(Object.keys(r).map(function(u){u in a.rawConfig&&(a.rawConfig[u]=r[u])}),!this.startInit)this.needUpdateConfig=(0,b.Z)((0,b.Z)({},this.needUpdateConfig),r);else{var o=this.container.get(qe.SceneID);this.configService.setLayerConfig(o,this.id,(0,b.Z)((0,b.Z)((0,b.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),r)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(r,a){this.container=r,this.sceneContainer=a}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(r){return this.plugins.push(r),this}},{key:"init",value:function(){var i=(0,st.Z)(q().mark(function a(){var o=this,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:u=this.container.get(qe.SceneID),this.startInit=!0,this.configService.setLayerConfig(u,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(qe.IIconService),this.fontService=this.container.get(qe.IFontService),this.rendererService=this.container.get(qe.IRendererService),this.layerService=this.container.get(qe.ILayerService),this.debugService=this.container.get(qe.IDebugService),this.interactionService=this.container.get(qe.IInteractionService),this.pickingService=this.container.get(qe.IPickingService),this.mapService=this.container.get(qe.IMapService),s=this.getLayerConfig(),l=s.enableMultiPassRenderer,h=s.passes,l&&h!==null&&h!==void 0&&h.length&&h.length>0&&this.mapService.on("mapAfterFrameChange",function(){o.renderLayers()}),this.cameraService=this.container.get(qe.ICameraService),this.coordinateService=this.container.get(qe.ICoordinateSystemService),this.shaderModuleService=this.container.get(qe.IShaderModuleService),this.postProcessingPassFactory=this.container.get(qe.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(qe.IFactoryNormalPass),this.styleAttributeService=this.container.get(qe.IStyleAttributeService),l&&(this.multiPassRenderer=this.container.get(qe.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(M){var O=M.attributeName,H=M.attributeField,W=M.attributeValues,he=M.updateOptions;o.styleAttributeService.updateStyleAttribute(O,{scale:(0,b.Z)({field:H},o.splitValuesAndCallbackInAttribute(W,o.getLayerConfig()[O]))},he)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(qe.ILayerPlugin),d=Bw(this.plugins);try{for(d.s();!(v=d.n()).done;)y=v.value,y.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(M){d.e(M)}finally{d.f()}return this.layerPickService=new kw(this),this.textureService=new Fw(this),this.log(ca.LayerInitStart),S.next=31,this.hooks.init.promise();case 31:this.log(ca.LayerInitEnd),this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 36:case"end":return S.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"log",value:function(r){var a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"init";if(!(this.tileLayer||this.isTileLayer)){var u="".concat(this.id,".").concat(o,".").concat(r),s={id:this.id,type:this.type};(a=this.debugService)===null||a===void 0||a.log(u,s)}}},{key:"updateModelData",value:function(r){r.attributes&&r.elements?this.models.map(function(a){a.updateAttributesAndElements(r.attributes,r.elements)}):console.warn("data error")}},{key:"createModelData",value:function(r,a){var o;if((o=this.layerModel)!==null&&o!==void 0&&o.createModelData)return this.layerModel.createModelData(a);var u=this.calculateEncodeData(r,a),s=this.triangulation;return u&&s?this.styleAttributeService.createAttributesAndIndices(u,s):{attributes:void 0,elements:void 0}}},{key:"setLayerPickService",value:function(r){this.layerPickService=r}},{key:"calculateEncodeData",value:function(r,a){return this.inited?Ow(this,this.fontService,this.mapService,this.styleAttributeService,r,a):(console.warn("layer not inited!"),null)}},{key:"prepareBuildModel",value:function(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});var r=this.getLayerConfig(),a=r.animateOption;a!=null&&a.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(r,a,o){return this.updateStyleAttribute("color",r,a,o),this}},{key:"texture",value:function(r,a,o){return this.updateStyleAttribute("texture",r,a,o),this}},{key:"rotate",value:function(r,a,o){return this.updateStyleAttribute("rotate",r,a,o),this}},{key:"size",value:function(r,a,o){return this.updateStyleAttribute("size",r,a,o),this}},{key:"filter",value:function(r,a,o){var u=this.updateStyleAttribute("filter",r,a,o);return this.dataState.dataSourceNeedUpdate=u&&this.inited,this}},{key:"shape",value:function(r,a,o){this.shapeOption={field:r,values:a};var u=this.updateStyleAttribute("shape",r,a,o);return this.dataState.dataSourceNeedUpdate=u&&this.inited,this}},{key:"label",value:function(r,a,o){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:r,attributeValues:a,updateOptions:o}),this}},{key:"animate",value:function(r){var a={};return(0,Rr.isObject)(r)?(a.enable=!0,a=(0,b.Z)((0,b.Z)({},a),r)):a.enable=r,this.updateLayerConfig({animateOption:a}),this}},{key:"source",value:function(r,a){return(r==null?void 0:r.type)==="source"?(this.setSource(r),this):(this.sourceOption={data:r,options:a},this.clusterZoom=0,this)}},{key:"setData",value:function(r,a){var o=this;return this.inited?(this.log(ca.SourceInitStart,$n.UPDATE),this.layerSource.setData(r,a),this.log(ca.SourceInitEnd,$n.UPDATE)):this.on("inited",function(){o.log(ca.SourceInitStart,$n.UPDATE);var u=o.getSource();u?o.layerSource.setData(r,a):o.source(new Eg(r,a)),o.layerSource.once("update",function(){o.log(ca.SourceInitEnd,$n.UPDATE)})}),this}},{key:"style",value:function(r){var a=this,o=r.passes,u=(0,es.Z)(r,Nw);o&&Yx(o).forEach(function(l){var h=a.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(l[0]);h&&h.updateOptions(l[1])});var s=u;return Object.keys(u).forEach(function(l){var h=u[l];Array.isArray(h)&&h.length===2&&!(0,Rr.isNumber)(h[0])&&!(0,Rr.isNumber)(h[1])&&(s[l]={field:h[0],value:h[1]})}),this.encodeStyle(s),this.updateLayerConfig(s),this}},{key:"encodeStyle",value:function(r){var a=this;Object.keys(r).forEach(function(o){a.enableEncodeStyles.includes(o)&&(0,Rr.isPlainObject)(r[o])&&(r[o].field||r[o].value)&&!(0,Rr.isEqual)(a.encodeStyleAttribute[o],r[o])?(a.encodeStyleAttribute[o]=r[o],a.updateStyleAttribute(o,r[o].field,r[o].value),a.styleNeedUpdate=!0):a.encodeStyleAttribute[o]&&delete a.encodeStyleAttribute[o]})}},{key:"scale",value:function(r,a){var o=(0,b.Z)({},this.scaleOptions);if((0,Rr.isObject)(r)?this.scaleOptions=(0,b.Z)((0,b.Z)({},this.scaleOptions),r):this.scaleOptions[r]=a,this.styleAttributeService&&!(0,Rr.isEqual)(o,this.scaleOptions)){var u=(0,Rr.isObject)(r)?r:(0,R.Z)({},r,a);this.styleAttributeService.updateScaleAttribute(u)}return this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}},{key:"render",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(r),this))}},{key:"renderMultiPass",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){u.next=2;break}return u.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){u.next=7;break}return u.next=5,this.multiPassRenderer.render();case 5:u.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"active",value:function(r){var a={};return a.enableHighlight=(0,Rr.isObject)(r)?!0:r,(0,Rr.isObject)(r)?(a.enableHighlight=!0,r.color&&(a.highlightColor=r.color),r.mix&&(a.activeMix=r.mix)):a.enableHighlight=!!r,this.updateLayerConfig(a),this}},{key:"setActive",value:function(r,a){var o=this;if((0,Rr.isObject)(r)){var u=r.x,s=u===void 0?0:u,l=r.y,h=l===void 0?0:l;this.updateLayerConfig({highlightColor:(0,Rr.isObject)(a)?a.color:this.getLayerConfig().highlightColor,activeMix:(0,Rr.isObject)(a)?a.mix:this.getLayerConfig().activeMix}),this.pick({x:s,y:h})}else this.updateLayerConfig({pickedFeatureID:r,highlightColor:(0,Rr.isObject)(a)?a.color:this.getLayerConfig().highlightColor,activeMix:(0,Rr.isObject)(a)?a.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(Eo(r)).then(function(){setTimeout(function(){o.reRender()},1)})}},{key:"select",value:function(r){var a={};return a.enableSelect=(0,Rr.isObject)(r)?!0:r,(0,Rr.isObject)(r)?(a.enableSelect=!0,r.color&&(a.selectColor=r.color),r.mix&&(a.selectMix=r.mix)):a.enableSelect=!!r,this.updateLayerConfig(a),this}},{key:"setSelect",value:function(r,a){var o=this;if((0,Rr.isObject)(r)){var u=r.x,s=u===void 0?0:u,l=r.y,h=l===void 0?0:l;this.updateLayerConfig({selectColor:(0,Rr.isObject)(a)?a.color:this.getLayerConfig().selectColor,selectMix:(0,Rr.isObject)(a)?a.mix:this.getLayerConfig().selectMix}),this.pick({x:s,y:h})}else this.updateLayerConfig({pickedFeatureID:r,selectColor:(0,Rr.isObject)(a)?a.color:this.getLayerConfig().selectColor,selectMix:(0,Rr.isObject)(a)?a.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(Eo(r)).then(function(){setTimeout(function(){o.reRender()},1)})}},{key:"setBlend",value:function(r){return this.updateLayerConfig({blend:r}),this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(r){return this.zIndex=r,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(r){this.currentPickId=r}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(r){this.selectedFeatureID=r}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var r=this.mapService.getZoom(),a=this.getLayerConfig(),o=a.visible,u=a.minZoom,s=u===void 0?-Infinity:u,l=a.maxZoom,h=l===void 0?Infinity:l;return!!o&&r>=s&&r<h}},{key:"setMultiPass",value:function(r,a){if(this.updateLayerConfig({enableMultiPassRenderer:r}),a&&this.updateLayerConfig({passes:a}),r){var o=this.getLayerConfig(),u=o.passes,s=u===void 0?[]:u;this.multiPassRenderer=Kx(this,s,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var l=this.rendererService.getViewportSize(),h=l.width,d=l.height;this.multiPassRenderer.resize(h,d)}return this}},{key:"setMinZoom",value:function(r){return this.updateLayerConfig({minZoom:r}),this}},{key:"getMinZoom",value:function(){var r=this.getLayerConfig(),a=r.minZoom;return a}},{key:"getMaxZoom",value:function(){var r=this.getLayerConfig(),a=r.maxZoom;return a}},{key:"get",value:function(r){var a=this.getLayerConfig();return a[r]}},{key:"setMaxZoom",value:function(r){return this.updateLayerConfig({maxZoom:r}),this}},{key:"setAutoFit",value:function(r){return this.updateLayerConfig({autoFit:r}),this}},{key:"fitBounds",value:function(r){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var a=this.getSource(),o=a.extent,u=o.some(function(s){return Math.abs(s)===Infinity});return u?this:(this.mapService.fitBounds([[o[0],o[1]],[o[2],o[3]]],r),this)}},{key:"destroy",value:function(){var r,a,o,u,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.isDestroyed){this.layerChildren.map(function(d){return d.destroy(!1)}),this.layerChildren=[];var l=this.getLayerConfig(),h=l.maskfence;h&&(this.masks.map(function(d){return d.destroy(!1)}),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(r=this.multiPassRenderer)===null||r===void 0||r.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(a=this.layerModel)===null||a===void 0||a.clearModels(s),(o=this.tileLayer)===null||o===void 0||o.destroy(),this.models=[],(u=this.debugService)===null||u===void 0||u.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var r;this.models.forEach(function(a){return a.destroy()}),(r=this.layerModel)===null||r===void 0||r.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(r){return r.needRescale||r.needRemapping||r.needRegenerateVertices}).length}},{key:"setSource",value:function(r){var a=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=r,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var o=this.mapService.getZoom();this.layerSource.updateClusterData(o)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(u){var s=u.type;if(a.coordCenter===void 0){var l,h=a.layerSource.center;a.coordCenter=h,(l=a.mapService)!==null&&l!==void 0&&l.setCoordCenter&&a.mapService.setCoordCenter(h)}if(s==="update"){if(a.tileLayer){a.tileLayer.reload();return}a.sourceEvent()}})}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(r){this.encodedData=r,this.encodeDataLength=r.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(r){return this.styleAttributeService.getLayerAttributeScale(r)}},{key:"getLegend",value:function(r){var a,o,u,s=this.styleAttributeService.getLayerStyleAttribute(r),l=(s==null||(a=s.scale)===null||a===void 0?void 0:a.scalers)||[];return{type:(o=l[0].option)===null||o===void 0?void 0:o.type,field:s==null||(u=s.scale)===null||u===void 0?void 0:u.field,items:this.getLegendItems(r)}}},{key:"getLegendItems",value:function(r){var a=this.styleAttributeService.getLayerAttributeScale(r);if(!a)return[];if(a.invertExtent){var o=a.range().map(function(l){return(0,R.Z)({value:a.invertExtent(l)},r,l)});return o}else if(a.ticks){var u=a.ticks().map(function(l){return(0,R.Z)({value:l},r,a(l))});return u}else if(a!=null&&a.domain){var s=a.domain().filter(function(l){return!(0,Rr.isUndefined)(l)}).map(function(l){return(0,R.Z)({value:l},r,a(l))});return s}return[]}},{key:"pick",value:function(r){var a=r.x,o=r.y;this.interactionService.triggerHover({x:a,y:o})}},{key:"boxSelect",value:function(r,a){this.pickingService.boxPickLayer(this,r,a)}},{key:"buildLayerModel",value:function(){var i=(0,st.Z)(q().mark(function a(o){var u=this,s,l,h,d,v,y,x,S,M,O,H,W;return q().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return s=o.moduleName,l=o.vertexShader,h=o.fragmentShader,d=o.inject,v=o.triangulation,y=o.segmentNumber,x=(0,es.Z)(o,Dw),this.shaderModuleService.registerModule(s,{vs:l,fs:h,inject:d}),S=this.shaderModuleService.getModule(s),M=S.vs,O=S.fs,H=S.uniforms,W=this.rendererService.createModel,ve.abrupt("return",new Promise(function(Re){var ze=u.styleAttributeService.createAttributesAndIndices(u.encodedData,v,y),ft=ze.attributes,gt=ze.elements,Pt=ze.count,Mt=(0,b.Z)({attributes:ft,uniforms:H,fs:O,vs:M,elements:gt,blend:Xx[Qu.normal]},x);Pt&&(Mt.count=Pt);var sr=W(Mt);Re(sr)}));case 5:case"end":return ve.stop()}},a,this)}));function r(a){return i.apply(this,arguments)}return r}()},{key:"createAttributes",value:function(r){var a=r.triangulation,o=this.styleAttributeService.createAttributes(this.encodedData,a),u=o.attributes;return u}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(r){var a=this.getLayerConfig(),o=a.enableHighlight,u=o===void 0?!0:o,s=a.enableSelect,l=s===void 0?!0:s,h=this.eventNames().indexOf(r)!==-1||this.eventNames().indexOf("un"+r)!==-1;return(r==="click"||r==="dblclick")&&l&&(h=!0),r==="mousemove"&&(u||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(h=!0),this.isVisible()&&h}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return u.stop()}},a)}));function r(){return i.apply(this,arguments)}return r}()},{key:"rebuildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"renderMulPass",value:function(){var i=(0,st.Z)(q().mark(function a(o){return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.render();case 2:case"end":return s.stop()}},a)}));function r(a){return i.apply(this,arguments)}return r}()},{key:"renderModels",value:function(){var r=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(function(o){o.draw({uniforms:r.layerModel.getUninforms(),blend:r.layerModel.getBlend(),stencil:r.layerModel.getStencil(a)},(a==null?void 0:a.ispick)||!1)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(r,a,o,u){var s=this.configService.getAttributeConfig(this.id)||{};return(0,Rr.isEqual)(s[r],{field:a,values:o})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(r)!==-1&&this.configService.setAttributeConfig(this.id,(0,R.Z)({},r,{field:a,values:o})),this.startInit?this.styleAttributeService.updateStyleAttribute(r,{scale:(0,b.Z)({field:a},this.splitValuesAndCallbackInAttribute(o,this.getLayerConfig()[a]))},u):this.pendingStyleAttributes.push({attributeName:r,attributeField:a,attributeValues:o,updateOptions:u}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(r){console.warn("empty fn")}},{key:"processData",value:function(r){return r}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.models.forEach(function(s){return s.destroy()}),this.models=[],u.next=4,this.layerModel.initModels();case 4:this.models=u.sent;case 5:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(r,a){return{values:(0,Rr.isFunction)(r)?void 0:r||a,callback:(0,Rr.isFunction)(r)?r:void 0}}}]),t}(Wi.EventEmitter),Qx=An(Cg.prototype,"configService",[qx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cg);function Gw(e,n){return{enable:e,mask:255,func:{cmp:N.EQUAL,ref:n?1:0,mask:1}}}function tS(e){return e.maskOperation===nf.OR?{enable:!0,mask:255,func:{cmp:N.ALWAYS,ref:1,mask:255},opFront:{fail:N.KEEP,zfail:N.REPLACE,zpass:N.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===zs.SINGLE||e.stencilIndex===0?N.ALWAYS:N.LESS,ref:e.stencilType===zs.SINGLE?1:e.stencilIndex===0?2:1,mask:255},opFront:{fail:N.KEEP,zfail:N.REPLACE,zpass:N.REPLACE}}}function Vw(e){switch(e){case"stroke":return{name:"stroke",type:Ar.Attribute,descriptor:{name:"a_Stroke",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:4,update:function(t){var i=t.stroke,r=i===void 0?[1,1,1,1]:i;return r}}};case"opacity":return{name:"opacity",type:Ar.Attribute,descriptor:{name:"a_Opacity",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(t){var i=t.opacity,r=i===void 0?1:i;return[r]}}};case"offsets":return{name:"offsets",type:Ar.Attribute,descriptor:{name:"a_Offsets",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(t){var i=t.offsets;return i}}};default:return}}var rS,wg,nS,ai=(rS=xg(qe.IGlobalConfigService),wg=function(){function e(n){(0,ot.Z)(this,e),(0,R.Z)(this,"preStyleAttribute",{}),(0,R.Z)(this,"encodeStyleAttribute",{}),En(this,"configService",nS,this),this.layer=n,this.rendererService=n.getContainer().get(qe.IRendererService),this.pickingService=n.getContainer().get(qe.IPickingService),this.shaderModuleService=n.getContainer().get(qe.IShaderModuleService),this.styleAttributeService=n.getContainer().get(qe.IStyleAttributeService),this.mapService=n.getContainer().get(qe.IMapService),this.iconService=n.getContainer().get(qe.IIconService),this.fontService=n.getContainer().get(qe.IFontService),this.cameraService=n.getContainer().get(qe.ICameraService),this.layerService=n.getContainer().get(qe.ILayerService),this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();var t=this.rendererService.createTexture2D;this.createTexture2D=t}return(0,at.Z)(e,[{key:"getBlend",value:function(){var t=this.layer.getLayerConfig(),i=t.blend,r=i===void 0?"normal":i;return Xx[Qu[r]]}},{key:"getStencil",value:function(t){var i=this.layer.getLayerConfig(),r=i.mask,a=r===void 0?!1:r,o=i.maskInside,u=o===void 0?!0:o,s=i.enableMask,l=i.maskOperation,h=l===void 0?nf.AND:l;if(this.layer.type==="MaskLayer")return tS({isStencil:!0,stencilType:zs.SINGLE});if(t.isStencil)return tS((0,b.Z)((0,b.Z)({},t),{},{maskOperation:h}));var d=a||s&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return Gw(d,u)}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var n=(0,st.Z)(q().mark(function i(){return q().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",!1);case 1:case"end":return a.stop()}},i)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,st.Z)(q().mark(function i(){return q().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},i)}));function t(){return n.apply(this,arguments)}return t}()},{key:"initModels",value:function(){var n=(0,st.Z)(q().mark(function i(){return q().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},i)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(t){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}},{key:"startModelAnimate",value:function(){var t=this.layer.getLayerConfig(),i=t.animateOption;i.enable&&this.layer.setAnimateStartTime()}},{key:"getInject",value:function(){var t=this.layer.encodeStyleAttribute,i="",r={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2"};this.layer.enableEncodeStyles.forEach(function(o){t[o]&&(i+="#define USE_ATTRIBUTE_".concat(o.toUpperCase(),` 0.0; 

`)),i+=`
      #ifdef USE_ATTRIBUTE_`.concat(o.toUpperCase(),`
  attribute `).concat(r[o]," a_").concat(o.charAt(0).toUpperCase()+o.slice(1),`;
#else
  uniform `).concat(r[o]," u_").concat(o,`;
#endif

`)});var a="";return this.layer.enableEncodeStyles.forEach(function(o){a+=`

#ifdef USE_ATTRIBUTE_`.concat(o.toUpperCase(),`
  `).concat(r[o]," ").concat(o,"  = a_").concat(o.charAt(0).toUpperCase()+o.slice(1),`;
#else
  `).concat(r[o]," ").concat(o," = u_").concat(o,`;
#endif

`)}),{"vs:#decl":i,"vs:#main-start":a}}},{key:"getStyleAttribute",value:function(){var t=this,i={},r={opacity:1,stroke:[1,0,0,1],offsets:[0,0]};return this.layer.enableEncodeStyles.forEach(function(a){if(!t.layer.encodeStyleAttribute[a]){var o=t.layer.getLayerConfig()[a],u=typeof o=="undefined"?r[a]:o;a==="stroke"&&(u=wn(u)),i["u_"+a]=u}}),i}},{key:"registerStyleAttribute",value:function(){var t=this;Object.keys(this.layer.encodeStyleAttribute).forEach(function(i){var r=Vw(i);r&&t.styleAttributeService.registerStyleAttribute(r)})}},{key:"updateEncodeAttribute",value:function(t,i){this.encodeStyleAttribute[t]=i}}]),e}(),nS=An(wg.prototype,"configService",[rS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wg),Mg=100,AF=36,TF=40;function iS(e){return e/180*Math.acos(-1)}function aS(e){var n=iS(e[0])+Math.PI/2,t=iS(e[1]),i=Mg+Math.random()*.4,r=i*Math.cos(t)*Math.cos(n),a=i*Math.cos(t)*Math.sin(n),o=i*Math.sin(t);return[a,o,r]}function CF(e,n){var t=mat4.create(),i=mat4.create(),r=vec3.fromValues(0,1,0),a=vec3.fromValues(0,0,0);n=n||{},e=typeof e!="undefined"?e:1;for(var o=typeof n.segments!="undefined"?n.segments:32,u=2+o,s=2*u,l=[],h=[],d=[],v=[],y=[],x=[],S=0;S<=u;S++){for(var M=S/u,O=M*Math.PI,H=0;H<=s;H++){var W=H/s,he=W*Math.PI*2;mat4.identity(i),mat4.rotateZ(i,i,-O),mat4.identity(t),mat4.rotateY(t,t,he),vec3.transformMat4(a,r,i),vec3.transformMat4(a,a,t),vec3.scale(a,a,-e),d.push(a.slice()),v.push.apply(v,_toConsumableArray(a.slice())),vec3.normalize(a,a),y.push.apply(y,_toConsumableArray(a.slice())),x.push([W,1-M]),v.push(W,1-M)}if(S>0)for(var ve=d.length,Re=ve-2*(s+1);Re+s+2<ve;Re++)l.push([Re,Re+1,Re+s+1]),h.push(Re,Re+1,Re+s+1),l.push([Re+s+1,Re+1,Re+s+2]),h.push(Re+s+1,Re+1,Re+s+2)}return{cells:l,positions:d,uvs:x,positionsArr:v,indicesArr:h,normalArr:y}}var Qv=Ut(),wF=Ut(),_a=Ut(),cf=Ut(),qh=Ut();function Rg(e,n,t,i,r){Rn(e,t,i),qu(e,e),n=Cr(-e[1],e[0]);var a=Cr(-t[1],t[0]);return[r/Ns(n,a),n]}function ff(e,n){return Qn(e,-n[1],n[0])}function Qh(e,n,t){return Kc(e,n,t),qu(e,e),e}function Lg(e,n){return e[0]===n[0]&&e[1]===n[1]}function MF(e){for(var n=new Map,t=0;t<e.length;t++){var i=e[0].toString()+"-"+e[1].toString();n.get(i)?(e.splice(t,1),t++):n.set(i,i)}return e}var Hw=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,ot.Z)(this,e),(0,R.Z)(this,"lastFlip",-1),(0,R.Z)(this,"miter",Cr(0,0)),(0,R.Z)(this,"started",!1),(0,R.Z)(this,"dash",!1),(0,R.Z)(this,"totalDistance",0),(0,R.Z)(this,"currentIndex",0),this.join=n.join||"miter",this.cap=n.cap||"butt",this.miterLimit=n.miterLimit||10,this.thickness=n.thickness||1,this.dash=n.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,at.Z)(e,[{key:"simpleExtrude",value:function(t){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,a=i.startIndex,o=1;o<r;o++){var u=t[o-1],s=t[o],l=o<t.length-1?t[o+1]:null,h=this.simpleSegment(i,a,u,s,l);a+=h}if(this.dash)for(var d=0;d<i.positions.length/6;d++)i.positions[d*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude_gaode2",value:function(t,i){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,o=r.startIndex,u=1;u<a;u++){var s,l,h,d=t[u-1];d.push((s=i[u-1][2])!==null&&s!==void 0?s:0);var v=i[u-1],y=t[u];y.push((l=i[u][2])!==null&&l!==void 0?l:0);var x=i[u],S=u<t.length-1?[].concat((0,L.Z)(t[u+1]),[(h=i[u+1][2])!==null&&h!==void 0?h:0]):null,M=u<i.length-1?i[u+1]:null,O=this.simpleSegment(r,o,d,y,S,v,x,M);o+=O}if(this.dash)for(var H=0;H<r.positions.length/6;H++)r.positions[H*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude_gaode2",value:function(t,i){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,o=r.startIndex,u=1;u<a;u++){var s,l,h,d=t[u-1];d.push((s=i[u-1][2])!==null&&s!==void 0?s:0);var v=i[u-1],y=t[u];y.push((l=i[u][2])!==null&&l!==void 0?l:0);var x=i[u],S=u<t.length-1?[].concat((0,L.Z)(t[u+1]),[(h=i[u+1][2])!==null&&h!==void 0?h:0]):null,M=u<i.length-1?i[u+1]:null,O=this.segment_gaode2(r,o,d,y,S,v,x,M);o+=O}if(this.dash)for(var H=0;H<r.positions.length/6;H++)r.positions[H*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,a=i.startIndex,o=1;o<r;o++){var u=t[o-1],s=t[o],l=o<t.length-1?t[o+1]:null,h=this.segment(i,a,u,s,l);a+=h}if(this.dash)for(var d=0;d<i.positions.length/6;d++)i.positions[d*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleSegment",value:function(t,i,r,a,o){var u=0,s=t.indices,l=t.positions,h=t.normals,d=ji([a[0],a[1]]),v=ji([r[0],r[1]]);Qh(_a,d,v);var y=0;if(this.dash&&(y=this.lineSegmentDistance(d,v),this.totalDistance+=y),this.normal||(this.normal=Ut(),ff(this.normal,_a)),this.started||(this.started=!0,this.extrusions(l,h,r,this.normal,this.thickness,this.totalDistance-y)),s.push(i+0,i+1,i+2),!o)ff(this.normal,_a),this.extrusions(l,h,a,this.normal,this.thickness,this.totalDistance),s.push.apply(s,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),u+=2;else{var x=ji([o[0],o[1]]);Lg(d,x)&&Rn(x,d,qu(x,Ta(x,d,v))),Qh(cf,x,d);var S=Rg(qh,Ut(),_a,cf,this.thickness),M=(0,Dr.Z)(S,2),O=M[0],H=M[1],W=Ns(qh,this.normal)<0?-1:1;this.extrusions(l,h,a,H,O,this.totalDistance),s.push.apply(s,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),W=-1,Ur(this.normal,H),u+=2,this.lastFlip=W}return u}},{key:"segment_gaode2",value:function(t,i,r,a,o,u,s,l){var h=0,d=t.indices,v=t.positions,y=t.normals,x=this.cap==="square",S=this.join==="bevel",M=ji([s[0],s[1]]),O=ji([u[0],u[1]]);Qh(_a,a,r);var H=0;if(this.dash&&(H=this.lineSegmentDistance(M,O),this.totalDistance+=H),this.normal||(this.normal=Ut(),ff(this.normal,_a)),!this.started)if(this.started=!0,x){var W=Ut(),he=Ut();Rn(W,this.normal,_a),Rn(he,this.normal,_a),y.push(he[0],he[1],0),y.push(W[0],W[1],0),v.push(r[0],r[1],r[2]|0,this.totalDistance-H,-this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),v.push(r[0],r[1],r[2]|0,this.totalDistance-H,this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(v,y,r,this.normal,this.thickness,this.totalDistance-H);if(d.push(i+0,i+1,i+2),o){Lg(a,o)&&Rn(o,a,qu(o,Ta(o,a,r))),Qh(cf,o,a);var ze=Rg(qh,Ut(),_a,cf,this.thickness),ft=(0,Dr.Z)(ze,2),gt=ft[0],Pt=ft[1],Mt=Ns(qh,this.normal)<0?-1:1,sr=S;if(!sr&&this.join==="miter"){var xr=gt;xr>this.miterLimit&&(sr=!0)}sr?(y.push(this.normal[0],this.normal[1],0),y.push(Pt[0],Pt[1],0),v.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Mt,a[2]|0),this.complex.indexes.push(this.currentIndex),v.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*Mt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,d.push.apply(d,(0,L.Z)(this.lastFlip!==-Mt?[i,i+2,i+3]:[i+2,i+1,i+3])),d.push(i+2,i+3,i+4),ff(Qv,cf),Ur(this.normal,Qv),y.push(this.normal[0],this.normal[1],0),v.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Mt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,h+=3):(this.extrusions(v,y,a,Pt,gt,this.totalDistance),d.push.apply(d,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),Mt=-1,Ur(this.normal,Pt),h+=2),this.lastFlip=Mt}else{if(ff(this.normal,_a),x){var ve=Ut(),Re=Ut();Kc(Re,_a,this.normal),Rn(ve,_a,this.normal),y.push(Re[0],Re[1],0),y.push(ve[0],ve[1],0),v.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),v.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(v,y,a,this.normal,this.thickness,this.totalDistance);d.push.apply(d,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),h+=2}return h}},{key:"segment",value:function(t,i,r,a,o){var u=0,s=t.indices,l=t.positions,h=t.normals,d=this.cap==="square",v=this.join==="bevel",y=ji([a[0],a[1]]),x=ji([r[0],r[1]]);Qh(_a,y,x);var S=0;if(this.dash&&(S=this.lineSegmentDistance(y,x),this.totalDistance+=S),this.normal||(this.normal=Ut(),ff(this.normal,_a)),!this.started)if(this.started=!0,d){var M=Ut(),O=Ut();Rn(M,this.normal,_a),Rn(O,this.normal,_a),h.push(O[0],O[1],0),h.push(M[0],M[1],0),l.push(r[0],r[1],r[2]|0,this.totalDistance-S,-this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),l.push(r[0],r[1],r[2]|0,this.totalDistance-S,this.thickness,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,h,r,this.normal,this.thickness,this.totalDistance-S);if(s.push(i+0,i+1,i+2),o){var he=ji([o[0],o[1]]);Lg(y,he)&&Rn(he,y,qu(he,Ta(he,y,x))),Qh(cf,he,y);var ve=Rg(qh,Ut(),_a,cf,this.thickness),Re=(0,Dr.Z)(ve,2),ze=Re[0],ft=Re[1],gt=Ns(qh,this.normal)<0?-1:1,Pt=v;if(!Pt&&this.join==="miter"){var Mt=ze;Mt>this.miterLimit&&(Pt=!0)}Pt?(h.push(this.normal[0],this.normal[1],0),h.push(ft[0],ft[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*gt,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*gt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s.push.apply(s,(0,L.Z)(this.lastFlip!==-gt?[i,i+2,i+3]:[i+2,i+1,i+3])),s.push(i+2,i+3,i+4),ff(Qv,cf),Ur(this.normal,Qv),h.push(this.normal[0],this.normal[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*gt,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,u+=3):(this.extrusions(l,h,a,ft,ze,this.totalDistance),s.push.apply(s,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),gt=-1,Ur(this.normal,ft),u+=2),this.lastFlip=gt}else{if(ff(this.normal,_a),d){var H=Ut(),W=Ut();Kc(W,_a,this.normal),Rn(H,_a,this.normal),h.push(W[0],W[1],0),h.push(H[0],H[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,h,a,this.normal,this.thickness,this.totalDistance);s.push.apply(s,(0,L.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),u+=2}return u}},{key:"extrusions",value:function(t,i,r,a,o,u){i.push(a[0],a[1],0),i.push(a[0],a[1],0),t.push(r[0],r[1],r[2]|0,u,-o,r[2]|0),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],r[2]|0,u,o,r[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,i){var r=i[0]-t[0],a=i[1]-t[1];return Math.sqrt(r*r+a*a)}}]),e}();function Jh(){var e=new Ht(3);return Ht!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function jw(e){var n=new Ht(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function oS(e){var n=e[0],t=e[1],i=e[2];return Math.hypot(n,t,i)}function Va(e,n,t){var i=new Ht(3);return i[0]=e,i[1]=n,i[2]=t,i}function Ww(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function $w(e,n,t,i){return e[0]=n,e[1]=t,e[2]=i,e}function Xw(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}function uS(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}function sS(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}function lS(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}function Yw(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e}function Kw(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e}function qw(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e}function Qw(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e}function Jw(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e}function eM(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e}function tM(e,n,t,i){return e[0]=n[0]+t[0]*i,e[1]=n[1]+t[1]*i,e[2]=n[2]+t[2]*i,e}function cS(e,n){var t=n[0]-e[0],i=n[1]-e[1],r=n[2]-e[2];return Math.hypot(t,i,r)}function fS(e,n){var t=n[0]-e[0],i=n[1]-e[1],r=n[2]-e[2];return t*t+i*i+r*r}function hS(e){var n=e[0],t=e[1],i=e[2];return n*n+t*t+i*i}function pS(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}function rM(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}function ep(e,n){var t=n[0],i=n[1],r=n[2],a=t*t+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=n[0]*a,e[1]=n[1]*a,e[2]=n[2]*a,e}function dS(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function vS(e,n,t){var i=n[0],r=n[1],a=n[2],o=t[0],u=t[1],s=t[2];return e[0]=r*s-a*u,e[1]=a*o-i*s,e[2]=i*u-r*o,e}function nM(e,n,t,i){var r=n[0],a=n[1],o=n[2];return e[0]=r+i*(t[0]-r),e[1]=a+i*(t[1]-a),e[2]=o+i*(t[2]-o),e}function iM(e,n,t,i,r,a){var o=a*a,u=o*(2*a-3)+1,s=o*(a-2)+a,l=o*(a-1),h=o*(3-2*a);return e[0]=n[0]*u+t[0]*s+i[0]*l+r[0]*h,e[1]=n[1]*u+t[1]*s+i[1]*l+r[1]*h,e[2]=n[2]*u+t[2]*s+i[2]*l+r[2]*h,e}function aM(e,n,t,i,r,a){var o=1-a,u=o*o,s=a*a,l=u*o,h=3*a*u,d=3*s*o,v=s*a;return e[0]=n[0]*l+t[0]*h+i[0]*d+r[0]*v,e[1]=n[1]*l+t[1]*h+i[1]*d+r[1]*v,e[2]=n[2]*l+t[2]*h+i[2]*d+r[2]*v,e}function oM(e,n){n=n||1;var t=or()*2*Math.PI,i=or()*2-1,r=Math.sqrt(1-i*i)*n;return e[0]=Math.cos(t)*r,e[1]=Math.sin(t)*r,e[2]=i*n,e}function yd(e,n,t){var i=n[0],r=n[1],a=n[2],o=t[3]*i+t[7]*r+t[11]*a+t[15];return o=o||1,e[0]=(t[0]*i+t[4]*r+t[8]*a+t[12])/o,e[1]=(t[1]*i+t[5]*r+t[9]*a+t[13])/o,e[2]=(t[2]*i+t[6]*r+t[10]*a+t[14])/o,e}function uM(e,n,t){var i=n[0],r=n[1],a=n[2];return e[0]=i*t[0]+r*t[3]+a*t[6],e[1]=i*t[1]+r*t[4]+a*t[7],e[2]=i*t[2]+r*t[5]+a*t[8],e}function sM(e,n,t){var i=t[0],r=t[1],a=t[2],o=t[3],u=n[0],s=n[1],l=n[2],h=r*l-a*s,d=a*u-i*l,v=i*s-r*u,y=r*v-a*d,x=a*h-i*v,S=i*d-r*h,M=o*2;return h*=M,d*=M,v*=M,y*=2,x*=2,S*=2,e[0]=u+h+y,e[1]=s+d+x,e[2]=l+v+S,e}function lM(e,n,t,i){var r=[],a=[];return r[0]=n[0]-t[0],r[1]=n[1]-t[1],r[2]=n[2]-t[2],a[0]=r[0],a[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),a[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function cM(e,n,t,i){var r=[],a=[];return r[0]=n[0]-t[0],r[1]=n[1]-t[1],r[2]=n[2]-t[2],a[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),a[1]=r[1],a[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function fM(e,n,t,i){var r=[],a=[];return r[0]=n[0]-t[0],r[1]=n[1]-t[1],r[2]=n[2]-t[2],a[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),a[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),a[2]=r[2],e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function Pg(e,n){var t=e[0],i=e[1],r=e[2],a=n[0],o=n[1],u=n[2],s=Math.sqrt(t*t+i*i+r*r),l=Math.sqrt(a*a+o*o+u*u),h=s*l,d=h&&dS(e,n)/h;return Math.acos(Math.min(Math.max(d,-1),1))}function hM(e){return e[0]=0,e[1]=0,e[2]=0,e}function pM(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function dM(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function vM(e,n){var t=e[0],i=e[1],r=e[2],a=n[0],o=n[1],u=n[2];return Math.abs(t-a)<=Et*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(i-o)<=Et*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-u)<=Et*Math.max(1,Math.abs(r),Math.abs(u))}var Ig=uS,mM=sS,gM=lS,yM=cS,_M=fS,xM=oS,SM=hS,bM=function(){var e=Jh();return function(n,t,i,r,a,o){var u,s;for(t||(t=3),i||(i=0),r?s=Math.min(r*t+i,n.length):s=n.length,u=i;u<s;u+=t)e[0]=n[u],e[1]=n[u+1],e[2]=n[u+2],a(e,e,o),n[u]=e[0],n[u+1]=e[1],n[u+2]=e[2];return n}}();function EM(e){var n=e[0][0],t=e[0][e[0].length-1];n[0]===t[0]&&n[1]===t[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,r=Xe().flatten(e),a=r.vertices,o=r.dimensions,u=[],s=[],l=0;l<a.length/o;l++)o===2?u.push(a[l*2],a[l*2+1],1):u.push(a[l*3],a[l*3+1],1);var h=Xe()(r.vertices,r.holes,r.dimensions);s.push.apply(s,(0,L.Z)(h));for(var d=function(x){var S=r.vertices.slice(x*o,(x+1)*o),M=r.vertices.slice((x+1)*o,(x+2)*o);M.length===0&&(M=r.vertices.slice(0,o));var O=u.length/3;u.push(S[0],S[1],1,M[0],M[1],1,S[0],S[1],0,M[0],M[1],0),s.push.apply(s,(0,L.Z)([0,2,1,2,3,1].map(function(H){return H+O})))},v=0;v<i;v++)d(v);return{positions:u,index:s}}function AM(e){var n=Xe().flatten(e),t=Xe()(n.vertices,n.holes,n.dimensions);return{positions:n.vertices,index:t}}function mS(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=e[0][0],i=e[0][e[0].length-1];t[0]===i[0]&&t[1]===i[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var r=e[0].length,a=Xe().flatten(e),o=a.vertices,u=a.dimensions,s=[],l=[],h=[],d=0;d<o.length/u;d++)s.push(o[d*u],o[d*u+1],1,-1,-1),h.push(0,0,1);var v=Xe()(a.vertices,a.holes,a.dimensions);l.push.apply(l,(0,L.Z)(v));for(var y=function(M){var O=a.vertices.slice(M*u,(M+1)*u),H=a.vertices.slice((M+1)*u,(M+2)*u);H.length===0&&(H=a.vertices.slice(0,u));var W=s.length/5;s.push(O[0],O[1],1,0,0,H[0],H[1],1,.1,0,O[0],O[1],0,0,.8,H[0],H[1],0,.1,.8);var he=TM([H[0],H[1],1],[O[0],O[1],0],[O[0],O[1],1],n);h.push.apply(h,(0,L.Z)(he).concat((0,L.Z)(he),(0,L.Z)(he),(0,L.Z)(he))),l.push.apply(l,(0,L.Z)([1,2,0,3,2,1].map(function(ve){return ve+W})))},x=0;x<r;x++)y(x);return{positions:s,index:l,normals:h}}function TM(e,n,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=Jh(),a=Jh(),o=Jh();i&&(e=Kl(e),n=Kl(n),t=Kl(t));var u=Va.apply(E,(0,L.Z)(e)),s=Va.apply(E,(0,L.Z)(n)),l=Va.apply(E,(0,L.Z)(t));Ig(r,l,s),Ig(a,u,s),vS(o,r,a);var h=Jh();return ep(h,o),h}var ts,Jf;(function(e){e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn"})(Jf||(Jf={}));var eh;(function(e){e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon"})(eh||(eh={}));function _d(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=Math.PI*2/e,i=[],r=0;r<e;r++)i.push(t*r+n*Math.PI/12);var a=i.map(function(o){var u=Math.sin(o+Math.PI/4),s=Math.cos(o+Math.PI/4);return[u,s,0]});return a}function gS(){return _d(30)}function yS(){return _d(4)}function _S(){return _d(3)}function xS(){return _d(6,1)}function SS(){return _d(5)}var tp=(ts={},(0,R.Z)(ts,eh.CIRCLE,gS),(0,R.Z)(ts,eh.HEXAGON,xS),(0,R.Z)(ts,eh.TRIANGLE,_S),(0,R.Z)(ts,eh.SQUARE,yS),(0,R.Z)(ts,eh.PENTAGON,SS),(0,R.Z)(ts,Jf.CYLINDER,gS),(0,R.Z)(ts,Jf.HEXAGONCOLUMN,xS),(0,R.Z)(ts,Jf.TRIANGLECOLUMN,_S),(0,R.Z)(ts,Jf.SQUARECOLUMN,yS),(0,R.Z)(ts,Jf.PENTAGONCOLUMN,SS),ts),Jv={};function e0(e){var n=Zo(e.coordinates);return{vertices:[].concat((0,L.Z)(n),(0,L.Z)(n),(0,L.Z)(n),(0,L.Z)(n)),indices:[0,1,2,2,3,0],size:n.length}}function bS(e){var n=Zo(e.coordinates),t=aS(n);return{vertices:[].concat((0,L.Z)(t),(0,L.Z)(t),(0,L.Z)(t),(0,L.Z)(t)),indices:[0,1,2,2,3,0],size:t.length}}function Og(e){var n=e.shape,t=OM(n,!1),i=t.positions,r=t.index,a=t.normals;return{vertices:i,indices:r,normals:a,size:5}}function CM(e){var n=Zo(e.coordinates);return{vertices:(0,L.Z)(n),indices:[0],size:n.length}}function kg(e){var n=e.coordinates,t=e.originCoordinates,i=e.version,r=new Hw({dash:!0,join:"bevel"});if(i==="GAODE2.x"){var a=n;Array.isArray(a[0][0])||(a=[n]);var o=t;Array.isArray(o[0][0])||(o=[t]);for(var u=0;u<a.length;u++){var s=a[u],l=o[u];r.extrude_gaode2(s,l)}}else{var h=n;h[0]&&!Array.isArray(h[0][0])&&(h=[n]),h.forEach(function(v){r.extrude(v)})}var d=r.complex;return{vertices:d.positions,indices:d.indices,normals:d.normals,indexes:d.indexes,size:6}}function wM(e){var n=e.coordinates.flat(),t=1,i=1;return{vertices:[1,0,0].concat((0,L.Z)(n),[1,2,-3],(0,L.Z)(n),[1,1,-3],(0,L.Z)(n),[0,1,0],(0,L.Z)(n),[0,0,0],(0,L.Z)(n),[1,0,0],(0,L.Z)(n),[1,2,-3],(0,L.Z)(n),[1,1,-3],(0,L.Z)(n),[0,1,0],(0,L.Z)(n),[0,0,0],(0,L.Z)(n)),normals:[-t,2*i,1,2*i,-i,1,i,-i,1,i,-i,1,-t,-i,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function RF(e){var n=e.coordinates.flat(),t=1,i=1;return{vertices:[1,0,0].concat(_toConsumableArray(n),[1,2,-3],_toConsumableArray(n),[1,1,-3],_toConsumableArray(n),[0,1,0],_toConsumableArray(n),[0,0,0],_toConsumableArray(n)),normals:[-t,2*i,1,2*i,-i,1,i,-i,1,i,-i,1,-t,-i,1],indices:[0,1,1,2,2,3,3,4,4,0],size:7}}function MM(e){var n=e.coordinates,t=[];if(!Array.isArray(n[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var i=RM(n),r=i.results,a=i.totalDistance;return r.map(function(o){t.push(o[0],o[1],o[2],o[3],0,a)}),{vertices:t,indices:[],normals:[],size:6,count:r.length}}function LF(e){var n=e.coordinates,t=[];if(!Array.isArray(n[0]))return{vertices:[],indices:[],size:4,count:0};var i=LM(n),r=i.results;return r.map(function(a){t.push(a[0],a[1],a[2],a[3])}),{vertices:t,indices:[],size:4,count:r.length}}function ES(e,n){var t=n[0]-e[0],i=n[1]-e[1];return Math.sqrt(t*t+i*i)}function rp(e,n){return e.length<3&&e.push(0),n!==void 0&&e.push(n),e}function RM(e){var n=e;Array.isArray(n)&&Array.isArray(n[0])&&Array.isArray(n[0][0])&&(n=e.flat());var t=0;if(n.length<2)return{results:n,totalDistance:0};var i=[],r=rp(n[0],t);i.push(r);for(var a=1;a<n.length-1;a++){var o=ES(n[a-1],n[a]);t+=o;var u=rp(n[a],t);i.push(u),i.push(u)}var s=ES(n[n.length-2],n[n.length-1]);return t+=s,i.push(rp(n[n.length-1],t)),{results:i,totalDistance:t}}function LM(e){if(e.length<2)return{results:e};var n=[],t=rp(e[0]);n.push(t);for(var i=1;i<e.length-1;i++){var r=rp(e[i]);n.push(r),n.push(r)}return n.push(rp(e[e.length-1])),{results:n}}function Fg(e){var n=e.coordinates,t=Xe().flatten(n),i=t.vertices,r=t.dimensions,a=t.holes;return{indices:Xe()(i,a,r),vertices:i,size:r}}function PM(e){var n=e.coordinates,t=Xe().flatten(n),i=t.vertices,r=t.dimensions,a=t.holes;return{indices:Xe()(i,a,r),vertices:IM(i),size:r+4}}function IM(e){for(var n=[],t=Rh(e),i=t.center,r=t.radius,a=0;a<e.length;a+=2){var o=e[a],u=e[a+1];n.push.apply(n,[o,u,0].concat((0,L.Z)(i),[r]))}return n}function AS(e){var n=e.coordinates,t=mS(n,!0),i=t.positions,r=t.index,a=t.normals;return{vertices:i,indices:r,normals:a,size:5}}function TS(e){var n=e.shape,t=FM(n),i=t.positions,r=t.index;return{vertices:i,indices:r,size:3}}function t0(e){var n=e.coordinates,t=[].concat((0,L.Z)(n[0]),[0,0,1,n[1][0],n[0][1],0,1,1],(0,L.Z)(n[1]),[0,1,0],(0,L.Z)(n[0]),[0,0,1],(0,L.Z)(n[1]),[0,1,0,n[0][0],n[1][1],0,0,0]),i=[0,1,2,3,4,5];return{vertices:t,indices:i,size:5}}function r0(e,n){for(var t=n||30,i=e.coordinates,r=[],a=[],o=function(l){r.push(l,1,l,i[0][0],i[0][1],i[1][0],i[1][1],l,-1,l,i[0][0],i[0][1],i[1][0],i[1][1]),l!==t-1&&a.push.apply(a,(0,L.Z)([0,1,2,1,3,2].map(function(h){return l*2+h})))},u=0;u<t;u++)o(u);return{vertices:r,indices:a,size:7}}function CS(e){var n=e.coordinates;n.length===2&&n.push(0);var t=n0(-1,1),i=n0(1,1),r=n0(-1,-1),a=n0(1,-1),o=[].concat((0,L.Z)(n),(0,L.Z)(t),(0,L.Z)(n),(0,L.Z)(r),(0,L.Z)(n),(0,L.Z)(a),(0,L.Z)(n),(0,L.Z)(i)),u=[0,1,2,3,0,2];return{vertices:o,indices:u,size:5}}function OM(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Jv&&Jv[e])return Jv[e];var t=tp[e]?tp[e]():tp.cylinder(),i=mS([t],n);return Jv[e]=i,i}function PF(e,n){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=new Float32Array(e.length/t*3),a,o,u,s=vec3.create(),l=vec3.create(),h=vec3.create(),d=0,v=n.length;d<v;d+=3){a=n[d+0]*3,o=n[d+1]*3,u=n[d+2]*3;var y=[e[a],e[a+1]],x=[e[o],e[o+1]],S=[e[u],e[u+1]];i&&(y=lngLatToMeters(y),x=lngLatToMeters(x),S=lngLatToMeters(S));var M=y,O=_slicedToArray(M,2),H=O[0],W=O[1],he=vec3.fromValues(H,W,e[a+2]),ve=x,Re=_slicedToArray(ve,2),ze=Re[0],ft=Re[1],gt=vec3.fromValues(ze,ft,e[o+2]),Pt=S,Mt=_slicedToArray(Pt,2),sr=Mt[0],xr=Mt[1],Br=vec3.fromValues(sr,xr,e[u+2]);vec3.sub(s,Br,gt),vec3.sub(l,he,gt),vec3.cross(h,s,l),r[a]+=s[0],r[a+1]+=s[1],r[a+2]+=s[2],r[o]+=s[0],r[o+1]+=s[1],r[o+2]+=s[2],r[u]+=s[0],r[u+1]+=s[1],r[u+2]+=s[2]}return kM(r),r}function kM(e){for(var n=0,t=e.length;n<t;n+=3){var i=vec3.fromValues(e[n],e[n+1],e[n+2]),r=vec3.create();vec3.normalize(r,i),e.set(r,n)}}function IF(e){var n=e[0][0],t=e[0][e[0].length-1];return n[0]===t[0]&&n[1]===t[1]}function FM(e){var n=["cylinder","triangleColumn","hexagonColumn","squareColumn"],t=tp[e]?tp[e]():tp.circle(),i=n.indexOf(e)===-1?AM([t]):EM([t]);return i}function n0(e,n){var t=(e+1)/2,i=(n+1)/2;return[t,i]}function OF(){var e=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),n=e.positionsArr,t=e.indicesArr,i=e.normalArr;return{vertices:n,indices:t,size:5,normals:i}}function kF(){var e=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),n=e.positionsArr,t=e.indicesArr,i=e.normalArr;return{vertices:n,indices:t,size:5,normals:i}}function NM(e){var n=DM();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function DM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var BM=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

uniform float u_circleSweep;
uniform float u_cityMinSize;
uniform vec3 u_circleSweepColor;
uniform float u_circleSweepSpeed;

varying float v_worldDis;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }


  if(u_circleSweep > 0.0 && v_worldDis < u_cityMinSize) {
    float r = fract(((v_worldDis/u_cityMinSize) - u_time * u_circleSweepSpeed) * 2.0);
    gl_FragColor.rgb += r * r * u_circleSweepColor;
  }
   
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ZM=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;
uniform mat4 u_Mvp;

uniform float u_circleSweep;
uniform vec2 u_cityCenter;

varying float v_worldDis;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"


void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

   v_texCoord = a_Uv;

  if(u_circleSweep > 0.0) {
     vec2 lnglatscale = vec2(0.0);
    if(u_CoordinateSystem != COORDINATE_SYSTEM_P20_2) {
      lnglatscale = (a_Position.xy - u_cityCenter) * vec2(0.0, 0.135);
    }
    v_worldDis = length(a_Position.xy + lnglatscale - u_cityCenter);
  }
 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,UM=function(e){(0,Ot.Z)(t,e);var n=NM(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.baseColor,s=u===void 0?"rgb(16,16,16)":u,l=r.brightColor,h=l===void 0?"rgb(255,176,38)":l,d=r.windowColor,v=d===void 0?"rgb(30,60,89)":d,y=r.time,x=y===void 0?0:y,S=r.sweep,M=S===void 0?{enable:!1,sweepRadius:1,sweepColor:"rgb(255, 255, 255)",sweepSpeed:.4,sweepCenter:this.cityCenter}:S;return{u_cityCenter:M.sweepCenter||this.cityCenter,u_cityMinSize:this.cityMinSize*M.sweepRadius,u_circleSweep:M.enable?1:0,u_circleSweepColor:wn(M.sweepColor).slice(0,3),u_circleSweepSpeed:M.sweepSpeed,u_opacity:o,u_baseColor:wn(s),u_brightColor:wn(h),u_windowColor:wn(v),u_time:this.layer.getLayerAnimateTime()||x}}},{key:"calCityGeo",value:function(){var r=(0,Dr.Z)(this.layer.getSource().extent,4),a=r[0],o=r[1],u=r[2],s=r[3];if(this.mapService.version==="GAODE2.x"){this.cityCenter=this.mapService.lngLatToCoord([(u+a)/2,(s+o)/2]);var l=this.mapService.lngLatToCoord([u,s]),h=this.mapService.lngLatToCoord([a,o]);this.cityMinSize=Math.sqrt(Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2))/4}else{var d=u-a,v=s-o;this.cityCenter=[(u+a)/2,(s+o)/2],this.cityMinSize=Math.sqrt(Math.pow(d,2)+Math.pow(v,2))/4}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.calCityGeo(),this.startModelAnimate(),u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:ZM,fragmentShader:BM,triangulation:AS,depth:{enable:!0},cull:{enable:!0,face:N.BACK}});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?10:o;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}}]),t}(ai);function zM(e){var n=GM();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function GM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var VM=function(e){(0,Ot.Z)(t,e);var n=zM(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"type","CityBuildingLayer"),i}return(0,at.Z)(t,[{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.layerModel=new UM(this),u.next=3,this.initLayerModels();case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"setLight",value:function(r){this.updateLayerConfig({time:r})}},{key:"getModelType",value:function(){return"citybuilding"}}]),t}(lf);function HM(e){var n=jM();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function jM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var WM=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
uniform mat4 u_Mvp;\r
varying vec4 v_color;\r
\r
uniform vec2 u_sceneCenterMercator;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  // gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\r
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec2 customLnglat = customProject(lnglat) - u_sceneCenterMercator; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807\r
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));\r
    gl_Position = u_Mvp * (project_pos);\r
  } else {\r
     vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
    gl_Position = project_common_position_to_clipspace(project_pos);\r
  }\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,$M=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,XM=function(e){(0,Ot.Z)(t,e);var n=HM(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=r.coverage,u=r.angle;return{u_opacity:a||1,u_coverage:o||.9,u_angle:u||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"heatmapGrid",vertexShader:WM,fragmentShader:$M,triangulation:TS,primitive:N.TRIANGLES,depth:{enable:!1}});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a){var o=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[o[0],o[1],0]}}})}}]),t}(ai);function YM(e){var n=KM();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function KM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qM=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_sceneCenterMercator;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"


void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));


  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
 
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u7ECF\u7EAC\u5EA6
    vec2 customLnglat = customProject(lnglat) - u_sceneCenterMercator; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807
    vec4 project_pos = project_position(vec4(customLnglat, a_Position.z * a_Size, 1.0));

    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    gl_Position = u_Mvp * vec4(customLnglat , a_Position.z * a_Size, 1.0);
  } else {
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
    vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
    
    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
    
    gl_Position = project_common_position_to_clipspace(project_pos);
  }



  setPickingColor(a_PickingColor);
}
`,QM=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,JM=function(e){(0,Ot.Z)(t,e);var n=YM(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=r.coverage,u=r.angle;return{u_opacity:a||1,u_coverage:o||1,u_angle:u||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"heatmapGrid3d",vertexShader:qM,fragmentShader:QM,triangulation:Og,primitive:N.TRIANGLES,depth:{enable:!0}});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a){var o=a.size;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a){var o=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[o[0],o[1],0]}}})}}]),t}(ai);function eR(e,n){for(var t=[],i=[],r=[],a=e+1,o=n+1,u=e/2,s=n/2,l=0;l<o;l++)for(var h=l-s,d=0;d<a;d++){var v=d-u;i.push(v/u,-h/s,0),r.push(d/e),r.push(1-l/n)}for(var y=0;y<n;y++)for(var x=0;x<e;x++){var S=x+a*y,M=x+a*(y+1),O=x+1+a*(y+1),H=x+1+a*y;t.push(S,M,H),t.push(M,O,H)}return{vertices:i,indices:t,uvs:r}}var wS,MS;function tR(e){var n=rR();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function rR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nR=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,iR=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;


vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // \u5C06\u539F\u672C 0 -> 1 \u7684 uv \u8F6C\u6362\u4E3A -1 -> 1 \u7684\u6807\u51C6\u5750\u6807\u7A7A\u95F4\uFF08NDC\uFF09

  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y \u5E73\u9762\u4E0A\u7684\u70B9\uFF08z == 0\uFF09\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E09\u7EF4\u4E0A\u7684\u70B9\u88AB\u6295\u5F71\u5230\u5E73\u9762\u540E\u7684\u70B9
	vec4 p2 = vec4(pos, 1.0, 1.0); // \u5E73\u884C\u4E8Ex/y\u5E73\u9762\u3001z==1 \u7684\u5E73\u9762\u4E0A\u7684\u70B9

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // \u6839\u636E\u89C6\u56FE\u6295\u5F71\u77E9\u9635\u7684\u9006\u77E9\u9635\u5E73\u9762\u4E0A\u7684\u53CD\u7B97\u51FA\u4E09\u7EF4\u7A7A\u95F4\u4E2D\u7684\u70B9\uFF08p1\u5E73\u9762\u4E0A\u7684\u70B9\uFF09
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w; // \u5F52\u4E00\u5316\u64CD\u4F5C\uFF08\u5F52\u4E00\u5316\u540E\u4E3A\u4E16\u754C\u5750\u6807\uFF09
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0.0, 1.0, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);
 
}
`,aR=`uniform sampler2D u_texture;        // \u70ED\u529B\u5F3A\u5EA6\u56FE
uniform sampler2D u_colorTexture;   // \u6839\u636E\u5F3A\u5EA6\u5206\u5E03\u7684\u8272\u5E26
uniform float u_opacity;
varying vec2 v_texCoord;

uniform vec2 u_ViewportSize;

float getBlurIndusty() {
    float vW = 2.0/u_ViewportSize.x;
    float vH = 2.0/u_ViewportSize.y;
    vec2 vUv = v_texCoord;
    float i11 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y + 1.0 * vH) ).r;
    float i12 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y + 1.0 * vH) ).r;
    float i13 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y + 1.0 * vH) ).r;

    float i21 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y) ).r;
    float i22 = texture2D( u_texture, vec2( vUv.x , vUv.y) ).r;
    float i23 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y) ).r;

    float i31 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y-1.0*vH) ).r;
    float i32 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y-1.0*vH) ).r;
    float i33 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y-1.0*vH) ).r;

    return(
        i11 + 
        i12 + 
        i13 + 
        i21 + 
        i21 + 
        i22 + 
        i23 + 
        i31 + 
        i32 + 
        i33
        )/9.0;
}


void main(){
    // float intensity = texture2D(u_texture, v_texCoord).r;
    float intensity = getBlurIndusty();
    vec4 color = texture2D(u_colorTexture, vec2(intensity, 0.0));

    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,oR=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;

void main() {
  v_texCoord = a_Uv;

  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,uR=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,sR=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 2.5;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
        gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
        gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
}
`,RS=(wS=(0,pr.b2)(),wS(MS=function(e){(0,Ot.Z)(t,e);var n=tR(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"render",value:function(r){var a=this,o=this.rendererService,u=o.clear,s=o.useFramebuffer,l=this.layer.getLayerConfig(),h=l.rampColors;s(this.heatmapFramerBuffer,function(){u({color:[0,0,0,0],depth:1,stencil:0,framebuffer:a.heatmapFramerBuffer}),a.drawIntensityMode()}),(0,Rr.isEqual)(this.preRampColors,h)||this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode(r):this.draw3DHeatMap(r)}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y,x,S;return q().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=this.rendererService,s=u.createFramebuffer,l=u.getViewportSize,h=u.createTexture2D,d=this.styleAttributeService.getLayerStyleAttribute("shape"),v=(d==null||(o=d.scale)===null||o===void 0?void 0:o.field)||"heatmap",this.shapeType=v,O.next=6,this.buildHeatMapIntensity();case 6:return this.intensityModel=O.sent,this.colorModel=v==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap(),y=l(),x=y.width,S=y.height,this.heatmapFramerBuffer=s({color:h({width:Math.floor(x/4),height:Math.floor(S/4),wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE,min:N.LINEAR,mag:N.LINEAR}),depth:!1}),this.updateColorTexture(),O.abrupt("return",[this.intensityModel,this.colorModel]);case 12:case"end":return O.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.initModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:Ar.Attribute,descriptor:{name:"a_Dir",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?1:o;return[u]}}})}},{key:"buildHeatMapIntensity",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.layer.triangulation=CS,s.next=3,this.layer.buildLayerModel({moduleName:"heatmapIntensity",vertexShader:sR,fragmentShader:uR,triangulation:CS,depth:{enable:!1},cull:{enable:!0,face:jl(this.mapService.version)}});case 3:return o=s.sent,s.abrupt("return",o);case 5:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:oR,fs:aR});var r=this.shaderModuleService.getModule("heatmapColor"),a=r.vs,o=r.fs,u=r.uniforms,s=this.rendererService,l=s.createAttribute,h=s.createElements,d=s.createBuffer,v=s.createModel;return v({vs:a,fs:o,attributes:{a_Position:l({buffer:d({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:N.FLOAT}),size:3}),a_Uv:l({buffer:d({data:[0,1,1,1,0,0,1,0],type:N.FLOAT}),size:2})},uniforms:(0,b.Z)({},u),depth:{enable:!1},elements:h({data:[0,2,1,2,3,1],type:N.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var r,a=this.layer.getLayerConfig(),o=a.opacity,u=a.intensity,s=u===void 0?10:u,l=a.radius,h=l===void 0?5:l;this.layerService.beforeRenderData(this.layer),this.layer.hooks.beforeRender.call(),(r=this.intensityModel)===null||r===void 0||r.draw({uniforms:{u_opacity:o||1,u_radius:h,u_intensity:s},blend:{enable:!0,func:{srcRGB:N.ONE,srcAlpha:1,dstRGB:N.ONE,dstAlpha:1}},stencil:{enable:!1,mask:255,func:{cmp:514,ref:1,mask:255}}}),this.layer.hooks.afterRender.call()}},{key:"drawColorMode",value:function(r){var a,o=this.layer.getLayerConfig(),u=o.opacity;(a=this.colorModel)===null||a===void 0||a.draw({uniforms:{u_opacity:u||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer},blend:this.getBlend(),stencil:this.getStencil(r)})}},{key:"draw3DHeatMap",value:function(r){var a,o=this.layer.getLayerConfig(),u=o.opacity,s=Ro();jh(s,this.cameraService.getViewProjectionMatrixUncentered()),(a=this.colorModel)===null||a===void 0||a.draw({uniforms:{u_opacity:u||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:(0,L.Z)(s)},blend:{enable:!0,func:{srcRGB:N.SRC_ALPHA,srcAlpha:1,dstRGB:N.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},stencil:this.getStencil(r)})}},{key:"build3dHeatMap",value:function(){var r=this.rendererService.getViewportSize,a=r(),o=a.width,u=a.height,s=eR(o/4,u/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:iR,fs:nR});var l=this.shaderModuleService.getModule("heatmap3dColor"),h=l.vs,d=l.fs,v=l.uniforms,y=this.rendererService,x=y.createAttribute,S=y.createElements,M=y.createBuffer,O=y.createModel;return O({vs:h,fs:d,attributes:{a_Position:x({buffer:M({data:s.vertices,type:N.FLOAT}),size:3}),a_Uv:x({buffer:M({data:s.uvs,type:N.FLOAT}),size:2})},primitive:N.TRIANGLES,uniforms:(0,b.Z)({},v),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:N.SRC_ALPHA,srcAlpha:1,dstRGB:N.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:S({data:s.indices,type:N.UNSIGNED_INT,count:s.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var r=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var a=this.layer.getLayerConfig(),o=a.rampColors,u=Rf(o);this.colorTexture=r({data:new Uint8Array(u.data),width:u.width,height:u.height,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE,min:N.NEAREST,mag:N.NEAREST,flipY:!1}),this.preRampColors=o}}]),t}(ai))||MS);function lR(e){var n=cR();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function cR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fR=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,hR=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_sceneCenterMercator;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
 
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xy, 0., 1.0));
    // gl_Position = u_Mvp * (vec4(a_Pos.xy + offset, 0., 1.0));
    vec2 customLnglat = customProject(lnglat) - u_sceneCenterMercator;
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));
    gl_Position = u_Mvp * vec4(project_pos.xy, 0.0, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,pR=function(e){(0,Ot.Z)(t,e);var n=lR(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=r.coverage,u=r.angle;return{u_opacity:a||1,u_coverage:o||.9,u_angle:u||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"heatmapHexagon",vertexShader:hR,fragmentShader:fR,triangulation:TS,depth:{enable:!1},primitive:N.TRIANGLES});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a){var o=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[o[0],o[1],0]}}})}}]),t}(ai),dR={heatmap:RS,heatmap3d:RS,grid:XM,grid3d:JM,hexagon:pR},vR=dR;function mR(e){var n=gR();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function gR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yR=function(e){(0,Ot.Z)(t,e);var n=mR(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"type","HeatMapLayer"),i}return(0,at.Z)(t,[{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new vR[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"renderModels",value:function(){var r=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=this.getModelType();return o==="heatmap"?(this.layerModel&&this.layerModel.render(a),this):this.encodeDataLength<=0&&!this.forceRender?this:(this.hooks.beforeRender.call(),this.models.forEach(function(u){return u.draw({uniforms:r.layerModel.getUninforms(),blend:r.layerModel.getBlend(),stencil:r.layerModel.getStencil(a)})}),this.hooks.afterRender.call(),this)}},{key:"updateModelData",value:function(r){r.attributes&&r.elements?this.models[0].updateAttributesAndElements(r.attributes,r.elements):console.warn("data error")}},{key:"getModelType",value:function(){var r,a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=this.getLayerConfig(),u=o.shape3d,s=this.getSource(),l=s.data.type,h=(a==null||(r=a.scale)===null||r===void 0?void 0:r.field)||"heatmap";return h==="heatmap"||h==="heatmap3d"?"heatmap":l==="hexagon"?(u==null?void 0:u.indexOf(h))===-1?"hexagon":"grid3d":l==="grid"?(u==null?void 0:u.indexOf(h))===-1?"grid":"grid3d":"heatmap"}}]),t}(lf);function _R(e){var n=xR();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function xR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var SR=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
  if(gl_FragColor.a < 0.01)
    discard;
}
`,bR=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,ER=function(e){(0,Ot.Z)(t,e);var n=_R(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity;return{u_opacity:a||1,u_texture:this.texture}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o=this,u,s,l,h,d,v;return q().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(u=this.layer.getSource(),s=this.rendererService.createTexture2D,this.texture=s({height:0,width:0}),!Ba){x.next=11;break}l=this.layerService.sceneService.getSceneConfig().canvas,h=l.createImage(),h.crossOrigin="anonymous",h.src=u.data.originData,h.onload=function(){o.texture=s({data:h,width:h.width,height:h.height}),o.layerService.reRender()},x.next=15;break;case 11:return x.next=13,u.data.images;case 13:d=x.sent,this.texture=s({data:d[0],width:d[0].width,height:d[0].height,mag:N.LINEAR,min:N.LINEAR});case 15:return x.next=17,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:bR,fragmentShader:SR,triangulation:t0,primitive:N.TRIANGLES,blend:{enable:!0},depth:{enable:!1}});case 17:return v=x.sent,x.abrupt("return",[v]);case 19:case"end":return x.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.initModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}}]),t}(ai),AR={image:ER},TR=AR;function CR(e){var n=wR();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function wR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var LS=function(e){(0,Ot.Z)(t,e);var n=CR(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"type","ImageLayer"),i}return(0,at.Z)(t,[{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new TR[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getDefaultConfig",value:function(){var r=this.getModelType(),a={image:{}};return a[r]}},{key:"getModelType",value:function(){return"image"}}]),t}(lf);function MR(e){var n=RR();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function RR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var LR=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_distance_ratio;

uniform float segmentNumber;


#pragma include "picking"

void main() {
  gl_FragColor = v_color;


  float flag = 0.;
  float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,PR=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;
varying float v_distance_ratio;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * u_opacity);
  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, u_thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, u_thetaOffset), 0.0, 1.0));
 
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,IR=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;
varying vec4 v_lineData;


#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_color;
  
  gl_FragColor.a *= u_opacity;

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= u_opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,OR=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_lineData;
varying vec2 v_distance_ratio;

uniform float u_opacity: 1.0;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

 v_lineData.b = d_distance_ratio;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, u_thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, u_thetaOffset), 0.0, 1.0));

  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
 v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,kR=`varying vec4 v_color;

#pragma include "picking"

void main() {
// \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  gl_FragColor = v_color;
  gl_FragColor = filterColor(gl_FragColor);
}`,FR=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;
varying float v_segmentIndex;

uniform float u_lineDir: 1.0;
uniform float u_opacity: 1.0;

uniform float u_thetaOffset: 0.314;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;




#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, u_thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, u_thetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  v_color.a *= u_opacity;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,NR={solid:0,dash:1},DR=function(e){(0,Ot.Z)(t,e);var n=MR(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=u({data:i.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.sourceColor,s=r.targetColor,l=r.textureBlend,h=l===void 0?"normal":l,d=r.lineType,v=d===void 0?"solid":d,y=r.dashArray,x=y===void 0?[10,5]:y,S=r.forward,M=S===void 0?!0:S,O=r.lineTexture,H=O===void 0?!1:O,W=r.iconStep,he=W===void 0?100:W,ve=r.segmentNumber,Re=ve===void 0?30:ve,ze=r.thetaOffset,ft=ze===void 0?.314:ze;x.length===2&&x.push(0,0);var gt=0,Pt=[0,0,0,0],Mt=[0,0,0,0];return u&&s&&(Pt=wn(u),Mt=wn(s),gt=1),this.rendererService.getDirty()&&this.texture.bind(),{u_thetaOffset:ft,u_opacity:(0,Rr.isNumber)(o)?o:1,u_textureBlend:h==="normal"?0:1,segmentNumber:Re,u_line_type:NR[v||"solid"],u_dash_array:x,u_blur:.9,u_lineDir:M?1:-1,u_texture:this.texture,u_line_texture:H?1:0,u_icon_step:he,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:gt,u_sourceColor:Pt,u_targetColor:Mt}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,o=r.targetColor,u=r.lineType;return u==="dash"?{frag:LR,vert:PR,type:"Dash"}:a&&o?{frag:kR,vert:FR,type:"Linear"}:{frag:IR,vert:OR,type:""}}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=this.layer.getLayerConfig(),u=o.segmentNumber,s=u===void 0?30:u,l=this.getShaders(),h=l.frag,d=l.vert,v=l.type,S.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+v,vertexShader:d,fragmentShader:h,triangulation:r0,depth:{enable:!1},segmentNumber:s});case 4:return y=S.sent,S.abrupt("return",[y]);case 6:case"end":return S.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:function(o,u,s){return[s[3],s[4],s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=r.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},h=l.x,d=l.y;return[h,d]}}})}}]),t}(ai);function BR(e){var n=ZR();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function ZR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var UR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;
varying vec4 v_line_data;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;
uniform float u_opacity;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];


#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,zR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,GR=`
#define Animate 0.0
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_Color;

varying float v_distance_ratio;
#pragma include "picking"

void main() {

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_Color;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,VR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_distance_ratio;

varying vec4 v_dash_array;
varying vec4 v_color;
varying vec2 v_iconMapUV;
varying vec4 v_Color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }


  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  v_Color = mix(u_sourceColor, u_targetColor, a_Position.x/segmentNumber);

  v_Color.a *= opacity;


  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,HR={solid:0,dash:1},jR=function(e){(0,Ot.Z)(t,e);var n=BR(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=u({data:i.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,o=r.targetColor,u=r.textureBlend,s=u===void 0?"normal":u,l=r.lineType,h=l===void 0?"solid":l,d=r.dashArray,v=d===void 0?[10,5]:d,y=r.lineTexture,x=y===void 0?!1:y,S=r.iconStep,M=S===void 0?100:S,O=r.segmentNumber,H=O===void 0?30:O,W=r.globalArcHeight,he=W===void 0?10:W;v.length===2&&v.push(0,0);var ve=0,Re=[0,0,0,0],ze=[0,0,0,0];return a&&o&&(Re=wn(a),ze=wn(o),ve=1),this.rendererService.getDirty()&&this.texture.bind(),(0,b.Z)({u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:Mg,u_global_height:he,u_textureBlend:s==="normal"?0:1,segmentNumber:H,u_line_type:HR[h]||0,u_dash_array:v,u_texture:this.texture,u_line_texture:x?1:0,u_icon_step:M,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:ve,u_sourceColor:Re,u_targetColor:ze},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,o=r.targetColor;return a&&o?{frag:GR,vert:VR,type:"Linear"}:{frag:UR,vert:zR,type:""}}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=this.layer.getLayerConfig(),u=o.segmentNumber,s=u===void 0?30:u,l=this.getShaders(),h=l.frag,d=l.vert,v=l.type,S.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+v,vertexShader:d,fragmentShader:h,inject:this.getInject(),triangulation:r0,segmentNumber:s});case 4:return y=S.sent,S.abrupt("return",[y]);case 6:case"end":return S.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:function(o,u,s){return[s[3],s[4],s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=r.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},h=l.x,d=l.y;return[h,d]}}})}}]),t}(ai);function WR(e){var n=$R();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function $R(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var XR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;
varying vec4 v_line_data;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;
uniform float u_opacity;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];


#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,YR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,KR=`
#define Animate 0.0
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_Color;

varying float v_distance_ratio;
#pragma include "picking"

void main() {

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_Color;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,qR=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_distance_ratio;

varying vec4 v_dash_array;
varying vec4 v_color;
varying vec2 v_iconMapUV;
varying vec4 v_Color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }


  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);

  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  v_Color = mix(u_sourceColor, u_targetColor, a_Position.x/segmentNumber);

  v_Color.a *= opacity;


  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,QR={solid:0,dash:1},JR=function(e){(0,Ot.Z)(t,e);var n=WR(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=u({data:i.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.sourceColor,s=r.targetColor,l=r.textureBlend,h=l===void 0?"normal":l,d=r.lineType,v=d===void 0?"solid":d,y=r.dashArray,x=y===void 0?[10,5]:y,S=r.lineTexture,M=S===void 0?!1:S,O=r.iconStep,H=O===void 0?100:O,W=r.segmentNumber,he=W===void 0?30:W,ve=r.globalArcHeight,Re=ve===void 0?10:ve;x.length===2&&x.push(0,0);var ze=0,ft=[0,0,0,0],gt=[0,0,0,0];return u&&s&&(ft=wn(u),gt=wn(s),ze=1),this.rendererService.getDirty()&&this.texture.bind(),{u_globel:1,u_globel_radius:Mg,u_global_height:Re,u_opacity:o,u_textureBlend:h==="normal"?0:1,segmentNumber:he,u_line_type:QR[v]||0,u_dash_array:x,u_texture:this.texture,u_line_texture:M?1:0,u_icon_step:H,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:ze,u_sourceColor:ft,u_targetColor:gt}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,o=r.targetColor;return a&&o?{frag:KR,vert:qR,type:"Linear"}:{frag:XR,vert:YR,type:""}}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=this.layer.getLayerConfig(),u=o.segmentNumber,s=u===void 0?30:u,l=this.getShaders(),h=l.frag,d=l.vert,v=l.type,S.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+v,vertexShader:d,fragmentShader:h,triangulation:r0,depth:{enable:!0},segmentNumber:s});case 4:return y=S.sent,S.abrupt("return",[y]);case 6:case"end":return S.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:function(o,u,s){return[s[3],s[4],s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=r.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},h=l.x,d=l.y;return[h,d]}}})}}]),t}(ai);function eL(e){var n=tL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function tL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rL=`#extension GL_OES_standard_derivatives : enable

varying vec4 v_color;


// line texture

#pragma include "picking"

void main() {
gl_FragColor = v_color;
gl_FragColor = filterColor(gl_FragColor);
}
`,nL=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec4 a_Instance;
attribute vec3 a_Normal;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"
#pragma include "picking"
varying vec4 v_color;
uniform float u_gap_width: 1.0;
uniform float u_stroke_width: 1.0;
uniform float u_stroke_opacity: 1.0;


void main() {

// #ifdef USE_ATTRIBUTE_OPACITY
//   float opacity  = a_Opacity;
// #else
//   float opacity = u_opacity;
// #endif


// #ifdef USE_ATTRIBUTE_OFFSETS
//   vec2 offsets  = a_Offsets;
// #else
//   vec2 offsets = u_offsets;
// #endif

  // float opacity = u_opacity;
// \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = normalize(target - source);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);


  vec2 position = mix(source, target, a_Position.x);

  float lengthCommon = length(target - source);    
  vec2 offsetDistances = a_Size.x * project_pixel(a_Position.yz);
  vec2 limitedOffsetDistances = clamp(   
   offsetDistances,
    -lengthCommon*.8, lengthCommon*.8
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon*.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon*.2),
    a_Position.x
  );

  vec2 normalsCommon =  u_stroke_width * project_pixel(a_Normal.xy);

  float gapCommon =  project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
    perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );


  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0));

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);


  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offsetCommon.xy, 0., 1.0);
  } else {
     gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offsetCommon.xy, 0., 1.0));
  }



  setPickingColor(a_PickingColor);
}
`,iL=function(e){(0,Ot.Z)(t,e);var n=eL(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.gapWidth,o=a===void 0?2:a,u=r.strokeWidth,s=u===void 0?1:u,l=r.stroke,h=l===void 0?"#000":l,d=r.strokeOpacity,v=d===void 0?1:d;return(0,b.Z)({u_gap_width:o,u_stroke_width:s,u_stroke:wn(h),u_stroke_opacity:v},this.getStyleAttribute())}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"flow_line",vertexShader:nL,fragmentShader:rL,inject:this.getInject(),triangulation:wM,primitive:N.TRIANGLES,depth:{enable:!1},pick:!1});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0],u[1]]:[u,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:function(a,o,u){return[u[3],u[4],u[5],u[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a,o,u,s,l){return l}}})}}]),t}(ai);function aL(e){var n=oL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function oL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uL=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
varying vec4 v_line_data;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,sL=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;
varying vec4 v_line_data;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
v_line_data.b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,lL={solid:0,dash:1},cL=function(e){(0,Ot.Z)(t,e);var n=aL(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=u({data:i.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.sourceColor,s=r.targetColor,l=r.textureBlend,h=l===void 0?"normal":l,d=r.lineType,v=d===void 0?"solid":d,y=r.dashArray,x=y===void 0?[10,5]:y,S=r.lineTexture,M=S===void 0?!1:S,O=r.iconStep,H=O===void 0?100:O,W=r.segmentNumber,he=W===void 0?30:W;x.length===2&&x.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var ve=0,Re=[0,0,0,0],ze=[0,0,0,0];return u&&s&&(Re=wn(u),ze=wn(s),ve=1),{u_opacity:o,u_textureBlend:h==="normal"?0:1,segmentNumber:he,u_line_type:lL[v]||0,u_dash_array:x,u_texture:this.texture,u_line_texture:M?1:0,u_icon_step:H,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:ve,u_sourceColor:Re,u_targetColor:ze}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:sL,fragmentShader:uL,triangulation:r0,depth:{enable:!1}});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:function(o,u,s){return[s[3],s[4],s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=r.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},h=l.x,d=l.y;return[h,d]}}})}}]),t}(ai),PS;(function(e){e[e.solid=0]="solid",e[e.dash=1]="dash"})(PS||(PS={}));var np;(function(e){e.VERTICAL="vertical",e.HORIZONTAL="horizontal"})(np||(np={}));var Ng;(function(e){e.NORMAL="normal",e.REPLACE="replace"})(Ng||(Ng={}));var xd;(function(e){e[e.pixel=0]="pixel",e[e.meter=1]="meter"})(xd||(xd={}));var IS;(function(e){e.ALWAYS="always",e.DRAGEND="dragend"})(IS||(IS={}));function fL(e){var n=hL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function hL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pL=`#define LineTypeSolid 0.0
varying vec4 v_color;

// dash
varying vec4 v_dash_array;
varying float v_d_distance_ratio;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

// [animate, duration, interval, trailLength],
void main() {

  gl_FragColor = v_color;

 
  float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,dL=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying float v_d_distance_ratio;

uniform float u_opacity: 1.0;

void main() {

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = vec4(a_Color.xyz, a_Color.w * u_opacity);

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;


  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,vL=`#extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;

uniform vec3 u_blur;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying vec2 v_iconMapUV;
varying vec4 v_texture_data;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8
// [animate, duration, interval, trailLength],
void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= u_opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth / 2.0;


    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,OS=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

varying vec4 v_texture_data;

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  
  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,mL=`varying vec4 v_color;
varying vec4 v_texture_data;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity: 1.0;

#pragma include "picking"


void main() {
  float linearRadio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = v_texture_data.a;
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= u_opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,gL={solid:0,dash:1},kS=function(e){(0,Ot.Z)(t,e);var n=fL(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"textureEventFlag",!1),(0,R.Z)((0,pe.Z)(i),"texture",i.createTexture2D({data:[0,0,0,0],mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1,height:1})),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=u({data:i.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.sourceColor,s=r.targetColor,l=r.textureBlend,h=l===void 0?"normal":l,d=r.lineType,v=d===void 0?"solid":d,y=r.dashArray,x=y===void 0?[10,5,0,0]:y,S=r.lineTexture,M=S===void 0?!1:S,O=r.iconStep,H=O===void 0?100:O,W=r.vertexHeightScale,he=W===void 0?20:W,ve=r.borderWidth,Re=ve===void 0?0:ve,ze=r.borderColor,ft=ze===void 0?"#ccc":ze,gt=r.raisingHeight,Pt=gt===void 0?0:gt,Mt=r.heightfixed,sr=Mt===void 0?!1:Mt,xr=r.linearDir,Br=xr===void 0?np.VERTICAL:xr,kn=r.blur,Oi=kn===void 0?[1,1,1]:kn,xi=r.arrow,vi=xi===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:xi;x.length===2&&x.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var na=0,is=[0,0,0,0],F0=[0,0,0,0];return u&&s&&(is=wn(u),F0=wn(s),na=1),{u_opacity:(0,Rr.isNumber)(o)?o:1,u_textureBlend:h===Ng.NORMAL?0:1,u_line_type:gL[v],u_dash_array:x,u_blur:Oi,u_texture:this.texture,u_line_texture:M?1:0,u_icon_step:H,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:Re,u_borderColor:wn(ft),u_linearDir:Br===np.VERTICAL?1:0,u_linearColor:na,u_sourceColor:is,u_targetColor:F0,u_heightfixed:Number(sr),u_vertexScale:he,u_raisingHeight:Number(Pt),u_arrow:Number(vi.enable),u_arrowHeight:vi.arrowHeight||3,u_arrowWidth:vi.arrowWidth||2,u_tailWidth:vi.tailWidth===void 0?1:vi.tailWidth}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.textureEventFlag||(this.textureEventFlag=!0,this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture)),u.abrupt("return",this.buildModels());case 2:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=this.layer.getLayerConfig(),u=o.depth,s=u===void 0?!1:u,l=this.getShaders(),h=l.frag,d=l.vert,v=l.type,this.layer.triangulation=zp,S.next=5,this.layer.buildLayerModel({moduleName:"line"+v,vertexShader:d,fragmentShader:h,triangulation:zp,depth:{enable:s}});case 5:return y=S.sent,S.abrupt("return",[y]);case 7:case"end":return S.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,o=r.targetColor,u=r.lineType;return u==="dash"?{frag:pL,vert:dL,type:"Dash"}:a&&o?{frag:mL,vert:OS,type:"Linear"}:{frag:vL,vert:OS,type:""}}},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Ar.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o,u,s,l,h,d){return d===void 0?[s[3],10]:[s[3],d]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ar.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o,u,s){return[s[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(o,u,s,l,h){return h}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ar.Attribute,descriptor:{name:"a_Miter",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o,u,s){return[s[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=r.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},h=l.x,d=l.y;return[h,d]}}})}}]),t}(ai);function yL(e){var n=_L();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function _L(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xL=`
varying vec4 v_Color;
#pragma include "picking"
void main() {

  gl_FragColor = v_Color; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,SL=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;
uniform float u_opacity : 1.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;
varying vec4 v_Color;


#pragma include "projection"
#pragma include "picking"


void main() {


  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  float linearRadio =currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = texV;
  }

  v_Color = texture2D(u_texture, vec2(linearRadio, 0.5));

  v_Color.a *= u_opacity; // \u5168\u5C40\u900F\u660E\u5EA6



  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,bL=function(e){(0,Ot.Z)(t,e);var n=yL(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;i.colorTexture&&i.colorTexture.destroy();var s=i.layer.getLayerConfig(),l=s.rampColors,h=Rf(l);i.colorTexture=u({data:new Uint8Array(h.data),width:h.width,height:h.height,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE,min:N.NEAREST,mag:N.NEAREST,flipY:!1})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.vertexHeightScale,s=u===void 0?20:u,l=r.raisingHeight,h=l===void 0?0:l,d=r.heightfixed,v=d===void 0?!1:d,y=r.linearDir,x=y===void 0?np.VERTICAL:y;return this.rendererService.getDirty()&&this.colorTexture.bind(),{u_linearDir:x===np.VERTICAL?1:0,u_opacity:(0,Rr.isNumber)(o)?o:1,u_texture:this.colorTexture,u_heightfixed:Number(v),u_vertexScale:s,u_raisingHeight:Number(h)}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),u.abrupt("return",this.buildModels());case 2:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.colorTexture)===null||r===void 0||r.destroy()}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.layer.getLayerConfig(),u=o.depth,s=u===void 0?!1:u,this.layer.triangulation=kg,d.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:SL,fragmentShader:xL,triangulation:kg,depth:{enable:s}});case 4:return l=d.sent,d.abrupt("return",[l]);case 6:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Ar.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u,s,l,h){return h===void 0?[u[3],10]:[u[3],h]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ar.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a,o,u){return[u[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0],u[1]]:[u,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ar.Attribute,descriptor:{name:"a_Miter",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a,o,u){return[u[4]]}}})}}]),t}(ai);function EL(e){var n=AL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function AL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var TL=`
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;

}
`,CL=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float opacity;
void main() {
  gl_FragColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,FS=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;



#pragma include "projection"

varying vec4 v_color;
varying float v_distanceScale;

void main() {

  v_color = a_Color; 
  v_distanceScale = a_Distance / a_Total_Distance;
  v_color = vec4(a_Color.xyz, a_Color.w * u_opacity); 
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,wL=function(e){(0,Ot.Z)(t,e);var n=EL(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.sourceColor,s=r.targetColor,l=r.vertexHeightScale,h=l===void 0?20:l,d=0,v=[0,0,0,0],y=[0,0,0,0];return u&&s&&(v=wn(u),y=wn(s),d=1),{u_opacity:(0,Rr.isNumber)(o)?o:1,u_linearColor:d,u_sourceColor:v,u_targetColor:y,u_vertexScale:h}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.sourceColor,o=r.targetColor;return a&&o?{frag:CL,vert:FS,type:"lineSimpleLinear"}:{frag:TL,vert:FS,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h;return q().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.getShaders(),u=o.frag,s=o.vert,l=o.type,v.next=3,this.layer.buildLayerModel({moduleName:l,vertexShader:s,fragmentShader:u,triangulation:MM,primitive:N.LINES,depth:{enable:!1},pick:!1});case 3:return h=v.sent,v.abrupt("return",[h]);case 5:case"end":return v.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:Ar.Attribute,descriptor:{name:"a_Distance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a,o,u){return[u[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ar.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a,o,u){return[u[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0],u[1]]:[u,0]}}})}}]),t}(ai);function ML(e){var n=RL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function RL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var LL=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,PL=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,IL=function(e){(0,Ot.Z)(t,e);var n=ML(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=u({data:i.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.sourceColor,s=r.targetColor,l=r.textureBlend,h=l===void 0?"normal":l,d=r.heightfixed,v=d===void 0?!1:d,y=r.lineTexture,x=y===void 0?!1:y,S=r.iconStep,M=S===void 0?100:S,O=r.iconStepCount,H=O===void 0?1:O;this.rendererService.getDirty()&&this.texture.bind();var W=0,he=[0,0,0,0],ve=[0,0,0,0];return u&&s&&(he=wn(u),ve=wn(s),W=1),{u_heightfixed:Number(v),u_opacity:(0,Rr.isNumber)(o)?o:1,u_textureBlend:h==="normal"?0:1,u_texture:this.texture,u_line_texture:x?1:0,u_iconStepCount:H,u_icon_step:M,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:W,u_sourceColor:he,u_targetColor:ve}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:PL,fragmentShader:LL,triangulation:kg,depth:{enable:!1},blend:this.getBlend()});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Ar.Attribute,descriptor:{name:"a_Distance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o,u,s){return[s[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ar.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o,u,s){return[s[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=o.size,s=u===void 0?1:u;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(o,u,s,l,h){return h}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ar.Attribute,descriptor:{name:"a_Miter",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o,u,s){return[s[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=r.iconService.getIconMap(),s=o.texture,l=u[s]||{x:0,y:0},h=l.x,d=l.y;return[h,d]}}})}}]),t}(ai),OL={arc:DR,arc3d:jR,greatcircle:cL,wall:IL,line:kS,simple:wL,linearline:bL,earthArc3d:JR,flowline:iL},kL=OL;function FL(e){var n=NL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function NL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Dg=function(e){(0,Ot.Z)(t,e);var n=FL(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"type","LineLayer"),(0,R.Z)((0,pe.Z)(i),"enableEncodeStyles",["opacity","offsets","stroke"]),(0,R.Z)((0,pe.Z)(i),"arrowInsertCount",0),(0,R.Z)((0,pe.Z)(i),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),i}return(0,at.Z)(t,[{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new kL[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getDefaultConfig",value:function(){var r=this.getModelType(),a={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{}};return a[r]}},{key:"getModelType",value:function(){var r;if(this.layerType)return this.layerType;var a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=a==null||(r=a.scale)===null||r===void 0?void 0:r.field;return o||"line"}},{key:"processData",value:function(r){if(this.getModelType()!=="simple")return r;var a=[];return r.map(function(o){if(Array.isArray(o.coordinates)&&Array.isArray(o.coordinates[0])&&Array.isArray(o.coordinates[0][0])){var u=(0,b.Z)({},o);o.coordinates.map(function(s){a.push((0,b.Z)((0,b.Z)({},u),{},{coordinates:s}))})}else a.push(o)}),a}}]),t}(lf);function DL(e){var n=BL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function BL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZL=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"


uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;
varying float v_lightWeight;
varying float v_barLinearZ;
void main() {

   gl_FragColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,UL=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;
varying float v_lightWeight;
varying float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;

    
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,zL=function(e){(0,Ot.Z)(t,e);var n=DL(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"raiseCount",0),(0,R.Z)((0,pe.Z)(i),"raiseRepeat",0),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,o=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,u=r.opacity,s=u===void 0?1:u,l=r.sourceColor,h=r.targetColor,d=r.pickLight,v=d===void 0?!1:d,y=r.heightfixed,x=y===void 0?!1:y,S=r.opacityLinear,M=S===void 0?{enable:!1,dir:"up"}:S,O=r.lightEnable,H=O===void 0?!0:O,W=0,he=[0,0,0,0],ve=[0,0,0,0];if(l&&h&&(he=wn(l),ve=wn(h),W=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){var Re=o.speed,ze=Re===void 0?.01:Re;this.raiseCount+=ze,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(v),u_heightfixed:Number(x),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:(0,Rr.isNumber)(s)?s:1,u_linearColor:W,u_sourceColor:he,u_targetColor:ve,u_opacitylinear:Number(M.enable),u_opacitylinear_dir:M.dir==="up"?1:0,u_lightEnable:Number(H)}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.layer.getLayerConfig(),u=o.animateOption.repeat,s=u===void 0?1:u,this.raiseRepeat=s,d.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:UL,fragmentShader:ZL,triangulation:Og,depth:{enable:!0},cull:{enable:!0,face:jl(this.mapService.version)},blend:this.getBlend()});case 4:return l=d.sent,d.abrupt("return",[l]);case 6:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a){var o=a.size;if(o){var u=[];return Array.isArray(o)&&(u=o.length===2?[o[0],o[0],o[1]]:o),Array.isArray(o)||(u=[o,o,o]),u}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a){var o=Zo(a.coordinates);return aS([o[0],o[1]])}}})}}]),t}(ai);function GL(e){var n=VL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function VL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var HL=`uniform float u_additive;
uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), u_stroke_color * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,jL=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + u_offsets, 1.0);

  setPickingColor(a_PickingColor);
}
`,WL=function(e){(0,Ot.Z)(t,e);var n=GL(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.strokeOpacity,s=u===void 0?1:u,l=r.strokeWidth,h=l===void 0?0:l,d=r.stroke,v=d===void 0?"rgba(0,0,0,0)":d,y=r.blend,x=r.blur,S=x===void 0?0:x;return{u_blur:S,u_additive:y==="additive"?1:0,u_opacity:o,u_stroke_opacity:s,u_stroke_width:h,u_stroke_color:wn(v)}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.layer.triangulation=bS,s.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:jL,fragmentShader:HL,triangulation:bS,depth:{enable:!0},blend:this.getBlend()});case 3:return o=s.sent,s.abrupt("return",[o]);case 5:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.speed||1,r.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(o,u,s,l){var h=(0,Dr.Z)(s,3),d=h[0],v=h[1],y=h[2],x=Va(0,0,1),S=Va(d,0,y),M=d>=0?Pg(x,S):Math.PI*2-Pg(x,S),O=Math.PI*2-Math.asin(v/100),H=Ro();Wh(H,H,M),tf(H,H,O);var W=Va(1,1,0);yd(W,W,H),ep(W,W);var he=Va(-1,1,0);yd(he,he,H),ep(he,he);var ve=Va(-1,-1,0);yd(ve,ve,H),ep(ve,ve);var Re=Va(1,-1,0);yd(Re,Re,H),ep(Re,Re);var ze=[].concat((0,L.Z)(W),(0,L.Z)(he),(0,L.Z)(ve),(0,L.Z)(Re)),ft=l%4*3;return[ze[ft],ze[ft+1],ze[ft+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Ar.Attribute,descriptor:{name:"a_Shape",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.shape,s=u===void 0?2:u,l=r.layer.getLayerConfig().shape2d,h=l.indexOf(s);return[h]}}})}}]),t}(ai);function $L(e){var n=XL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function XL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var YL=`varying vec4 v_color;
varying float v_lightWeight;
uniform float u_pickLight: 0.0;

#pragma include "picking"


void main() {

  gl_FragColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,KL=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;
varying float v_lightWeight;
varying float v_barLinearZ;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;
uniform float u_opacitylinear: 0.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacitylinear_dir: 1.0;
uniform float  u_linearColor: 0.0;


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {


  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

    // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a =  v_color.a * u_opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * u_opacity);
  }

    if(u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? (1.0 - a_Position.z): a_Position.z;
  }


  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }

  setPickingColor(a_PickingColor);
}
`,NS=function(e){(0,Ot.Z)(t,e);var n=$L(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"raiseCount",0),(0,R.Z)((0,pe.Z)(i),"raiseRepeat",0),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,o=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,u=r.opacity,s=u===void 0?1:u,l=r.sourceColor,h=r.targetColor,d=r.pickLight,v=d===void 0?!1:d,y=r.heightfixed,x=y===void 0?!1:y,S=r.opacityLinear,M=S===void 0?{enable:!1,dir:"up"}:S,O=r.lightEnable,H=O===void 0?!0:O,W=0,he=[0,0,0,0],ve=[0,0,0,0];if(l&&h&&(he=wn(l),ve=wn(h),W=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){var Re=o.speed,ze=Re===void 0?.01:Re;this.raiseCount+=ze,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(v),u_heightfixed:Number(x),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:s,u_linearColor:W,u_sourceColor:he,u_targetColor:ve,u_opacitylinear:Number(M.enable),u_opacitylinear_dir:M.dir==="up"?1:0,u_lightEnable:Number(H)}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d;return q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return o=this.layer.getLayerConfig(),u=o.depth,s=u===void 0?!0:u,l=o.animateOption.repeat,h=l===void 0?1:l,this.raiseRepeat=h,y.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:KL,fragmentShader:YL,triangulation:Og,cull:{enable:!0,face:jl(this.mapService.version)},depth:{enable:s}});case 4:return d=y.sent,y.abrupt("return",[d]);case 6:case"end":return y.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a){var o=a.size;if(o){var u=[];return Array.isArray(o)&&(u=o.length===2?[o[0],o[0],o[1]]:o),Array.isArray(o)||(u=[o,o,o]),u}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a,o,u,s,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a){var o=Zo(a.coordinates);return[o[0],o[1],0]}}})}}]),t}(ai);function qL(e){var n=QL();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function QL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DS=`
uniform float u_additive;


varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  gl_FragColor = v_color;

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,JL=`uniform float u_additive;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec4 v_stroke;


#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    gl_FragColor = v_color;
  } else {
    gl_FragColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(gl_FragColor.a < 0.01) {
    discard;
  } 
}
`,Bg=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform int u_size_unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec4 v_stroke;

// uniform float u_opacity : 1;
uniform float u_stroke_width: 2;
uniform vec3 u_blur_height_fixed: [0, 0, 0];


#pragma include "projection"
#pragma include "picking"


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
  v_stroke = stroke;  
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);
  
  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }
 

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position =  u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,BS=function(e){(0,Ot.Z)(t,e);var n=qL(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.strokeOpacity,o=a===void 0?1:a,u=r.strokeWidth,s=u===void 0?0:u,l=r.blend,h=r.blur,d=h===void 0?0:h,v=r.raisingHeight,y=v===void 0?0:v,x=r.heightfixed,S=x===void 0?!1:x,M=r.unit,O=M===void 0?"pixel":M;return(0,b.Z)({u_blur_height_fixed:[d,Number(y),Number(S)],u_additive:l==="additive"?1:0,u_stroke_opacity:o,u_stroke_width:s,u_size_unit:xd[O]},this.getStyleAttribute())}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Zh)}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=this.layer.getLayerConfig(),u=o.animateOption,s=u===void 0?{enable:!1}:u,l=this.getShaders(s),h=l.frag,d=l.vert,v=l.type,this.layer.triangulation=Zh,S.next=5,this.layer.buildLayerModel({moduleName:v,vertexShader:d,fragmentShader:h,inject:this.getInject(),triangulation:Zh,depth:{enable:!1}});case 5:return y=S.sent,S.abrupt("return",[y]);case 7:case"end":return S.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getShaders",value:function(r){if(r.enable)switch(r.type){case"wave":return{frag:DS,vert:Bg,type:"pointWave"};default:return{frag:DS,vert:Bg,type:"pointWave"}}else return{frag:JL,vert:Bg,type:"pointFill"}}},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.speed||1,r.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(o,u,s,l){var h=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],d=l%4*3;return[h[d],h[d+1],h[d+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Ar.Attribute,descriptor:{name:"a_Shape",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.shape,s=u===void 0?2:u,l=r.indexOf(s);return[l]}}})}}]),t}(ai);function eP(e){var n=tP();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function tP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rP=`uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;

void main() {

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,nP=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;
attribute float a_Rotate;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform mat2 u_RotateMatrix;
uniform int u_size_unit;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
uniform float u_opacity : 1;
uniform vec2 u_offsets;



#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;


  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float newSize = a_Size;
  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (newSize) + u_offsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp *vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,iP=function(e){(0,Ot.Z)(t,e);var n=eP(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"meter2coord",1),(0,R.Z)((0,pe.Z)(i),"isMeter",!1),(0,R.Z)((0,pe.Z)(i),"radian",0),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),i.layerService.throttleRenderLayers();return}i.texture=u({data:i.iconService.getCanvas(),mag:N.LINEAR,min:N.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128,mipmap:!0})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.offsets,s=u===void 0?[0,0]:u,l=r.rotation,h=r.raisingHeight,d=h===void 0?0:h,v=r.heightfixed,y=v===void 0?!1:v,x=r.unit,S=x===void 0?"pixel":x;this.rendererService.getDirty()&&this.texture.bind();var M=1;return(this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(M=-1),this.radian=l!==void 0?M*Math.PI*l/180:M*Math.PI*(this.mapService.getRotation()%360)/180,{u_raisingHeight:Number(d),u_heightfixed:Number(y),u_size_unit:xd[S],u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:o,u_offsets:s}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),e0)}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:nP,fragmentShader:rP,triangulation:e0,depth:{enable:!1},cull:{enable:!0,face:jl(this.mapService.version)}});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;this.iconService.off("imageUpdate",this.updateTexture),(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Ar.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.rotate,s=u===void 0?0:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=r.iconService.getIconMap(),s=o.shape,l=u[s]||{x:-64,y:-64},h=l.x,d=l.y;return[h,d]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(o,u,s,l){var h=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],d=l%4*3;return[h[d],h[d+1],h[d+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]]:[s]}}})}}]),t}(ai);function aP(e){var n=oP();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function oP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uP=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

#pragma include "picking"

void main(){
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * u_opacity;
      
      if (gl_FragColor.a < 0.01) {
         discard;
      }
      gl_FragColor = filterColor(gl_FragColor);
}
`,sP=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec2 u_offsets;

uniform float u_opacity : 1;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;


#pragma include "projection"
#pragma include "picking"

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(u_offsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,ZS=function(e){(0,Ot.Z)(t,e);var n=aP(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"updateTexture",function(){var u=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){i.layerService.throttleRenderLayers()});return}i.texture=u({data:i.iconService.getCanvas(),mag:N.LINEAR,min:N.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128,mipmap:!0})}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.offsets,s=u===void 0?[0,0]:u,l=r.raisingHeight,h=l===void 0?0:l,d=r.heightfixed,v=d===void 0?!1:d;return this.rendererService.getDirty()&&this.texture.bind(),{u_raisingHeight:Number(h),u_heightfixed:Number(v),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:o,u_offsets:s}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:sP,fragmentShader:uP,triangulation:CM,depth:{enable:!1},primitive:N.POINTS});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(o){var u=o.size,s=u===void 0?5:u;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(o){var u=r.iconService.getIconMap(),s=o.shape,l=u[s]||{x:-64,y:-64},h=l.x,d=l.y;return[h,d]}}})}}]),t}(ai);function lP(e){var n=cP();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function cP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fP=`varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
}
`,hP=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform float u_opacity : 1;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * u_opacity);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`;function US(e){var n=e.coordinates;return{vertices:(0,L.Z)(n),indices:[0],size:n.length}}var zS=function(e){(0,Ot.Z)(t,e);var n=lP(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a;return{u_opacity:(0,Rr.isNumber)(o)?o:1}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.layer.triangulation=US,s.next=3,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:hP,fragmentShader:fP,triangulation:US,depth:{enable:!1},primitive:N.POINTS,pick:!1});case 3:return o=s.sent,s.abrupt("return",[o]);case 5:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0]]:[u]}}})}}]),t}(ai);function pP(e){var n=dP();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function dP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vP=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  // full circle
  // float rades = dot(dir, baseDir);
  // float flag = sign(dir.y);
  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;
  
  // half circle
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,mP=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform int u_size_unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;



  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
  offset = project_pixel(offset);
  
  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp *vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,gP=function(e){(0,Ot.Z)(t,e);var n=pP(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.blend,s=r.speed,l=s===void 0?1:s,h=r.unit,d=h===void 0?"pixel":h;return{u_size_unit:xd[d],u_speed:l,u_additive:u==="additive"?1:0,u_opacity:o}}},{key:"getAnimateUniforms",value:function(){var r=this.layer.getLayerConfig(),a=r.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),e0)}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:mP,fragmentShader:vP,triangulation:e0,depth:{enable:!1}});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.speed||1,r.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(a,o,u,s){var l=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=s%4*3;return[l[h],l[h+1],l[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?5:o;return Array.isArray(u)?[u[0]]:[u]}}})}}]),t}(ai);function yP(e){var n=_P();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function _P(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xP=`
uniform float u_additive;
uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,SP=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying float v_blur;
varying float v_innerRadius;



#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * u_opacity);
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);
  
  vec2 offset = project_pixel(u_offsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function GS(e){var n=e.coordinates;return{vertices:(0,L.Z)(n),indices:[0],size:n.length}}var bP=function(e){(0,Ot.Z)(t,e);var n=yP(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.offsets,s=u===void 0?[0,0]:u,l=r.blend,h=r.strokeOpacity,d=h===void 0?1:h,v=r.strokeWidth,y=v===void 0?0:v,x=r.stroke,S=x===void 0?"#fff":x;return{u_additive:l==="additive"?1:0,u_opacity:o,u_offsets:s,u_stroke_opacity:d,u_stroke_width:y,u_stroke_color:wn(S)}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.layer.triangulation=GS,s.next=3,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:SP,fragmentShader:xP,triangulation:GS,depth:{enable:!1},primitive:N.POINTS});case 3:return o=s.sent,s.abrupt("return",[o]);case 5:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?1:o;return Array.isArray(u)?[u[0]]:[u]}}})}}]),t}(ai);function EP(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=AP(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function AP(e,n){if(!!e){if(typeof e=="string")return VS(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return VS(e,n)}}function VS(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var TP=function(){function e(n,t,i){(0,ot.Z)(this,e),(0,R.Z)(this,"boxCells",[]);var r=this.boxCells;this.xCellCount=Math.ceil(n/i),this.yCellCount=Math.ceil(t/i);for(var a=0;a<this.xCellCount*this.yCellCount;a++)r.push([]);this.boxKeys=[],this.bboxes=[],this.width=n,this.height=t,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/t,this.boxUid=0}return(0,at.Z)(e,[{key:"insert",value:function(t,i,r,a,o){this.forEachCell(i,r,a,o,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(o)}},{key:"query",value:function(t,i,r,a,o){return this.queryHitTest(t,i,r,a,!1,o)}},{key:"hitTest",value:function(t,i,r,a,o){return this.queryHitTest(t,i,r,a,!0,o)}},{key:"insertBoxCell",value:function(t,i,r,a,o,u){this.boxCells[o].push(u)}},{key:"queryHitTest",value:function(t,i,r,a,o,u){if(r<0||t>this.width||a<0||i>this.height)return o?!1:[];var s=[];if(t<=0&&i<=0&&this.width<=r&&this.height<=a){if(o)return!0;for(var l=0;l<this.boxKeys.length;l++)s.push({key:this.boxKeys[l],x1:this.bboxes[l*4],y1:this.bboxes[l*4+1],x2:this.bboxes[l*4+2],y2:this.bboxes[l*4+3]});return u?s.filter(u):s}var h={hitTest:o,seenUids:{box:{},circle:{}}};return this.forEachCell(t,i,r,a,this.queryCell,s,h,u),o?s.length>0:s}},{key:"queryCell",value:function(t,i,r,a,o,u,s,l){var h=s.seenUids,d=this.boxCells[o];if(d!==null){var v=this.bboxes,y=EP(d),x;try{for(y.s();!(x=y.n()).done;){var S=x.value;if(!h.box[S]){h.box[S]=!0;var M=S*4;if(t<=v[M+2]&&i<=v[M+3]&&r>=v[M+0]&&a>=v[M+1]&&(!l||l(this.boxKeys[S]))){if(s.hitTest)return u.push(!0),!0;u.push({key:this.boxKeys[S],x1:v[M],y1:v[M+1],x2:v[M+2],y2:v[M+3]})}}}}catch(O){y.e(O)}finally{y.f()}}return!1}},{key:"forEachCell",value:function(t,i,r,a,o,u,s,l){for(var h=this.convertToXCellCoord(t),d=this.convertToYCellCoord(i),v=this.convertToXCellCoord(r),y=this.convertToYCellCoord(a),x=h;x<=v;x++)for(var S=d;S<=y;S++){var M=this.xCellCount*S+x;if(o.call(this,t,i,r,a,M,u,s,l))return}}},{key:"convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}]),e}(),CP=TP,wP=function(){function e(n,t){(0,ot.Z)(this,e),(0,R.Z)(this,"viewportPadding",100),this.width=n,this.height=t,this.viewportPadding=Math.max(n,t),this.grid=new CP(n+this.viewportPadding,t+this.viewportPadding,25),this.screenRightBoundary=n+this.viewportPadding,this.screenBottomBoundary=t+this.viewportPadding,this.gridRightBoundary=n+2*this.viewportPadding,this.gridBottomBoundary=t+2*this.viewportPadding}return(0,at.Z)(e,[{key:"placeCollisionBox",value:function(t){var i=t.x1+t.anchorPointX+this.viewportPadding,r=t.y1+t.anchorPointY+this.viewportPadding,a=t.x2+t.anchorPointX+this.viewportPadding,o=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(i,r,a,o)||this.grid.hitTest(i,r,a,o)?{box:[]}:{box:[i,r,a,o]}}},{key:"insertCollisionBox",value:function(t,i){var r={featureIndex:i};this.grid.insert(r,t[0],t[1],t[2],t[3])}},{key:"project",value:function(t,i,r){var a=Ym(i,r,0,1),o=Uv(),u=Vh.apply(oe,(0,L.Z)(t));return od(o,a,u),{x:(o[0]/o[3]+1)/2*this.width+this.viewportPadding,y:(-o[1]/o[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(t,i,r,a){return r>=0&&t<this.gridRightBoundary&&a>=0&&i<this.gridBottomBoundary}}]),e}();function HS(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=MP(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function MP(e,n){if(!!e){if(typeof e=="string")return jS(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return jS(e,n)}}function jS(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function WS(e){var n=.5,t=.5;switch(e){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0;break;default:n=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break;default:t=.5}return{horizontalAlign:n,verticalAlign:t}}function $S(e,n,t,i,r){if(!!r){var a=e[i],o=a.glyph;if(o)for(var u=n[o].advance*a.scale,s=(e[i].x+u)*r,l=t;l<=i;l++)e[l].x-=s}}function XS(e,n,t,i,r,a,o){var u=(n-t)*r,s=(-i*o+.5)*a,l=HS(e),h;try{for(l.s();!(h=l.n()).done;){var d=h.value;d.x+=u,d.y+=s}}catch(v){l.e(v)}finally{l.f()}}function RP(e,n,t,i,r,a,o){var u=-8,s=0,l=u,h=0,d=e.positionedGlyphs,v=a==="right"?1:a==="left"?0:.5,y=d.length;t.forEach(function(H){if(H.split("").forEach(function(he){var ve=n[he],Re=0;ve&&(d.push({glyph:he,x:s,y:l+Re,vertical:!1,scale:1,metrics:ve}),s+=ve.advance+o)}),d.length!==y){var W=s-o;h=Math.max(W,h),$S(d,n,y,d.length-1,v)}s=0,l-=i+5});var x=WS(r),S=x.horizontalAlign,M=x.verticalAlign;XS(d,v,S,M,h,i,t.length);var O=l-u;e.top+=-M*O,e.bottom=e.top-O,e.left+=-S*h,e.right=e.left+h}function LP(e,n,t,i,r,a,o){var u=-8,s=0,l=u,h=0,d=e.positionedGlyphs,v=a==="right"?1:a==="left"?0:.5,y=d.length;t.forEach(function(H){var W=n[H],he=0;if(W&&(d.push({glyph:H,x:W.advance/2,y:l+he,vertical:!1,scale:1,metrics:W}),s+=W.advance+o),d.length!==y){var ve=s-o;h=Math.max(ve,h),$S(d,n,y,d.length-1,v)}s=0,l-=i+5});var x=WS(r),S=x.horizontalAlign,M=x.verticalAlign;XS(d,v,S,M,h,i,t.length);var O=l-u;e.top+=-M*O,e.bottom=e.top-O,e.left+=-S*h,e.right=e.left+h}function PP(e,n,t,i,r,a){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],u=arguments.length>7?arguments[7]:void 0,s=e.split(`
`),l=[],h={positionedGlyphs:l,top:o[1],bottom:o[1],left:o[0],right:o[0],lineCount:s.length,text:e};return u?LP(h,n,s,t,i,r,a):RP(h,n,s,t,i,r,a),l.length?h:!1}function IP(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],t=arguments.length>2?arguments[2]:void 0,i=e.positionedGlyphs,r=i===void 0?[]:i,a=[],o=HS(r),u;try{for(o.s();!(u=o.n()).done;){var s=u.value,l=s.metrics,h=4,d=l.advance*s.scale/2,v=t?[s.x+d,s.y]:[0,0],y=t?[0,0]:[s.x+d+n[0],s.y+n[1]],x=(0-h)*s.scale-d+y[0],S=(0-h)*s.scale+y[1],M=x+l.width*s.scale,O=S+l.height*s.scale,H={x,y:S},W={x:M,y:S},he={x,y:O},ve={x:M,y:O};a.push({tl:H,tr:W,bl:he,br:ve,tex:l,glyphOffset:v})}}catch(Re){o.e(Re)}finally{o.f()}return a}function OP(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=kP(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function kP(e,n){if(!!e){if(typeof e=="string")return YS(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return YS(e,n)}}function YS(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function FP(e){var n=NP();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function NP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var KS=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec4 v_stroke_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;


#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  gl_FragColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  gl_FragColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (gl_FragColor.a < 0.01) {
    discard;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,qS=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying vec4 v_stroke_color;
varying float v_fontScale;
// uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];


#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  
  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp *(vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function QS(e){var n=this,t=e.id,i=[],r=[];if(!n.glyphInfoMap||!n.glyphInfoMap[t])return{vertices:[],indices:[],size:7};var a=n.glyphInfoMap[t].centroid,o=a.length===2?[a[0],a[1],0]:a;return n.glyphInfoMap[t].glyphQuads.forEach(function(u,s){i.push.apply(i,(0,L.Z)(o).concat([u.tex.x,u.tex.y+u.tex.height,u.tl.x,u.tl.y],(0,L.Z)(o),[u.tex.x+u.tex.width,u.tex.y+u.tex.height,u.tr.x,u.tr.y],(0,L.Z)(o),[u.tex.x+u.tex.width,u.tex.y,u.br.x,u.br.y],(0,L.Z)(o),[u.tex.x,u.tex.y,u.bl.x,u.bl.y])),r.push(0+s*4,1+s*4,2+s*4,2+s*4,3+s*4,0+s*4)}),{vertices:i,indices:r,size:7}}var JS=function(e){(0,Ot.Z)(t,e);var n=FP(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"glyphInfoMap",{}),(0,R.Z)((0,pe.Z)(i),"currentZoom",-1),(0,R.Z)((0,pe.Z)(i),"textureHeight",0),(0,R.Z)((0,pe.Z)(i),"textCount",0),(0,R.Z)((0,pe.Z)(i),"preTextStyle",{}),(0,R.Z)((0,pe.Z)(i),"mapping",(0,st.Z)(q().mark(function u(){return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i.initGlyph(),i.updateTexture(),l.next=4,i.reBuildModel();case 4:case"end":return l.stop()}},u)}))),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.stroke,s=u===void 0?"#fff":u,l=r.strokeWidth,h=l===void 0?0:l,d=r.halo,v=d===void 0?.5:d,y=r.gamma,x=y===void 0?2:y,S=r.raisingHeight,M=S===void 0?0:S,O=this.getFontServiceMapping(),H=this.getFontServiceCanvas();return O&&Object.keys(O).length!==this.textCount&&H&&(this.updateTexture(),this.textCount=Object.keys(O).length),this.preTextStyle=this.getTextStyle(),(0,b.Z)({u_raisingHeight:Number(M),u_stroke_width:h,u_stroke_color:wn(s),u_sdf_map:this.texture,u_halo_blur:v,u_gamma_scale:x,u_sdf_map_size:[(H==null?void 0:H.width)||1,(H==null?void 0:H.height)||1]},this.getStyleAttribute())}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),this.rawEncodeData=this.layer.getEncodedData(),this.preTextStyle=this.getTextStyle(),u.abrupt("return",this.buildModels());case 5:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.layer.getLayerConfig(),u=o.textAllowOverlap,s=u===void 0?!1:u,this.initGlyph(),this.updateTexture(),s||this.filterGlyphs(),d.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:qS,fragmentShader:KS,inject:this.getInject(),triangulation:QS.bind(this),depth:{enable:!1}});case 6:return l=d.sent,d.abrupt("return",[l]);case 8:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"needUpdate",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y,x,S,M,O;return q().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(o=this.getTextStyle(),u=o.textAllowOverlap,s=u===void 0?!1:u,l=o.textAnchor,h=l===void 0?"center":l,d=o.textOffset,v=o.padding,y=o.fontFamily,x=o.fontWeight,!(!(0,Rr.isEqual)(v,this.preTextStyle.padding)||!(0,Rr.isEqual)(d,this.preTextStyle.textOffset)||!(0,Rr.isEqual)(h,this.preTextStyle.textAnchor)||!(0,Rr.isEqual)(y,this.preTextStyle.fontFamily)||!(0,Rr.isEqual)(x,this.preTextStyle.fontWeight))){W.next=5;break}return W.next=4,this.mapping();case 4:return W.abrupt("return",!0);case 5:if(!s){W.next=7;break}return W.abrupt("return",!1);case 7:if(S=this.mapService.getZoom(),M=this.mapService.getBounds(),O=kf(this.extent,M),!(Math.abs(this.currentZoom-S)>.5||!O||s!==this.preTextStyle.textAllowOverlap)){W.next=14;break}return W.next=13,this.reBuildModel();case 13:return W.abrupt("return",!0);case 14:return W.abrupt("return",!1);case 15:case"end":return W.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Ar.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a){var o=a.rotate,u=o===void 0?0:o;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Ar.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u){return[u[5],u[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(a){var o=a.size,u=o===void 0?12:o;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Ar.Attribute,descriptor:{name:"a_tex",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var r=this.mapService.getBounds();return Ms(r,.5)}},{key:"initTextFont",value:function(){var r=this.getTextStyle(),a=r.fontWeight,o=r.fontFamily,u=this.rawEncodeData,s=[];u.forEach(function(l){var h=l.shape,d=h===void 0?"":h;d=d.toString();var v=OP(d),y;try{for(v.s();!(y=v.n()).done;){var x=y.value;s.indexOf(x)===-1&&s.push(x)}}catch(S){v.e(S)}finally{v.f()}}),this.fontService.setFontOptions({characterSet:s,fontWeight:a,fontFamily:o,iconfont:!1})}},{key:"initIconFontTex",value:function(){var r=this.getTextStyle(),a=r.fontWeight,o=r.fontFamily,u=this.rawEncodeData,s=[];u.forEach(function(l){var h=l.shape,d=h===void 0?"":h;d="".concat(d),s.indexOf(d)===-1&&s.push(d)}),this.fontService.setFontOptions({characterSet:s,fontWeight:a,fontFamily:o,iconfont:!0})}},{key:"getTextStyle",value:function(){var r=this.layer.getLayerConfig(),a=r.fontWeight,o=a===void 0?"400":a,u=r.fontFamily,s=u===void 0?"sans-serif":u,l=r.textAllowOverlap,h=l===void 0?!1:l,d=r.padding,v=d===void 0?[0,0]:d,y=r.textAnchor,x=y===void 0?"center":y,S=r.textOffset,M=S===void 0?[0,0]:S,O=r.opacity,H=O===void 0?1:O,W=r.strokeOpacity,he=W===void 0?1:W,ve=r.strokeWidth,Re=ve===void 0?0:ve,ze=r.stroke,ft=ze===void 0?"#000":ze;return{fontWeight:o,fontFamily:s,textAllowOverlap:h,padding:v,textAnchor:x,textOffset:M,opacity:H,strokeOpacity:he,strokeWidth:Re,stroke:ft}}},{key:"generateGlyphLayout",value:function(r){var a=this,o=this.getFontServiceMapping(),u=this.layer.getLayerConfig(),s=u.spacing,l=s===void 0?2:s,h=u.textAnchor,d=h===void 0?"center":h,v=u.textOffset,y=this.rawEncodeData;this.glyphInfo=y.map(function(x){var S=x.shape,M=S===void 0?"":S,O=x.id,H=x.size,W=H===void 0?1:H,he=PP(M.toString(),o,W,d,"left",l,v,r),ve=IP(he,v,!1);return x.shaping=he,x.glyphQuads=ve,x.centroid=Zo(x.coordinates),x.originCentroid=x.version==="GAODE2.x"?Zo(x.originCoordinates):x.originCentroid=x.centroid,a.glyphInfoMap[O]={shaping:he,glyphQuads:ve,centroid:Zo(x.coordinates)},x})}},{key:"getFontServiceMapping",value:function(){var r=this.layer.getLayerConfig(),a=r.fontWeight,o=a===void 0?"400":a,u=r.fontFamily,s=u===void 0?"sans-serif":u;return this.fontService.getMappingByKey("".concat(s,"_").concat(o))}},{key:"getFontServiceCanvas",value:function(){var r=this.layer.getLayerConfig(),a=r.fontWeight,o=a===void 0?"400":a,u=r.fontFamily,s=u===void 0?"sans-serif":u;return this.fontService.getCanvasByKey("".concat(s,"_").concat(o))}},{key:"filterGlyphs",value:function(){var r=this,a=this.layer.getLayerConfig(),o=a.padding,u=o===void 0?[0,0]:o,s=a.textAllowOverlap,l=s===void 0?!1:s;if(!l){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var h=this.rendererService.getViewportSize(),d=h.width,v=h.height,y=new wP(d,v),x=this.glyphInfo.filter(function(S){var M=S.shaping,O=S.id,H=O===void 0?0:O,W=S.version==="GAODE2.x"?S.originCentroid:S.centroid,he=S.size,ve=he/16,Re=r.mapService.lngLatToContainer(W),ze=y.placeCollisionBox({x1:M.left*ve-u[0],x2:M.right*ve+u[0],y1:M.top*ve-u[1],y2:M.bottom*ve+u[1],anchorPointX:Re.x,anchorPointY:Re.y}),ft=ze.box;return ft&&ft.length?(y.insertCollisionBox(ft,H),!0):!1});x.forEach(function(S){r.glyphInfoMap[S.id]=S})}}},{key:"initGlyph",value:function(){var r=this.layer.getLayerConfig(),a=r.iconfont,o=a===void 0?!1:a;o?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(o)}},{key:"updateTexture",value:function(){var r=this.rendererService.createTexture2D,a=this.getFontServiceCanvas();this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=r({data:a,mag:N.LINEAR,min:N.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return this.filterGlyphs(),s.next=3,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:qS,fragmentShader:KS,triangulation:QS.bind(this),inject:this.getInject(),depth:{enable:!1}});case 3:o=s.sent,this.layer.models=[o];case 5:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()}]),t}(ai),DP={fillImage:iP,fill:BS,radar:gP,image:ZS,normal:zS,simplePoint:bP,extrude:NS,text:JS,earthFill:WL,earthExtrude:zL},BP=DP;function ZP(e,n){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=UP(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw u}}}}function UP(e,n){if(!!e){if(typeof e=="string")return eb(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return eb(e,n)}}function eb(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function zP(e){var n=GP();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function GP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var i0=function(e){(0,Ot.Z)(t,e);var n=zP(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"type","PointLayer"),(0,R.Z)((0,pe.Z)(i),"enableEncodeStyles",["opacity","offsets","stroke"]),(0,R.Z)((0,pe.Z)(i),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),i}return(0,at.Z)(t,[{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new BP[o](this),s.next=5,this.initLayerModels();case 5:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"rebuildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.buildModels();case 2:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var r=this.shapeOption,a=r.field,o=r.values,u=this.getLayerConfig(),s=u.shape2d,l=this.iconService.getIconMap();if(a&&(s==null?void 0:s.indexOf(a))!==-1)return"fill";if(o==="text")return"text";if(o&&o instanceof Array){var h=ZP(o),d;try{for(h.s();!(d=h.n()).done;){var v=d.value;if(typeof v=="string"&&l.hasOwnProperty(v))return"image"}}catch(y){h.e(y)}finally{h.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var r=this.getModelType(),a={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return a[r]}},{key:"getModelType",value:function(){var r=this.getEncodedData(),a=this.getLayerConfig(),o=a.shape2d,u=a.shape3d,s=this.iconService.getIconMap(),l=r.find(function(d){return d.hasOwnProperty("shape")});if(l){var h=l.shape;return h==="dot"?"normal":h==="simple"?"simplePoint":h==="radar"?"radar":this.layerType==="fillImage"?"fillImage":(o==null?void 0:o.indexOf(h))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(u==null?void 0:u.indexOf(h))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":s.hasOwnProperty(h)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),t}(lf);function VP(e){var n=HP();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function HP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var jP=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;

#pragma include "picking"

void main() {


     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  

  gl_FragColor = filterColor(gl_FragColor);
}
`,WP=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  float isSide = a_Position.z;
 float topU = a_uvs[0];
 float topV = 1.0 - a_uvs[1];
 float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);

  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }



  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);


  setPickingColor(a_PickingColor);
}
`,$P=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying vec3 v_uvs;
varying vec2 v_texture_data;


#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
    // gl_FragColor = vec4(1.0, 0., 0., 1.0);
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,XP=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform sampler2D u_texture;


uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;
varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_linearColor: 0.0;

varying vec2 v_texture_data;
varying vec3 v_uvs;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_uvs = a_uvs;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }




  setPickingColor(a_PickingColor);
}
`,YP=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying vec3 v_uvs;
varying vec2 v_texture_data;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,KP=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;

varying vec2 v_texture_data;
varying vec3 v_uvs;
varying vec4 v_Color;


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {


  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  v_texture_data = vec2(a_Position.z,lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,qP=function(e){(0,Ot.Z)(t,e);var n=VP(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.heightfixed,o=a===void 0?!1:a,u=r.raisingHeight,s=u===void 0?0:u,l=r.topsurface,h=l===void 0?!0:l,d=r.sidesurface,v=d===void 0?!0:d,y=r.sourceColor,x=r.targetColor,S=0,M=[1,1,1,1],O=[1,1,1,1];return y&&x&&(M=wn(y),O=wn(x),S=1),(0,b.Z)({u_topsurface:Number(h),u_sidesurface:Number(v),u_heightfixed:Number(o),u_raisingHeight:Number(s),u_linearColor:S,u_sourceColor:M,u_targetColor:O,u_texture:this.texture},this.getStyleAttribute())}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.loadTexture();case 2:return u.abrupt("return",this.buildModels());case 3:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h;return q().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=this.getShaders(),u=o.frag,s=o.vert,l=o.type,v.next=3,this.layer.buildLayerModel({moduleName:l,vertexShader:s,fragmentShader:u,inject:this.getInject(),triangulation:AS});case 3:return h=v.sent,v.abrupt("return",[h]);case 5:case"end":return v.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getShaders",value:function(){var r=this.layer.getLayerConfig(),a=r.pickLight,o=r.mapTexture;return o?{frag:$P,vert:XP,type:"polygonExtrudeTexture"}:a?{frag:YP,vert:KP,type:"polygonExtrudePickLight"}:{frag:jP,vert:WP,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getSource().extent,a=r,o=this.layer.coordCenter||this.layer.getSource().center,u=a[2]-a[0],s=a[3]-a[1];if(this.mapService.version==="GAODE2.x"){var l=this.mapService.coordToAMap2RelativeCoordinates([r[0],r[1]],o),h=(0,Dr.Z)(l,2),d=h[0],v=h[1],y=this.mapService.coordToAMap2RelativeCoordinates([r[2],r[3]],o),x=(0,Dr.Z)(y,2),S=x[0],M=x[1];u=S-d,s=M-v,a=[d,v,S,M]}this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Ar.Attribute,descriptor:{name:"a_uvs",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(H,W,he){var ve=he[0],Re=he[1];return[(ve-a[0])/u,(Re-a[1])/s,he[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(H,W,he,ve,Re){return Re}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(H){var W=H.size,he=W===void 0?10:W;return Array.isArray(he)?[he[0]]:[he]}}})}},{key:"loadTexture",value:function(){var i=(0,st.Z)(q().mark(function a(){var o=this,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(u=this.layer.getLayerConfig(),s=u.mapTexture,l=this.rendererService.createTexture2D,this.texture=l({height:0,width:0}),!s){d.next=5;break}return d.abrupt("return",new Promise(function(v,y){var x=new Image;x.crossOrigin="anonymous",x.src=s,x.onload=function(){return o.texture=l({data:x,width:x.width,height:x.height,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE,min:N.LINEAR,mag:N.LINEAR}),v(null)},x.onerror=function(){y(new Error("image load error"))}}));case 5:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()}]),t}(ai);function QP(e){var n=JP();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function JP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eI=`varying vec4 v_color;
#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor = filterColor(gl_FragColor);
}
`,tI=`#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;
varying vec4 v_Color;


void main() {
   gl_FragColor = v_Color;
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,rI=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;


#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_Color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,nI=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_raisingHeight: 0.0;

varying vec4 v_color;


#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,iI=function(e){(0,Ot.Z)(t,e);var n=QP(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.raisingHeight,o=a===void 0?0:a,u=r.opacityLinear,s=u===void 0?{enable:!1,dir:"in"}:u;return(0,b.Z)({u_raisingHeight:Number(o),u_opacitylinear:Number(s.enable),u_dir:s.dir==="in"?1:0},this.getStyleAttribute())}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y,x,S;return q().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return o=this.getModelParams(),u=o.frag,s=o.vert,l=o.triangulation,h=o.type,d=this.layer.getLayerConfig(),v=d.workerEnabled,y=v===void 0?!1:v,x=d.enablePicking,this.layer.triangulation=l,O.next=5,this.layer.buildLayerModel({moduleName:h,vertexShader:s,fragmentShader:u,inject:this.getInject(),triangulation:l,primitive:N.TRIANGLES,depth:{enable:!1},workerEnabled:y,workerOptions:{modelType:h,enablePicking:x}});case 5:return S=O.sent,O.abrupt("return",[S]);case 7:case"end":return O.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getLayerConfig(),a=r.opacityLinear,o=a===void 0?{enable:!1,dir:"in"}:a;o.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Ar.Attribute,descriptor:{name:"a_linear",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:function(s,l,h){return[h[3],h[4],h[5]]}}})}},{key:"getModelParams",value:function(){var r=this.layer.getLayerConfig(),a=r.opacityLinear,o=a===void 0?{enable:!1}:a;return o.enable?{frag:tI,vert:rI,type:"polygonLinear",triangulation:PM}:{frag:eI,vert:nI,type:"polygonFill",triangulation:Xd}}}]),t}(ai);function aI(e){var n=oI();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function oI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uI=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,sI=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,lI=function(e){(0,Ot.Z)(t,e);var n=aI(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.watercolor,s=u===void 0?"#6D99A8":u,l=r.watercolor2,h=l===void 0?"#0F121C":l;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:wn(s),u_watercolor2:wn(h),u_opacity:(0,Rr.isNumber)(o)?o:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.loadTexture(),u.abrupt("return",this.buildModels());case 2:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:sI,fragmentShader:uI,triangulation:Fg,primitive:N.TRIANGLES,depth:{enable:!1}});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r,a,o;(r=this.texture1)===null||r===void 0||r.destroy(),(a=this.texture2)===null||a===void 0||a.destroy(),(o=this.texture3)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getSource().extent,a=(0,Dr.Z)(r,4),o=a[0],u=a[1],s=a[2],l=a[3],h=s-o,d=l-u;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Ar.Attribute,descriptor:{name:"a_uv",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(y,x,S,M){var O=y.version===Au["GAODE2.x"]?y.originCoordinates[0][M]:S,H=(0,Dr.Z)(O,2),W=H[0],he=H[1];return[(W-o)/h,(he-u)/d]}}})}},{key:"loadTexture",value:function(){var r=this,a=this.rendererService.createTexture2D,o={height:0,width:0};this.texture1=a(o),this.texture2=a(o),this.texture3=a(o),u(function(l){r.texture1=s(l[0]),r.texture2=s(l[1]),r.texture3=s(l[2]),r.layerService.reRender()});function u(l){var h=0,d=[],v=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];v.map(function(y){var x=new Image;x.crossOrigin="",x.src=y,d.push(x),x.onload=function(){h++,h===3&&l(d)}})}function s(l){return a({data:l,width:l.width,height:l.height,wrapS:N.MIRRORED_REPEAT,wrapT:N.MIRRORED_REPEAT,min:N.LINEAR,mag:N.LINEAR})}}}]),t}(ai);function cI(e){var n=fI();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function fI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hI=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,pI=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,dI=function(e){(0,Ot.Z)(t,e);var n=cI(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.speed,s=u===void 0?.5:u;return{u_texture:this.texture,u_speed:s,u_opacity:(0,Rr.isNumber)(o)?o:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.loadTexture(),u.abrupt("return",this.buildModels());case 2:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:pI,fragmentShader:hI,triangulation:Fg,primitive:N.TRIANGLES,depth:{enable:!1}});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){var r=this.layer.getSource().extent,a=(0,Dr.Z)(r,4),o=a[0],u=a[1],s=a[2],l=a[3],h=s-o,d=l-u;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Ar.Attribute,descriptor:{name:"a_uv",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(y,x,S,M){var O=y.version===Au["GAODE2.x"]?y.originCoordinates[0][M]:S,H=(0,Dr.Z)(O,2),W=H[0],he=H[1];return[(W-o)/h,(he-u)/d]}}})}},{key:"loadTexture",value:function(){var r=this,a=this.layer.getLayerConfig(),o=a.waterTexture,u=this.rendererService.createTexture2D;this.texture=u({height:0,width:0});var s=new Image;s.crossOrigin="",o?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),s.src=o):s.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",s.onload=function(){r.texture=u({data:s,width:s.width,height:s.height,wrapS:N.MIRRORED_REPEAT,wrapT:N.MIRRORED_REPEAT,min:N.LINEAR,mag:N.LINEAR}),r.layerService.reRender()}}}]),t}(ai),vI={fill:iI,line:kS,extrude:qP,text:JS,point_fill:BS,point_image:ZS,point_normal:zS,point_extrude:NS,water:dI,ocean:lI},mI=vI;function gI(e){var n=yI();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function yI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a0=function(e){(0,Ot.Z)(t,e);var n=gI(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"type","PolygonLayer"),(0,R.Z)((0,pe.Z)(i),"enableEncodeStyles",["opacity"]),i}return(0,at.Z)(t,[{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new mI[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getModelType",value:function(){var r,a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=a==null||(r=a.scale)===null||r===void 0?void 0:r.field;return o==="fill"||!o?"fill":o==="extrude"?"extrude":o==="water"?"water":o==="ocean"?"ocean":o==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var r=this.getEncodedData(),a=this.getLayerConfig(),o=a.shape2d,u=a.shape3d,s=this.iconService.getIconMap(),l=r.find(function(d){return d.hasOwnProperty("shape")});if(l){var h=l.shape;return h==="dot"?"point_normal":(o==null?void 0:o.indexOf(h))!==-1?"point_fill":(u==null?void 0:u.indexOf(h))!==-1?"point_extrude":s.hasOwnProperty(h)?"point_image":"text"}else return"fill"}}]),t}(lf);function _I(e){var n=xI();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function xI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var SI=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
      discard;
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
     discard;
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
    if(gl_FragColor.a < 0.01)
      discard;
   
  }
}
`,bI=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,tb=function(e){(0,Ot.Z)(t,e);var n=_I(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.clampLow,s=u===void 0?!0:u,l=r.clampHigh,h=l===void 0?!0:l,d=r.noDataValue,v=d===void 0?-9999999:d,y=r.domain,x=r.rampColors,S=y||Yi(x);return this.colorTexture=this.layer.textureService.getColorTexture(x,S),{u_opacity:o||1,u_texture:this.texture,u_domain:S,u_clampLow:s,u_clampHigh:typeof h!="undefined"?h:s,u_noDataValue:v,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var i=(0,st.Z)(q().mark(function a(o){var u,s,l,h;return q().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!Array.isArray(o.data)){v.next=4;break}return v.abrupt("return",{data:o.data,width:o.width,height:o.height});case 4:return v.next=6,o.data;case 6:return u=v.sent,s=u.rasterData,l=u.width,h=u.height,v.abrupt("return",{data:Array.from(s),width:l,height:h});case 11:case"end":return v.stop()}},a)}));function r(a){return i.apply(this,arguments)}return r}()},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=this.layer.getSource(),u=this.rendererService.createTexture2D,s=o.data.dataArray[0],S.next=5,this.getRasterData(s);case 5:return l=S.sent,h=l.data,d=l.width,v=l.height,this.texture=u({data:h,width:d,height:v,format:N.LUMINANCE,type:N.FLOAT}),S.next=12,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:bI,fragmentShader:SI,triangulation:t0,primitive:N.TRIANGLES,depth:{enable:!1}});case 12:return y=S.sent,S.abrupt("return",[y]);case 14:case"end":return S.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.initModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r,a;(r=this.texture)===null||r===void 0||r.destroy(),(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}}]),t}(ai),EI=["data"],AI=["rasterData"];function TI(e){var n=CI();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function CI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var wI=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,MI=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
  if(gl_FragColor.a < 0.01)
    discard;
 
}`,RI=function(e){(0,Ot.Z)(t,e);var n=TI(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"dataOption",{}),i}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.noDataValue,s=u===void 0?0:u,l=this.dataOption,h=l.rMinMax,d=l.gMinMax,v=l.bMinMax;return{u_opacity:o||1,u_texture:this.texture,u_noDataValue:s,u_rminmax:h,u_gminmax:d,u_bminmax:v}}},{key:"getRasterData",value:function(){var i=(0,st.Z)(q().mark(function a(o){var u,s,l,h,d;return q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!Array.isArray(o.data)){y.next=4;break}return u=o.data,s=(0,es.Z)(o,EI),this.dataOption=s,y.abrupt("return",(0,b.Z)({data:u},s));case 4:return y.next=6,o.data;case 6:if(l=y.sent,h=l.rasterData,d=(0,es.Z)(l,AI),this.dataOption=d,!Array.isArray(h)){y.next=14;break}return y.abrupt("return",(0,b.Z)({data:h},d));case 14:return y.abrupt("return",(0,b.Z)({data:Array.from(h)},d));case 15:case"end":return y.stop()}},a,this)}));function r(a){return i.apply(this,arguments)}return r}()},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=this.layer.getSource(),u=this.rendererService.createTexture2D,s=o.data.dataArray[0],S.next=5,this.getRasterData(s);case 5:return l=S.sent,h=l.data,d=l.width,v=l.height,this.texture=u({data:h,width:d,height:v,format:N.RGB,type:N.FLOAT}),S.next=12,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:wI,fragmentShader:MI,triangulation:t0,primitive:N.TRIANGLES,depth:{enable:!1}});case 12:return y=S.sent,S.abrupt("return",[y]);case 14:case"end":return S.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.initModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}}]),t}(ai);function LI(e){var n=PI();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function PI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var II=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
uniform vec4 u_unpack;

float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data = texture2D(u_texture, coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return texture2D(u_colorTexture, coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    gl_FragColor = getColor(value);
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
      if(gl_FragColor.a < 0.01)
      discard;
  }
}
`,OI=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,kI=function(e){(0,Ot.Z)(t,e);var n=LI(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=r.clampLow,u=o===void 0?!0:o,s=r.clampHigh,l=s===void 0?!0:s,h=r.noDataValue,d=h===void 0?-9999999:h,v=r.domain,y=r.rampColors,x=r.colorTexture,S=r.rScaler,M=S===void 0?6553.6:S,O=r.gScaler,H=O===void 0?25.6:O,W=r.bScaler,he=W===void 0?.1:W,ve=r.offset,Re=ve===void 0?1e4:ve,ze=v||Yi(y),ft=x;return x?this.layer.textureService.setColorTexture(x,y,ze):ft=this.layer.textureService.getColorTexture(y,ze),{u_opacity:a||1,u_texture:this.texture,u_domain:ze,u_clampLow:u,u_clampHigh:typeof l!="undefined"?l:u,u_noDataValue:d,u_unpack:[M,H,he,Re],u_colorTexture:ft}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.layer.getSource(),u=this.rendererService.createTexture2D,d.next=4,o.data.images;case 4:return s=d.sent,this.texture=u({data:s[0],width:s[0].width,height:s[0].height,min:N.LINEAR,mag:N.LINEAR}),d.next=8,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:OI,fragmentShader:II,triangulation:t0,primitive:N.TRIANGLES,depth:{enable:!1}});case 8:return l=d.sent,d.abrupt("return",[l]);case 10:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r;(r=this.texture)===null||r===void 0||r.destroy()}},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.initModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:function(a,o,u){return[u[3],u[4]]}}})}}]),t}(ai),FI={raster:tb,rasterRgb:RI,raster3d:tb,rasterTerrainRgb:kI},NI=FI;function DI(e){var n=BI();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function BI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var o0=function(e){(0,Ot.Z)(t,e);var n=DI(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"type","RasterLayer"),i}return(0,at.Z)(t,[{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new NI[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getDefaultConfig",value:function(){var r=this.getModelType(),a={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return a[r]}},{key:"getModelType",value:function(){var r=this.layerSource.getParserType();switch(r){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),t}(lf);function ZI(e){var n=UI();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function UI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zI=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,GI=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,VI=function(e){(0,Ot.Z)(t,e);var n=ZI(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getUninforms",value:function(){var r=this.layer.getLayerConfig(),a=r.opacity,o=a===void 0?1:a,u=r.color,s=u===void 0?"#000":u;return{u_opacity:(0,Rr.isNumber)(o)?o:0,u_color:wn(s)}}},{key:"initModels",value:function(){var i=(0,st.Z)(q().mark(function a(){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.buildModels());case 1:case"end":return u.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:GI,fragmentShader:zI,triangulation:Fg,depth:{enable:!1},pick:!1});case 2:return o=s.sent,s.abrupt("return",[o]);case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),t}(ai),HI={fill:VI},jI=HI;function WI(e){var n=$I();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function $I(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rb=function(e){(0,Ot.Z)(t,e);var n=WI(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"type","MaskLayer"),i}return(0,at.Z)(t,[{key:"buildModels",value:function(){var i=(0,st.Z)(q().mark(function a(){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this.getModelType(),this.layerModel=new jI[o](this),s.next=4,this.initLayerModels();case 4:case"end":return s.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getModelType",value:function(){return"fill"}}]),t}(lf),nb,ib,ab,ob,u0,ub,sb,XI=(nb=(0,pr.b2)(),ib=(0,pr.f3)(qe.IMapService),ab=(0,pr.f3)(qe.IFontService),nb(ob=(u0=function(){function e(){(0,ot.Z)(this,e),En(this,"mapService",ub,this),En(this,"fontService",sb,this)}return(0,at.Z)(e,[{key:"apply",value:function(t,i){var r=this,a=i.styleAttributeService;t.hooks.init.tapPromise("DataMappingPlugin",(0,st.Z)(q().mark(function o(){return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:t.log(ca.MappingStart,$n.INIT),r.generateMaping(t,{styleAttributeService:a}),t.log(ca.MappingEnd,$n.INIT);case 3:case"end":return s.stop()}},o)}))),t.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var o=(0,st.Z)(q().mark(function u(s){var l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(s){d.next=2;break}return d.abrupt("return",s);case 2:return t.dataState.dataMappingNeedUpdate=!1,t.log(ca.MappingStart,$n.UPDATE),l=r.generateMaping(t,{styleAttributeService:a}),t.log(ca.MappingEnd,$n.UPDATE),d.abrupt("return",l);case 7:case"end":return d.stop()}},u)}));return function(u){return o.apply(this,arguments)}}()),t.hooks.beforeRender.tap("DataMappingPlugin",function(){var o=t.getSource();if(!(t.layerModelNeedUpdate||!o||!o.inited)){var u=a.getLayerStyleAttributes()||[],s=a.getLayerStyleAttribute("filter"),l=o.data.dataArray;if(!(Array.isArray(l)&&l.length===0)){var h=u.filter(function(y){return y.needRemapping}),d=l;if(s!=null&&s.needRemapping&&s!==null&&s!==void 0&&s.scale&&(d=l.filter(function(y){return r.applyAttributeMapping(s,y)[0]})),h.length){var v=r.mapping(t,h,d,t.getEncodedData());t.setEncodedData(v)}}}})}},{key:"generateMaping",value:function(t,i){var r=this,a=i.styleAttributeService,o=a.getLayerStyleAttributes()||[],u=a.getLayerStyleAttribute("filter"),s=t.getSource().data.dataArray,l=s;u!=null&&u.scale&&(l=s.filter(function(d){return r.applyAttributeMapping(u,d)[0]})),l=t.processData(l);var h=this.mapping(t,o,l,void 0);return t.setEncodedData(h),s.length===0&&t.encodeDataLength===0?!1:(t.emit("dataUpdate",null),!0)}},{key:"mapping",value:function(t,i,r,a){var o=this,u=t.getLayerConfig(),s=u.arrow,l=s===void 0?{enable:!1}:s,h=i.filter(function(v){return v.scale!==void 0}).filter(function(v){return v.name!=="filter"}),d=r.map(function(v,y){var x=a?a[y]:{},S=(0,b.Z)({id:v._id,coordinates:v.coordinates},x);if(h.forEach(function(H){var W=o.applyAttributeMapping(H,v);(H.name==="color"||H.name==="stroke")&&(W=W.map(function(he){return wn(he)})),S[H.name]=Array.isArray(W)&&W.length===1?W[0]:W,H.name==="shape"&&(S.shape=o.fontService.getIconFontKey(S[H.name]))}),l.enable&&S.shape==="line"){var M=S.coordinates;if(t.arrowInsertCount<t.encodeDataLength){var O=o.getArrowPoints(M[0],M[1]);S.coordinates.splice(1,0,O,O),t.arrowInsertCount++}}return S});return i.forEach(function(v){v.needRemapping=!1}),this.adjustData2Amap2Coordinates(d,t),this.adjustData2SimpleCoordinates(d),d}},{key:"adjustData2Amap2Coordinates",value:function(t,i){var r=this;if(t.length>0&&this.mapService.version===Au["GAODE2.x"]){var a=i.coordCenter||i.getSource().center;t.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=Au["GAODE2.x"],o.originCoordinates=(0,Rr.cloneDeep)(o.coordinates),o.coordinates=r.mapService.coordToAMap2RelativeCoordinates(o.coordinates,a)})}}},{key:"adjustData2SimpleCoordinates",value:function(t){var i=this;t.length>0&&this.mapService.version===Au.SIMPLE&&t.map(function(r){r.simpleCoordinate||(r.coordinates=i.unProjectCoordinates(r.coordinates),r.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(t){var i=this;if(typeof t[0]=="number")return this.mapService.simpleMapCoord.unproject(t);if(t[0]&&t[0][0]instanceof Array){var r=[];return t.map(function(o){var u=[];o.map(function(s){u.push(i.mapService.simpleMapCoord.unproject(s))}),r.push(u)}),r}else{var a=[];return t.map(function(o){a.push(i.mapService.simpleMapCoord.unproject(o))}),a}}},{key:"applyAttributeMapping",value:function(t,i){var r;if(!t.scale)return[];var a=(t==null||(r=t.scale)===null||r===void 0?void 0:r.scalers)||[],o=[];a.forEach(function(s){var l,h=s.field;(i.hasOwnProperty(h)||((l=t.scale)===null||l===void 0?void 0:l.type)==="variable")&&o.push(i[h])});var u=t.mapping?t.mapping(o):[];return u}},{key:"getArrowPoints",value:function(t,i){var r=[i[0]-t[0],i[1]-t[1]],a=Ff(r),o=[t[0]+a[0]*1e-4,t[1]+a[1]*1e-4];return o}}]),e}(),ub=An(u0.prototype,"mapService",[ib],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sb=An(u0.prototype,"fontService",[ab],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u0))||ob),lb,cb,YI=(lb=(0,pr.b2)(),lb(cb=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t){var i=this;this.mapService=t.getContainer().get(qe.IMapService),t.hooks.init.tapPromise("DataSourcePlugin",(0,st.Z)(q().mark(function r(){var a,o,u,s;return q().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(t.log(ca.SourceInitStart,$n.INIT),a=t.getSource(),a||(o=t.sourceOption||t.defaultSourceConfig,u=o.data,s=o.options,a=new Eg(u,s),t.setSource(a)),!a.inited){h.next=8;break}i.updateClusterData(t),t.log(ca.SourceInitEnd,$n.INIT),h.next=10;break;case 8:return h.next=10,new Promise(function(d){a.on("update",function(v){v.type==="inited"&&(i.updateClusterData(t),t.log(ca.SourceInitEnd,$n.INIT)),d(null)})});case 10:case"end":return h.stop()}},r)}))),t.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,st.Z)(q().mark(function r(){var a,o,u;return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=i.updateClusterData(t),o=t.dataState.dataSourceNeedUpdate,t.dataState.dataSourceNeedUpdate=!1,u=a||o,l.abrupt("return",u);case 5:case"end":return l.stop()}},r)})))}},{key:"updateClusterData",value:function(t){if(t.isTileLayer||t.tileLayer||!t.getSource())return!1;var i=t.getSource(),r=i.cluster,a=i.clusterOptions.zoom,o=a===void 0?0:a,u=this.mapService.getZoom()-1,s=t.dataState.dataSourceNeedUpdate;return r&&s&&i.updateClusterData(Math.floor(u)),r&&Math.abs(t.clusterZoom-u)>=1?(o!==Math.floor(u)&&i.updateClusterData(Math.floor(u)),t.clusterZoom=u,!0):!1}}]),e}())||cb);function Zg(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function fb(e){return e.length===1&&(e=KI(e)),{left:function(n,t,i,r){for(i==null&&(i=0),r==null&&(r=n.length);i<r;){var a=i+r>>>1;e(n[a],t)<0?i=a+1:r=a}return i},right:function(n,t,i,r){for(i==null&&(i=0),r==null&&(r=n.length);i<r;){var a=i+r>>>1;e(n[a],t)>0?r=a:i=a+1}return i}}}function KI(e){return function(n,t){return Zg(e(n),t)}}var hb=fb(Zg),qI=hb.right,FF=hb.left,s0=qI;function pb(e,n){var t=e.length,i=-1,r,a,o;if(n==null){for(;++i<t;)if((r=e[i])!=null&&r>=r)for(a=o=r;++i<t;)(r=e[i])!=null&&(a>r&&(a=r),o<r&&(o=r))}else for(;++i<t;)if((r=n(e[i],i,e))!=null&&r>=r)for(a=o=r;++i<t;)(r=n(e[i],i,e))!=null&&(a>r&&(a=r),o<r&&(o=r));return[a,o]}var db=Array.prototype,NF=db.slice,DF=db.map,Ug=Math.sqrt(50),zg=Math.sqrt(10),Gg=Math.sqrt(2);function vb(e,n,t){var i,r=-1,a,o,u;if(n=+n,e=+e,t=+t,e===n&&t>0)return[e];if((i=n<e)&&(a=e,e=n,n=a),(u=l0(e,n,t))===0||!isFinite(u))return[];if(u>0)for(e=Math.ceil(e/u),n=Math.floor(n/u),o=new Array(a=Math.ceil(n-e+1));++r<a;)o[r]=(e+r)*u;else for(e=Math.floor(e*u),n=Math.ceil(n*u),o=new Array(a=Math.ceil(e-n+1));++r<a;)o[r]=(e-r)/u;return i&&o.reverse(),o}function l0(e,n,t){var i=(n-e)/Math.max(0,t),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=Ug?10:a>=zg?5:a>=Gg?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=Ug?10:a>=zg?5:a>=Gg?2:1)}function Vg(e,n,t){var i=Math.abs(n-e)/Math.max(0,t),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=Ug?r*=10:a>=zg?r*=5:a>=Gg&&(r*=2),n<e?-r:r}function BF(){var e=identity,n=extent,t=sturges;function i(r){var a,o=r.length,u,s=new Array(o);for(a=0;a<o;++a)s[a]=e(r[a],a,r);var l=n(s),h=l[0],d=l[1],v=t(s,h,d);Array.isArray(v)||(v=tickStep(h,d,v),v=range(Math.ceil(h/v)*v,d,v));for(var y=v.length;v[0]<=h;)v.shift(),--y;for(;v[y-1]>d;)v.pop(),--y;var x=new Array(y+1),S;for(a=0;a<=y;++a)S=x[a]=[],S.x0=a>0?v[a-1]:h,S.x1=a<y?v[a]:d;for(a=0;a<o;++a)u=s[a],h<=u&&u<=d&&x[bisect(v,u,0,y)].push(r[a]);return x}return i.value=function(r){return arguments.length?(e=typeof r=="function"?r:constant(r),i):e},i.domain=function(r){return arguments.length?(n=typeof r=="function"?r:constant([r[0],r[1]]),i):n},i.thresholds=function(r){return arguments.length?(t=typeof r=="function"?r:Array.isArray(r)?constant(slice.call(r)):constant(r),i):t},i}function ZF(e,n,t){return e=map.call(e,number).sort(ascending),Math.ceil((t-n)/(2*(quantile(e,.75)-quantile(e,.25))*Math.pow(e.length,-1/3)))}function QI(e){return e===null?NaN:+e}function JI(e,n,t){if(t==null&&(t=QI),!!(i=e.length)){if((n=+n)<=0||i<2)return+t(e[0],0,e);if(n>=1)return+t(e[i-1],i-1,e);var i,r=(i-1)*n,a=Math.floor(r),o=+t(e[a],a,e),u=+t(e[a+1],a+1,e);return o+(u-o)*(r-a)}}function mb(e,n,t,i,r){var a=e*e,o=a*e;return((1-3*e+3*a-o)*n+(4-6*a+3*o)*t+(1+3*e+3*a-3*o)*i+o*r)/6}function e4(e){var n=e.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),r=e[i],a=e[i+1],o=i>0?e[i-1]:2*r-a,u=i<n-1?e[i+2]:2*a-r;return mb((t-i/n)*n,o,r,a,u)}}function t4(e){var n=e.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),r=e[(i+n-1)%n],a=e[i%n],o=e[(i+1)%n],u=e[(i+2)%n];return mb((t-i/n)*n,r,a,o,u)}}function Hg(e){return function(){return e}}function gb(e,n){return function(t){return e+t*n}}function r4(e,n,t){return e=Math.pow(e,t),n=Math.pow(n,t)-e,t=1/t,function(i){return Math.pow(e+i*n,t)}}function UF(e,n){var t=n-e;return t?gb(e,t>180||t<-180?t-360*Math.round(t/360):t):constant(isNaN(e)?n:e)}function n4(e){return(e=+e)==1?yb:function(n,t){return t-n?r4(n,t,e):Hg(isNaN(n)?t:n)}}function yb(e,n){var t=n-e;return t?gb(e,t):Hg(isNaN(e)?n:e)}var _b=function e(n){var t=n4(n);function i(r,a){var o=t((r=Rc(r)).r,(a=Rc(a)).r),u=t(r.g,a.g),s=t(r.b,a.b),l=yb(r.opacity,a.opacity);return function(h){return r.r=o(h),r.g=u(h),r.b=s(h),r.opacity=l(h),r+""}}return i.gamma=e,i}(1);function xb(e){return function(n){var t=n.length,i=new Array(t),r=new Array(t),a=new Array(t),o,u;for(o=0;o<t;++o)u=Rc(n[o]),i[o]=u.r||0,r[o]=u.g||0,a[o]=u.b||0;return i=e(i),r=e(r),a=e(a),u.opacity=1,function(s){return u.r=i(s),u.g=r(s),u.b=a(s),u+""}}}var i4=xb(e4),zF=xb(t4),rs="$";function c0(){}c0.prototype=Sb.prototype={constructor:c0,has:function(e){return rs+e in this},get:function(e){return this[rs+e]},set:function(e,n){return this[rs+e]=n,this},remove:function(e){var n=rs+e;return n in this&&delete this[n]},clear:function(){for(var e in this)e[0]===rs&&delete this[e]},keys:function(){var e=[];for(var n in this)n[0]===rs&&e.push(n.slice(1));return e},values:function(){var e=[];for(var n in this)n[0]===rs&&e.push(this[n]);return e},entries:function(){var e=[];for(var n in this)n[0]===rs&&e.push({key:n.slice(1),value:this[n]});return e},size:function(){var e=0;for(var n in this)n[0]===rs&&++e;return e},empty:function(){for(var e in this)if(e[0]===rs)return!1;return!0},each:function(e){for(var n in this)n[0]===rs&&e(this[n],n.slice(1),this)}};function Sb(e,n){var t=new c0;if(e instanceof c0)e.each(function(u,s){t.set(s,u)});else if(Array.isArray(e)){var i=-1,r=e.length,a;if(n==null)for(;++i<r;)t.set(i,e[i]);else for(;++i<r;)t.set(n(a=e[i],i,e),a)}else if(e)for(var o in e)t.set(o,e[o]);return t}var jg=Sb;function GF(){var e=[],n=[],t,i,r;function a(u,s,l,h){if(s>=e.length)return t!=null&&u.sort(t),i!=null?i(u):u;for(var d=-1,v=u.length,y=e[s++],x,S,M=map(),O,H=l();++d<v;)(O=M.get(x=y(S=u[d])+""))?O.push(S):M.set(x,[S]);return M.each(function(W,he){h(H,he,a(W,s,l,h))}),H}function o(u,s){if(++s>e.length)return u;var l,h=n[s-1];return i!=null&&s>=e.length?l=u.entries():(l=[],u.each(function(d,v){l.push({key:v,values:o(d,s)})})),h!=null?l.sort(function(d,v){return h(d.key,v.key)}):l}return r={object:function(u){return a(u,0,a4,o4)},map:function(u){return a(u,0,bb,Eb)},entries:function(u){return o(a(u,0,bb,Eb),0)},key:function(u){return e.push(u),r},sortKeys:function(u){return n[e.length-1]=u,r},sortValues:function(u){return t=u,r},rollup:function(u){return i=u,r}}}function a4(){return{}}function o4(e,n,t){e[n]=t}function bb(){return map()}function Eb(e,n,t){e.set(n,t)}function f0(){}var th=jg.prototype;f0.prototype=u4.prototype={constructor:f0,has:th.has,add:function(e){return e+="",this[rs+e]=e,this},remove:th.remove,clear:th.clear,values:th.keys,size:th.size,empty:th.empty,each:th.each};function u4(e,n){var t=new f0;if(e instanceof f0)e.each(function(a){t.add(a)});else if(e){var i=-1,r=e.length;if(n==null)for(;++i<r;)t.add(e[i]);else for(;++i<r;)t.add(n(e[i],i,e))}return t}var VF=null,Ab=Array.prototype,Tb=Ab.map,rh=Ab.slice;function hf(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}function Cb(e,n){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(n).domain(e);break}return this}var wb={name:"implicit"};function h0(){var e=jg(),n=[],t=[],i=wb;function r(a){var o=a+"",u=e.get(o);if(!u){if(i!==wb)return i;e.set(o,u=n.push(a))}return t[(u-1)%t.length]}return r.domain=function(a){if(!arguments.length)return n.slice();n=[],e=jg();for(var o=-1,u=a.length,s,l;++o<u;)e.has(l=(s=a[o])+"")||e.set(l,n.push(s));return r},r.range=function(a){return arguments.length?(t=rh.call(a),r):t.slice()},r.unknown=function(a){return arguments.length?(i=a,r):i},r.copy=function(){return h0(n,t).unknown(i)},hf.apply(r,arguments),r}function Mb(){var e=ordinal().unknown(void 0),n=e.domain,t=e.range,i=[0,1],r,a,o=!1,u=0,s=0,l=.5;delete e.unknown;function h(){var d=n().length,v=i[1]<i[0],y=i[v-0],x=i[1-v];r=(x-y)/Math.max(1,d-u+s*2),o&&(r=Math.floor(r)),y+=(x-y-r*(d-u))*l,a=r*(1-u),o&&(y=Math.round(y),a=Math.round(a));var S=sequence(d).map(function(M){return y+r*M});return t(v?S.reverse():S)}return e.domain=function(d){return arguments.length?(n(d),h()):n()},e.range=function(d){return arguments.length?(i=[+d[0],+d[1]],h()):i.slice()},e.rangeRound=function(d){return i=[+d[0],+d[1]],o=!0,h()},e.bandwidth=function(){return a},e.step=function(){return r},e.round=function(d){return arguments.length?(o=!!d,h()):o},e.padding=function(d){return arguments.length?(u=Math.min(1,s=+d),h()):u},e.paddingInner=function(d){return arguments.length?(u=Math.min(1,d),h()):u},e.paddingOuter=function(d){return arguments.length?(s=+d,h()):s},e.align=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),h()):l},e.copy=function(){return Mb(n(),i).round(o).paddingInner(u).paddingOuter(s).align(l)},initRange.apply(h(),arguments)}function Rb(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Rb(n())},e}function HF(){return Rb(Mb.apply(null,arguments).paddingInner(1))}function jF(e,n){return(isNumberArray(n)?numberArray:Lb)(e,n)}function Lb(e,n){var t=n?n.length:0,i=e?Math.min(t,e.length):0,r=new Array(i),a=new Array(t),o;for(o=0;o<i;++o)r[o]=Xg(e[o],n[o]);for(;o<t;++o)a[o]=n[o];return function(u){for(o=0;o<i;++o)a[o]=r[o](u);return a}}function s4(e,n){var t=new Date;return e=+e,n=+n,function(i){return t.setTime(e*(1-i)+n*i),t}}function p0(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}function l4(e,n){var t={},i={},r;(e===null||typeof e!="object")&&(e={}),(n===null||typeof n!="object")&&(n={});for(r in n)r in e?t[r]=Xg(e[r],n[r]):i[r]=n[r];return function(a){for(r in t)i[r]=t[r](a);return i}}var Wg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$g=new RegExp(Wg.source,"g");function c4(e){return function(){return e}}function f4(e){return function(n){return e(n)+""}}function h4(e,n){var t=Wg.lastIndex=$g.lastIndex=0,i,r,a,o=-1,u=[],s=[];for(e=e+"",n=n+"";(i=Wg.exec(e))&&(r=$g.exec(n));)(a=r.index)>t&&(a=n.slice(t,a),u[o]?u[o]+=a:u[++o]=a),(i=i[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:p0(i,r)})),t=$g.lastIndex;return t<n.length&&(a=n.slice(t),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?f4(s[0].x):c4(n):(n=s.length,function(l){for(var h=0,d;h<n;++h)u[(d=s[h]).i]=d.x(l);return u.join("")})}function p4(e,n){n||(n=[]);var t=e?Math.min(n.length,e.length):0,i=n.slice(),r;return function(a){for(r=0;r<t;++r)i[r]=e[r]*(1-a)+n[r]*a;return i}}function d4(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Xg(e,n){var t=typeof n,i;return n==null||t==="boolean"?Hg(n):(t==="number"?p0:t==="string"?(i=xs(n))?(n=i,_b):h4:n instanceof xs?_b:n instanceof Date?s4:d4(n)?p4:Array.isArray(n)?Lb:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?l4:p0)(e,n)}function v4(e,n){return e=+e,n=+n,function(t){return Math.round(e*(1-t)+n*t)}}function m4(e){return function(){return e}}function g4(e){return+e}var Pb=[0,1];function Io(e){return e}function Yg(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:m4(isNaN(n)?NaN:.5)}function Ib(e){var n=e[0],t=e[e.length-1],i;return n>t&&(i=n,n=t,t=i),function(r){return Math.max(n,Math.min(t,r))}}function y4(e,n,t){var i=e[0],r=e[1],a=n[0],o=n[1];return r<i?(i=Yg(r,i),a=t(o,a)):(i=Yg(i,r),a=t(a,o)),function(u){return a(i(u))}}function _4(e,n,t){var i=Math.min(e.length,n.length)-1,r=new Array(i),a=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++o<i;)r[o]=Yg(e[o],e[o+1]),a[o]=t(n[o],n[o+1]);return function(u){var s=s0(e,u,1,i)-1;return a[s](r[s](u))}}function d0(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Kg(){var e=Pb,n=Pb,t=Xg,i,r,a,o=Io,u,s,l;function h(){return u=Math.min(e.length,n.length)>2?_4:y4,s=l=null,d}function d(v){return isNaN(v=+v)?a:(s||(s=u(e.map(i),n,t)))(i(o(v)))}return d.invert=function(v){return o(r((l||(l=u(n,e.map(i),p0)))(v)))},d.domain=function(v){return arguments.length?(e=Tb.call(v,g4),o===Io||(o=Ib(e)),h()):e.slice()},d.range=function(v){return arguments.length?(n=rh.call(v),h()):n.slice()},d.rangeRound=function(v){return n=rh.call(v),t=v4,h()},d.clamp=function(v){return arguments.length?(o=v?Ib(e):Io,d):o!==Io},d.interpolate=function(v){return arguments.length?(t=v,h()):t},d.unknown=function(v){return arguments.length?(a=v,d):a},function(v,y){return i=v,r=y,h()}}function Ob(e,n){return Kg()(e,n)}var x4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function v0(e){if(!(n=x4.exec(e)))throw new Error("invalid format: "+e);var n;return new qg({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}v0.prototype=qg.prototype;function qg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}qg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function S4(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function m0(e,n){if((t=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var t,i=e.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+e.slice(t+1)]}function ip(e){return e=m0(Math.abs(e)),e?e[1]:NaN}function b4(e,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ip(n)/3)))*3-ip(Math.abs(e)))}function E4(e,n){return function(t,i){for(var r=t.length,a=[],o=0,u=e[0],s=0;r>0&&u>0&&(s+u+1>i&&(u=Math.max(1,i-s)),a.push(t.substring(r-=u,r+u)),!((s+=u+1)>i));)u=e[o=(o+1)%e.length];return a.reverse().join(n)}}function A4(e){return function(n){return n.replace(/[0-9]/g,function(t){return e[+t]})}}function T4(e){e:for(var n=e.length,t=1,i=-1,r;t<n;++t)switch(e[t]){case".":i=r=t;break;case"0":i===0&&(i=t),r=t;break;default:if(!+e[t])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var kb;function C4(e,n){var t=m0(e,n);if(!t)return e+"";var i=t[0],r=t[1],a=r-(kb=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+m0(e,Math.max(0,n+a-1))[0]}function Fb(e,n){var t=m0(e,n);if(!t)return e+"";var i=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var Nb={"%":function(e,n){return(e*100).toFixed(n)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:S4,e:function(e,n){return e.toExponential(n)},f:function(e,n){return e.toFixed(n)},g:function(e,n){return e.toPrecision(n)},o:function(e){return Math.round(e).toString(8)},p:function(e,n){return Fb(e*100,n)},r:Fb,s:C4,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Db(e){return e}var Bb=Array.prototype.map,Zb=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function w4(e){var n=e.grouping===void 0||e.thousands===void 0?Db:E4(Bb.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?Db:A4(Bb.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"-":e.minus+"",s=e.nan===void 0?"NaN":e.nan+"";function l(d){d=v0(d);var v=d.fill,y=d.align,x=d.sign,S=d.symbol,M=d.zero,O=d.width,H=d.comma,W=d.precision,he=d.trim,ve=d.type;ve==="n"?(H=!0,ve="g"):Nb[ve]||(W===void 0&&(W=12),he=!0,ve="g"),(M||v==="0"&&y==="=")&&(M=!0,v="0",y="=");var Re=S==="$"?t:S==="#"&&/[boxX]/.test(ve)?"0"+ve.toLowerCase():"",ze=S==="$"?i:/[%p]/.test(ve)?o:"",ft=Nb[ve],gt=/[defgprs%]/.test(ve);W=W===void 0?6:/[gprs]/.test(ve)?Math.max(1,Math.min(21,W)):Math.max(0,Math.min(20,W));function Pt(Mt){var sr=Re,xr=ze,Br,kn,Oi;if(ve==="c")xr=ft(Mt)+xr,Mt="";else{Mt=+Mt;var xi=Mt<0||1/Mt<0;if(Mt=isNaN(Mt)?s:ft(Math.abs(Mt),W),he&&(Mt=T4(Mt)),xi&&+Mt==0&&x!=="+"&&(xi=!1),sr=(xi?x==="("?x:u:x==="-"||x==="("?"":x)+sr,xr=(ve==="s"?Zb[8+kb/3]:"")+xr+(xi&&x==="("?")":""),gt){for(Br=-1,kn=Mt.length;++Br<kn;)if(Oi=Mt.charCodeAt(Br),48>Oi||Oi>57){xr=(Oi===46?r+Mt.slice(Br+1):Mt.slice(Br))+xr,Mt=Mt.slice(0,Br);break}}}H&&!M&&(Mt=n(Mt,Infinity));var vi=sr.length+Mt.length+xr.length,na=vi<O?new Array(O-vi+1).join(v):"";switch(H&&M&&(Mt=n(na+Mt,na.length?O-xr.length:Infinity),na=""),y){case"<":Mt=sr+Mt+xr+na;break;case"=":Mt=sr+na+Mt+xr;break;case"^":Mt=na.slice(0,vi=na.length>>1)+sr+Mt+xr+na.slice(vi);break;default:Mt=na+sr+Mt+xr;break}return a(Mt)}return Pt.toString=function(){return d+""},Pt}function h(d,v){var y=l((d=v0(d),d.type="f",d)),x=Math.max(-8,Math.min(8,Math.floor(ip(v)/3)))*3,S=Math.pow(10,-x),M=Zb[8+x/3];return function(O){return y(S*O)+M}}return{format:l,formatPrefix:h}}var g0,Qg,Ub;M4({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function M4(e){return g0=w4(e),Qg=g0.format,Ub=g0.formatPrefix,g0}function R4(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,ip(n)-ip(e))+1}function L4(e){return Math.max(0,-ip(Math.abs(e)))}function P4(e,n,t,i){var r=Vg(e,n,t),a;switch(i=v0(i==null?",f":i),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(n));return i.precision==null&&!isNaN(a=b4(r,o))&&(i.precision=a),Ub(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(a=R4(r,Math.max(Math.abs(e),Math.abs(n))))&&(i.precision=a-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(a=L4(r))&&(i.precision=a-(i.type==="%")*2);break}}return Qg(i)}function Sd(e){var n=e.domain;return e.ticks=function(t){var i=n();return vb(i[0],i[i.length-1],t==null?10:t)},e.tickFormat=function(t,i){var r=n();return P4(r[0],r[r.length-1],t==null?10:t,i)},e.nice=function(t){t==null&&(t=10);var i=n(),r=0,a=i.length-1,o=i[r],u=i[a],s;return u<o&&(s=o,o=u,u=s,s=r,r=a,a=s),s=l0(o,u,t),s>0?(o=Math.floor(o/s)*s,u=Math.ceil(u/s)*s,s=l0(o,u,t)):s<0&&(o=Math.ceil(o*s)/s,u=Math.floor(u*s)/s,s=l0(o,u,t)),s>0?(i[r]=Math.floor(o/s)*s,i[a]=Math.ceil(u/s)*s,n(i)):s<0&&(i[r]=Math.ceil(o*s)/s,i[a]=Math.floor(u*s)/s,n(i)),e},e}function zb(){var e=Ob(Io,Io);return e.copy=function(){return d0(e,zb())},hf.apply(e,arguments),Sd(e)}function I4(e){var n;function t(i){return isNaN(i=+i)?n:i}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(e=map.call(i,number),t):e.slice()},t.unknown=function(i){return arguments.length?(n=i,t):n},t.copy=function(){return I4(e).unknown(n)},e=arguments.length?map.call(e,number):[0,1],linearish(t)}function Gb(e,n){e=e.slice();var t=0,i=e.length-1,r=e[t],a=e[i],o;return a<r&&(o=t,t=i,i=o,o=r,r=a,a=o),e[t]=n.floor(r),e[i]=n.ceil(a),e}function Vb(e){return Math.log(e)}function Hb(e){return Math.exp(e)}function O4(e){return-Math.log(-e)}function k4(e){return-Math.exp(-e)}function F4(e){return isFinite(e)?+("1e"+e):e<0?0:e}function N4(e){return e===10?F4:e===Math.E?Math.exp:function(n){return Math.pow(e,n)}}function D4(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(n){return Math.log(n)/e})}function jb(e){return function(n){return-e(-n)}}function B4(e){var n=e(Vb,Hb),t=n.domain,i=10,r,a;function o(){return r=D4(i),a=N4(i),t()[0]<0?(r=jb(r),a=jb(a),e(O4,k4)):e(Vb,Hb),n}return n.base=function(u){return arguments.length?(i=+u,o()):i},n.domain=function(u){return arguments.length?(t(u),o()):t()},n.ticks=function(u){var s=t(),l=s[0],h=s[s.length-1],d;(d=h<l)&&(v=l,l=h,h=v);var v=r(l),y=r(h),x,S,M,O=u==null?10:+u,H=[];if(!(i%1)&&y-v<O){if(v=Math.round(v)-1,y=Math.round(y)+1,l>0){for(;v<y;++v)for(S=1,x=a(v);S<i;++S)if(M=x*S,!(M<l)){if(M>h)break;H.push(M)}}else for(;v<y;++v)for(S=i-1,x=a(v);S>=1;--S)if(M=x*S,!(M<l)){if(M>h)break;H.push(M)}}else H=vb(v,y,Math.min(y-v,O)).map(a);return d?H.reverse():H},n.tickFormat=function(u,s){if(s==null&&(s=i===10?".0e":","),typeof s!="function"&&(s=Qg(s)),u===Infinity)return s;u==null&&(u=10);var l=Math.max(1,i*u/n.ticks().length);return function(h){var d=h/a(Math.round(r(h)));return d*i<i-.5&&(d*=i),d<=l?s(h):""}},n.nice=function(){return t(Gb(t(),{floor:function(u){return a(Math.floor(r(u)))},ceil:function(u){return a(Math.ceil(r(u)))}}))},n}function Wb(){var e=B4(Kg()).domain([1,10]);return e.copy=function(){return d0(e,Wb()).base(e.base())},hf.apply(e,arguments),e}function $b(e){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/e))}}function Xb(e){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*e}}function Z4(e){var n=1,t=e($b(n),Xb(n));return t.constant=function(i){return arguments.length?e($b(n=+i),Xb(n)):n},linearish(t)}function U4(){var e=Z4(transformer());return e.copy=function(){return copy(e,U4()).constant(e.constant())},initRange.apply(e,arguments)}function Yb(e){return function(n){return n<0?-Math.pow(-n,e):Math.pow(n,e)}}function z4(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function G4(e){return e<0?-e*e:e*e}function V4(e){var n=e(Io,Io),t=1;function i(){return t===1?e(Io,Io):t===.5?e(z4,G4):e(Yb(t),Yb(1/t))}return n.exponent=function(r){return arguments.length?(t=+r,i()):t},Sd(n)}function Jg(){var e=V4(Kg());return e.copy=function(){return d0(e,Jg()).exponent(e.exponent())},hf.apply(e,arguments),e}function WF(){return Jg.apply(null,arguments).exponent(.5)}function Kb(){var e=[],n=[],t=[],i;function r(){var o=0,u=Math.max(1,n.length);for(t=new Array(u-1);++o<u;)t[o-1]=JI(e,o/u);return a}function a(o){return isNaN(o=+o)?i:n[s0(t,o)]}return a.invertExtent=function(o){var u=n.indexOf(o);return u<0?[NaN,NaN]:[u>0?t[u-1]:e[0],u<t.length?t[u]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(var u=0,s=o.length,l;u<s;++u)l=o[u],l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Zg),r()},a.range=function(o){return arguments.length?(n=rh.call(o),r()):n.slice()},a.unknown=function(o){return arguments.length?(i=o,a):i},a.quantiles=function(){return t.slice()},a.copy=function(){return Kb().domain(e).range(n).unknown(i)},hf.apply(a,arguments)}function qb(){var e=0,n=1,t=1,i=[.5],r=[0,1],a;function o(s){return s<=s?r[s0(i,s,0,t)]:a}function u(){var s=-1;for(i=new Array(t);++s<t;)i[s]=((s+1)*n-(s-t)*e)/(t+1);return o}return o.domain=function(s){return arguments.length?(e=+s[0],n=+s[1],u()):[e,n]},o.range=function(s){return arguments.length?(t=(r=rh.call(s)).length-1,u()):r.slice()},o.invertExtent=function(s){var l=r.indexOf(s);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=t?[i[t-1],n]:[i[l-1],i[l]]},o.unknown=function(s){return arguments.length&&(a=s),o},o.thresholds=function(){return i.slice()},o.copy=function(){return qb().domain([e,n]).range(r).unknown(a)},hf.apply(Sd(o),arguments)}function Qb(){var e=[.5],n=[0,1],t,i=1;function r(a){return a<=a?n[s0(e,a,0,i)]:t}return r.domain=function(a){return arguments.length?(e=rh.call(a),i=Math.min(e.length,n.length-1),r):e.slice()},r.range=function(a){return arguments.length?(n=rh.call(a),i=Math.min(e.length,n.length-1),r):n.slice()},r.invertExtent=function(a){var o=n.indexOf(a);return[e[o-1],e[o]]},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return Qb().domain(e).range(n).unknown(t)},hf.apply(r,arguments)}var ey=new Date,ty=new Date;function Ho(e,n,t,i){function r(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return r.floor=function(a){return e(a=new Date(+a)),a},r.ceil=function(a){return e(a=new Date(a-1)),n(a,1),e(a),a},r.round=function(a){var o=r(a),u=r.ceil(a);return a-o<u-a?o:u},r.offset=function(a,o){return n(a=new Date(+a),o==null?1:Math.floor(o)),a},r.range=function(a,o,u){var s=[],l;if(a=r.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return s;do s.push(l=new Date(+a)),n(a,u),e(a);while(l<a&&a<o);return s},r.filter=function(a){return Ho(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,u){if(o>=o)if(u<0)for(;++u<=0;)for(;n(o,-1),!a(o););else for(;--u>=0;)for(;n(o,1),!a(o););})},t&&(r.count=function(a,o){return ey.setTime(+a),ty.setTime(+o),e(ey),e(ty),Math.floor(t(ey,ty))},r.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?r.filter(i?function(o){return i(o)%a==0}:function(o){return r.count(0,o)%a==0}):r}),r}var ry=Ho(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n)},function(e,n){return n.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});ry.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ho(function(n){n.setFullYear(Math.floor(n.getFullYear()/e)*e),n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,t){n.setFullYear(n.getFullYear()+t*e)})};var ap=ry,$F=ry.range,Jb=Ho(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,n){e.setMonth(e.getMonth()+n)},function(e,n){return n.getMonth()-e.getMonth()+(n.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),H4=Jb,XF=Jb.range,y0=1e3,bd=6e4,eE=36e5,tE=864e5,rE=6048e5;function nh(e){return Ho(function(n){n.setDate(n.getDate()-(n.getDay()+7-e)%7),n.setHours(0,0,0,0)},function(n,t){n.setDate(n.getDate()+t*7)},function(n,t){return(t-n-(t.getTimezoneOffset()-n.getTimezoneOffset())*bd)/rE})}var ny=nh(0),_0=nh(1),j4=nh(2),W4=nh(3),op=nh(4),$4=nh(5),X4=nh(6),YF=ny.range,KF=_0.range,qF=j4.range,QF=W4.range,JF=op.range,e7=$4.range,t7=X4.range,nE=Ho(function(e){e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*bd)/tE},function(e){return e.getDate()-1}),iy=nE,r7=nE.range,iE=Ho(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*y0-e.getMinutes()*bd)},function(e,n){e.setTime(+e+n*eE)},function(e,n){return(n-e)/eE},function(e){return e.getHours()}),Y4=iE,n7=iE.range,aE=Ho(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*y0)},function(e,n){e.setTime(+e+n*bd)},function(e,n){return(n-e)/bd},function(e){return e.getMinutes()}),K4=aE,i7=aE.range,oE=Ho(function(e){e.setTime(e-e.getMilliseconds())},function(e,n){e.setTime(+e+n*y0)},function(e,n){return(n-e)/y0},function(e){return e.getUTCSeconds()}),q4=oE,a7=oE.range,x0=Ho(function(){},function(e,n){e.setTime(+e+n)},function(e,n){return n-e});x0.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ho(function(n){n.setTime(Math.floor(n/e)*e)},function(n,t){n.setTime(+n+t*e)},function(n,t){return(t-n)/e}):x0};var Q4=x0,o7=x0.range;function ih(e){return Ho(function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7),n.setUTCHours(0,0,0,0)},function(n,t){n.setUTCDate(n.getUTCDate()+t*7)},function(n,t){return(t-n)/rE})}var uE=ih(0),S0=ih(1),J4=ih(2),eO=ih(3),up=ih(4),tO=ih(5),rO=ih(6),u7=uE.range,s7=S0.range,l7=J4.range,c7=eO.range,f7=up.range,h7=tO.range,p7=rO.range,sE=Ho(function(e){e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n)},function(e,n){return(n-e)/tE},function(e){return e.getUTCDate()-1}),lE=sE,d7=sE.range,ay=Ho(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n)},function(e,n){return n.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});ay.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ho(function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/e)*e),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,t){n.setUTCFullYear(n.getUTCFullYear()+t*e)})};var Ed=ay,v7=ay.range;function oy(e){if(0<=e.y&&e.y<100){var n=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return n.setFullYear(e.y),n}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function uy(e){if(0<=e.y&&e.y<100){var n=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return n.setUTCFullYear(e.y),n}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ad(e,n,t){return{y:e,m:n,d:t,H:0,M:0,S:0,L:0}}function nO(e){var n=e.dateTime,t=e.date,i=e.time,r=e.periods,a=e.days,o=e.shortDays,u=e.months,s=e.shortMonths,l=Td(r),h=Cd(r),d=Td(a),v=Cd(a),y=Td(o),x=Cd(o),S=Td(u),M=Cd(u),O=Td(s),H=Cd(s),W={a:xi,A:vi,b:na,B:is,c:null,d:vE,e:vE,f:CO,g:NO,G:BO,H:EO,I:AO,j:TO,L:mE,m:wO,M:MO,p:F0,q:Q6,Q:bE,s:EE,S:RO,u:LO,U:PO,V:IO,w:OO,W:kO,x:null,X:null,y:FO,Y:DO,Z:ZO,"%":SE},he={a:J6,A:eF,b:tF,B:rF,c:null,d:yE,e:yE,f:VO,g:JO,G:tk,H:UO,I:zO,j:GO,L:_E,m:HO,M:jO,p:nF,q:iF,Q:bE,s:EE,S:WO,u:$O,U:XO,V:YO,w:KO,W:qO,x:null,X:null,y:QO,Y:ek,Z:rk,"%":SE},ve={a:Pt,A:Mt,b:sr,B:xr,c:Br,d:pE,e:pE,f:_O,g:hE,G:fE,H:dE,I:dE,j:vO,L:yO,m:dO,M:mO,p:gt,q:pO,Q:SO,s:bO,S:gO,u:sO,U:lO,V:cO,w:uO,W:fO,x:kn,X:Oi,y:hE,Y:fE,Z:hO,"%":xO};W.x=Re(t,W),W.X=Re(i,W),W.c=Re(n,W),he.x=Re(t,he),he.X=Re(i,he),he.c=Re(n,he);function Re(Jr,Xn){return function(ci){var wr=[],ou=-1,ki=0,Cu=Jr.length,wu,sh,mA;for(ci instanceof Date||(ci=new Date(+ci));++ou<Cu;)Jr.charCodeAt(ou)===37&&(wr.push(Jr.slice(ki,ou)),(sh=cE[wu=Jr.charAt(++ou)])!=null?wu=Jr.charAt(++ou):sh=wu==="e"?" ":"0",(mA=Xn[wu])&&(wu=mA(ci,sh)),wr.push(wu),ki=ou+1);return wr.push(Jr.slice(ki,ou)),wr.join("")}}function ze(Jr,Xn){return function(ci){var wr=Ad(1900,void 0,1),ou=ft(wr,Jr,ci+="",0),ki,Cu;if(ou!=ci.length)return null;if("Q"in wr)return new Date(wr.Q);if("s"in wr)return new Date(wr.s*1e3+("L"in wr?wr.L:0));if(Xn&&!("Z"in wr)&&(wr.Z=0),"p"in wr&&(wr.H=wr.H%12+wr.p*12),wr.m===void 0&&(wr.m="q"in wr?wr.q:0),"V"in wr){if(wr.V<1||wr.V>53)return null;"w"in wr||(wr.w=1),"Z"in wr?(ki=uy(Ad(wr.y,0,1)),Cu=ki.getUTCDay(),ki=Cu>4||Cu===0?S0.ceil(ki):S0(ki),ki=lE.offset(ki,(wr.V-1)*7),wr.y=ki.getUTCFullYear(),wr.m=ki.getUTCMonth(),wr.d=ki.getUTCDate()+(wr.w+6)%7):(ki=oy(Ad(wr.y,0,1)),Cu=ki.getDay(),ki=Cu>4||Cu===0?_0.ceil(ki):_0(ki),ki=iy.offset(ki,(wr.V-1)*7),wr.y=ki.getFullYear(),wr.m=ki.getMonth(),wr.d=ki.getDate()+(wr.w+6)%7)}else("W"in wr||"U"in wr)&&("w"in wr||(wr.w="u"in wr?wr.u%7:"W"in wr?1:0),Cu="Z"in wr?uy(Ad(wr.y,0,1)).getUTCDay():oy(Ad(wr.y,0,1)).getDay(),wr.m=0,wr.d="W"in wr?(wr.w+6)%7+wr.W*7-(Cu+5)%7:wr.w+wr.U*7-(Cu+6)%7);return"Z"in wr?(wr.H+=wr.Z/100|0,wr.M+=wr.Z%100,uy(wr)):oy(wr)}}function ft(Jr,Xn,ci,wr){for(var ou=0,ki=Xn.length,Cu=ci.length,wu,sh;ou<ki;){if(wr>=Cu)return-1;if(wu=Xn.charCodeAt(ou++),wu===37){if(wu=Xn.charAt(ou++),sh=ve[wu in cE?Xn.charAt(ou++):wu],!sh||(wr=sh(Jr,ci,wr))<0)return-1}else if(wu!=ci.charCodeAt(wr++))return-1}return wr}function gt(Jr,Xn,ci){var wr=l.exec(Xn.slice(ci));return wr?(Jr.p=h[wr[0].toLowerCase()],ci+wr[0].length):-1}function Pt(Jr,Xn,ci){var wr=y.exec(Xn.slice(ci));return wr?(Jr.w=x[wr[0].toLowerCase()],ci+wr[0].length):-1}function Mt(Jr,Xn,ci){var wr=d.exec(Xn.slice(ci));return wr?(Jr.w=v[wr[0].toLowerCase()],ci+wr[0].length):-1}function sr(Jr,Xn,ci){var wr=O.exec(Xn.slice(ci));return wr?(Jr.m=H[wr[0].toLowerCase()],ci+wr[0].length):-1}function xr(Jr,Xn,ci){var wr=S.exec(Xn.slice(ci));return wr?(Jr.m=M[wr[0].toLowerCase()],ci+wr[0].length):-1}function Br(Jr,Xn,ci){return ft(Jr,n,Xn,ci)}function kn(Jr,Xn,ci){return ft(Jr,t,Xn,ci)}function Oi(Jr,Xn,ci){return ft(Jr,i,Xn,ci)}function xi(Jr){return o[Jr.getDay()]}function vi(Jr){return a[Jr.getDay()]}function na(Jr){return s[Jr.getMonth()]}function is(Jr){return u[Jr.getMonth()]}function F0(Jr){return r[+(Jr.getHours()>=12)]}function Q6(Jr){return 1+~~(Jr.getMonth()/3)}function J6(Jr){return o[Jr.getUTCDay()]}function eF(Jr){return a[Jr.getUTCDay()]}function tF(Jr){return s[Jr.getUTCMonth()]}function rF(Jr){return u[Jr.getUTCMonth()]}function nF(Jr){return r[+(Jr.getUTCHours()>=12)]}function iF(Jr){return 1+~~(Jr.getUTCMonth()/3)}return{format:function(Jr){var Xn=Re(Jr+="",W);return Xn.toString=function(){return Jr},Xn},parse:function(Jr){var Xn=ze(Jr+="",!1);return Xn.toString=function(){return Jr},Xn},utcFormat:function(Jr){var Xn=Re(Jr+="",he);return Xn.toString=function(){return Jr},Xn},utcParse:function(Jr){var Xn=ze(Jr+="",!0);return Xn.toString=function(){return Jr},Xn}}}var cE={"-":"",_:" ","0":"0"},Ha=/^\s*\d+/,iO=/^%/,aO=/[\\^$*+?|[\]().{}]/g;function li(e,n,t){var i=e<0?"-":"",r=(i?-e:e)+"",a=r.length;return i+(a<t?new Array(t-a+1).join(n)+r:r)}function oO(e){return e.replace(aO,"\\$&")}function Td(e){return new RegExp("^(?:"+e.map(oO).join("|")+")","i")}function Cd(e){for(var n={},t=-1,i=e.length;++t<i;)n[e[t].toLowerCase()]=t;return n}function uO(e,n,t){var i=Ha.exec(n.slice(t,t+1));return i?(e.w=+i[0],t+i[0].length):-1}function sO(e,n,t){var i=Ha.exec(n.slice(t,t+1));return i?(e.u=+i[0],t+i[0].length):-1}function lO(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.U=+i[0],t+i[0].length):-1}function cO(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.V=+i[0],t+i[0].length):-1}function fO(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.W=+i[0],t+i[0].length):-1}function fE(e,n,t){var i=Ha.exec(n.slice(t,t+4));return i?(e.y=+i[0],t+i[0].length):-1}function hE(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),t+i[0].length):-1}function hO(e,n,t){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(t,t+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),t+i[0].length):-1}function pO(e,n,t){var i=Ha.exec(n.slice(t,t+1));return i?(e.q=i[0]*3-3,t+i[0].length):-1}function dO(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.m=i[0]-1,t+i[0].length):-1}function pE(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.d=+i[0],t+i[0].length):-1}function vO(e,n,t){var i=Ha.exec(n.slice(t,t+3));return i?(e.m=0,e.d=+i[0],t+i[0].length):-1}function dE(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.H=+i[0],t+i[0].length):-1}function mO(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.M=+i[0],t+i[0].length):-1}function gO(e,n,t){var i=Ha.exec(n.slice(t,t+2));return i?(e.S=+i[0],t+i[0].length):-1}function yO(e,n,t){var i=Ha.exec(n.slice(t,t+3));return i?(e.L=+i[0],t+i[0].length):-1}function _O(e,n,t){var i=Ha.exec(n.slice(t,t+6));return i?(e.L=Math.floor(i[0]/1e3),t+i[0].length):-1}function xO(e,n,t){var i=iO.exec(n.slice(t,t+1));return i?t+i[0].length:-1}function SO(e,n,t){var i=Ha.exec(n.slice(t));return i?(e.Q=+i[0],t+i[0].length):-1}function bO(e,n,t){var i=Ha.exec(n.slice(t));return i?(e.s=+i[0],t+i[0].length):-1}function vE(e,n){return li(e.getDate(),n,2)}function EO(e,n){return li(e.getHours(),n,2)}function AO(e,n){return li(e.getHours()%12||12,n,2)}function TO(e,n){return li(1+iy.count(ap(e),e),n,3)}function mE(e,n){return li(e.getMilliseconds(),n,3)}function CO(e,n){return mE(e,n)+"000"}function wO(e,n){return li(e.getMonth()+1,n,2)}function MO(e,n){return li(e.getMinutes(),n,2)}function RO(e,n){return li(e.getSeconds(),n,2)}function LO(e){var n=e.getDay();return n===0?7:n}function PO(e,n){return li(ny.count(ap(e)-1,e),n,2)}function gE(e){var n=e.getDay();return n>=4||n===0?op(e):op.ceil(e)}function IO(e,n){return e=gE(e),li(op.count(ap(e),e)+(ap(e).getDay()===4),n,2)}function OO(e){return e.getDay()}function kO(e,n){return li(_0.count(ap(e)-1,e),n,2)}function FO(e,n){return li(e.getFullYear()%100,n,2)}function NO(e,n){return e=gE(e),li(e.getFullYear()%100,n,2)}function DO(e,n){return li(e.getFullYear()%1e4,n,4)}function BO(e,n){var t=e.getDay();return e=t>=4||t===0?op(e):op.ceil(e),li(e.getFullYear()%1e4,n,4)}function ZO(e){var n=e.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+li(n/60|0,"0",2)+li(n%60,"0",2)}function yE(e,n){return li(e.getUTCDate(),n,2)}function UO(e,n){return li(e.getUTCHours(),n,2)}function zO(e,n){return li(e.getUTCHours()%12||12,n,2)}function GO(e,n){return li(1+lE.count(Ed(e),e),n,3)}function _E(e,n){return li(e.getUTCMilliseconds(),n,3)}function VO(e,n){return _E(e,n)+"000"}function HO(e,n){return li(e.getUTCMonth()+1,n,2)}function jO(e,n){return li(e.getUTCMinutes(),n,2)}function WO(e,n){return li(e.getUTCSeconds(),n,2)}function $O(e){var n=e.getUTCDay();return n===0?7:n}function XO(e,n){return li(uE.count(Ed(e)-1,e),n,2)}function xE(e){var n=e.getUTCDay();return n>=4||n===0?up(e):up.ceil(e)}function YO(e,n){return e=xE(e),li(up.count(Ed(e),e)+(Ed(e).getUTCDay()===4),n,2)}function KO(e){return e.getUTCDay()}function qO(e,n){return li(S0.count(Ed(e)-1,e),n,2)}function QO(e,n){return li(e.getUTCFullYear()%100,n,2)}function JO(e,n){return e=xE(e),li(e.getUTCFullYear()%100,n,2)}function ek(e,n){return li(e.getUTCFullYear()%1e4,n,4)}function tk(e,n){var t=e.getUTCDay();return e=t>=4||t===0?up(e):up.ceil(e),li(e.getUTCFullYear()%1e4,n,4)}function rk(){return"+0000"}function SE(){return"%"}function bE(e){return+e}function EE(e){return Math.floor(+e/1e3)}var sp,AE,nk,ik,ak;ok({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ok(e){return sp=nO(e),AE=sp.format,nk=sp.parse,ik=sp.utcFormat,ak=sp.utcParse,sp}var wd=1e3,Md=wd*60,Rd=Md*60,Ld=Rd*24,uk=Ld*7,TE=Ld*30,sy=Ld*365;function sk(e){return new Date(e)}function lk(e){return e instanceof Date?+e:+new Date(+e)}function CE(e,n,t,i,r,a,o,u,s){var l=Ob(Io,Io),h=l.invert,d=l.domain,v=s(".%L"),y=s(":%S"),x=s("%I:%M"),S=s("%I %p"),M=s("%a %d"),O=s("%b %d"),H=s("%B"),W=s("%Y"),he=[[o,1,wd],[o,5,5*wd],[o,15,15*wd],[o,30,30*wd],[a,1,Md],[a,5,5*Md],[a,15,15*Md],[a,30,30*Md],[r,1,Rd],[r,3,3*Rd],[r,6,6*Rd],[r,12,12*Rd],[i,1,Ld],[i,2,2*Ld],[t,1,uk],[n,1,TE],[n,3,3*TE],[e,1,sy]];function ve(ze){return(o(ze)<ze?v:a(ze)<ze?y:r(ze)<ze?x:i(ze)<ze?S:n(ze)<ze?t(ze)<ze?M:O:e(ze)<ze?H:W)(ze)}function Re(ze,ft,gt,Pt){if(ze==null&&(ze=10),typeof ze=="number"){var Mt=Math.abs(gt-ft)/ze,sr=fb(function(xr){return xr[2]}).right(he,Mt);sr===he.length?(Pt=Vg(ft/sy,gt/sy,ze),ze=e):sr?(sr=he[Mt/he[sr-1][2]<he[sr][2]/Mt?sr-1:sr],Pt=sr[1],ze=sr[0]):(Pt=Math.max(Vg(ft,gt,ze),1),ze=u)}return Pt==null?ze:ze.every(Pt)}return l.invert=function(ze){return new Date(h(ze))},l.domain=function(ze){return arguments.length?d(Tb.call(ze,lk)):d().map(sk)},l.ticks=function(ze,ft){var gt=d(),Pt=gt[0],Mt=gt[gt.length-1],sr=Mt<Pt,xr;return sr&&(xr=Pt,Pt=Mt,Mt=xr),xr=Re(ze,Pt,Mt,ft),xr=xr?xr.range(Pt,Mt+1):[],sr?xr.reverse():xr},l.tickFormat=function(ze,ft){return ft==null?ve:s(ft)},l.nice=function(ze,ft){var gt=d();return(ze=Re(ze,gt[0],gt[gt.length-1],ft))?d(Gb(gt,ze)):l},l.copy=function(){return d0(l,CE(e,n,t,i,r,a,o,u,s))},l}function ck(){return hf.apply(CE(ap,H4,ny,iy,Y4,K4,q4,Q4,AE).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function m7(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function b0(){var e=0,n=1,t,i,r,a,o=Io,u=!1,s;function l(h){return isNaN(h=+h)?s:o(r===0?.5:(h=(a(h)-t)*r,u?Math.max(0,Math.min(1,h)):h))}return l.domain=function(h){return arguments.length?(t=a(e=+h[0]),i=a(n=+h[1]),r=t===i?0:1/(i-t),l):[e,n]},l.clamp=function(h){return arguments.length?(u=!!h,l):u},l.interpolator=function(h){return arguments.length?(o=h,l):o},l.unknown=function(h){return arguments.length?(s=h,l):s},function(h){return a=h,t=h(e),i=h(n),r=t===i?0:1/(i-t),l}}function Pd(e,n){return n.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function wE(){var e=Sd(b0()(Io));return e.copy=function(){return Pd(e,wE())},Cb.apply(e,arguments)}function fk(){var e=loggish(b0()).domain([1,10]);return e.copy=function(){return Pd(e,fk()).base(e.base())},initInterpolator.apply(e,arguments)}function hk(){var e=symlogish(b0());return e.copy=function(){return Pd(e,hk()).constant(e.constant())},initInterpolator.apply(e,arguments)}function ME(){var e=powish(b0());return e.copy=function(){return Pd(e,ME()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function g7(){return ME.apply(null,arguments).exponent(.5)}function pk(){var e=[],n=identity;function t(i){if(!isNaN(i=+i))return n((bisect(e,i)-1)/(e.length-1))}return t.domain=function(i){if(!arguments.length)return e.slice();e=[];for(var r=0,a=i.length,o;r<a;++r)o=i[r],o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ascending),t},t.interpolator=function(i){return arguments.length?(n=i,t):n},t.copy=function(){return pk(n).domain(e)},initInterpolator.apply(t,arguments)}function E0(){var e=0,n=.5,t=1,i,r,a,o,u,s=Io,l,h=!1,d;function v(y){return isNaN(y=+y)?d:(y=.5+((y=+l(y))-r)*(y<r?o:u),s(h?Math.max(0,Math.min(1,y)):y))}return v.domain=function(y){return arguments.length?(i=l(e=+y[0]),r=l(n=+y[1]),a=l(t=+y[2]),o=i===r?0:.5/(r-i),u=r===a?0:.5/(a-r),v):[e,n,t]},v.clamp=function(y){return arguments.length?(h=!!y,v):h},v.interpolator=function(y){return arguments.length?(s=y,v):s},v.unknown=function(y){return arguments.length?(d=y,v):d},function(y){return l=y,i=y(e),r=y(n),a=y(t),o=i===r?0:.5/(r-i),u=r===a?0:.5/(a-r),v}}function RE(){var e=Sd(E0()(Io));return e.copy=function(){return Pd(e,RE())},Cb.apply(e,arguments)}function dk(){var e=loggish(E0()).domain([.1,1,10]);return e.copy=function(){return copy(e,dk()).base(e.base())},initInterpolator.apply(e,arguments)}function vk(){var e=symlogish(E0());return e.copy=function(){return copy(e,vk()).constant(e.constant())},initInterpolator.apply(e,arguments)}function LE(){var e=powish(E0());return e.copy=function(){return copy(e,LE()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function y7(){return LE.apply(null,arguments).exponent(.5)}function PE(e){var n,t=[];function i(r){return r==null?n:r}return i.invert=i,i.domain=i.range=function(r){return r?(t=r,r):t},i.unknown=function(r){return r?(n=r,r):n},i.copy=function(){return PE(e).unknown(n)},i}var Tu,IE,OE,mk=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,gk=(Tu={},(0,R.Z)(Tu,pi.LINEAR,zb),(0,R.Z)(Tu,pi.POWER,Jg),(0,R.Z)(Tu,pi.LOG,Wb),(0,R.Z)(Tu,pi.IDENTITY,PE),(0,R.Z)(Tu,pi.SEQUENTIAL,wE),(0,R.Z)(Tu,pi.TIME,ck),(0,R.Z)(Tu,pi.QUANTILE,Kb),(0,R.Z)(Tu,pi.QUANTIZE,qb),(0,R.Z)(Tu,pi.THRESHOLD,Qb),(0,R.Z)(Tu,pi.CAT,h0),(0,R.Z)(Tu,pi.DIVERGING,RE),Tu),yk=(IE=(0,pr.b2)(),IE(OE=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"scaleOptions",{})}return(0,at.Z)(e,[{key:"apply",value:function(t,i){var r=this,a=i.styleAttributeService;t.hooks.init.tapPromise("FeatureScalePlugin",(0,st.Z)(q().mark(function o(){var u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(t.log(ca.ScaleInitStart,$n.INIT),r.scaleOptions=t.getScaleOptions(),s=a.getLayerStyleAttributes(),l=(u=t.getSource())===null||u===void 0?void 0:u.data.dataArray,!(Array.isArray(l)&&l.length===0)){d.next=8;break}return d.abrupt("return");case 8:r.caculateScalesForAttributes(s||[],l);case 9:t.log(ca.ScaleInitEnd,$n.INIT);case 10:case"end":return d.stop()}},o)}))),t.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var o=(0,st.Z)(q().mark(function u(s){var l,h;return q().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(s){v.next=2;break}return v.abrupt("return",s);case 2:if(t.log(ca.ScaleInitStart,$n.UPDATE),r.scaleOptions=t.getScaleOptions(),l=a.getLayerStyleAttributes(),h=t.getSource().data.dataArray,!(Array.isArray(h)&&h.length===0)){v.next=8;break}return v.abrupt("return",!0);case 8:return r.caculateScalesForAttributes(l||[],h),t.log(ca.ScaleInitEnd,$n.UPDATE),t.layerModelNeedUpdate=!0,v.abrupt("return",!0);case 12:case"end":return v.stop()}},u)}));return function(u){return o.apply(this,arguments)}}()),t.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!t.layerModelNeedUpdate){r.scaleOptions=t.getScaleOptions();var o=a.getLayerStyleAttributes(),u=t.getSource().data.dataArray;if(!(Array.isArray(u)&&u.length===0)&&o){var s=o.filter(function(l){return l.needRescale});s.length&&r.caculateScalesForAttributes(s,u)}}})}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"caculateScalesForAttributes",value:function(t,i){var r=this;t.forEach(function(a){if(a.scale){var o=a.scale;o.names=r.parseFields(a.scale.field||[]);var u=[];o.names.forEach(function(s){var l;u.push(r.createScale(s,a.name,(l=a.scale)===null||l===void 0?void 0:l.values,i))}),u.some(function(s){return s.type===uf.VARIABLE})?(o.type=uf.VARIABLE,u.forEach(function(s){var l;if(!o.callback&&o.values!=="text")switch((l=s.option)===null||l===void 0?void 0:l.type){case pi.LOG:case pi.LINEAR:case pi.POWER:if(o.values&&o.values.length>2){var h=s.scale.ticks(o.values.length);s.scale.domain(h)}o.values?s.scale.range(o.values):s.scale.range(s.option.domain);break;case pi.QUANTILE:case pi.QUANTIZE:case pi.THRESHOLD:s.scale.range(o.values);break;case pi.IDENTITY:break;case pi.CAT:o.values?s.scale.range(o.values):s.scale.range(s.option.domain);break;case pi.DIVERGING:case pi.SEQUENTIAL:s.scale.interpolator(i4(o.values));break}if(o.values==="text"){var d;s.scale.range((d=s.option)===null||d===void 0?void 0:d.domain)}})):(o.type=uf.CONSTANT,o.defaultValues=u.map(function(s,l){return s.scale(o.names[l])})),o.scalers=u.map(function(s){return{field:s.field,func:s.scale,option:s.option}}),a.needRescale=!1}})}},{key:"parseFields",value:function(t){return Array.isArray(t)?t:(0,Rr.isString)(t)?t.split("*"):[t]}},{key:"createScale",value:function(t,i,r,a){var o,u,s=this.scaleOptions[i]&&((o=this.scaleOptions[i])===null||o===void 0?void 0:o.field)===t?this.scaleOptions[i]:this.scaleOptions[t],l={field:t,scale:void 0,type:uf.VARIABLE,option:s};if(!a||!a.length)return s&&s.type?l.scale=this.createDefaultScale(s):(l.scale=h0([t]),l.type=uf.CONSTANT),l;var h=(u=a.find(function(y){return!(0,Rr.isNil)(y[t])}))===null||u===void 0?void 0:u[t];if(this.isNumber(t)||(0,Rr.isNil)(h)&&!s)l.scale=h0([t]),l.type=uf.CONSTANT;else{var d=s&&s.type||this.getDefaultType(h);r==="text"&&(d=pi.CAT);var v=this.createScaleConfig(d,t,s,a);l.scale=this.createDefaultScale(v),l.option=v}return l}},{key:"getDefaultType",value:function(t){var i=pi.LINEAR;return typeof t=="string"&&(i=mk.test(t)?pi.TIME:pi.CAT),i}},{key:"createScaleConfig",value:function(t,i,r,a){var o={type:t},u=(a==null?void 0:a.map(function(h){return h[i]}))||[];if(r!=null&&r.domain)o.domain=r==null?void 0:r.domain;else if(t===pi.CAT||t===pi.IDENTITY)o.domain=(0,Rr.uniq)(u);else if(t===pi.QUANTILE)o.domain=u;else if(t===pi.DIVERGING){var s=pb(u),l=(r==null?void 0:r.neutral)!==void 0?r==null?void 0:r.neutral:(s[0]+s[1])/2;o.domain=[s[0],l,s[1]]}else o.domain=pb(u);return(0,b.Z)((0,b.Z)({},o),r)}},{key:"createDefaultScale",value:function(t){var i=t.type,r=t.domain,a=t.unknown,o=t.clamp,u=t.nice,s=gk[i]();return r&&s.domain&&s.domain(r),a&&s.unknown(a),o!==void 0&&s.clamp&&s.clamp(o),u!==void 0&&s.nice&&s.nice(u),s}}]),e}())||OE),kE,FE,_k=(kE=(0,pr.b2)(),kE(FE=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var i=t.animateStatus;i&&t.models.forEach(function(r){r.addUniforms((0,b.Z)({},t.layerModel.getAnimateUniforms()))})})}}]),e}())||FE),NE,DE,xk=(NE=(0,pr.b2)(),NE(DE=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerMaskPlugin",function(){var i=t.getLayerConfig(),r=i.maskLayers,a=i.enableMask;if(!t.tileLayer&&r&&r.length>0){var o;(o=t.masks).push.apply(o,(0,L.Z)(r)),t.updateLayerConfig({mask:a})}})}}]),e}())||DE),Sk=function(){function e(n){var t=n.rendererService,i=n.layerService,r=n.parent;(0,ot.Z)(this,e),(0,R.Z)(this,"tileResource",new Map),(0,R.Z)(this,"layerTiles",[]),this.rendererService=t,this.layerService=i,this.parent=r}return(0,at.Z)(e,[{key:"tiles",get:function(){return this.layerTiles}},{key:"hasTile",value:function(t){return this.layerTiles.some(function(i){return i.key===t})}},{key:"addTile",value:function(t){this.layerTiles.push(t)}},{key:"getTile",value:function(t){return this.layerTiles.find(function(i){return i.key===t})}},{key:"getVisibleTileBylngLat",value:function(t){return this.layerTiles.find(function(i){return i.isLoaded&&i.visible&&i.lnglatInBounds(t)})}},{key:"removeTile",value:function(t){var i=this.layerTiles.findIndex(function(a){return a.key===t}),r=this.layerTiles.splice(i,1);r[0]&&r[0].destroy()}},{key:"updateTileVisible",value:function(t){var i=this.getTile(t.key);i==null||i.updateVisible(t.isVisible)}},{key:"isParentLoaded",value:function(t){var i=t.parent;if(!i)return!0;var r=this.getTile(i==null?void 0:i.key);return!!(r!=null&&r.isLoaded)}},{key:"isChildrenLoaded",value:function(t){var i=this,r=t==null?void 0:t.children;return r.length===0?!0:r.some(function(a){var o=i.getTile(a==null?void 0:a.key);return(o==null?void 0:o.isLoaded)===!1})}},{key:"render",value:function(){var n=(0,st.Z)(q().mark(function i(){var r=this,a,o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=this.getRenderLayers(),o=a.map(function(){var l=(0,st.Z)(q().mark(function h(d){return q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,r.layerService.renderTileLayer(d);case 2:case"end":return y.stop()}},h)}));return function(h){return l.apply(this,arguments)}}()),s.next=4,Promise.all(o);case 4:case"end":return s.stop()}},i,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getRenderLayers",value:function(){var t=this.layerTiles.filter(function(r){return r.visible&&r.isLoaded}),i=[];return t.map(function(r){return i.push.apply(i,(0,L.Z)(r.getLayers()))}),i}},{key:"getLayers",value:function(){var t=this.layerTiles.filter(function(r){return r.isLoaded}),i=[];return t.map(function(r){return i.push.apply(i,(0,L.Z)(r.getLayers()))}),i}},{key:"getTiles",value:function(){return this.layerTiles}},{key:"destroy",value:function(){this.layerTiles.forEach(function(t){return t.destroy()}),this.tileResource.clear()}}]),e}(),bk=D(32676);function Ek(e,n,t){t===void 0&&(t={});var i=Yr(e),r=Yr(n),a=bk.union(i.coordinates,r.coordinates);return a.length===0?null:a.length===1?pn(a[0],t.properties):Vr(a,t.properties)}var Ak=Ek,Tk=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"getCombineFeature",value:function(t){var i=null,r=t[0];return t.map(function(a){var o=pn(a.coordinates);i===null?i=o:i=Ak(i,o)}),r&&(i.properties=(0,b.Z)({},r)),i}}]),e}(),Id="select",Od="active",Ck=function(){function e(n){var t=n.layerService,i=n.tileLayerService,r=n.parent;(0,ot.Z)(this,e),(0,R.Z)(this,"tilePickID",new Map),this.layerService=t,this.tileLayerService=i,this.parent=r,this.tileSourceService=new Tk}return(0,at.Z)(e,[{key:"pickRender",value:function(t){var i=this.tileLayerService.getVisibleTileBylngLat(t.lngLat);if(i){var r=i.getMainLayer();r==null||r.layerPickService.pickRender(t)}}},{key:"pick",value:function(t,i){var r=this.parent.getContainer(),a=r.get(qe.IPickingService);if(t.type==="RasterLayer"){var o=this.tileLayerService.getVisibleTileBylngLat(i.lngLat);if(o&&o.getMainLayer()!==void 0){var u=o.getMainLayer();return u.layerPickService.pickRasterLayer(u,i,this.parent)}return!1}return this.pickRender(i),a.pickFromPickingFBO(t,i)}},{key:"selectFeature",value:function(t){var i=(0,Dr.Z)(t,3),r=i[0],a=i[1],o=i[2],u=this.color2PickId(r,a,o);this.tilePickID.set(Id,u),this.updateHighLight(r,a,o,Id)}},{key:"highlightPickedFeature",value:function(t){var i=(0,Dr.Z)(t,3),r=i[0],a=i[1],o=i[2],u=this.color2PickId(r,a,o);this.tilePickID.set(Od,u),this.updateHighLight(r,a,o,Od)}},{key:"updateHighLight",value:function(t,i,r,a){this.tileLayerService.tiles.map(function(o){var u=o.getMainLayer();switch(a){case Id:u==null||u.hooks.beforeSelect.call([t,i,r]);break;case Od:u==null||u.hooks.beforeHighlight.call([t,i,r]);break}})}},{key:"setPickState",value:function(){var t=this.tilePickID.get(Id),i=this.tilePickID.get(Od);if(t){var r=this.pickId2Color(t),a=(0,Dr.Z)(r,3),o=a[0],u=a[1],s=a[2];this.updateHighLight(o,u,s,Id);return}if(i){var l=this.pickId2Color(i),h=(0,Dr.Z)(l,3),d=h[0],v=h[1],y=h[2];this.updateHighLight(d,v,y,Od);return}}},{key:"color2PickId",value:function(t,i,r){return Bo(new Uint8Array([t,i,r]))}},{key:"pickId2Color",value:function(t){return Eo(t)}},{key:"getFeatureById",value:function(t){var i=this.tileLayerService.getTiles().filter(function(a){return a.visible}),r=[];return i.forEach(function(a){r.push.apply(r,(0,L.Z)(a.getFeatureById(t)))}),r}},{key:"pickRasterLayer",value:function(t,i,r){return!1}}]),e}(),wk=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask"];function Mk(e){return e==="PolygonLayer"?a0:e==="LineLayer"?Dg:i0}function Rk(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}var ah=function(){function e(n,t){(0,ot.Z)(this,e),(0,R.Z)(this,"visible",!0),(0,R.Z)(this,"layers",[]),(0,R.Z)(this,"isLoaded",!1),(0,R.Z)(this,"tileMaskLayers",[]),this.parent=t,this.sourceTile=n,this.x=n.x,this.y=n.y,this.z=n.z,this.key="".concat(this.x,"_").concat(this.y,"_").concat(this.z)}return(0,at.Z)(e,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(t){var i=(0,Dr.Z)(this.sourceTile.bounds,4),r=i[0],a=i[1],o=i[2],u=i[3],s=t.lng,l=t.lat;return s>=r&&s<=o&&l>=a&&l<=u}},{key:"getLayerOptions",value:function(){var t,i=this.parent.getLayerConfig();return(0,b.Z)((0,b.Z)({},i),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:Rk(this.parent.type),mask:i.mask||((t=i.maskLayers)===null||t===void 0?void 0:t.length)!==0&&i.enableMask})}},{key:"getMaskLayer",value:function(){var t=this,i=this.parent.getLayerConfig(),r=i.maskLayers,a=[];return r==null||r.forEach(function(o){if(!o.tileLayer)return a.push(o),o;var u=o.tileLayer,s=u.getTile(t.sourceTile.key),l=s==null?void 0:s.getLayers()[0];l&&a.push(l)}),a}},{key:"addTileMask",value:function(){var n=(0,st.Z)(q().mark(function i(){var r,a,o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return r=new a0({visible:!1,enablePicking:!1}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill"),a=gd(this.parent.sceneContainer),r.setContainer(a,this.parent.sceneContainer),s.next=5,r.init();case 5:return this.tileMask=r,o=this.getMainLayer(),o!==void 0&&(o.tileMask=r),s.abrupt("return",r);case 9:case"end":return s.stop()}},i,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"addMask",value:function(){var n=(0,st.Z)(q().mark(function i(r,a){var o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=gd(this.parent.sceneContainer),a.setContainer(o,this.parent.sceneContainer),s.next=4,a.init();case 4:r.addMask(a),this.tileMaskLayers.push(a);case 6:case"end":return s.stop()}},i,this)}));function t(i,r){return n.apply(this,arguments)}return t}()},{key:"addLayer",value:function(){var n=(0,st.Z)(q().mark(function i(r){var a;return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r.isTileLayer=!0,a=gd(this.parent.sceneContainer),r.setContainer(a,this.parent.sceneContainer),this.layers.push(r),u.next=6,r.init();case 6:case"end":return u.stop()}},i,this)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"updateVisible",value:function(t){this.visible=t,this.updateOptions("visible",t)}},{key:"updateOptions",value:function(t,i){this.layers.forEach(function(r){r.updateLayerConfig((0,R.Z)({},t,i))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(t){return[]}},{key:"getFeatureById",value:function(t){return[]}},{key:"destroy",value:function(){var t;(t=this.tileMask)===null||t===void 0||t.destroy(),this.layers.forEach(function(i){return i.destroy()})}}]),e}();function Lk(e){var n=Pk();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Pk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ik=function(e){(0,Ot.Z)(t,e);var n=Lk(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"initTileLayer",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.getSourceOption(),u=o.data.features[0].properties,s=new Dg().source(o.data,o.options).size(1).shape("line").color("red"),l=new i0({minZoom:this.z-1,maxZoom:this.z+1,textAllowOverlap:!0}).source([u],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),d.next=6,this.addLayer(s);case 6:return d.next=8,this.addLayer(l);case 8:this.isLoaded=!0;case 9:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:a},options:{parser:{type:"geojson"},transforms:r.transforms}}}}]),t}(ah);function Ok(e){var n=kk();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function kk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fk=function(e){(0,Ot.Z)(t,e);var n=Ok(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"initTileLayer",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=new LS((0,b.Z)({},u)).source(s.data,s.options),o&&Object.keys(o).forEach(function(v){var y,x,S=v;l[S]((y=o[S])===null||y===void 0?void 0:y.field,(x=o[S])===null||x===void 0?void 0:x.values)}),d.next=7,this.addLayer(l);case 7:this.isLoaded=!0;case 8:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:r.transforms}}}}]),t}(ah);function Nk(e){var n=Dk();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Dk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Bk=function(e){(0,Ot.Z)(t,e);var n=Nk(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"initTileLayer",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=new rb((0,b.Z)({},u)).source(s.data,s.options),o&&Object.keys(o).forEach(function(v){var y,x,S=v;l[S]((y=o[S])===null||y===void 0?void 0:y.field,(x=o[S])===null||x===void 0?void 0:x.values)}),d.next=7,this.addLayer(l);case 7:this.isLoaded=!0;case 8:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getFeatures",value:function(r){if(!r)return[];var a=this.sourceTile.data;return a.getTileData(r)}},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.parent.getLayerConfig(),o=a.sourceLayer,u=a.featureId,s=this.getFeatures(o);return{data:{type:"FeatureCollection",features:s},options:{parser:{type:"geojson",featureId:u},transforms:r.transforms}}}}]),t}(ah),Zk=["rasterData"];function Uk(e){var n=zk();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function zk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Gk=function(e){(0,Ot.Z)(t,e);var n=Uk(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"initTileLayer",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=new o0((0,b.Z)({},u)).source(s.data,s.options),o&&Object.keys(o).forEach(function(v){var y,x,S=v;l[S]((y=o[S])===null||y===void 0?void 0:y.field,(x=o[S])===null||x===void 0?void 0:x.values)}),d.next=7,this.addLayer(l);case 7:this.isLoaded=!0;case 8:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.sourceTile.data.data,o=a.rasterData,u=(0,es.Z)(a,Zk);return{data:o,options:{parser:(0,b.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},u),transforms:r.transforms}}}}]),t}(ah);function Vk(e){var n=Hk();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Hk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var jk=function(e){(0,Ot.Z)(t,e);var n=Vk(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"initTileLayer",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l;return q().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=new o0((0,b.Z)({},u)).source(s.data,s.options),o&&Object.keys(o).forEach(function(v){var y,x,S=v;l[S]((y=o[S])===null||y===void 0?void 0:y.field,(x=o[S])===null||x===void 0?void 0:x.values)}),d.next=7,this.addLayer(l);case 7:this.isLoaded=!0;case 8:case"end":return d.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:r.transforms}}}}]),t}(ah),Wk=["rasterData"];function $k(e){var n=Xk();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Xk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Yk={positions:[0,1],colors:["#000","#fff"]},Kk=function(e){(0,Ot.Z)(t,e);var n=$k(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"initTileLayer",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v;return q().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=this.getSourceOption(),l=this.getLayerOptions(),h=l.rampColors,d=l.domain,this.colorTexture=this.parent.textureService.getColorTexture(h,d),v=new o0((0,b.Z)((0,b.Z)({},u),{},{colorTexture:this.colorTexture})).source(s.data,s.options),o&&Object.keys(o).forEach(function(S){var M,O,H=S;v[H]((M=o[H])===null||M===void 0?void 0:M.field,(O=o[H])===null||O===void 0?void 0:O.values)}),x.next=9,this.addLayer(v);case 9:this.isLoaded=!0;case 10:case"end":return x.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.sourceTile.data.data,o=a.rasterData,u=(0,es.Z)(a,Wk);return{data:o,options:{parser:(0,b.Z)({type:"raster",extent:this.sourceTile.bounds},u),transforms:r.transforms}}}},{key:"styleUpdate",value:function(){for(var r=this,a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];var s=o,l=s.rampColors,h=l===void 0?Yk:l,d=s.domain;this.colorTexture=this.parent.textureService.getColorTexture(h,d||Yi(h)),this.layers.forEach(function(v){return v.style({colorTexture:r.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(r){return r.destroy()})}}]),t}(ah);function qk(e){var n=Qk();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function Qk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var A0=function(e){(0,Ot.Z)(t,e);var n=qk(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"initTileLayer",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h;return q().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(o=this.parent.getLayerAttributeConfig(),u=this.getLayerOptions(),s=Mk(this.parent.type),l=this.getSourceOption(),l){v.next=7;break}return this.isLoaded=!0,v.abrupt("return");case 7:return h=new s((0,b.Z)({},u)).source(l.data,l.options),Object.keys(o).forEach(function(y){var x,S,M=y;h[M]((x=o[M])===null||x===void 0?void 0:x.field,(S=o[M])===null||S===void 0?void 0:S.values)}),v.next=11,this.addLayer(h);case 11:if(!u.tileMask){v.next=14;break}return v.next=14,this.addTileMask();case 14:this.setLayerMinMaxZoom(h),this.isLoaded=!0;case 16:case"end":return v.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getSourceOption",value:function(){var r=this.parent.getSource(),a=this.parent.getLayerConfig(),o=a.sourceLayer,u=o===void 0?"defaultLayer":o,s=a.featureId,l=s===void 0?"id":s,h=this.getFeatures(u);return{data:{type:"FeatureCollection",features:h},options:{parser:{type:"geojson",featureId:l},transforms:r.transforms}}}},{key:"setLayerMinMaxZoom",value:function(r){r.getModelType()==="text"&&r.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(r){var a=this.sourceTile.data;return a.getTileData(r)}},{key:"getFeatureById",value:function(r){var a=this.getMainLayer();if(!a)return[];var o=a.getSource().data.dataArray.filter(function(u){return u._id===r});return o}}]),t}(ah);function Jk(e){var n=e.type;switch(n){case"PolygonLayer":return A0;case"LineLayer":return A0;case"PointLayer":return A0;case"TileDebugLayer":return Ik;case"MaskLayer":return Bk;case"RasterLayer":var t=e.getSource().parser.dataType;switch(t){case Ma.RGB:case Ma.CUSTOMRGB:return Gk;case Ma.ARRAYBUFFER:case Ma.CUSTOMARRAYBUFFER:return Kk;case Ma.TERRAINRGB:case Ma.CUSTOMTERRAINRGB:return jk;default:return Fk}default:return A0}}var BE=function(){function e(n){var t=this;(0,ot.Z)(this,e),(0,R.Z)(this,"initedTileset",!1),(0,R.Z)(this,"mapchange",function(){var r,a=t.getCurrentView(),o=a.latLonBounds,u=a.zoom;if(t.mapService.version==="GAODE1.x"){var s=t.parent.getLayerConfig(),l=s.visible;u<2&&l?(t.parent.updateLayerConfig({visible:!1}),t.layerService.reRender()):u>=2&&!l&&(t.parent.updateLayerConfig({visible:!0}),t.layerService.reRender())}t.lastViewStates&&t.lastViewStates.zoom===u&&t.lastViewStates.latLonBounds.toString()===o.toString()||(t.lastViewStates={zoom:u,latLonBounds:o},(r=t.tilesetManager)===null||r===void 0||r.throttleUpdate(u,o))}),(0,R.Z)(this,"viewchange",(0,Rr.debounce)(this.mapchange,24)),this.parent=n;var i=this.parent.getContainer();this.rendererService=i.get(qe.IRendererService),this.layerService=i.get(qe.ILayerService),this.mapService=i.get(qe.IMapService),this.pickingService=i.get(qe.IPickingService),this.tileLayerService=new Sk({rendererService:this.rendererService,layerService:this.layerService,parent:n}),this.tilePickService=new Ck({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:n}),this.parent.setLayerPickService(this.tilePickService),this.proxy(n),this.initTileSetManager()}return(0,at.Z)(e,[{key:"initTileSetManager",value:function(){var t,i=this.parent.getSource();this.tilesetManager=i.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0);var r=this.getCurrentView(),a=r.latLonBounds,o=r.zoom;(t=this.tilesetManager)===null||t===void 0||t.update(o,a)}},{key:"getCurrentView",value:function(){var t=this.mapService.getBounds(),i=[t[0][0],t[0][1],t[1][0],t[1][1]],r=this.mapService.getZoom();return{latLonBounds:i,zoom:r}}},{key:"bindTilesetEvent",value:function(){var t=this;this.tilesetManager.on("tile-loaded",function(i){}),this.tilesetManager.on("tile-unload",function(i){t.tileUnLoad(i)}),this.tilesetManager.on("tile-error",function(i,r){t.tileError(i)}),this.tilesetManager.on("tile-update",function(){t.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"getTile",value:function(t){return this.tileLayerService.getTile(t)}},{key:"tileLoaded",value:function(t){}},{key:"tileError",value:function(t){console.warn("error:",t)}},{key:"destroy",value:function(){var t;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(t=this.tilesetManager)===null||t===void 0||t.destroy(),this.tileLayerService.destroy()}},{key:"reload",value:function(){var t;this.tilesetManager.clear();var i=this.getCurrentView(),r=i.latLonBounds,a=i.zoom;(t=this.tilesetManager)===null||t===void 0||t.update(a,r)}},{key:"tileUnLoad",value:function(t){this.tileLayerService.removeTile(t.key)}},{key:"tileUpdate",value:function(){var n=(0,st.Z)(q().mark(function i(){var r=this,a,o;return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.tilesetManager){s.next=2;break}return s.abrupt("return");case 2:return a=this.parent.getMinZoom(),o=this.parent.getMaxZoom(),s.next=6,Promise.all(this.tilesetManager.tiles.filter(function(l){return l.isLoaded}).filter(function(l){return l.isVisibleChange}).filter(function(l){return l.data}).filter(function(l){return l.z>=a&&l.z<o}).map(function(){var l=(0,st.Z)(q().mark(function h(d){var v,y;return q().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(r.tileLayerService.hasTile(d.key)){S.next=9;break}return v=Jk(r.parent),y=new v(d,r.parent),S.next=5,y.initTileLayer();case 5:r.tilePickService.setPickState(),y.getLayers().length!==0&&(r.tileLayerService.addTile(y),r.tileLayerService.updateTileVisible(d),r.layerService.reRender()),S.next=12;break;case 9:r.tileLayerService.updateTileVisible(d),r.tilePickService.setPickState(),r.layerService.reRender();case 12:case"end":return S.stop()}},h)}));return function(h){return l.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return s.stop()}},i,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"setPickState",value:function(t){}},{key:"pickRender",value:function(t){this.tilePickService.pickRender(t)}},{key:"selectFeature",value:function(t){this.tilePickService.selectFeature(t)}},{key:"highlightPickedFeature",value:function(t){this.tilePickService.highlightPickedFeature(t)}},{key:"proxy",value:function(t){var i=this;wk.forEach(function(r){var a=t[r].bind(t);t[r]=function(){for(var o=arguments.length,u=new Array(o),s=0;s<o;s++)u[s]=arguments[s];return a.apply(void 0,u),i.getLayers().map(function(l){l[r].apply(l,u)}),r==="style"&&i.getTiles().forEach(function(l){return l.styleUpdate.apply(l,u)}),t}})}}]),e}(),ZE,UE,e5=(ZE=(0,pr.b2)(),ZE(UE=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"build",value:function(){var n=(0,st.Z)(q().mark(function i(r){return q().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return r.prepareBuildModel(),o.next=3,r.buildModels();case 3:case"end":return o.stop()}},i)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"initLayerModel",value:function(){var n=(0,st.Z)(q().mark(function i(r){return q().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.build(r);case 2:r.styleNeedUpdate=!1;case 3:case"end":return o.stop()}},i,this)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"prepareLayerModel",value:function(){var n=(0,st.Z)(q().mark(function i(r){return q().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.build(r);case 2:r.styleNeedUpdate=!1;case 3:case"end":return o.stop()}},i,this)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"apply",value:function(t){var i=this;t.hooks.init.tapPromise("LayerModelPlugin",(0,st.Z)(q().mark(function r(){return q().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!t.getSource().isTile){o.next=4;break}return t.prepareBuildModel(),t.tileLayer=new BE(t),o.abrupt("return");case 4:return t.log(ca.BuildModelStart,$n.INIT),o.next=7,i.initLayerModel(t);case 7:t.log(ca.BuildModelEnd,$n.INIT);case 8:case"end":return o.stop()}},r)}))),t.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var r=(0,st.Z)(q().mark(function a(o){return q().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o){s.next=2;break}return s.abrupt("return",!1);case 2:if(!t.getSource().isTile){s.next=5;break}return t.tileLayer=new BE(t),s.abrupt("return",!1);case 5:return t.log(ca.BuildModelStart,$n.UPDATE),s.next=8,i.prepareLayerModel(t);case 8:return t.log(ca.BuildModelEnd,$n.UPDATE),s.abrupt("return",!0);case 10:case"end":return s.stop()}},a)}));return function(a){return r.apply(this,arguments)}}()),t.hooks.beforeRender.tap("LayerModelPlugin",function(){t.styleNeedUpdate&&i.prepareLayerModel(t).then(function(){t.styleNeedUpdate=!1,t.renderLayers()}),t.styleNeedUpdate=!1})}}]),e}())||UE),zE,GE,t5=(zE=(0,pr.b2)(),zE(GE=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerStylePlugin",function(){var i=t.getLayerConfig(),r=i.autoFit,a=i.fitBoundsOptions;r&&t.fitBounds(a)})}}]),e}())||GE),VE,HE,r5=["type"],jE={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},n5={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},i5={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},a5={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function o5(e){var n={u_DirectionalLights:new Array(3).fill((0,b.Z)({},i5)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,b.Z)({},a5)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[n5]),e.forEach(function(t){var i=t.type,r=i===void 0?"directional":i,a=(0,es.Z)(t,r5),o=jE[r].lights,u=jE[r].num,s=n[u];n[o][s]=(0,b.Z)((0,b.Z)({},n[o][s]),a),n[u]++}),n}var u5=(VE=(0,pr.b2)(),VE(HE=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LightingPlugin",function(){var i=t.getLayerConfig(),r=i.enableLighting;r&&t.models.forEach(function(a){return a.addUniforms((0,b.Z)({},o5()))})})}}]),e}())||HE),WE,$E,s5=(WE=(0,pr.b2)(),WE($E=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t,i){var r=this,a=i.rendererService,o=i.postProcessingPassFactory,u=i.normalPassFactory;t.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var s=t.getLayerConfig(),l=s.enableMultiPassRenderer,h=s.passes,d=h===void 0?[]:h;r.enabled=!!l&&t.getLayerConfig().enableMultiPassRenderer!==!1,r.enabled&&(t.multiPassRenderer=Kx(t,d,o,u),t.multiPassRenderer.setRenderFlag(!0))}),t.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(r.enabled){var s=a.getViewportSize(),l=s.width,h=s.height;t.multiPassRenderer.resize(l,h)}})}}]),e}())||$E),XE,YE,T0={NONE:0,ENCODE:1,HIGHLIGHT:2},l5=(XE=(0,pr.b2)(),XE(YE=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t,i){var r=i.styleAttributeService;t.hooks.init.tapPromise("PixelPickingPlugin",function(){var a=t.getLayerConfig(),o=a.enablePicking;r.registerStyleAttribute({name:"pickingColor",type:Ar.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:N.FLOAT},size:3,update:function(s){var l=s.id;return o?Eo(l):[0,0,0]}}})}),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),o=a.enablePicking;o&&t.isVisible()&&t.models.forEach(function(u){return u.addUniforms({u_PickingStage:T0.ENCODE})})}),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),o=a.enablePicking;o&&t.isVisible()&&t.models.forEach(function(u){return u.addUniforms({u_PickingStage:T0.HIGHLIGHT})})}),t.hooks.beforeHighlight.tap("PixelPickingPlugin",function(a){var o=t.getLayerConfig(),u=o.highlightColor,s=o.activeMix,l=s===void 0?0:s,h=typeof u=="string"?wn(u):u||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Bo(new Uint8Array(a))}),t.models.forEach(function(d){return d.addUniforms({u_PickingStage:T0.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:h.map(function(v){return v*255}),u_activeMix:l})})}),t.hooks.beforeSelect.tap("PixelPickingPlugin",function(a){var o=t.getLayerConfig(),u=o.selectColor,s=o.selectMix,l=s===void 0?0:s,h=typeof u=="string"?wn(u):u||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Bo(new Uint8Array(a))}),t.models.forEach(function(d){return d.addUniforms({u_PickingStage:T0.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:h.map(function(v){return v*255}),u_activeMix:l,u_CurrentSelectedId:a,u_SelectColor:h.map(function(v){return v*255}),u_EnableSelect:1})})})}}]),e}())||YE),c5=["mvt","geojsonvt","testTile"];function f5(e){var n=e.getSource();return c5.includes(n.parser.type)}function _7(e){return e.getContext?{width:e.width/DOM.DPR,height:e.height/DOM.DPR}:e.getBoundingClientRect()}var KE,qE,h5=(KE=(0,pr.b2)(),KE(qE=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t,i){var r=this,a=i.styleAttributeService;t.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){f5(t)||r.registerBuiltinAttributes(a,t)})}},{key:"registerBuiltinAttributes",value:function(t,i){if(i.type==="MaskLayer"){this.registerPositionAttribute(t);return}this.registerPositionAttribute(t),this.registerColorAttribute(t),this.registerVertexIdAttribute(t)}},{key:"registerPositionAttribute",value:function(t){t.registerStyleAttribute({name:"position",type:Ar.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:N.FLOAT},size:3,update:function(r,a,o){return o.length===2?[o[0],o[1],0]:[o[0],o[1],o[2]]}}})}},{key:"registerFilterAttribute",value:function(t){t.registerStyleAttribute({name:"filter",type:Ar.Attribute,descriptor:{name:"filter",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(r){var a=r.filter;return a?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(t){t.registerStyleAttribute({name:"color",type:Ar.Attribute,descriptor:{name:"a_Color",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:4,update:function(r){var a=r.color;return!a||!a.length?[1,1,1,1]:a}}})}},{key:"registerVertexIdAttribute",value:function(t){t.registerStyleAttribute({name:"vertexId",type:Ar.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:function(r,a){return[a]}}})}}]),e}())||qE),QE,JE,e2,t2,r2,n2,lp,i2,a2,o2,u2,p5=(QE=(0,pr.b2)(),JE=(0,pr.f3)(qe.ICameraService),e2=(0,pr.f3)(qe.ICoordinateSystemService),t2=(0,pr.f3)(qe.IRendererService),r2=(0,pr.f3)(qe.IMapService),QE(n2=(lp=function(){function e(){(0,ot.Z)(this,e),En(this,"cameraService",i2,this),En(this,"coordinateSystemService",a2,this),En(this,"rendererService",o2,this),En(this,"mapService",u2,this)}return(0,at.Z)(e,[{key:"apply",value:function(t){var i=this,r=this.mapService.version,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o=[0,0];t.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var u=t.getLayerConfig().tileOrigin;i.coordinateSystemService.refresh(u),r==="GAODE2.x"&&(i.setLayerCenter(t),a=i.mapService.map.customCoords.getMVPMatrix(),o=i.mapService.getCustomCoordCenter());var s=i.rendererService.getViewportSize(),l=s.width,h=s.height;t.models.forEach(function(d){var v;d.addUniforms((v={},(0,R.Z)(v,Qf.ProjectionMatrix,i.cameraService.getProjectionMatrix()),(0,R.Z)(v,Qf.ViewMatrix,i.cameraService.getViewMatrix()),(0,R.Z)(v,Qf.ViewProjectionMatrix,i.cameraService.getViewProjectionMatrix()),(0,R.Z)(v,Qf.Zoom,i.cameraService.getZoom()),(0,R.Z)(v,Qf.ZoomScale,i.cameraService.getZoomScale()),(0,R.Z)(v,Qf.FocalDistance,i.cameraService.getFocalDistance()),(0,R.Z)(v,Qf.CameraPosition,i.cameraService.getCameraPosition()),(0,R.Z)(v,un.CoordinateSystem,i.coordinateSystemService.getCoordinateSystem()),(0,R.Z)(v,un.ViewportCenter,i.coordinateSystemService.getViewportCenter()),(0,R.Z)(v,un.ViewportCenterProjection,i.coordinateSystemService.getViewportCenterProjection()),(0,R.Z)(v,un.PixelsPerDegree,i.coordinateSystemService.getPixelsPerDegree()),(0,R.Z)(v,un.PixelsPerDegree2,i.coordinateSystemService.getPixelsPerDegree2()),(0,R.Z)(v,un.PixelsPerMeter,i.coordinateSystemService.getPixelsPerMeter()),(0,R.Z)(v,un.Mvp,a),(0,R.Z)(v,"u_sceneCenterMercator",o),(0,R.Z)(v,"u_ViewportSize",[l,h]),(0,R.Z)(v,"u_ModelMatrix",i.cameraService.getModelMatrix()),(0,R.Z)(v,"u_DevicePixelRatio",In.devicePixelRatio),(0,R.Z)(v,"u_PickingBuffer",t.getLayerConfig().pickingBuffer||0),(0,R.Z)(v,"u_shaderPick",Number(t.getShaderPickStat())),v))})})}},{key:"setLayerCenter",value:function(t){t.coordCenter===void 0&&(t.coordCenter=t.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(t.coordCenter)}}]),e}(),i2=An(lp.prototype,"cameraService",[JE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a2=An(lp.prototype,"coordinateSystemService",[e2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o2=An(lp.prototype,"rendererService",[t2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u2=An(lp.prototype,"mapService",[r2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lp))||n2),s2,l2,d5=(s2=(0,pr.b2)(),s2(l2=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("UpdateModelPlugin",function(){t.layerModel&&t.layerModel.needUpdate().then(function(i){i&&t.renderLayers()})}),t.hooks.afterRender.tap("UpdateModelPlugin",function(){t.layerModelNeedUpdate=!1})}}]),e}())||l2),c2,f2,v5=(c2=(0,pr.b2)(),c2(f2=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"apply",value:function(t,i){var r=this,a=i.styleAttributeService;t.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){r.initStyleAttribute(t,{styleAttributeService:a})}),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){t.layerModelNeedUpdate||t.inited&&r.updateStyleAttribute(t,{styleAttributeService:a})})}},{key:"updateStyleAttribute",value:function(t,i){var r=i.styleAttributeService,a=r.getLayerStyleAttributes()||[],o=r.getLayerStyleAttribute("filter");if(o&&o.needRegenerateVertices){t.layerModelNeedUpdate=!0,a.forEach(function(u){return u.needRegenerateVertices=!1});return}a.filter(function(u){return u.needRegenerateVertices}).forEach(function(u){r.updateAttributeByFeatureRange(u.name,t.getEncodedData(),u.featureRange.startIndex,u.featureRange.endIndex,t),u.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(t,i){var r=i.styleAttributeService,a=r.getLayerStyleAttributes()||[];a.filter(function(o){return o.needRegenerateVertices}).forEach(function(o){r.updateAttributeByFeatureRange(o.name,t.getEncodedData(),o.featureRange.startIndex,o.featureRange.endIndex),o.needRegenerateVertices=!1})}}]),e}())||f2);au.bind(qe.ILayerPlugin).to(YI).inRequestScope(),au.bind(qe.ILayerPlugin).to(h5).inRequestScope(),au.bind(qe.ILayerPlugin).to(yk).inRequestScope(),au.bind(qe.ILayerPlugin).to(XI).inRequestScope(),au.bind(qe.ILayerPlugin).to(t5).inRequestScope(),au.bind(qe.ILayerPlugin).to(xk).inRequestScope(),au.bind(qe.ILayerPlugin).to(v5).inRequestScope(),au.bind(qe.ILayerPlugin).to(d5).inRequestScope(),au.bind(qe.ILayerPlugin).to(s5).inRequestScope(),au.bind(qe.ILayerPlugin).to(p5).inRequestScope(),au.bind(qe.ILayerPlugin).to(_k).inRequestScope(),au.bind(qe.ILayerPlugin).to(u5).inRequestScope(),au.bind(qe.ILayerPlugin).to(l5).inRequestScope(),au.bind(qe.ILayerPlugin).to(e5).inRequestScope();var m5=D(88307),g5=D.n(m5),y5=function(){function e(n,t){(0,ot.Z)(this,e);var i=t.buffer,r=t.offset,a=t.stride,o=t.normalized,u=t.size,s=t.divisor;this.buffer=i,this.attribute={buffer:i.get(),offset:r||0,stride:a||0,normalized:o||!1,divisor:s||0},u&&(this.attribute.size=u)}return(0,at.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),vc,kd,mc,ns,Fd,pf,Nd,C0,Tl,oh,fo,Cl,wl,w0,_5=(vc={},(0,R.Z)(vc,N.POINTS,"points"),(0,R.Z)(vc,N.LINES,"lines"),(0,R.Z)(vc,N.LINE_LOOP,"line loop"),(0,R.Z)(vc,N.LINE_STRIP,"line strip"),(0,R.Z)(vc,N.TRIANGLES,"triangles"),(0,R.Z)(vc,N.TRIANGLE_FAN,"triangle fan"),(0,R.Z)(vc,N.TRIANGLE_STRIP,"triangle strip"),vc),h2=(kd={},(0,R.Z)(kd,N.STATIC_DRAW,"static"),(0,R.Z)(kd,N.DYNAMIC_DRAW,"dynamic"),(0,R.Z)(kd,N.STREAM_DRAW,"stream"),kd),ly=(mc={},(0,R.Z)(mc,N.BYTE,"int8"),(0,R.Z)(mc,N.UNSIGNED_INT,"int16"),(0,R.Z)(mc,N.INT,"int32"),(0,R.Z)(mc,N.UNSIGNED_BYTE,"uint8"),(0,R.Z)(mc,N.UNSIGNED_SHORT,"uint16"),(0,R.Z)(mc,N.UNSIGNED_INT,"uint32"),(0,R.Z)(mc,N.FLOAT,"float"),mc),x5=(ns={},(0,R.Z)(ns,N.ALPHA,"alpha"),(0,R.Z)(ns,N.LUMINANCE,"luminance"),(0,R.Z)(ns,N.LUMINANCE_ALPHA,"luminance alpha"),(0,R.Z)(ns,N.RGB,"rgb"),(0,R.Z)(ns,N.RGBA,"rgba"),(0,R.Z)(ns,N.RGBA4,"rgba4"),(0,R.Z)(ns,N.RGB5_A1,"rgb5 a1"),(0,R.Z)(ns,N.RGB565,"rgb565"),(0,R.Z)(ns,N.DEPTH_COMPONENT,"depth"),(0,R.Z)(ns,N.DEPTH_STENCIL,"depth stencil"),ns),S5=(Fd={},(0,R.Z)(Fd,N.DONT_CARE,"dont care"),(0,R.Z)(Fd,N.NICEST,"nice"),(0,R.Z)(Fd,N.FASTEST,"fast"),Fd),p2=(pf={},(0,R.Z)(pf,N.NEAREST,"nearest"),(0,R.Z)(pf,N.LINEAR,"linear"),(0,R.Z)(pf,N.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,R.Z)(pf,N.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,R.Z)(pf,N.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,R.Z)(pf,N.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),pf),d2=(Nd={},(0,R.Z)(Nd,N.REPEAT,"repeat"),(0,R.Z)(Nd,N.CLAMP_TO_EDGE,"clamp"),(0,R.Z)(Nd,N.MIRRORED_REPEAT,"mirror"),Nd),b5=(C0={},(0,R.Z)(C0,N.NONE,"none"),(0,R.Z)(C0,N.BROWSER_DEFAULT_WEBGL,"browser"),C0),E5=(Tl={},(0,R.Z)(Tl,N.NEVER,"never"),(0,R.Z)(Tl,N.ALWAYS,"always"),(0,R.Z)(Tl,N.LESS,"less"),(0,R.Z)(Tl,N.LEQUAL,"lequal"),(0,R.Z)(Tl,N.GREATER,"greater"),(0,R.Z)(Tl,N.GEQUAL,"gequal"),(0,R.Z)(Tl,N.EQUAL,"equal"),(0,R.Z)(Tl,N.NOTEQUAL,"notequal"),Tl),v2=(oh={},(0,R.Z)(oh,N.FUNC_ADD,"add"),(0,R.Z)(oh,N.MIN_EXT,"min"),(0,R.Z)(oh,N.MAX_EXT,"max"),(0,R.Z)(oh,N.FUNC_SUBTRACT,"subtract"),(0,R.Z)(oh,N.FUNC_REVERSE_SUBTRACT,"reverse subtract"),oh),M0=(fo={},(0,R.Z)(fo,N.ZERO,"zero"),(0,R.Z)(fo,N.ONE,"one"),(0,R.Z)(fo,N.SRC_COLOR,"src color"),(0,R.Z)(fo,N.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,R.Z)(fo,N.SRC_ALPHA,"src alpha"),(0,R.Z)(fo,N.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,R.Z)(fo,N.DST_COLOR,"dst color"),(0,R.Z)(fo,N.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,R.Z)(fo,N.DST_ALPHA,"dst alpha"),(0,R.Z)(fo,N.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,R.Z)(fo,N.CONSTANT_COLOR,"constant color"),(0,R.Z)(fo,N.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,R.Z)(fo,N.CONSTANT_ALPHA,"constant alpha"),(0,R.Z)(fo,N.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,R.Z)(fo,N.SRC_ALPHA_SATURATE,"src alpha saturate"),fo),A5=(Cl={},(0,R.Z)(Cl,N.NEVER,"never"),(0,R.Z)(Cl,N.ALWAYS,"always"),(0,R.Z)(Cl,N.LESS,"less"),(0,R.Z)(Cl,N.LEQUAL,"lequal"),(0,R.Z)(Cl,N.GREATER,"greater"),(0,R.Z)(Cl,N.GEQUAL,"gequal"),(0,R.Z)(Cl,N.EQUAL,"equal"),(0,R.Z)(Cl,N.NOTEQUAL,"notequal"),Cl),cp=(wl={},(0,R.Z)(wl,N.ZERO,"zero"),(0,R.Z)(wl,N.KEEP,"keep"),(0,R.Z)(wl,N.REPLACE,"replace"),(0,R.Z)(wl,N.INVERT,"invert"),(0,R.Z)(wl,N.INCR,"increment"),(0,R.Z)(wl,N.DECR,"decrement"),(0,R.Z)(wl,N.INCR_WRAP,"increment wrap"),(0,R.Z)(wl,N.DECR_WRAP,"decrement wrap"),wl),T5=(w0={},(0,R.Z)(w0,N.FRONT,"front"),(0,R.Z)(w0,N.BACK,"back"),w0),C5=function(){function e(n,t){(0,ot.Z)(this,e);var i=t.data,r=t.usage,a=t.type;this.buffer=n.buffer({data:i,usage:h2[r||N.STATIC_DRAW],type:ly[a||N.UNSIGNED_BYTE]})}return(0,at.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var i=t.data,r=t.offset;this.buffer.subdata(i,r)}}]),e}(),w5=function(){function e(n,t){(0,ot.Z)(this,e);var i=t.data,r=t.usage,a=t.type,o=t.count;this.elements=n.elements({data:i,usage:h2[r||N.STATIC_DRAW],type:ly[a||N.UNSIGNED_BYTE],count:o})}return(0,at.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var i=t.data;this.elements.subdata(i)}},{key:"destroy",value:function(){}}]),e}(),M5=function(){function e(n,t){(0,ot.Z)(this,e);var i=t.width,r=t.height,a=t.color,o=t.colors,u={width:i,height:r};Array.isArray(o)&&(u.colors=o.map(function(s){return s.get()})),a&&typeof a!="boolean"&&(u.color=a.get()),this.framebuffer=n.framebuffer(u)}return(0,at.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var i=t.width,r=t.height;this.framebuffer.resize(i,r)}}]),e}(),R5=function(){function e(n,t){(0,ot.Z)(this,e),(0,R.Z)(this,"destroyed",!1),(0,R.Z)(this,"uniforms",{}),this.reGl=n;var i=t.vs,r=t.fs,a=t.attributes,o=t.uniforms,u=t.primitive,s=t.count,l=t.elements,h=t.depth,d=t.cull,v=t.instances,y={};this.options=t,o&&(this.uniforms=this.extractUniforms(o),Object.keys(o).forEach(function(M){y[M]=n.prop(M)}));var x={};Object.keys(a).forEach(function(M){x[M]=a[M].get()});var S={attributes:x,frag:r,uniforms:y,vert:i,colorMask:n.prop("colorMask"),lineWidth:1,blend:{enable:n.prop("blend.enable"),func:n.prop("blend.func"),equation:n.prop("blend.equation"),color:n.prop("blend.color")},stencil:{enable:n.prop("stencil.enable"),mask:n.prop("stencil.mask"),func:n.prop("stencil.func"),opFront:n.prop("stencil.opFront"),opBack:n.prop("stencil.opBack")},primitive:_5[u===void 0?N.TRIANGLES:u]};v&&(S.instances=v),s?S.count=s:l&&(S.elements=l.get()),this.initDepthDrawParams({depth:h},S),this.initCullDrawParams({cull:d},S),this.drawCommand=n(S),this.drawParams=S}return(0,at.Z)(e,[{key:"updateAttributesAndElements",value:function(t,i){var r={};Object.keys(t).forEach(function(a){r[a]=t[a].get()}),this.drawParams.attributes=r,this.drawParams.elements=i.get(),this.drawCommand=this.reGl(this.drawParams)}},{key:"updateAttributes",value:function(t){var i={};Object.keys(t).forEach(function(r){i[r]=t[r].get()}),this.drawParams.attributes=i,this.drawCommand=this.reGl(this.drawParams)}},{key:"addUniforms",value:function(t){this.uniforms=(0,b.Z)((0,b.Z)({},this.uniforms),this.extractUniforms(t))}},{key:"draw",value:function(t,i){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var r=(0,b.Z)((0,b.Z)({},this.uniforms),this.extractUniforms(t.uniforms||{})),a={};Object.keys(r).forEach(function(o){var u=(0,Oo.Z)(r[o]);u==="boolean"||u==="number"||Array.isArray(r[o])||r[o].BYTES_PER_ELEMENT?a[o]=r[o]:a[o]=r[o].get()}),a.blend=i?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(t),a.stencil=this.getStencilDrawParams(t),a.colorMask=this.getColorMaskDrawParams(t,i),this.drawCommand(a)}}},{key:"destroy",value:function(){var t,i;(t=this.drawParams)===null||t===void 0||(i=t.elements)===null||i===void 0||i.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(r){r==null||r.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(t,i){var r=t.depth;r&&(i.depth={enable:r.enable===void 0?!0:!!r.enable,mask:r.mask===void 0?!0:!!r.mask,func:E5[r.func||N.LESS],range:r.range||[0,1]})}},{key:"getBlendDrawParams",value:function(t){var i=t.blend,r=i||{},a=r.enable,o=r.func,u=r.equation,s=r.color,l=s===void 0?[0,0,0,0]:s;return{enable:!!a,func:{srcRGB:M0[o&&o.srcRGB||N.SRC_ALPHA],srcAlpha:M0[o&&o.srcAlpha||N.SRC_ALPHA],dstRGB:M0[o&&o.dstRGB||N.ONE_MINUS_SRC_ALPHA],dstAlpha:M0[o&&o.dstAlpha||N.ONE_MINUS_SRC_ALPHA]},equation:{rgb:v2[u&&u.rgb||N.FUNC_ADD],alpha:v2[u&&u.alpha||N.FUNC_ADD]},color:l}}},{key:"getStencilDrawParams",value:function(t){var i=t.stencil,r=i||{},a=r.enable,o=r.mask,u=o===void 0?-1:o,s=r.func,l=s===void 0?{cmp:N.ALWAYS,ref:0,mask:-1}:s,h=r.opFront,d=h===void 0?{fail:N.KEEP,zfail:N.KEEP,zpass:N.KEEP}:h,v=r.opBack,y=v===void 0?{fail:N.KEEP,zfail:N.KEEP,zpass:N.KEEP}:v;return{enable:!!a,mask:u,func:(0,b.Z)((0,b.Z)({},l),{},{cmp:A5[l.cmp]}),opFront:{fail:cp[d.fail],zfail:cp[d.zfail],zpass:cp[d.zpass]},opBack:{fail:cp[y.fail],zfail:cp[y.zfail],zpass:cp[y.zpass]}}}},{key:"getColorMaskDrawParams",value:function(t,i){var r=t.stencil,a=r!=null&&r.enable&&r.opFront&&!i?[!1,!1,!1,!1]:[!0,!0,!0,!0];return a}},{key:"initCullDrawParams",value:function(t,i){var r=t.cull;if(r){var a=r.enable,o=r.face,u=o===void 0?N.BACK:o;i.cull={enable:!!a,face:T5[u]}}}},{key:"extractUniforms",value:function(t){var i=this,r={};return Object.keys(t).forEach(function(a){i.extractUniformsRecursively(a,t[a],r,"")}),r}},{key:"extractUniformsRecursively",value:function(t,i,r,a){var o=this;if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||(0,Rr.isTypedArray)(i)||i===""||"resize"in i){r["".concat(a&&a+".").concat(t)]=i;return}(0,Rr.isPlainObject)(i)&&Object.keys(i).forEach(function(u){o.extractUniformsRecursively(u,i[u],r,"".concat(a&&a+".").concat(t))}),Array.isArray(i)&&i.forEach(function(u,s){Object.keys(u).forEach(function(l){o.extractUniformsRecursively(l,u[l],r,"".concat(a&&a+".").concat(t,"[").concat(s,"]"))})})}}]),e}(),L5=function(){function e(n,t){(0,ot.Z)(this,e),(0,R.Z)(this,"isDestroy",!1);var i=t.data,r=t.type,a=r===void 0?N.UNSIGNED_BYTE:r,o=t.width,u=t.height,s=t.flipY,l=s===void 0?!1:s,h=t.format,d=h===void 0?N.RGBA:h,v=t.mipmap,y=v===void 0?!1:v,x=t.wrapS,S=x===void 0?N.CLAMP_TO_EDGE:x,M=t.wrapT,O=M===void 0?N.CLAMP_TO_EDGE:M,H=t.aniso,W=H===void 0?0:H,he=t.alignment,ve=he===void 0?1:he,Re=t.premultiplyAlpha,ze=Re===void 0?!1:Re,ft=t.mag,gt=ft===void 0?N.NEAREST:ft,Pt=t.min,Mt=Pt===void 0?N.NEAREST:Pt,sr=t.colorSpace,xr=sr===void 0?N.BROWSER_DEFAULT_WEBGL:sr,Br=t.x,kn=Br===void 0?0:Br,Oi=t.y,xi=Oi===void 0?0:Oi,vi=t.copy,na=vi===void 0?!1:vi;this.width=o,this.height=u;var is={width:o,height:u,type:ly[a],format:x5[d],wrapS:d2[S],wrapT:d2[O],mag:p2[gt],min:p2[Mt],alignment:ve,flipY:l,colorSpace:b5[xr],premultiplyAlpha:ze,aniso:W,x:kn,y:xi,copy:na};i&&(is.data=i),typeof y=="number"?is.mipmap=S5[y]:typeof y=="boolean"&&(is.mipmap=y),this.texture=n.texture(is)}return(0,at.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(t)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var i=t.width,r=t.height;this.texture.resize(i,r),this.width=i,this.height=r}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var t;(t=this.texture)===null||t===void 0||t.destroy()}this.isDestroy=!0}}]),e}(),m2,g2,P5=(m2=(0,pr.b2)(),m2(g2=function(){function e(){var n=this;(0,ot.Z)(this,e),(0,R.Z)(this,"createModel",function(t){return new R5(n.gl,t)}),(0,R.Z)(this,"createAttribute",function(t){return new y5(n.gl,t)}),(0,R.Z)(this,"createBuffer",function(t){return new C5(n.gl,t)}),(0,R.Z)(this,"createElements",function(t){return new w5(n.gl,t)}),(0,R.Z)(this,"createTexture2D",function(t){return new L5(n.gl,t)}),(0,R.Z)(this,"createFramebuffer",function(t){return new M5(n.gl,t)}),(0,R.Z)(this,"useFramebuffer",function(t,i){n.gl({framebuffer:t?t.get():null})(i)}),(0,R.Z)(this,"clear",function(t){var i,r=t.color,a=t.depth,o=t.stencil,u=t.framebuffer,s=u===void 0?null:u,l={color:r,depth:a,stencil:o};l.framebuffer=s===null?s:s.get(),(i=n.gl)===null||i===void 0||i.clear(l)}),(0,R.Z)(this,"viewport",function(t){var i=t.x,r=t.y,a=t.width,o=t.height;n.gl._gl.viewport(i,r,a,o),n.width=a,n.height=o,n.gl._refresh()}),(0,R.Z)(this,"readPixels",function(t){var i=t.framebuffer,r=t.x,a=t.y,o=t.width,u=t.height,s={x:r,y:a,width:o,height:u};return i&&(s.framebuffer=i.get()),n.gl.read(s)}),(0,R.Z)(this,"getViewportSize",function(){return{width:n.gl._gl.drawingBufferWidth,height:n.gl._gl.drawingBufferHeight}}),(0,R.Z)(this,"getContainer",function(){if(Ba)return n.canvas;var t;return(t=n.canvas)===null||t===void 0?void 0:t.parentElement}),(0,R.Z)(this,"getCanvas",function(){return n.canvas}),(0,R.Z)(this,"getGLContext",function(){return n.gl._gl}),(0,R.Z)(this,"destroy",function(){var t,i,r;n.canvas=null,(t=n.gl)===null||t===void 0||(i=t._gl)===null||i===void 0||(r=i.getExtension("WEBGL_lose_context"))===null||r===void 0||r.loseContext(),n.gl.destroy(),n.gl=null})}return(0,at.Z)(e,[{key:"init",value:function(){var n=(0,st.Z)(q().mark(function i(r,a,o){var u=this;return q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.canvas=r,!o){l.next=5;break}this.gl=o,l.next=8;break;case 5:return l.next=7,new Promise(function(h,d){g5()({canvas:u.canvas,attributes:{alpha:!0,antialias:a.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:a.preserveDrawingBuffer,stencil:a.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:function(y,x){(y||!x)&&d(y),h(x)}})});case 7:this.gl=l.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return l.stop()}},i,this)}));function t(i,r,a){return n.apply(this,arguments)}return t}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(t){return!!this.getGLContext().getExtension(t)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var t=this.getGLContext();t.disable(t.CULL_FACE)}},{key:"setDirty",value:function(t){this.isDirty=t}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||g2);function I5(e){var n=O5();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function O5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cy=["selectstart","selecting","selectend"],k5=function(e){(0,Ot.Z)(t,e);var n=I5(t);function t(i){var r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,ot.Z)(this,t),r=n.call(this),(0,R.Z)((0,pe.Z)(r),"isEnable",!1),(0,R.Z)((0,pe.Z)(r),"onDragStart",function(o){r.box.style.display="block",r.startEvent=r.endEvent=o,r.syncBoxBound(),r.emit("selectstart",r.getLngLatBox(),r.startEvent,r.endEvent)}),(0,R.Z)((0,pe.Z)(r),"onDragging",function(o){r.endEvent=o,r.syncBoxBound(),r.emit("selecting",r.getLngLatBox(),r.startEvent,r.endEvent)}),(0,R.Z)((0,pe.Z)(r),"onDragEnd",function(o){r.endEvent=o,r.box.style.display="none",r.emit("selectend",r.getLngLatBox(),r.startEvent,r.endEvent)}),r.scene=i,r.options=a,r}return(0,at.Z)(t,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var r=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var a=bn("div",void 0,this.container);a.classList.add("l7-select-box"),r&&a.classList.add(r),a.style.display="none",this.box=a}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){!this.isEnable||(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var r=this.startEvent,a=r.x,o=r.y,u=this.endEvent,s=u.x,l=u.y,h=Math.min(a,s),d=Math.min(o,l),v=Math.abs(a-s),y=Math.abs(o-l);this.box.style.top="".concat(d,"px"),this.box.style.left="".concat(h,"px"),this.box.style.width="".concat(v,"px"),this.box.style.height="".concat(y,"px")}},{key:"getLngLatBox",value:function(){var r=this.startEvent.lngLat,a=r.lng,o=r.lat,u=this.endEvent.lngLat,s=u.lng,l=u.lat;return Bc([[a,o],[s,l]])}}]),t}(Wi.EventEmitter),F5=function(){function e(n){(0,ot.Z)(this,e);var t=n.id,i=n.map,r=n.canvas,a=n.hasBaseMap,o=IC();this.container=o,i.setContainer(o,t,r,a),o.bind(qe.IRendererService).to(P5).inSingletonScope(),this.sceneService=o.get(qe.ISceneService),this.mapService=o.get(qe.IMapService),this.iconService=o.get(qe.IIconService),this.fontService=o.get(qe.IFontService),this.controlService=o.get(qe.IControlService),this.layerService=o.get(qe.ILayerService),this.debugService=o.get(qe.IDebugService),this.debugService.setEnable(n.debug),this.markerService=o.get(qe.IMarkerService),this.interactionService=o.get(qe.IInteractionService),this.popupService=o.get(qe.IPopupService),this.boxSelect=new k5(this,{}),la((n==null?void 0:n.isMini)||!1),Ba?this.sceneService.initMiniScene(n):(this.initComponent(t),this.sceneService.init(n),this.initControl())}return(0,at.Z)(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"getDebugService",value:function(){return this.debugService}},{key:"exportPng",value:function(){var n=(0,st.Z)(q().mark(function i(r){return q().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.sceneService.exportPng(r));case 1:case"end":return o.stop()}},i,this)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"exportMap",value:function(){var n=(0,st.Z)(q().mark(function i(r){return q().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.sceneService.exportPng(r));case 1:case"end":return o.stop()}},i,this)}));function t(i){return n.apply(this,arguments)}return t}()},{key:"registerRenderService",value:function(t){var i=this;if(this.sceneService.loaded){var r=new t(this);r.init()}else this.on("loaded",function(){var a=new t(i);a.init()})}},{key:"setBgColor",value:function(t){this.mapService.setBgColor(t)}},{key:"addLayer",value:function(t){var i=this,r=gd(this.container);if(t.setContainer(r,this.container),this.sceneService.addLayer(t),t.inited){var a=this.initMask(t);this.addMask(a,t.id)}else t.on("inited",function(){var o=i.initMask(t);i.addMask(o,t.id)})}},{key:"initMask",value:function(t){var i=t.getLayerConfig(),r=i.mask,a=i.maskfence,o=i.maskColor,u=o===void 0?"#000":o,s=i.maskOpacity,l=s===void 0?0:s;if(!(!r||!a)){var h=new rb().source(a).shape("fill").style({color:u,opacity:l});return h}}},{key:"addMask",value:function(t,i){if(!!t){var r=this.getLayer(i);if(r){var a=gd(this.container);t.setContainer(a,this.container),r.addMaskLayer(t),this.sceneService.addMask(t)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(t){return this.layerService.getLayer(t)}},{key:"getLayerByName",value:function(t){return this.layerService.getLayerByName(t)}},{key:"removeLayer",value:function(){var n=(0,st.Z)(q().mark(function i(r,a){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.layerService.remove(r,a);case 2:case"end":return u.stop()}},i,this)}));function t(i,r){return n.apply(this,arguments)}return t}()},{key:"removeAllLayer",value:function(){var n=(0,st.Z)(q().mark(function i(){return q().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.layerService.removeAllLayers();case 2:case"end":return a.stop()}},i,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(t){this.layerService.setEnableRender(t)}},{key:"addIconFont",value:function(t,i){this.fontService.addIconFont(t,i)}},{key:"addIconFonts",value:function(t){var i=this;t.forEach(function(r){var a=(0,Dr.Z)(r,2),o=a[0],u=a[1];i.fontService.addIconFont(o,u)})}},{key:"addFontFace",value:function(t,i){var r=this;this.fontService.once("fontloaded",function(a){r.emit("fontloaded",a)}),this.fontService.addFontFace(t,i)}},{key:"addImage",value:function(){var n=(0,st.Z)(q().mark(function i(r,a){return q().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(Ba){u.next=5;break}return u.next=3,this.iconService.addImage(r,a);case 3:u.next=6;break;case 5:this.iconService.addImageMini(r,a,this.sceneService);case 6:case"end":return u.stop()}},i,this)}));function t(i,r){return n.apply(this,arguments)}return t}()},{key:"hasImage",value:function(t){return this.iconService.hasImage(t)}},{key:"removeImage",value:function(t){this.iconService.removeImage(t)}},{key:"addIconFontGlyphs",value:function(t,i){this.fontService.addIconGlyphs(i)}},{key:"addControl",value:function(t){this.controlService.addControl(t,this.container)}},{key:"removeControl",value:function(t){this.controlService.removeControl(t)}},{key:"getControlByName",value:function(t){return this.controlService.getControlByName(t)}},{key:"addMarker",value:function(t){this.markerService.addMarker(t)}},{key:"addMarkerLayer",value:function(t){this.markerService.addMarkerLayer(t)}},{key:"removeMarkerLayer",value:function(t){this.markerService.removeMarkerLayer(t)}},{key:"removeAllMarkers",value:function(){this.markerService.removeAllMarkers()}},{key:"removeAllMakers",value:function(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(t){this.popupService.addPopup(t)}},{key:"removePopup",value:function(t){this.popupService.removePopup(t)}},{key:"on",value:function(t,i){if(cy.includes(t)){var r;(r=this.boxSelect)===null||r===void 0||r.on(t,i)}else Kv.includes(t)?this.sceneService.on(t,i):this.mapService.on(t,i)}},{key:"once",value:function(t,i){if(cy.includes(t)){var r;(r=this.boxSelect)===null||r===void 0||r.once(t,i)}else Kv.includes(t)?this.sceneService.once(t,i):this.mapService.once(t,i)}},{key:"emit",value:function(t,i){Kv.indexOf(t)===-1?this.mapService.on(t,i):this.sceneService.emit(t,i)}},{key:"off",value:function(t,i){if(cy.includes(t)){var r;(r=this.boxSelect)===null||r===void 0||r.off(t,i)}else Kv.includes(t)?this.sceneService.off(t,i):this.mapService.off(t,i)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(t){return this.mapService.getCenter(t)}},{key:"setCenter",value:function(t,i){return this.mapService.setCenter(t,i)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(t){return this.mapService.setPitch(t)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(t){this.mapService.setRotation(t)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(t){this.mapService.panTo(t)}},{key:"panBy",value:function(t,i){this.mapService.panBy(t,i)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(t){this.mapService.setZoom(t)}},{key:"fitBounds",value:function(t,i){var r=this.sceneService.getSceneConfig(),a=r.fitBoundsOptions,o=r.animate;this.mapService.fitBounds(t,i||(0,b.Z)((0,b.Z)({},a),{},{animate:o}))}},{key:"setZoomAndCenter",value:function(t,i){this.mapService.setZoomAndCenter(t,i)}},{key:"setMapStyle",value:function(t){this.mapService.setMapStyle(t)}},{key:"setMapStatus",value:function(t){this.mapService.setMapStatus(t)}},{key:"pixelToLngLat",value:function(t){return this.mapService.pixelToLngLat(t)}},{key:"lngLatToPixel",value:function(t){return this.mapService.lngLatToPixel(t)}},{key:"containerToLngLat",value:function(t){return this.mapService.containerToLngLat(t)}},{key:"lngLatToContainer",value:function(t){return this.mapService.lngLatToContainer(t)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(t,i){this.container.bind(qe.IPostProcessingPass).to(t).whenTargetNamed(i)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),i&&this.boxSelect.once("selectend",function(){t.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(t){this.controlService.init({container:Za(t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var t=this.sceneService.getSceneConfig(),i=t.logoVisible,r=t.logoPosition;i&&this.addControl(new $x({position:r}))}}]),e}(),x7="2.17.4",y2,fy,_2,N5=(y2=xg(qe.IGlobalConfigService),fy=function(){function e(n){(0,ot.Z)(this,e),En(this,"configService",_2,this),this.config=n}return(0,at.Z)(e,[{key:"setContainer",value:function(t,i,r,a){t.bind(qe.MapConfig).toConstantValue((0,b.Z)((0,b.Z)({},this.config),{},{id:i,canvas:r,hasBaseMap:a})),t.bind(qe.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),_2=An(fy.prototype,"configService",[y2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fy),D5=D(81618),x2=D.n(D5),B5=function(){function e(n){(0,ot.Z)(this,e),(0,R.Z)(this,"size",1e4),this.size=n||1e4}return(0,at.Z)(e,[{key:"setSize",value:function(t){this.size=t}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(t){return(180+t)/360*this.size}},{key:"mercatorYfromLat",value:function(t){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(t){return t/this.size*360-180}},{key:"latFromMercatorY",value:function(t){var i=180-(1-t/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90}},{key:"project",value:function(t){var i=this.mercatorXfromLng(t[0]),r=this.mercatorYfromLat(t[1]);return[i,r]}},{key:"unproject",value:function(t){var i=this.lngFromMercatorX(t[0]),r=this.latFromMercatorY(t[1]);return[i,r]}}]),e}();function S2(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return(0,b.Z)((0,b.Z)({},n),e)}function Dd(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function R0(e,n){var t=od([],n,e);return qm(t,t,1/t[3]),t}function S7(e,n){var t=e%n;return t<0?n+t:t}function b7(e,n,t){return t*n+(1-t)*e}function uh(e,n){if(!e)throw new Error(n||"viewport-mercator-project: assertion failed.")}var Gs=Math.PI,b2=Gs/4,gc=Gs/180,E2=180/Gs,hy=512,py=4003e4,Z5=1.5;function A2(e){return Math.pow(2,e)}function U5(e){return Math.log2(e)}function L0(e,n){var t=(0,Dr.Z)(e,2),i=t[0],r=t[1];uh(Number.isFinite(i)&&Number.isFinite(n)),uh(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude"),n*=hy;var a=i*gc,o=r*gc,u=n*(a+Gs)/(2*Gs),s=n*(Gs-Math.log(Math.tan(b2+o*.5)))/(2*Gs);return[u,s]}function dy(e,n){var t=(0,Dr.Z)(e,2),i=t[0],r=t[1];n*=hy;var a=i/n*(2*Gs)-Gs,o=2*(Math.atan(Math.exp(Gs-r/n*(2*Gs)))-b2);return[a*E2,o*E2]}function E7(e){var n=e.latitude;assert(Number.isFinite(n));var t=Math.cos(n*gc);return U5(py*t)-9}function T2(e){var n=e.latitude,t=e.longitude,i=e.zoom,r=e.scale,a=e.highPrecision,o=a===void 0?!1:a;r=r!==void 0?r:A2(i),uh(Number.isFinite(n)&&Number.isFinite(t)&&Number.isFinite(r));var u={},s=hy*r,l=Math.cos(n*gc),h=s/360,d=h/l,v=s/py/l;if(u.pixelsPerMeter=[v,-v,v],u.metersPerPixel=[1/v,-1/v,1/v],u.pixelsPerDegree=[h,-d,v],u.degreesPerPixel=[1/h,-1/d,1/v],o){var y=gc*Math.tan(n*gc)/l,x=h*y/2,S=s/py*y,M=S/d*v;u.pixelsPerDegree2=[0,-x,S],u.pixelsPerMeter2=[M,0,M]}return u}function A7(e,n){var t=_slicedToArray(e,3),i=t[0],r=t[1],a=t[2],o=_slicedToArray(n,3),u=o[0],s=o[1],l=o[2],h=1,d=T2({longitude:i,latitude:r,scale:h,highPrecision:!0}),v=d.pixelsPerMeter,y=d.pixelsPerMeter2,x=L0(e,h);x[0]+=u*(v[0]+y[0]*s),x[1]+=s*(v[1]+y[1]*s);var S=dy(x,h),M=(a||0)+(l||0);return Number.isFinite(a)||Number.isFinite(l)?[S[0],S[1],M]:S}function z5(e){var n=e.height,t=e.pitch,i=e.bearing,r=e.altitude,a=e.center,o=a===void 0?null:a,u=e.flipY,s=u===void 0?!1:u,l=Dd();return cc(l,l,[0,0,-r]),ef(l,l,[1,1,1/n]),tf(l,l,-t*gc),$h(l,l,i*gc),s&&ef(l,l,[1,-1,1]),o&&cc(l,l,pS([],o)),l}function G5(e){var n=e.width,t=e.height,i=e.altitude,r=i===void 0?Z5:i,a=e.pitch,o=a===void 0?0:a,u=e.nearZMultiplier,s=u===void 0?1:u,l=e.farZMultiplier,h=l===void 0?1:l,d=o*gc,v=Math.atan(.5/r),y=Math.sin(v)*r/Math.sin(Math.PI/2-d-v),x=Math.cos(Math.PI/2-d)*y+r;return{fov:2*Math.atan(t/2/r),aspect:n/t,focalDistance:r,near:s,far:x*h}}function V5(e){var n=e.width,t=e.height,i=e.pitch,r=e.altitude,a=e.nearZMultiplier,o=e.farZMultiplier,u=G5({width:n,height:t,altitude:r,pitch:i,nearZMultiplier:a,farZMultiplier:o}),s=u.fov,l=u.aspect,h=u.near,d=u.far,v=Qp([],s,l,h,d);return v}function H5(e,n){var t=(0,Dr.Z)(e,3),i=t[0],r=t[1],a=t[2],o=a===void 0?0:a;return uh(Number.isFinite(i)&&Number.isFinite(r)&&Number.isFinite(o)),R0(n,[i,r,o,1])}function C2(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(0,Dr.Z)(e,3),r=i[0],a=i[1],o=i[2];if(uh(Number.isFinite(r)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(o)){var u=R0(n,[r,a,o,1]);return u}var s=R0(n,[r,a,0,1]),l=R0(n,[r,a,1,1]),h=s[2],d=l[2],v=h===d?0:((t||0)-h)/(d-h);return Nh([],s,l,v)}var w2=Dd(),j5=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=n.width,i=n.height,r=n.viewMatrix,a=r===void 0?w2:r,o=n.projectionMatrix,u=o===void 0?w2:o;(0,ot.Z)(this,e),this.width=t||1,this.height=i||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=u;var s=Dd();Ri(s,s,this.projectionMatrix),Ri(s,s,this.viewMatrix),this.viewProjectionMatrix=s;var l=Dd();ef(l,l,[this.width/2,-this.height/2,1]),cc(l,l,[1,-1,0]),Ri(l,l,this.viewProjectionMatrix);var h=jh(Dd(),l);if(!h)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=l,this.pixelUnprojectionMatrix=h,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,at.Z)(e,[{key:"equals",value:function(t){return t instanceof e?t.width===this.width&&t.height===this.height&&Jp(t.projectionMatrix,this.projectionMatrix)&&Jp(t.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.topLeft,a=r===void 0?!0:r,o=this.projectPosition(t),u=H5(o,this.pixelProjectionMatrix),s=(0,Dr.Z)(u,2),l=s[0],h=s[1],d=a?h:this.height-h;return t.length===2?[l,d]:[l,d,u[2]]}},{key:"unproject",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.topLeft,a=r===void 0?!0:r,o=i.targetZ,u=(0,Dr.Z)(t,3),s=u[0],l=u[1],h=u[2],d=a?l:this.height-l,v=o&&o*this.pixelsPerMeter,y=C2([s,d,h],this.pixelUnprojectionMatrix,v),x=this.unprojectPosition(y),S=(0,Dr.Z)(x,3),M=S[0],O=S[1],H=S[2];return Number.isFinite(h)?[M,O,H]:Number.isFinite(o)?[M,O,o]:[M,O]}},{key:"projectPosition",value:function(t){var i=this.projectFlat(t),r=(0,Dr.Z)(i,2),a=r[0],o=r[1],u=(t[2]||0)*this.pixelsPerMeter;return[a,o,u]}},{key:"unprojectPosition",value:function(t){var i=this.unprojectFlat(t),r=(0,Dr.Z)(i,2),a=r[0],o=r[1],u=(t[2]||0)/this.pixelsPerMeter;return[a,o,u]}},{key:"projectFlat",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return t}}]),e}();function W5(e){var n=e.width,t=e.height,i=e.bounds,r=e.minExtent,a=r===void 0?0:r,o=e.maxZoom,u=o===void 0?24:o,s=e.padding,l=s===void 0?0:s,h=e.offset,d=h===void 0?[0,0]:h,v=(0,Dr.Z)(i,2),y=(0,Dr.Z)(v[0],2),x=y[0],S=y[1],M=(0,Dr.Z)(v[1],2),O=M[0],H=M[1];if(Number.isFinite(l)){var W=l;l={top:W,bottom:W,left:W,right:W}}else uh(Number.isFinite(l.top)&&Number.isFinite(l.bottom)&&Number.isFinite(l.left)&&Number.isFinite(l.right));var he=new M2({width:n,height:t,longitude:0,latitude:0,zoom:0}),ve=he.project([x,H]),Re=he.project([O,S]),ze=[Math.max(Math.abs(Re[0]-ve[0]),a),Math.max(Math.abs(Re[1]-ve[1]),a)],ft=[n-l.left-l.right-Math.abs(d[0])*2,t-l.top-l.bottom-Math.abs(d[1])*2];uh(ft[0]>0&&ft[1]>0);var gt=ft[0]/ze[0],Pt=ft[1]/ze[1],Mt=(l.right-l.left)/2/gt,sr=(l.bottom-l.top)/2/Pt,xr=[(Re[0]+ve[0])/2+Mt,(Re[1]+ve[1])/2+sr],Br=he.unproject(xr),kn=he.zoom+Math.log2(Math.abs(Math.min(gt,Pt)));return{longitude:Br[0],latitude:Br[1],zoom:Math.min(kn,u)}}var M2=function(e){(0,Ot.Z)(n,e);function n(){var t,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=i.width,a=i.height,o=i.latitude,u=o===void 0?0:o,s=i.longitude,l=s===void 0?0:s,h=i.zoom,d=h===void 0?0:h,v=i.pitch,y=v===void 0?0:v,x=i.bearing,S=x===void 0?0:x,M=i.altitude,O=M===void 0?1.5:M,H=i.nearZMultiplier,W=i.farZMultiplier;(0,ot.Z)(this,n),r=r||1,a=a||1;var he=A2(d);O=Math.max(.75,O);var ve=L0([l,u],he);ve[2]=0;var Re=V5({width:r,height:a,pitch:y,bearing:S,altitude:O,nearZMultiplier:H||1/a,farZMultiplier:W||1.01}),ze=z5({height:a,center:ve,pitch:y,bearing:S,altitude:O,flipY:!0});return t=(0,zt.Z)(this,(0,be.Z)(n).call(this,{width:r,height:a,viewMatrix:ze,projectionMatrix:Re})),t.latitude=u,t.longitude=l,t.zoom=d,t.pitch=y,t.bearing=S,t.altitude=O,t.scale=he,t.center=ve,t.pixelsPerMeter=T2((0,pe.Z)((0,pe.Z)(t))).pixelsPerMeter[2],Object.freeze((0,pe.Z)((0,pe.Z)(t))),t}return(0,at.Z)(n,[{key:"projectFlat",value:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return L0(i,r)}},{key:"unprojectFlat",value:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return dy(i,r)}},{key:"getMapCenterByLngLatPosition",value:function(i){var r=i.lngLat,a=i.pos,o=C2(a,this.pixelUnprojectionMatrix),u=L0(r,this.scale),s=Rn([],u,N0([],o)),l=Rn([],this.center,s);return dy(l,this.scale)}},{key:"getLocationAtPoint",value:function(i){var r=i.lngLat,a=i.pos;return this.getMapCenterByLngLatPosition({lngLat:r,pos:a})}},{key:"fitBounds",value:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,o=this.height,u=W5(Object.assign({width:a,height:o,bounds:i},r)),s=u.longitude,l=u.latitude,h=u.zoom;return new n({width:a,height:o,longitude:s,latitude:l,zoom:h})}}]),n}(j5),$5=function(){function e(){(0,ot.Z)(this,e)}return(0,at.Z)(e,[{key:"syncWithMapCamera",value:function(t){var i=t.center,r=t.zoom,a=t.pitch,o=t.bearing,u=t.viewportHeight,s=t.viewportWidth,l=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new M2((0,b.Z)((0,b.Z)({},l),{},{width:s,height:u,longitude:i&&i[0],latitude:i&&i[1],zoom:r,pitch:a,bearing:o}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,i){return this.viewport.projectFlat(t,i)}}]),e}(),X5={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},Y5=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],R2,L2,P2,I2,O2,k2,fp,F2,N2,D2,B2;function K5(e,n){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,i=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||i)&&(n||(n=document),!!n)){var r=n.head||n.getElementsByTagName("head")[0];if(!r){r=n.createElement("head");var a=n.body||n.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(r,a):n.documentElement.appendChild(r)}var o=n.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(n.createTextNode(e)),r.appendChild(o),o}}K5(`.amap-logo{
 display: none !important;
}
`);var q5={contextmenu:"rightclick"},Q5={contextmenu:"rightclick",camerachange:"viewchange"},Z2={"GAODE1.x":q5,"GAODE2.x":Q5},J5=0;window.forceWebGL=!0;var U2="15cd8a57710d40c9b7c0e3cc120f1200",e8="1.4.15",t8="amap-script",vy=!1,P0=[],r8=12,n8=(R2=(0,pr.b2)(),L2=(0,pr.f3)(qe.IGlobalConfigService),P2=(0,pr.f3)(qe.MapConfig),I2=(0,pr.f3)(qe.ICoordinateSystemService),O2=(0,pr.f3)(qe.IEventEmitter),R2(k2=(fp=function(){function e(){var n=this;(0,ot.Z)(this,e),(0,R.Z)(this,"version",Au["GAODE1.x"]),(0,R.Z)(this,"simpleMapCoord",new B5),(0,R.Z)(this,"bgColor","rgba(0, 0, 0, 0)"),En(this,"configService",F2,this),En(this,"config",N2,this),En(this,"coordinateSystemService",D2,this),En(this,"eventEmitter",B2,this),(0,R.Z)(this,"handleCameraChanged",function(t){var i=t.camera,r=i.fov,a=i.near,o=i.far,u=i.height,s=i.pitch,l=i.rotation,h=i.aspect,d=i.position,v=n.getCenter(),y=v.lng,x=v.lat;if(n.emit("mapchange"),n.cameraChangedCallback){n.viewport.syncWithMapCamera({aspect:h,bearing:360-l,far:o,fov:r,cameraHeight:u,near:a,pitch:s,zoom:n.map.getZoom()-1,center:[y,x],offsetOrigin:[d.x,d.y]});var S=n.config.offsetZoom,M=S===void 0?r8:S;n.viewport.getZoom()>M?n.coordinateSystemService.setCoordinateSystem(mn.P20_OFFSET):n.coordinateSystemService.setCoordinateSystem(mn.P20),n.cameraChangedCallback(n.viewport)}})}return(0,at.Z)(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getContainer();if(t!==null){var i=t.getElementsByClassName("amap-maps")[0];this.markerContainer=bn("div","l7-marker-container",i)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,i){Lx.indexOf(t)!==-1?this.eventEmitter.on(t,i):this.map.on(Z2[this.version][t]||t,i)}},{key:"off",value:function(t,i){Lx.indexOf(t)!==-1?this.eventEmitter.off(t,i):this.map.off(Z2[this.version][t]||t,i)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(t!=null&&t.padding){var i=this.getCenter(),r=S2(t.padding),a=this.lngLatToPixel([i.lng,i.lat]),o=[(r.right-r.left)/2,(r.bottom-r.top)/2],u=this.pixelToLngLat([a.x-o[0],a.y-o[1]]);return u}var s=this.map.getCenter();return{lng:s.getLng(),lat:s.getLat()}}},{key:"setCenter",value:function(t,i){if(i!=null&&i.padding){var r=S2(i.padding),a=this.lngLatToPixel(t),o=[(r.right-r.left)/2,(r.bottom-r.top)/2],u=this.pixelToLngLat([a.x+o[0],a.y+o[1]]);this.map.setCenter([u.lng,u.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds().toBounds(),i=t.getNorthEast(),r=t.getSouthWest(),a=this.getCenter(),o=a.lng>i.getLng()||a.lng<r.getLng()?180-i.getLng():i.getLng(),u=a.lng<r.getLng()?r.getLng()-180:r.getLng();return[[u,r.getLat()],[o,i.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.get("zooms");return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.get("zooms");return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(t,i)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,i){this.map.setZoomAndCenter(t+1,i)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyleValue(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"getMapStyleConfig",value:function(){return X5}},{key:"getMapStyleValue",value:function(t){return this.getMapStyleConfig()[t]||t}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(t){var i=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:i.getLng(),lat:i.getLat()}}},{key:"lngLatToPixel",value:function(t){var i=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:i.getX(),y:i.getY()}}},{key:"containerToLngLat",value:function(t){var i=new AMap.Pixel(t[0],t[1]),r=this.map.containerToLngLat(i);return{lng:r==null?void 0:r.getLng(),lat:r==null?void 0:r.getLat()}}},{key:"lngLatToContainer",value:function(t){var i=new AMap.LngLat(t[0],t[1]),r=this.map.lngLatToContainer(i);return{x:r.getX(),y:r.getY()}}},{key:"lngLatToCoord",value:function(t){var i=this.map.lngLatToGeodeticCoord(t),r=i.x,a=i.y;return[r,-a]}},{key:"lngLatToMercator",value:function(t,i){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,i,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],o=this.viewport.projectFlat(t),u=Ro();return cc(u,u,Va(o[0],o[1],i)),ef(u,u,Va(a[0],a[1],a[2])),tf(u,u,r[0]),Wh(u,u,r[1]),$h(u,u,r[2]),u}},{key:"init",value:function(){var n=(0,st.Z)(q().mark(function i(){var r=this,a,o,u,s,l,h,d,v,y,x,S,M,O,H;return q().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return a=this.config,o=a.id,u=a.style,s=u===void 0?"light":u,l=a.minZoom,h=l===void 0?0:l,d=a.maxZoom,v=d===void 0?18:d,y=a.token,x=y===void 0?U2:y,S=a.mapInstance,M=a.plugin,O=M===void 0?[]:M,H=(0,es.Z)(a,Y5),he.next=3,new Promise(function(ve){var Re=function(){if(S)r.map=S,r.$mapContainer=r.map.getContainer(),setTimeout(function(){r.map.on("camerachange",r.handleCameraChanged),ve()},30);else{r.$mapContainer=r.creatMapContainer(o);var ft=(0,b.Z)({mapStyle:r.getMapStyleValue(s),zooms:[h,v],viewMode:"3D"},H);ft.zoom&&(ft.zoom+=1);var gt=new AMap.Map(r.$mapContainer,ft);gt.on("camerachange",r.handleCameraChanged),gt.on("camerachange",function(){setTimeout(function(){return r.handleAfterMapChange()})}),r.map=gt,setTimeout(function(){ve()},10)}};!vy&&!S?(x===U2&&console.warn("%c".concat(r.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),vy=!0,O.push("Map3D"),x2().load({key:x,version:e8,plugins:O}).then(function(){Re(),P0.length&&(P0.forEach(function(ze){return ze()}),P0=[])}).catch(function(ze){throw new Error(ze)})):vy&&window.AMap||S?Re():P0.push(Re)});case 3:this.viewport=new $5;case 4:case"end":return he.stop()}},i,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,i){var r=AMap.GeometryUtil.distance(Ka(AMap.LngLat,(0,L.Z)(t)),Ka(AMap.LngLat,(0,L.Z)(i))),a=this.lngLatToCoord(t),o=(0,Dr.Z)(a,2),u=o[0],s=o[1],l=this.lngLatToCoord(i),h=(0,Dr.Z)(l,2),d=h[0],v=h[1],y=Math.sqrt(Math.pow(u-d,2)+Math.pow(s-v,2));return y/r}},{key:"updateView",value:function(t){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(t){var i,r=(i=this.getContainer())===null||i===void 0?void 0:i.getElementsByClassName("amap-layer")[0],a=t==="jpg"?r==null?void 0:r.toDataURL("image/jpeg"):r==null?void 0:r.toDataURL("image/png");return a}},{key:"emit",value:function(t){for(var i,r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];(i=this.eventEmitter).emit.apply(i,[t].concat(a))}},{key:"once",value:function(t){for(var i,r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];(i=this.eventEmitter).once.apply(i,[t].concat(a))}},{key:"destroy",value:function(){var t,i;(t=this.$mapContainer)===null||t===void 0||(i=t.parentNode)===null||i===void 0||i.removeChild(this.$mapContainer),delete window.initAMap;var r=document.getElementById(t8);r&&document.head.removeChild(r),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(t){var i=t;typeof t=="string"&&(i=document.getElementById(t));var r=document.createElement("div");return r.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,r.id="l7_amap_div"+J5++,i.appendChild(r),r}}]),e}(),F2=An(fp.prototype,"configService",[L2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N2=An(fp.prototype,"config",[P2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D2=An(fp.prototype,"coordinateSystemService",[I2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B2=An(fp.prototype,"eventEmitter",[O2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fp))||k2),i8=function(){function e(){(0,ot.Z)(this,e),(0,R.Z)(this,"projectionMatrix",Ro()),(0,R.Z)(this,"viewMatrix",Ro()),(0,R.Z)(this,"viewProjectionMatrix",Ro()),(0,R.Z)(this,"ViewProjectionMatrixUncentered",Ro()),(0,R.Z)(this,"viewUncenteredMatrix",Ro())}return(0,at.Z)(e,[{key:"syncWithMapCamera",value:function(t){var i=t.zoom,r=i===void 0?1:i,a=t.center,o=a===void 0?[0,0]:a,u=t.offsetOrigin,s=u===void 0?[0,0]:u,l=t.cameraPosition,h=l===void 0?[0,0,0]:l,d=t.up,v=d===void 0?[0,1,0]:d,y=t.lookAt,x=y===void 0?[0,0,0]:y,S=t.aspect,M=S===void 0?1:S,O=t.near,H=O===void 0?.1:O,W=t.far,he=W===void 0?1e3:W,ve=t.fov,Re=ve===void 0?45:ve;this.zoom=r,this.center=o,Qp(this.projectionMatrix,Re/180*Math.PI,M,H,he);var ze=Va.apply(E,(0,L.Z)(h)),ft=Va.apply(E,(0,L.Z)(x)),gt=Va.apply(E,(0,L.Z)(v));Rv(this.viewMatrix,ze,ft,gt),this.viewUncenteredMatrix=xv(this.viewMatrix),cc(this.viewMatrix,this.viewMatrix,Va(-s[0],s[1],0)),Ri(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),Ri(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var t=(0,Dr.Z)(this.center,2),i=t[0],r=t[1];return[i,r]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1.2}},{key:"projectFlat",value:function(t){var i=85.0511287798,r=Math.max(Math.min(i,t[1]),-i),a=256<<20,o=Math.PI/180,u=t[0]*o,s=r*o;s=Math.log(Math.tan(Math.PI/4+s/2));var l=.5/Math.PI,h=.5,d=-.5/Math.PI;return o=.5,u=a*(l*u+h)-215440491,s=-(a*(d*s+o)-106744817),[u,s]}}]),e}(),a8=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],z2,G2;function o8(e){var n=u8();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function u8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function s8(e,n){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,i=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||i)&&(n||(n=document),!!n)){var r=n.head||n.getElementsByTagName("head")[0];if(!r){r=n.createElement("head");var a=n.body||n.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(r,a):n.documentElement.appendChild(r)}var o=n.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(n.createTextNode(e)),r.appendChild(o),o}}s8(`.amap-logo{
 display: none !important;
}
`);var V2=[108.92361,34.54083];window.forceWebGL=!0;var H2="ff533602d57df6f8ab3b0fea226ae52f",j2="2.0",T7=!1,C7=null,l8=(z2=(0,pr.b2)(),z2(G2=function(e){(0,Ot.Z)(t,e);var n=o8(t);function t(){var i;(0,ot.Z)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=n.call.apply(n,[this].concat(a)),(0,R.Z)((0,pe.Z)(i),"version",Au["GAODE2.x"]),(0,R.Z)((0,pe.Z)(i),"handleViewChanged",function(u){var s=i.map.customCoords.getCameraParams(),l=s.fov,h=s.near,d=s.far,v=s.aspect,y=s.position,x=s.lookAt,S=s.up;i.emit("mapchange");var M=i.map.customCoords.getCenter();i.cameraChangedCallback&&(i.viewport.syncWithMapCamera({aspect:v,far:d,fov:l,cameraPosition:y,lookAt:x,up:S,near:h,zoom:i.map.getZoom()-1,center:M,offsetOrigin:[y[0],y[1]]}),i.coordinateSystemService.setCoordinateSystem(mn.P20_2),i.cameraChangedCallback(i.viewport))}),i}return(0,at.Z)(t,[{key:"setCustomCoordCenter",value:function(r){this.sceneCenter=r,this.sceneCenterMercator=ql.apply(void 0,(0,L.Z)(r))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMercator}},{key:"lngLatToCoordByLayer",value:function(r,a){var o=a||this.sceneCenterMercator,u=this._sub(ql(r[0],r[1]),o);return r[2]&&u.push(r[2]),u}},{key:"coordToAMap2RelativeCoordinates",value:function(r,a){var o=this,u=ql(a[0],a[1]);return typeof r[0]=="number"?this.lngLatToCoordByLayer(r,u):r.map(function(s){return Array.isArray(s)&&typeof s[0]=="number"?o.lngLatToCoordByLayer(s,u):s.map(function(l){return o.lngLatToCoordByLayer(l,u)})})}},{key:"setCoordCenter",value:function(r){this.map.customCoords.setCenter(r||V2),this.setCustomCoordCenter(r||V2)}},{key:"lngLatToCoord",value:function(r){return this.sceneCenter||(this.map.customCoords.setCenter(r),this.setCustomCoordCenter(r)),this._sub(ql(r[0],r[1]),this.sceneCenterMercator)}},{key:"lngLatToCoords",value:function(r){var a=this;return r.map(function(o){return typeof o[0]=="number"?a.lngLatToCoord(o):o.map(function(u){return a.lngLatToCoord(u)})})}},{key:"addMarkerContainer",value:function(){if(!!this.map){var r=this.map.getContainer();if(r!==null){var a=r.getElementsByClassName("amap-maps")[0];a.style.zIndex="auto",this.markerContainer=bn("div","l7-marker-container2",a)}}}},{key:"updateView",value:function(r){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var r=this.map.getBounds(),a=r.getNorthEast(),o=r.getSouthWest(),u=this.getCenter(),s=u.lng>a.getLng()||u.lng<o.getLng()?180-a.getLng():a.getLng(),l=u.lng<o.getLng()?o.getLng()-180:o.getLng();return[[l,o.getLat()],[s,a.getLat()]]}},{key:"getMinZoom",value:function(){var r=this.map.getZooms();return r[0]-1}},{key:"getMaxZoom",value:function(){var r=this.map.getZooms();return r[1]-1}},{key:"lngLatToContainer",value:function(r){var a=this.map.lngLatToContainer(r);return{x:a.getX(),y:a.getY()}}},{key:"lngLatToPixel",value:function(r){var a=this.map.lngLatToPixel(new AMap.LngLat(r[0],r[1]));return{x:a.getX(),y:a.getY()}}},{key:"getModelMatrix",value:function(r,a,o){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],s=this.map.customCoords.lngLatToCoord(r),l=Ro();return cc(l,l,Va(s[0],s[1],a)),ef(l,l,Va(u[0],u[1],u[2])),tf(l,l,o[0]),Wh(l,l,o[1]),$h(l,l,o[2]),l}},{key:"init",value:function(){var i=(0,st.Z)(q().mark(function a(){var o,u,s,l,h,d,v,y,x,S,M,O,H,W,he,ve,Re,ze,ft,gt,Pt,Mt;return q().wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:if(o=this.config,u=o.id,s=o.style,l=s===void 0?"light":s,h=o.minZoom,d=h===void 0?0:h,v=o.maxZoom,y=v===void 0?18:v,x=o.token,S=x===void 0?H2:x,M=o.mapInstance,O=o.plugin,H=O===void 0?[]:O,W=o.version,he=W===void 0?j2:W,ve=(0,es.Z)(o,a8),this.viewport=new i8,window.AMap||M){xr.next=6;break}return H.push("Map3D"),xr.next=6,x2().load({key:S,version:j2,plugins:H});case 6:M?(this.map=M,this.$mapContainer=this.map.getContainer(),ze=this.map.getCenter(),(Re=this.map.customCoords)===null||Re===void 0||Re.setCenter([ze.lng,ze.lat]),this.setCustomCoordCenter([ze.lng,ze.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(u),gt=(0,b.Z)({mapStyle:this.getMapStyleValue(l),zooms:[d,y],viewMode:"3D"},ve),gt.zoom&&(gt.zoom+=1),S===H2&&console.warn("%c".concat(this.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),Pt=new AMap.Map(this.$mapContainer,gt),this.map=Pt,Mt=Pt.getCenter(),(ft=this.map.customCoords)===null||ft===void 0||ft.setCenter([Mt.lng,Mt.lat]),this.setCustomCoordCenter([Mt.lng,Mt.lat]),Pt.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return xr.stop()}},a,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(r){this.cameraChangedCallback=r}},{key:"initViewPort",value:function(){var r,a=(r=this.map.customCoords)===null||r===void 0?void 0:r.getCameraParams(),o=a.fov,u=a.near,s=a.far,l=a.aspect,h=a.position,d=a.lookAt,v=a.up;this.emit("mapchange");var y=this.map.customCoords.getCenter(),x=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:l,far:s,fov:o,cameraPosition:h,lookAt:d,near:u,up:v,zoom:x-1,center:y,offsetOrigin:[h[0],h[1]]}),this.coordinateSystemService.setCoordinateSystem(mn.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(r,a){var o=[0,0];return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o}}]),t}(n8))||G2);function c8(e){var n=f8();return function(){var i=(0,be.Z)(e),r;if(n){var a=(0,be.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,zt.Z)(this,r)}}function f8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var h8=function(e){(0,Ot.Z)(t,e);var n=c8(t);function t(){return(0,ot.Z)(this,t),n.apply(this,arguments)}return(0,at.Z)(t,[{key:"getServiceConstructor",value:function(){return l8}}]),t}(N5);function Bd(e){return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Bd(e)}function W2(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function $2(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?W2(Object(t),!0).forEach(function(i){p8(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):W2(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function p8(e,n,t){return n=d8(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function d8(e){var n=v8(e,"string");return Bd(n)==="symbol"?n:String(n)}function v8(e,n){if(Bd(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n||"default");if(Bd(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function m8(e,n){return x8(e)||_8(e,n)||y8(e,n)||g8()}function g8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y8(e,n){if(!!e){if(typeof e=="string")return X2(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return X2(e,n)}}function X2(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function _8(e,n){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,r,a,o,u=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=a.call(t)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(h){l=!0,r=h}finally{try{if(!s&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return u}}function x8(e){if(Array.isArray(e))return e}var S8=ce.memo(function(e){var n=e.style,t=e.className,i=e.map,r=e.option,a=e.onSceneLoaded,o=e.children,u=(0,ce.useRef)(null),s=(0,ce.useState)(),l=m8(s,2),h=l[0],d=l[1];return(0,ce.useEffect)(function(){var v=new F5($2($2({id:u.current},r),{},{map:new h8(i)}));return v.on("loaded",function(){d(v),a&&a(v)}),function(){v.destroy()}},[]),(0,ce.useEffect)(function(){h&&i.style&&h.setMapStyle(i.style)},[JSON.stringify(i.style)]),(0,ce.useEffect)(function(){h&&i.zoom&&h.setZoom(i.zoom)},[i.zoom]),(0,ce.useEffect)(function(){h&&i.center&&h.setCenter(i.center)},[JSON.stringify(i.center)]),(0,ce.useEffect)(function(){h&&i.pitch&&h.setPitch(i.pitch)},[i.pitch]),(0,ce.useEffect)(function(){h&&i.rotation&&h.setRotation(i.rotation)},[i.rotation]),ce.createElement(J.Provider,{value:h},ce.createElement("div",{ref:u,className:t,style:n},h&&o))}),b8=S8;function Zd(e){return Zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Zd(e)}function Y2(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function w7(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?Y2(Object(t),!0).forEach(function(i){E8(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Y2(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function E8(e,n,t){return n=A8(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function A8(e){var n=T8(e,"string");return Zd(n)==="symbol"?n:String(n)}function T8(e,n){if(Zd(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n||"default");if(Zd(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function M7(e,n){return R8(e)||M8(e,n)||w8(e,n)||C8()}function C8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w8(e,n){if(!!e){if(typeof e=="string")return K2(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return K2(e,n)}}function K2(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function M8(e,n){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,r,a,o,u=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=a.call(t)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(h){l=!0,r=h}finally{try{if(!s&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return u}}function R8(e){if(Array.isArray(e))return e}var R7=null,L7=null;function Ud(e){return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ud(e)}function q2(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function P7(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?q2(Object(t),!0).forEach(function(i){L8(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):q2(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function L8(e,n,t){return n=P8(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function P8(e){var n=I8(e,"string");return Ud(n)==="symbol"?n:String(n)}function I8(e,n){if(Ud(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n||"default");if(Ud(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function I7(e,n){return N8(e)||F8(e,n)||k8(e,n)||O8()}function O8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k8(e,n){if(!!e){if(typeof e=="string")return Q2(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Q2(e,n)}}function Q2(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function F8(e,n){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,r,a,o,u=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=a.call(t)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(h){l=!0,r=h}finally{try{if(!s&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return u}}function N8(e){if(Array.isArray(e))return e}var O7=null,k7=null;function zd(e){return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},zd(e)}function J2(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function F7(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?J2(Object(t),!0).forEach(function(i){D8(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):J2(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function D8(e,n,t){return n=B8(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function B8(e){var n=Z8(e,"string");return zd(n)==="symbol"?n:String(n)}function Z8(e,n){if(zd(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n||"default");if(zd(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function N7(e,n){return V8(e)||G8(e,n)||z8(e,n)||U8()}function U8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z8(e,n){if(!!e){if(typeof e=="string")return eA(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return eA(e,n)}}function eA(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function G8(e,n){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,r,a,o,u=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=a.call(t)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(h){l=!0,r=h}finally{try{if(!s&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return u}}function V8(e){if(Array.isArray(e))return e}var D7=null,B7=null;function Gd(e){return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Gd(e)}function tA(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function Z7(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?tA(Object(t),!0).forEach(function(i){H8(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tA(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function H8(e,n,t){return n=j8(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function j8(e){var n=W8(e,"string");return Gd(n)==="symbol"?n:String(n)}function W8(e,n){if(Gd(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n||"default");if(Gd(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function U7(e,n){return K8(e)||Y8(e,n)||X8(e,n)||$8()}function $8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X8(e,n){if(!!e){if(typeof e=="string")return rA(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return rA(e,n)}}function rA(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function Y8(e,n){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,r,a,o,u=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=a.call(t)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(h){l=!0,r=h}finally{try{if(!s&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return u}}function K8(e){if(Array.isArray(e))return e}var z7=null,G7=null;function V7(e,n){return e6(e)||J8(e,n)||Q8(e,n)||q8()}function q8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q8(e,n){if(!!e){if(typeof e=="string")return nA(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nA(e,n)}}function nA(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function J8(e,n){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,r,a,o,u=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=a.call(t)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(h){l=!0,r=h}finally{try{if(!s&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return u}}function e6(e){if(Array.isArray(e))return e}var H7=null;function Vd(e){return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Vd(e)}var j7=null;function iA(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function W7(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?iA(Object(t),!0).forEach(function(i){t6(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):iA(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function t6(e,n,t){return n=r6(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r6(e){var n=n6(e,"string");return Vd(n)==="symbol"?n:String(n)}function n6(e,n){if(Vd(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n||"default");if(Vd(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function $7(e,n){if(e==null)return{};var t=i6(e,n),i,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],!(n.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,i)||(t[i]=e[i]))}return t}function i6(e,n){if(e==null)return{};var t={},i=Object.keys(e),r,a;for(a=0;a<i.length;a++)r=i[a],!(n.indexOf(r)>=0)&&(t[r]=e[r]);return t}var X7={exportImage:K3,fullscreen:ew,geoLocate:nw,layer:Wx,layerSwitch:Wx,logo:$x,mapTheme:hw,mouseLocation:vw,zoom:Sw,scale:yw},Y7=null,aA=D(73935);function oA(e,n){return s6(e)||u6(e,n)||o6(e,n)||a6()}function a6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o6(e,n){if(!!e){if(typeof e=="string")return uA(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uA(e,n)}}function uA(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function u6(e,n){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,r,a,o,u=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=a.call(t)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(h){l=!0,r=h}finally{try{if(!s&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return u}}function s6(e){if(Array.isArray(e))return e}var sA=ce.useEffect,lA=ce.useState,l6=/\B([A-Z])/g,c6=function(n){return n.replace(l6,"-$1").toLowerCase()};function K7(e){var n=e.className,t=e.style,i=e.children,r=e.position,a=lA(),o=oA(a,2),u=o[0],s=o[1],l=useSceneValue(),h=lA(function(){return document.createElement("div")}),d=oA(h,1),v=d[0];return sA(function(){var y=new Control({position:r});return y.onAdd=function(){if(n&&(v.className=n),t){var x=Object.keys(t).map(function(S){return"".concat(c6(S),":").concat(t[S])}).join(";");v.style.cssText=x}return v},y.onRemove=function(){},s(y),l.addControl(y),function(){l.removeControl(y)}},[]),sA(function(){u&&u.setPosition(r||"bottomleft")},[r]),createPortal(i,v)}var cA=(0,ce.createContext)({});function q7(){return useContext(cA)}var f6=D(60442),Ml=D.n(f6),h6=ce.memo(function(n){var t=n.layer,i=n.active;return t.active(i.option),null},Ml()),p6=ce.memo(function(n){var t=n.layer,i=n.animate;return t.animate(i),null},Ml()),d6=ce.memo(function(n){var t=n.layer,i=n.color;return i.field?t.color(i.field,i.values):t.color(i.values),null},Ml()),v6=ce.memo(function(n){var t=n.layer,i=n.filter;return i.field&&t.filter(i.field,i.values),null},Ml()),m6=ce.memo(function(n){var t=n.layer,i=n.scale;return t.scale(i.values),null},Ml()),g6=ce.memo(function(n){var t=n.layer,i=n.select;return t.select(i.option),null},Ml()),y6=ce.memo(function(n){var t=n.layer,i=n.shape;return i.field?t.shape(i.field,i.values):t.shape(i.values),null},Ml()),_6=ce.memo(function(n){var t=n.layer,i=n.size;return i.field?t.size(i.field,i.values):t.size(i.values),null},Ml()),x6=["data"];function S6(e,n){if(e==null)return{};var t=b6(e,n),i,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],!(n.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,i)||(t[i]=e[i]))}return t}function b6(e,n){if(e==null)return{};var t={},i=Object.keys(e),r,a;for(a=0;a<i.length;a++)r=i[a],!(n.indexOf(r)>=0)&&(t[r]=e[r]);return t}var E6=ce.memo(function(n){var t=n.layer,i=n.source,r=i.data,a=S6(i,x6);return t.inited?t.setData(r,a):t.source(r,a),a.autoFit&&t.fitBounds(a&&a.fitBoundsOptions),null},Ml()),Q7=ce.useEffect,A6=ce.memo(function(n){var t=n.layer,i=n.style;return t.style(i),null},Ml());function T6(e,n){return R6(e)||M6(e,n)||w6(e,n)||C6()}function C6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w6(e,n){if(!!e){if(typeof e=="string")return fA(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fA(e,n)}}function fA(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function M6(e,n){var t=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,r,a,o,u=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=a.call(t)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(h){l=!0,r=h}finally{try{if(!s&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return u}}function R6(e){if(Array.isArray(e))return e}var Hd=ce.useEffect,L6=ce.useState;function P6(e,n){var t=n.source,i=n.color,r=n.shape,a=n.style,o=n.size,u=n.scale,s=n.active,l=n.select,h=n.filter,d=n.animate,v=n.options,y=n.onLayerLoaded,x=U(),S=L6(function(){var H;switch(e){case"polygonLayer":H=new a0(v);break;case"lineLayer":H=new Dg(v);break;case"pointLayer":H=new i0(v);break;case"heatmapLayer":H=new yR(v);break;case"rasterLayer":H=new o0(v);break;case"imageLayer":H=new LS(v);break;case"citybuildingLayer":H=new VM(v);break;default:H=new a0(v)}return H.on("inited",function(){y&&y(H,x)}),H}),M=T6(S,1),O=M[0];return Hd(function(){return x.addLayer(O),function(){x.removeLayer(O)}},[]),Hd(function(){O.inited&&v&&O.updateLayerConfig(v)},[v==null?void 0:v.minZoom,v==null?void 0:v.maxZoom,v==null?void 0:v.visible]),Hd(function(){O.inited&&(v==null?void 0:v.zIndex)&&O.setIndex(v.zIndex)},[v==null?void 0:v.zIndex]),Hd(function(){O.inited&&(v==null?void 0:v.blend)&&O.setBlend(v.blend)},[v==null?void 0:v.blend]),Hd(function(){x.render()}),ce.createElement(cA.Provider,{value:O},ce.createElement(E6,{layer:O,source:t}),u&&ce.createElement(m6,{layer:O,scale:u}),i&&ce.createElement(d6,{layer:O,color:i}),o&&ce.createElement(_6,{layer:O,size:o}),r&&ce.createElement(y6,{layer:O,shape:r}),a&&ce.createElement(A6,{layer:O,style:a}),s&&ce.createElement(h6,{layer:O,active:s}),l&&ce.createElement(g6,{layer:O,select:l}),h&&ce.createElement(v6,{layer:O,filter:h}),d&&ce.createElement(p6,{layer:O,animate:d}),n.children)}var J7=null,I6=ce.memo(function(n){return P6("lineLayer",n)}),eN=null,tN=null,rN=null,nN=null,iN=null,aN=ce.useEffect,oN=null,uN=null;function hp(e){return hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},hp(e)}function hA(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function I0(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?hA(Object(t),!0).forEach(function(i){O6(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):hA(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function O6(e,n,t){return n=dA(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function k6(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function pA(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,dA(i.key),i)}}function F6(e,n,t){return n&&pA(e.prototype,n),t&&pA(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function dA(e){var n=N6(e,"string");return hp(n)==="symbol"?n:String(n)}function N6(e,n){if(hp(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n||"default");if(hp(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function D6(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&gy(e,n)}function gy(e,n){return gy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},gy(e,n)}function B6(e){var n=z6();return function(){var i=O0(e),r;if(n){var a=O0(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return Z6(this,r)}}function Z6(e,n){if(n&&(hp(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U6(e)}function U6(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function O0(e){return O0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O0(e)}var sN=function(e){D6(t,e);var n=B6(t);function t(i){var r;return k6(this,t),r=n.call(this,i),r.el=void 0,r.scene=void 0,r.popup=void 0,r.el=document.createElement("div"),r}return F6(t,[{key:"componentDidMount",value:function(){var r,a=this.props,o=a.lnglat,u=a.children,s=a.option,l=a.lngLat,h=new Tg(I0(I0({},s),{},{stopPropagation:(r=this.props.option)===null||r===void 0?void 0:r.stopPropagation}));o&&h.setLnglat(o),l&&h.setLnglat(l),u&&h.setHTML(this.el),this.popup=h,this.scene.addPopup(h)}},{key:"componentDidUpdate",value:function(r){var a,o,u,s,l,h,d=Array.isArray(r.lnglat)?r.lnglat:[r==null||(a=r.lnglat)===null||a===void 0?void 0:a.lng,r==null||(o=r.lnglat)===null||o===void 0?void 0:o.lat],v=Array.isArray(this.props.lnglat)?this.props.lnglat:[(u=this.props)===null||u===void 0||(s=u.lnglat)===null||s===void 0?void 0:s.lng,(l=this.props)===null||l===void 0||(h=l.lnglat)===null||h===void 0?void 0:h.lat],y=d.toString()!==v.toString();if(y){var x;this.popup.remove(),this.popup=new Tg(I0(I0({},this.props.option),{},{stopPropagation:(x=this.props.option)===null||x===void 0?void 0:x.stopPropagation})),this.popup.setLnglat(this.props.lnglat),this.popup.setHTML(this.el),this.scene.addPopup(this.popup)}}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var r=this;return ce.createElement(J.Consumer,{},function(a){return a&&(r.scene=a),(0,aA.createPortal)(r.props.children,r.el)})}}]),t}(ce.PureComponent);function pp(e){return pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},pp(e)}function G6(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function vA(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,H6(i.key),i)}}function V6(e,n,t){return n&&vA(e.prototype,n),t&&vA(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function H6(e){var n=j6(e,"string");return pp(n)==="symbol"?n:String(n)}function j6(e,n){if(pp(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n||"default");if(pp(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function W6(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&yy(e,n)}function yy(e,n){return yy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},yy(e,n)}function $6(e){var n=K6();return function(){var i=k0(e),r;if(n){var a=k0(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return X6(this,r)}}function X6(e,n){if(n&&(pp(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y6(e)}function Y6(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function k0(e){return k0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k0(e)}var q6=function(e){W6(t,e);var n=$6(t);function t(i){var r;return G6(this,t),r=n.call(this,i),r.el=void 0,r.scene=void 0,r.marker=void 0,r.el=document.createElement("div"),r}return V6(t,[{key:"componentDidMount",value:function(){var r=this.props,a=r.lnglat,o=r.children,u=r.option,s=r.onMarkerLoaded,l=new Zx(u);a&&l.setLnglat(a),o&&l.setElement(this.el),this.marker=l,s&&s(l),this.scene.addMarker(l)}},{key:"componentDidUpdate",value:function(r){var a,o=JSON.stringify(r==null?void 0:r.lnglat)!==JSON.stringify((a=this.props)===null||a===void 0?void 0:a.lnglat);o&&this.props.lnglat&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var r=this;return ce.createElement(J.Consumer,{},function(a){return a&&(r.scene=a),(0,aA.createPortal)(r.props.children,r.el)})}}]),t}(ce.PureComponent),lN=ce.useEffect,cN=null,fN=null,hN=ce.useEffect,pN=null},59591:function(rr,G,D){var oe=D(50008).default;function E(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */rr.exports=E=function(){return ce},rr.exports.__esModule=!0,rr.exports.default=rr.exports;var ce={},J=Object.prototype,U=J.hasOwnProperty,re=Object.defineProperty||function(P,L,b){P[L]=b.value},Y=typeof Symbol=="function"?Symbol:{},se=Y.iterator||"@@iterator",le=Y.asyncIterator||"@@asyncIterator",ye=Y.toStringTag||"@@toStringTag";function Ce(P,L,b){return Object.defineProperty(P,L,{value:b,enumerable:!0,configurable:!0,writable:!0}),P[L]}try{Ce({},"")}catch(P){Ce=function(b,de,Te){return b[de]=Te}}function Oe(P,L,b,de){var Te=L&&L.prototype instanceof Ge?L:Ge,we=Object.create(Te.prototype),We=new _t(de||[]);return re(we,"_invoke",{value:ge(P,b,We)}),we}function Ue(P,L,b){try{return{type:"normal",arg:P.call(L,b)}}catch(de){return{type:"throw",arg:de}}}ce.wrap=Oe;var pt={};function Ge(){}function lt(){}function Je(){}var Ye={};Ce(Ye,se,function(){return this});var Ke=Object.getPrototypeOf,xt=Ke&&Ke(Ke(k([])));xt&&xt!==J&&U.call(xt,se)&&(Ye=xt);var I=Je.prototype=Ge.prototype=Object.create(Ye);function ht(P){["next","throw","return"].forEach(function(L){Ce(P,L,function(b){return this._invoke(L,b)})})}function Fe(P,L){function b(Te,we,We,St){var ar=Ue(P[Te],P,we);if(ar.type!=="throw"){var jt=ar.arg,Or=jt.value;return Or&&oe(Or)=="object"&&U.call(Or,"__await")?L.resolve(Or.__await).then(function(Wr){b("next",Wr,We,St)},function(Wr){b("throw",Wr,We,St)}):L.resolve(Or).then(function(Wr){jt.value=Wr,We(jt)},function(Wr){return b("throw",Wr,We,St)})}St(ar.arg)}var de;re(this,"_invoke",{value:function(we,We){function St(){return new L(function(ar,jt){b(we,We,ar,jt)})}return de=de?de.then(St,St):St()}})}function ge(P,L,b){var de="suspendedStart";return function(Te,we){if(de==="executing")throw new Error("Generator is already running");if(de==="completed"){if(Te==="throw")throw we;return ne()}for(b.method=Te,b.arg=we;;){var We=b.delegate;if(We){var St=je(We,b);if(St){if(St===pt)continue;return St}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(de==="suspendedStart")throw de="completed",b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);de="executing";var ar=Ue(P,L,b);if(ar.type==="normal"){if(de=b.done?"completed":"suspendedYield",ar.arg===pt)continue;return{value:ar.arg,done:b.done}}ar.type==="throw"&&(de="completed",b.method="throw",b.arg=ar.arg)}}}function je(P,L){var b=L.method,de=P.iterator[b];if(de===void 0)return L.delegate=null,b==="throw"&&P.iterator.return&&(L.method="return",L.arg=void 0,je(P,L),L.method==="throw")||b!=="return"&&(L.method="throw",L.arg=new TypeError("The iterator does not provide a '"+b+"' method")),pt;var Te=Ue(de,P.iterator,L.arg);if(Te.type==="throw")return L.method="throw",L.arg=Te.arg,L.delegate=null,pt;var we=Te.arg;return we?we.done?(L[P.resultName]=we.value,L.next=P.nextLoc,L.method!=="return"&&(L.method="next",L.arg=void 0),L.delegate=null,pt):we:(L.method="throw",L.arg=new TypeError("iterator result is not an object"),L.delegate=null,pt)}function Be(P){var L={tryLoc:P[0]};1 in P&&(L.catchLoc=P[1]),2 in P&&(L.finallyLoc=P[2],L.afterLoc=P[3]),this.tryEntries.push(L)}function tt(P){var L=P.completion||{};L.type="normal",delete L.arg,P.completion=L}function _t(P){this.tryEntries=[{tryLoc:"root"}],P.forEach(Be,this),this.reset(!0)}function k(P){if(P){var L=P[se];if(L)return L.call(P);if(typeof P.next=="function")return P;if(!isNaN(P.length)){var b=-1,de=function Te(){for(;++b<P.length;)if(U.call(P,b))return Te.value=P[b],Te.done=!1,Te;return Te.value=void 0,Te.done=!0,Te};return de.next=de}}return{next:ne}}function ne(){return{value:void 0,done:!0}}return lt.prototype=Je,re(I,"constructor",{value:Je,configurable:!0}),re(Je,"constructor",{value:lt,configurable:!0}),lt.displayName=Ce(Je,ye,"GeneratorFunction"),ce.isGeneratorFunction=function(P){var L=typeof P=="function"&&P.constructor;return!!L&&(L===lt||(L.displayName||L.name)==="GeneratorFunction")},ce.mark=function(P){return Object.setPrototypeOf?Object.setPrototypeOf(P,Je):(P.__proto__=Je,Ce(P,ye,"GeneratorFunction")),P.prototype=Object.create(I),P},ce.awrap=function(P){return{__await:P}},ht(Fe.prototype),Ce(Fe.prototype,le,function(){return this}),ce.AsyncIterator=Fe,ce.async=function(P,L,b,de,Te){Te===void 0&&(Te=Promise);var we=new Fe(Oe(P,L,b,de),Te);return ce.isGeneratorFunction(L)?we:we.next().then(function(We){return We.done?We.value:we.next()})},ht(I),Ce(I,ye,"Generator"),Ce(I,se,function(){return this}),Ce(I,"toString",function(){return"[object Generator]"}),ce.keys=function(P){var L=Object(P),b=[];for(var de in L)b.push(de);return b.reverse(),function Te(){for(;b.length;){var we=b.pop();if(we in L)return Te.value=we,Te.done=!1,Te}return Te.done=!0,Te}},ce.values=k,_t.prototype={constructor:_t,reset:function(L){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(tt),!L)for(var b in this)b.charAt(0)==="t"&&U.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var L=this.tryEntries[0].completion;if(L.type==="throw")throw L.arg;return this.rval},dispatchException:function(L){if(this.done)throw L;var b=this;function de(jt,Or){return We.type="throw",We.arg=L,b.next=jt,Or&&(b.method="next",b.arg=void 0),!!Or}for(var Te=this.tryEntries.length-1;Te>=0;--Te){var we=this.tryEntries[Te],We=we.completion;if(we.tryLoc==="root")return de("end");if(we.tryLoc<=this.prev){var St=U.call(we,"catchLoc"),ar=U.call(we,"finallyLoc");if(St&&ar){if(this.prev<we.catchLoc)return de(we.catchLoc,!0);if(this.prev<we.finallyLoc)return de(we.finallyLoc)}else if(St){if(this.prev<we.catchLoc)return de(we.catchLoc,!0)}else{if(!ar)throw new Error("try statement without catch or finally");if(this.prev<we.finallyLoc)return de(we.finallyLoc)}}}},abrupt:function(L,b){for(var de=this.tryEntries.length-1;de>=0;--de){var Te=this.tryEntries[de];if(Te.tryLoc<=this.prev&&U.call(Te,"finallyLoc")&&this.prev<Te.finallyLoc){var we=Te;break}}we&&(L==="break"||L==="continue")&&we.tryLoc<=b&&b<=we.finallyLoc&&(we=null);var We=we?we.completion:{};return We.type=L,We.arg=b,we?(this.method="next",this.next=we.finallyLoc,pt):this.complete(We)},complete:function(L,b){if(L.type==="throw")throw L.arg;return L.type==="break"||L.type==="continue"?this.next=L.arg:L.type==="return"?(this.rval=this.arg=L.arg,this.method="return",this.next="end"):L.type==="normal"&&b&&(this.next=b),pt},finish:function(L){for(var b=this.tryEntries.length-1;b>=0;--b){var de=this.tryEntries[b];if(de.finallyLoc===L)return this.complete(de.completion,de.afterLoc),tt(de),pt}},catch:function(L){for(var b=this.tryEntries.length-1;b>=0;--b){var de=this.tryEntries[b];if(de.tryLoc===L){var Te=de.completion;if(Te.type==="throw"){var we=Te.arg;tt(de)}return we}}throw new Error("illegal catch attempt")},delegateYield:function(L,b,de){return this.delegate={iterator:k(L),resultName:b,nextLoc:de},this.method==="next"&&(this.arg=void 0),pt}},ce}rr.exports=E,rr.exports.__esModule=!0,rr.exports.default=rr.exports},87757:function(rr,G,D){var oe=D(59591)();rr.exports=oe;try{regeneratorRuntime=oe}catch(E){typeof globalThis=="object"?globalThis.regeneratorRuntime=oe:Function("r","regeneratorRuntime = r")(oe)}},38163:function(rr){rr.exports=G;function G(E,ce){var J=E&&E.type,U;if(J==="FeatureCollection")for(U=0;U<E.features.length;U++)G(E.features[U],ce);else if(J==="GeometryCollection")for(U=0;U<E.geometries.length;U++)G(E.geometries[U],ce);else if(J==="Feature")G(E.geometry,ce);else if(J==="Polygon")D(E.coordinates,ce);else if(J==="MultiPolygon")for(U=0;U<E.coordinates.length;U++)D(E.coordinates[U],ce);return E}function D(E,ce){if(E.length!==0){oe(E[0],ce);for(var J=1;J<E.length;J++)oe(E[J],!ce)}}function oe(E,ce){for(var J=0,U=0,re=0,Y=E.length,se=Y-1;re<Y;se=re++){var le=(E[re][0]-E[se][0])*(E[se][1]+E[re][1]),ye=J+le;U+=Math.abs(J)>=Math.abs(le)?J-ye+le:le-ye+J,J=ye}J+U>=0!=!!ce&&E.reverse()}},75550:function(rr){"use strict";rr.exports=G;function G(D,oe){this.x=D,this.y=oe}G.prototype={clone:function(){return new G(this.x,this.y)},add:function(D){return this.clone()._add(D)},sub:function(D){return this.clone()._sub(D)},multByPoint:function(D){return this.clone()._multByPoint(D)},divByPoint:function(D){return this.clone()._divByPoint(D)},mult:function(D){return this.clone()._mult(D)},div:function(D){return this.clone()._div(D)},rotate:function(D){return this.clone()._rotate(D)},rotateAround:function(D,oe){return this.clone()._rotateAround(D,oe)},matMult:function(D){return this.clone()._matMult(D)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(D){return this.x===D.x&&this.y===D.y},dist:function(D){return Math.sqrt(this.distSqr(D))},distSqr:function(D){var oe=D.x-this.x,E=D.y-this.y;return oe*oe+E*E},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(D){return Math.atan2(this.y-D.y,this.x-D.x)},angleWith:function(D){return this.angleWithSep(D.x,D.y)},angleWithSep:function(D,oe){return Math.atan2(this.x*oe-this.y*D,this.x*D+this.y*oe)},_matMult:function(D){var oe=D[0]*this.x+D[1]*this.y,E=D[2]*this.x+D[3]*this.y;return this.x=oe,this.y=E,this},_add:function(D){return this.x+=D.x,this.y+=D.y,this},_sub:function(D){return this.x-=D.x,this.y-=D.y,this},_mult:function(D){return this.x*=D,this.y*=D,this},_div:function(D){return this.x/=D,this.y/=D,this},_multByPoint:function(D){return this.x*=D.x,this.y*=D.y,this},_divByPoint:function(D){return this.x/=D.x,this.y/=D.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var D=this.y;return this.y=this.x,this.x=-D,this},_rotate:function(D){var oe=Math.cos(D),E=Math.sin(D),ce=oe*this.x-E*this.y,J=E*this.x+oe*this.y;return this.x=ce,this.y=J,this},_rotateAround:function(D,oe){var E=Math.cos(D),ce=Math.sin(D),J=oe.x+E*(this.x-oe.x)-ce*(this.y-oe.y),U=oe.y+ce*(this.x-oe.x)+E*(this.y-oe.y);return this.x=J,this.y=U,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},G.convert=function(D){return D instanceof G?D:Array.isArray(D)?new G(D[0],D[1]):D}},38929:function(rr,G,D){rr.exports.VectorTile=D(22779),D(66024),D(59701)},22779:function(rr,G,D){"use strict";var oe=D(59701);rr.exports=E;function E(J,U){this.layers=J.readFields(ce,{},U)}function ce(J,U,re){if(J===3){var Y=new oe(re,re.readVarint()+re.pos);Y.length&&(U[Y.name]=Y)}}},66024:function(rr,G,D){"use strict";var oe=D(75550);rr.exports=E;function E(Y,se,le,ye,Ce){this.properties={},this.extent=le,this.type=0,this._pbf=Y,this._geometry=-1,this._keys=ye,this._values=Ce,Y.readFields(ce,this,se)}function ce(Y,se,le){Y==1?se.id=le.readVarint():Y==2?J(le,se):Y==3?se.type=le.readVarint():Y==4&&(se._geometry=le.pos)}function J(Y,se){for(var le=Y.readVarint()+Y.pos;Y.pos<le;){var ye=se._keys[Y.readVarint()],Ce=se._values[Y.readVarint()];se.properties[ye]=Ce}}E.types=["Unknown","Point","LineString","Polygon"],E.prototype.loadGeometry=function(){var Y=this._pbf;Y.pos=this._geometry;for(var se=Y.readVarint()+Y.pos,le=1,ye=0,Ce=0,Oe=0,Ue=[],pt;Y.pos<se;){if(ye<=0){var Ge=Y.readVarint();le=Ge&7,ye=Ge>>3}if(ye--,le===1||le===2)Ce+=Y.readSVarint(),Oe+=Y.readSVarint(),le===1&&(pt&&Ue.push(pt),pt=[]),pt.push(new oe(Ce,Oe));else if(le===7)pt&&pt.push(pt[0].clone());else throw new Error("unknown command "+le)}return pt&&Ue.push(pt),Ue},E.prototype.bbox=function(){var Y=this._pbf;Y.pos=this._geometry;for(var se=Y.readVarint()+Y.pos,le=1,ye=0,Ce=0,Oe=0,Ue=Infinity,pt=-Infinity,Ge=Infinity,lt=-Infinity;Y.pos<se;){if(ye<=0){var Je=Y.readVarint();le=Je&7,ye=Je>>3}if(ye--,le===1||le===2)Ce+=Y.readSVarint(),Oe+=Y.readSVarint(),Ce<Ue&&(Ue=Ce),Ce>pt&&(pt=Ce),Oe<Ge&&(Ge=Oe),Oe>lt&&(lt=Oe);else if(le!==7)throw new Error("unknown command "+le)}return[Ue,Ge,pt,lt]},E.prototype.toGeoJSON=function(Y,se,le){var ye=this.extent*Math.pow(2,le),Ce=this.extent*Y,Oe=this.extent*se,Ue=this.loadGeometry(),pt=E.types[this.type],Ge,lt;function Je(xt){for(var I=0;I<xt.length;I++){var ht=xt[I],Fe=180-(ht.y+Oe)*360/ye;xt[I]=[(ht.x+Ce)*360/ye-180,360/Math.PI*Math.atan(Math.exp(Fe*Math.PI/180))-90]}}switch(this.type){case 1:var Ye=[];for(Ge=0;Ge<Ue.length;Ge++)Ye[Ge]=Ue[Ge][0];Ue=Ye,Je(Ue);break;case 2:for(Ge=0;Ge<Ue.length;Ge++)Je(Ue[Ge]);break;case 3:for(Ue=U(Ue),Ge=0;Ge<Ue.length;Ge++)for(lt=0;lt<Ue[Ge].length;lt++)Je(Ue[Ge][lt]);break}Ue.length===1?Ue=Ue[0]:pt="Multi"+pt;var Ke={type:"Feature",geometry:{type:pt,coordinates:Ue},properties:this.properties};return"id"in this&&(Ke.id=this.id),Ke};function U(Y){var se=Y.length;if(se<=1)return[Y];for(var le=[],ye,Ce,Oe=0;Oe<se;Oe++){var Ue=re(Y[Oe]);Ue!==0&&(Ce===void 0&&(Ce=Ue<0),Ce===Ue<0?(ye&&le.push(ye),ye=[Y[Oe]]):ye.push(Y[Oe]))}return ye&&le.push(ye),le}function re(Y){for(var se=0,le=0,ye=Y.length,Ce=ye-1,Oe,Ue;le<ye;Ce=le++)Oe=Y[le],Ue=Y[Ce],se+=(Ue.x-Oe.x)*(Oe.y+Ue.y);return se}},59701:function(rr,G,D){"use strict";var oe=D(66024);rr.exports=E;function E(U,re){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=U,this._keys=[],this._values=[],this._features=[],U.readFields(ce,this,re),this.length=this._features.length}function ce(U,re,Y){U===15?re.version=Y.readVarint():U===1?re.name=Y.readString():U===5?re.extent=Y.readVarint():U===2?re._features.push(Y.pos):U===3?re._keys.push(Y.readString()):U===4&&re._values.push(J(Y))}function J(U){for(var re=null,Y=U.readVarint()+U.pos;U.pos<Y;){var se=U.readVarint()>>3;re=se===1?U.readString():se===2?U.readFloat():se===3?U.readDouble():se===4?U.readVarint64():se===5?U.readVarint():se===6?U.readSVarint():se===7?U.readBoolean():null}return re}E.prototype.feature=function(U){if(U<0||U>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[U];var re=this._pbf.readVarint()+this._pbf.pos;return new oe(this._pbf,re,this.extent,this._keys,this._values)}},52953:function(){},13277:function(){},4914:function(rr,G,D){"use strict";D.d(G,{K:function(){return xt},Z:function(){return Be}});var oe=D(96156),E=D(28481),ce=D(90484),J=D(94184),U=D.n(J),re=D(50344),Y=D(67294),se=D(53124),le=D(96159),ye=D(24308),Ce=function(_t){var k=_t.children;return k},Oe=Ce,Ue=D(22122);function pt(tt){return tt!=null}var Ge=function(_t){var k=_t.itemPrefixCls,ne=_t.component,P=_t.span,L=_t.className,b=_t.style,de=_t.labelStyle,Te=_t.contentStyle,we=_t.bordered,We=_t.label,St=_t.content,ar=_t.colon,jt=ne;if(we){var Or;return Y.createElement(jt,{className:U()((Or={},(0,oe.Z)(Or,"".concat(k,"-item-label"),pt(We)),(0,oe.Z)(Or,"".concat(k,"-item-content"),pt(St)),Or),L),style:b,colSpan:P},pt(We)&&Y.createElement("span",{style:de},We),pt(St)&&Y.createElement("span",{style:Te},St))}return Y.createElement(jt,{className:U()("".concat(k,"-item"),L),style:b,colSpan:P},Y.createElement("div",{className:"".concat(k,"-item-container")},(We||We===0)&&Y.createElement("span",{className:U()("".concat(k,"-item-label"),(0,oe.Z)({},"".concat(k,"-item-no-colon"),!ar)),style:de},We),(St||St===0)&&Y.createElement("span",{className:U()("".concat(k,"-item-content")),style:Te},St)))},lt=Ge;function Je(tt,_t,k){var ne=_t.colon,P=_t.prefixCls,L=_t.bordered,b=k.component,de=k.type,Te=k.showLabel,we=k.showContent,We=k.labelStyle,St=k.contentStyle;return tt.map(function(ar,jt){var Or=ar.props,Wr=Or.label,Zr=Or.children,pn=Or.prefixCls,an=pn===void 0?P:pn,Fn=Or.className,ln=Or.style,gn=Or.labelStyle,nn=Or.contentStyle,Tr=Or.span,Vr=Tr===void 0?1:Tr,fi=ar.key;return typeof b=="string"?Y.createElement(lt,{key:"".concat(de,"-").concat(fi||jt),className:Fn,style:ln,labelStyle:(0,Ue.Z)((0,Ue.Z)({},We),gn),contentStyle:(0,Ue.Z)((0,Ue.Z)({},St),nn),span:Vr,colon:ne,component:b,itemPrefixCls:an,bordered:L,label:Te?Wr:null,content:we?Zr:null}):[Y.createElement(lt,{key:"label-".concat(fi||jt),className:Fn,style:(0,Ue.Z)((0,Ue.Z)((0,Ue.Z)({},We),ln),gn),span:1,colon:ne,component:b[0],itemPrefixCls:an,bordered:L,label:Wr}),Y.createElement(lt,{key:"content-".concat(fi||jt),className:Fn,style:(0,Ue.Z)((0,Ue.Z)((0,Ue.Z)({},St),ln),nn),span:Vr*2-1,component:b[1],itemPrefixCls:an,bordered:L,content:Zr})]})}var Ye=function(_t){var k=Y.useContext(xt),ne=_t.prefixCls,P=_t.vertical,L=_t.row,b=_t.index,de=_t.bordered;return P?Y.createElement(Y.Fragment,null,Y.createElement("tr",{key:"label-".concat(b),className:"".concat(ne,"-row")},Je(L,_t,(0,Ue.Z)({component:"th",type:"label",showLabel:!0},k))),Y.createElement("tr",{key:"content-".concat(b),className:"".concat(ne,"-row")},Je(L,_t,(0,Ue.Z)({component:"td",type:"content",showContent:!0},k)))):Y.createElement("tr",{key:b,className:"".concat(ne,"-row")},Je(L,_t,(0,Ue.Z)({component:de?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},k)))},Ke=Ye,xt=Y.createContext({}),I={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function ht(tt,_t){if(typeof tt=="number")return tt;if((0,ce.Z)(tt)==="object")for(var k=0;k<ye.c4.length;k++){var ne=ye.c4[k];if(_t[ne]&&tt[ne]!==void 0)return tt[ne]||I[ne]}return 3}function Fe(tt,_t,k){var ne=tt;return(_t===void 0||_t>k)&&(ne=(0,le.Tm)(tt,{span:k})),ne}function ge(tt,_t){var k=(0,re.Z)(tt).filter(function(b){return b}),ne=[],P=[],L=_t;return k.forEach(function(b,de){var Te,we=(Te=b.props)===null||Te===void 0?void 0:Te.span,We=we||1;if(de===k.length-1){P.push(Fe(b,we,L)),ne.push(P);return}We<L?(L-=We,P.push(b)):(P.push(Fe(b,We,L)),ne.push(P),L=_t,P=[])}),ne}function je(tt){var _t,k=tt.prefixCls,ne=tt.title,P=tt.extra,L=tt.column,b=L===void 0?I:L,de=tt.colon,Te=de===void 0?!0:de,we=tt.bordered,We=tt.layout,St=tt.children,ar=tt.className,jt=tt.style,Or=tt.size,Wr=tt.labelStyle,Zr=tt.contentStyle,pn=Y.useContext(se.E_),an=pn.getPrefixCls,Fn=pn.direction,ln=an("descriptions",k),gn=Y.useState({}),nn=(0,E.Z)(gn,2),Tr=nn[0],Vr=nn[1],fi=ht(b,Tr);Y.useEffect(function(){var Ne=ye.ZP.subscribe(function(V){(0,ce.Z)(b)==="object"&&Vr(V)});return function(){ye.ZP.unsubscribe(Ne)}},[]);var ti=ge(St,fi),Zn=Y.useMemo(function(){return{labelStyle:Wr,contentStyle:Zr}},[Wr,Zr]);return Y.createElement(xt.Provider,{value:Zn},Y.createElement("div",{className:U()(ln,(_t={},(0,oe.Z)(_t,"".concat(ln,"-").concat(Or),Or&&Or!=="default"),(0,oe.Z)(_t,"".concat(ln,"-bordered"),!!we),(0,oe.Z)(_t,"".concat(ln,"-rtl"),Fn==="rtl"),_t),ar),style:jt},(ne||P)&&Y.createElement("div",{className:"".concat(ln,"-header")},ne&&Y.createElement("div",{className:"".concat(ln,"-title")},ne),P&&Y.createElement("div",{className:"".concat(ln,"-extra")},P)),Y.createElement("div",{className:"".concat(ln,"-view")},Y.createElement("table",null,Y.createElement("tbody",null,ti.map(function(Ne,V){return Y.createElement(Ke,{key:V,index:V,colon:Te,prefixCls:ln,vertical:We==="vertical",bordered:we,row:Ne})}))))))}je.Item=Oe;var Be=je},98858:function(rr,G,D){"use strict";var oe=D(38663),E=D.n(oe),ce=D(52953),J=D.n(ce)},60331:function(rr,G,D){"use strict";D.d(G,{Z:function(){return xt}});var oe=D(96156),E=D(22122),ce=D(28481),J=D(54549),U=D(94184),re=D.n(U),Y=D(98423),se=D(67294),le=D(53124),ye=D(98787),Ce=D(21790),Oe=function(I,ht){var Fe={};for(var ge in I)Object.prototype.hasOwnProperty.call(I,ge)&&ht.indexOf(ge)<0&&(Fe[ge]=I[ge]);if(I!=null&&typeof Object.getOwnPropertySymbols=="function")for(var je=0,ge=Object.getOwnPropertySymbols(I);je<ge.length;je++)ht.indexOf(ge[je])<0&&Object.prototype.propertyIsEnumerable.call(I,ge[je])&&(Fe[ge[je]]=I[ge[je]]);return Fe},Ue=function(ht){var Fe,ge=ht.prefixCls,je=ht.className,Be=ht.checked,tt=ht.onChange,_t=ht.onClick,k=Oe(ht,["prefixCls","className","checked","onChange","onClick"]),ne=se.useContext(le.E_),P=ne.getPrefixCls,L=function(we){tt==null||tt(!Be),_t==null||_t(we)},b=P("tag",ge),de=re()(b,(Fe={},(0,oe.Z)(Fe,"".concat(b,"-checkable"),!0),(0,oe.Z)(Fe,"".concat(b,"-checkable-checked"),Be),Fe),je);return se.createElement("span",(0,E.Z)({},k,{className:de,onClick:L}))},pt=Ue,Ge=function(I,ht){var Fe={};for(var ge in I)Object.prototype.hasOwnProperty.call(I,ge)&&ht.indexOf(ge)<0&&(Fe[ge]=I[ge]);if(I!=null&&typeof Object.getOwnPropertySymbols=="function")for(var je=0,ge=Object.getOwnPropertySymbols(I);je<ge.length;je++)ht.indexOf(ge[je])<0&&Object.prototype.propertyIsEnumerable.call(I,ge[je])&&(Fe[ge[je]]=I[ge[je]]);return Fe},lt=new RegExp("^(".concat(ye.Y.join("|"),")(-inverse)?$")),Je=new RegExp("^(".concat(ye.E.join("|"),")$")),Ye=function(ht,Fe){var ge,je=ht.prefixCls,Be=ht.className,tt=ht.style,_t=ht.children,k=ht.icon,ne=ht.color,P=ht.onClose,L=ht.closeIcon,b=ht.closable,de=b===void 0?!1:b,Te=Ge(ht,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),we=se.useContext(le.E_),We=we.getPrefixCls,St=we.direction,ar=se.useState(!0),jt=(0,ce.Z)(ar,2),Or=jt[0],Wr=jt[1];se.useEffect(function(){"visible"in Te&&Wr(Te.visible)},[Te.visible]);var Zr=function(){return ne?lt.test(ne)||Je.test(ne):!1},pn=(0,E.Z)({backgroundColor:ne&&!Zr()?ne:void 0},tt),an=Zr(),Fn=We("tag",je),ln=re()(Fn,(ge={},(0,oe.Z)(ge,"".concat(Fn,"-").concat(ne),an),(0,oe.Z)(ge,"".concat(Fn,"-has-color"),ne&&!an),(0,oe.Z)(ge,"".concat(Fn,"-hidden"),!Or),(0,oe.Z)(ge,"".concat(Fn,"-rtl"),St==="rtl"),ge),Be),gn=function(V){V.stopPropagation(),P==null||P(V),!V.defaultPrevented&&("visible"in Te||Wr(!1))},nn=function(){return de?L?se.createElement("span",{className:"".concat(Fn,"-close-icon"),onClick:gn},L):se.createElement(J.Z,{className:"".concat(Fn,"-close-icon"),onClick:gn}):null},Tr="onClick"in Te||_t&&_t.type==="a",Vr=(0,Y.Z)(Te,["visible"]),fi=k||null,ti=fi?se.createElement(se.Fragment,null,fi,se.createElement("span",null,_t)):_t,Zn=se.createElement("span",(0,E.Z)({},Vr,{ref:Fe,className:ln,style:pn}),ti,nn());return Tr?se.createElement(Ce.Z,null,Zn):Zn},Ke=se.forwardRef(Ye);Ke.CheckableTag=pt;var xt=Ke},71153:function(rr,G,D){"use strict";var oe=D(38663),E=D.n(oe),ce=D(13277),J=D.n(ce)},9187:function(rr){"use strict";rr.exports=G,rr.exports.default=G;function G(P,L,b){b=b||2;var de=L&&L.length,Te=de?L[0]*b:P.length,we=D(P,0,Te,b,!0),We=[];if(!we||we.next===we.prev)return We;var St,ar,jt,Or,Wr,Zr,pn;if(de&&(we=Y(P,L,we,b)),P.length>80*b){St=jt=P[0],ar=Or=P[1];for(var an=b;an<Te;an+=b)Wr=P[an],Zr=P[an+1],Wr<St&&(St=Wr),Zr<ar&&(ar=Zr),Wr>jt&&(jt=Wr),Zr>Or&&(Or=Zr);pn=Math.max(jt-St,Or-ar),pn=pn!==0?32767/pn:0}return E(we,We,b,St,ar,pn,0),We}function D(P,L,b,de,Te){var we,We;if(Te===ne(P,L,b,de)>0)for(we=L;we<b;we+=de)We=tt(we,P[we],P[we+1],We);else for(we=b-de;we>=L;we-=de)We=tt(we,P[we],P[we+1],We);return We&&Ke(We,We.next)&&(_t(We),We=We.next),We}function oe(P,L){if(!P)return P;L||(L=P);var b=P,de;do if(de=!1,!b.steiner&&(Ke(b,b.next)||Ye(b.prev,b,b.next)===0)){if(_t(b),b=L=b.prev,b===b.next)break;de=!0}else b=b.next;while(de||b!==L);return L}function E(P,L,b,de,Te,we,We){if(!!P){!We&&we&&Oe(P,de,Te,we);for(var St=P,ar,jt;P.prev!==P.next;){if(ar=P.prev,jt=P.next,we?J(P,de,Te,we):ce(P)){L.push(ar.i/b|0),L.push(P.i/b|0),L.push(jt.i/b|0),_t(P),P=jt.next,St=jt.next;continue}if(P=jt,P===St){We?We===1?(P=U(oe(P),L,b),E(P,L,b,de,Te,we,2)):We===2&&re(P,L,b,de,Te,we):E(oe(P),L,b,de,Te,we,1);break}}}}function ce(P){var L=P.prev,b=P,de=P.next;if(Ye(L,b,de)>=0)return!1;for(var Te=L.x,we=b.x,We=de.x,St=L.y,ar=b.y,jt=de.y,Or=Te<we?Te<We?Te:We:we<We?we:We,Wr=St<ar?St<jt?St:jt:ar<jt?ar:jt,Zr=Te>we?Te>We?Te:We:we>We?we:We,pn=St>ar?St>jt?St:jt:ar>jt?ar:jt,an=de.next;an!==L;){if(an.x>=Or&&an.x<=Zr&&an.y>=Wr&&an.y<=pn&&lt(Te,St,we,ar,We,jt,an.x,an.y)&&Ye(an.prev,an,an.next)>=0)return!1;an=an.next}return!0}function J(P,L,b,de){var Te=P.prev,we=P,We=P.next;if(Ye(Te,we,We)>=0)return!1;for(var St=Te.x,ar=we.x,jt=We.x,Or=Te.y,Wr=we.y,Zr=We.y,pn=St<ar?St<jt?St:jt:ar<jt?ar:jt,an=Or<Wr?Or<Zr?Or:Zr:Wr<Zr?Wr:Zr,Fn=St>ar?St>jt?St:jt:ar>jt?ar:jt,ln=Or>Wr?Or>Zr?Or:Zr:Wr>Zr?Wr:Zr,gn=pt(pn,an,L,b,de),nn=pt(Fn,ln,L,b,de),Tr=P.prevZ,Vr=P.nextZ;Tr&&Tr.z>=gn&&Vr&&Vr.z<=nn;){if(Tr.x>=pn&&Tr.x<=Fn&&Tr.y>=an&&Tr.y<=ln&&Tr!==Te&&Tr!==We&&lt(St,Or,ar,Wr,jt,Zr,Tr.x,Tr.y)&&Ye(Tr.prev,Tr,Tr.next)>=0||(Tr=Tr.prevZ,Vr.x>=pn&&Vr.x<=Fn&&Vr.y>=an&&Vr.y<=ln&&Vr!==Te&&Vr!==We&&lt(St,Or,ar,Wr,jt,Zr,Vr.x,Vr.y)&&Ye(Vr.prev,Vr,Vr.next)>=0))return!1;Vr=Vr.nextZ}for(;Tr&&Tr.z>=gn;){if(Tr.x>=pn&&Tr.x<=Fn&&Tr.y>=an&&Tr.y<=ln&&Tr!==Te&&Tr!==We&&lt(St,Or,ar,Wr,jt,Zr,Tr.x,Tr.y)&&Ye(Tr.prev,Tr,Tr.next)>=0)return!1;Tr=Tr.prevZ}for(;Vr&&Vr.z<=nn;){if(Vr.x>=pn&&Vr.x<=Fn&&Vr.y>=an&&Vr.y<=ln&&Vr!==Te&&Vr!==We&&lt(St,Or,ar,Wr,jt,Zr,Vr.x,Vr.y)&&Ye(Vr.prev,Vr,Vr.next)>=0)return!1;Vr=Vr.nextZ}return!0}function U(P,L,b){var de=P;do{var Te=de.prev,we=de.next.next;!Ke(Te,we)&&xt(Te,de,de.next,we)&&ge(Te,we)&&ge(we,Te)&&(L.push(Te.i/b|0),L.push(de.i/b|0),L.push(we.i/b|0),_t(de),_t(de.next),de=P=we),de=de.next}while(de!==P);return oe(de)}function re(P,L,b,de,Te,we){var We=P;do{for(var St=We.next.next;St!==We.prev;){if(We.i!==St.i&&Je(We,St)){var ar=Be(We,St);We=oe(We,We.next),ar=oe(ar,ar.next),E(We,L,b,de,Te,we,0),E(ar,L,b,de,Te,we,0);return}St=St.next}We=We.next}while(We!==P)}function Y(P,L,b,de){var Te=[],we,We,St,ar,jt;for(we=0,We=L.length;we<We;we++)St=L[we]*de,ar=we<We-1?L[we+1]*de:P.length,jt=D(P,St,ar,de,!1),jt===jt.next&&(jt.steiner=!0),Te.push(Ge(jt));for(Te.sort(se),we=0;we<Te.length;we++)b=le(Te[we],b);return b}function se(P,L){return P.x-L.x}function le(P,L){var b=ye(P,L);if(!b)return L;var de=Be(b,P);return oe(de,de.next),oe(b,b.next)}function ye(P,L){var b=L,de=P.x,Te=P.y,we=-Infinity,We;do{if(Te<=b.y&&Te>=b.next.y&&b.next.y!==b.y){var St=b.x+(Te-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(St<=de&&St>we&&(we=St,We=b.x<b.next.x?b:b.next,St===de))return We}b=b.next}while(b!==L);if(!We)return null;var ar=We,jt=We.x,Or=We.y,Wr=Infinity,Zr;b=We;do de>=b.x&&b.x>=jt&&de!==b.x&&lt(Te<Or?de:we,Te,jt,Or,Te<Or?we:de,Te,b.x,b.y)&&(Zr=Math.abs(Te-b.y)/(de-b.x),ge(b,P)&&(Zr<Wr||Zr===Wr&&(b.x>We.x||b.x===We.x&&Ce(We,b)))&&(We=b,Wr=Zr)),b=b.next;while(b!==ar);return We}function Ce(P,L){return Ye(P.prev,P,L.prev)<0&&Ye(L.next,P,P.next)<0}function Oe(P,L,b,de){var Te=P;do Te.z===0&&(Te.z=pt(Te.x,Te.y,L,b,de)),Te.prevZ=Te.prev,Te.nextZ=Te.next,Te=Te.next;while(Te!==P);Te.prevZ.nextZ=null,Te.prevZ=null,Ue(Te)}function Ue(P){var L,b,de,Te,we,We,St,ar,jt=1;do{for(b=P,P=null,we=null,We=0;b;){for(We++,de=b,St=0,L=0;L<jt&&(St++,de=de.nextZ,!!de);L++);for(ar=jt;St>0||ar>0&&de;)St!==0&&(ar===0||!de||b.z<=de.z)?(Te=b,b=b.nextZ,St--):(Te=de,de=de.nextZ,ar--),we?we.nextZ=Te:P=Te,Te.prevZ=we,we=Te;b=de}we.nextZ=null,jt*=2}while(We>1);return P}function pt(P,L,b,de,Te){return P=(P-b)*Te|0,L=(L-de)*Te|0,P=(P|P<<8)&16711935,P=(P|P<<4)&252645135,P=(P|P<<2)&858993459,P=(P|P<<1)&1431655765,L=(L|L<<8)&16711935,L=(L|L<<4)&252645135,L=(L|L<<2)&858993459,L=(L|L<<1)&1431655765,P|L<<1}function Ge(P){var L=P,b=P;do(L.x<b.x||L.x===b.x&&L.y<b.y)&&(b=L),L=L.next;while(L!==P);return b}function lt(P,L,b,de,Te,we,We,St){return(Te-We)*(L-St)>=(P-We)*(we-St)&&(P-We)*(de-St)>=(b-We)*(L-St)&&(b-We)*(we-St)>=(Te-We)*(de-St)}function Je(P,L){return P.next.i!==L.i&&P.prev.i!==L.i&&!Fe(P,L)&&(ge(P,L)&&ge(L,P)&&je(P,L)&&(Ye(P.prev,P,L.prev)||Ye(P,L.prev,L))||Ke(P,L)&&Ye(P.prev,P,P.next)>0&&Ye(L.prev,L,L.next)>0)}function Ye(P,L,b){return(L.y-P.y)*(b.x-L.x)-(L.x-P.x)*(b.y-L.y)}function Ke(P,L){return P.x===L.x&&P.y===L.y}function xt(P,L,b,de){var Te=ht(Ye(P,L,b)),we=ht(Ye(P,L,de)),We=ht(Ye(b,de,P)),St=ht(Ye(b,de,L));return!!(Te!==we&&We!==St||Te===0&&I(P,b,L)||we===0&&I(P,de,L)||We===0&&I(b,P,de)||St===0&&I(b,L,de))}function I(P,L,b){return L.x<=Math.max(P.x,b.x)&&L.x>=Math.min(P.x,b.x)&&L.y<=Math.max(P.y,b.y)&&L.y>=Math.min(P.y,b.y)}function ht(P){return P>0?1:P<0?-1:0}function Fe(P,L){var b=P;do{if(b.i!==P.i&&b.next.i!==P.i&&b.i!==L.i&&b.next.i!==L.i&&xt(b,b.next,P,L))return!0;b=b.next}while(b!==P);return!1}function ge(P,L){return Ye(P.prev,P,P.next)<0?Ye(P,L,P.next)>=0&&Ye(P,P.prev,L)>=0:Ye(P,L,P.prev)<0||Ye(P,P.next,L)<0}function je(P,L){var b=P,de=!1,Te=(P.x+L.x)/2,we=(P.y+L.y)/2;do b.y>we!=b.next.y>we&&b.next.y!==b.y&&Te<(b.next.x-b.x)*(we-b.y)/(b.next.y-b.y)+b.x&&(de=!de),b=b.next;while(b!==P);return de}function Be(P,L){var b=new k(P.i,P.x,P.y),de=new k(L.i,L.x,L.y),Te=P.next,we=L.prev;return P.next=L,L.prev=P,b.next=Te,Te.prev=b,de.next=b,b.prev=de,we.next=de,de.prev=we,de}function tt(P,L,b,de){var Te=new k(P,L,b);return de?(Te.next=de.next,Te.prev=de,de.next.prev=Te,de.next=Te):(Te.prev=Te,Te.next=Te),Te}function _t(P){P.next.prev=P.prev,P.prev.next=P.next,P.prevZ&&(P.prevZ.nextZ=P.nextZ),P.nextZ&&(P.nextZ.prevZ=P.prevZ)}function k(P,L,b){this.i=P,this.x=L,this.y=b,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}G.deviation=function(P,L,b,de){var Te=L&&L.length,we=Te?L[0]*b:P.length,We=Math.abs(ne(P,0,we,b));if(Te)for(var St=0,ar=L.length;St<ar;St++){var jt=L[St]*b,Or=St<ar-1?L[St+1]*b:P.length;We-=Math.abs(ne(P,jt,Or,b))}var Wr=0;for(St=0;St<de.length;St+=3){var Zr=de[St]*b,pn=de[St+1]*b,an=de[St+2]*b;Wr+=Math.abs((P[Zr]-P[an])*(P[pn+1]-P[Zr+1])-(P[Zr]-P[pn])*(P[an+1]-P[Zr+1]))}return We===0&&Wr===0?0:Math.abs((Wr-We)/We)};function ne(P,L,b,de){for(var Te=0,we=L,We=b-de;we<b;we+=de)Te+=(P[We]-P[we])*(P[we+1]+P[We+1]),We=we;return Te}G.flatten=function(P){for(var L=P[0][0].length,b={vertices:[],holes:[],dimensions:L},de=0,Te=0;Te<P.length;Te++){for(var we=0;we<P[Te].length;we++)for(var We=0;We<L;We++)b.vertices.push(P[Te][we][We]);Te>0&&(de+=P[Te-1].length,b.holes.push(de))}return b}},67709:function(rr){function G(oe){var E=oe.target||oe.srcElement;E.__resizeRAF__&&cancelAnimationFrame(E.__resizeRAF__),E.__resizeRAF__=requestAnimationFrame(function(){var ce=E.__resizeTrigger__,J=ce&&ce.__resizeListeners__;J&&J.forEach(function(U){U.call(ce,oe)})})}var D=function(E,ce){var J=this,U=J.document,re,Y=U.attachEvent;typeof navigator!="undefined"&&(re=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function se(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",G)}if(!E.__resizeListeners__)if(E.__resizeListeners__=[],Y)E.__resizeTrigger__=E,E.attachEvent("onresize",G);else{getComputedStyle(E).position==="static"&&(E.style.position="relative");var le=E.__resizeTrigger__=U.createElement("object");le.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),le.setAttribute("class","resize-sensor"),le.setAttribute("tabindex","-1"),le.setAttribute("title",""),le.__resizeElement__=E,le.onload=se,le.type="text/html",re&&E.appendChild(le),le.data="about:blank",re||E.appendChild(le)}E.__resizeListeners__.push(ce)};rr.exports=typeof window=="undefined"?D:D.bind(window),rr.exports.unbind=function(oe,E){var ce=document.attachEvent,J=oe.__resizeListeners__||[];if(E){var U=J.indexOf(E);U!==-1&&J.splice(U,1)}else J=oe.__resizeListeners__=[];if(!J.length){if(ce)oe.detachEvent("onresize",G);else if(oe.__resizeTrigger__){var re=oe.__resizeTrigger__.contentDocument,Y=re&&re.defaultView;Y&&(Y.removeEventListener("resize",G),delete Y.__resizeTrigger__),oe.__resizeTrigger__=!oe.removeChild(oe.__resizeTrigger__)}delete oe.__resizeListeners__}}},26729:function(rr){"use strict";var G=Object.prototype.hasOwnProperty,D="~";function oe(){}Object.create&&(oe.prototype=Object.create(null),new oe().__proto__||(D=!1));function E(re,Y,se){this.fn=re,this.context=Y,this.once=se||!1}function ce(re,Y,se,le,ye){if(typeof se!="function")throw new TypeError("The listener must be a function");var Ce=new E(se,le||re,ye),Oe=D?D+Y:Y;return re._events[Oe]?re._events[Oe].fn?re._events[Oe]=[re._events[Oe],Ce]:re._events[Oe].push(Ce):(re._events[Oe]=Ce,re._eventsCount++),re}function J(re,Y){--re._eventsCount==0?re._events=new oe:delete re._events[Y]}function U(){this._events=new oe,this._eventsCount=0}U.prototype.eventNames=function(){var Y=[],se,le;if(this._eventsCount===0)return Y;for(le in se=this._events)G.call(se,le)&&Y.push(D?le.slice(1):le);return Object.getOwnPropertySymbols?Y.concat(Object.getOwnPropertySymbols(se)):Y},U.prototype.listeners=function(Y){var se=D?D+Y:Y,le=this._events[se];if(!le)return[];if(le.fn)return[le.fn];for(var ye=0,Ce=le.length,Oe=new Array(Ce);ye<Ce;ye++)Oe[ye]=le[ye].fn;return Oe},U.prototype.listenerCount=function(Y){var se=D?D+Y:Y,le=this._events[se];return le?le.fn?1:le.length:0},U.prototype.emit=function(Y,se,le,ye,Ce,Oe){var Ue=D?D+Y:Y;if(!this._events[Ue])return!1;var pt=this._events[Ue],Ge=arguments.length,lt,Je;if(pt.fn){switch(pt.once&&this.removeListener(Y,pt.fn,void 0,!0),Ge){case 1:return pt.fn.call(pt.context),!0;case 2:return pt.fn.call(pt.context,se),!0;case 3:return pt.fn.call(pt.context,se,le),!0;case 4:return pt.fn.call(pt.context,se,le,ye),!0;case 5:return pt.fn.call(pt.context,se,le,ye,Ce),!0;case 6:return pt.fn.call(pt.context,se,le,ye,Ce,Oe),!0}for(Je=1,lt=new Array(Ge-1);Je<Ge;Je++)lt[Je-1]=arguments[Je];pt.fn.apply(pt.context,lt)}else{var Ye=pt.length,Ke;for(Je=0;Je<Ye;Je++)switch(pt[Je].once&&this.removeListener(Y,pt[Je].fn,void 0,!0),Ge){case 1:pt[Je].fn.call(pt[Je].context);break;case 2:pt[Je].fn.call(pt[Je].context,se);break;case 3:pt[Je].fn.call(pt[Je].context,se,le);break;case 4:pt[Je].fn.call(pt[Je].context,se,le,ye);break;default:if(!lt)for(Ke=1,lt=new Array(Ge-1);Ke<Ge;Ke++)lt[Ke-1]=arguments[Ke];pt[Je].fn.apply(pt[Je].context,lt)}}return!0},U.prototype.on=function(Y,se,le){return ce(this,Y,se,le,!1)},U.prototype.once=function(Y,se,le){return ce(this,Y,se,le,!0)},U.prototype.removeListener=function(Y,se,le,ye){var Ce=D?D+Y:Y;if(!this._events[Ce])return this;if(!se)return J(this,Ce),this;var Oe=this._events[Ce];if(Oe.fn)Oe.fn===se&&(!ye||Oe.once)&&(!le||Oe.context===le)&&J(this,Ce);else{for(var Ue=0,pt=[],Ge=Oe.length;Ue<Ge;Ue++)(Oe[Ue].fn!==se||ye&&!Oe[Ue].once||le&&Oe[Ue].context!==le)&&pt.push(Oe[Ue]);pt.length?this._events[Ce]=pt.length===1?pt[0]:pt:J(this,Ce)}return this},U.prototype.removeAllListeners=function(Y){var se;return Y?(se=D?D+Y:Y,this._events[se]&&J(this,se)):(this._events=new oe,this._eventsCount=0),this},U.prototype.off=U.prototype.removeListener,U.prototype.addListener=U.prototype.on,U.prefixed=D,U.EventEmitter=U,rr.exports=U},7375:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0});var D=Symbol.for("INJECTION");function oe(re,Y,se,le){function ye(){return le&&!Reflect.hasMetadata(D,this,Y)&&Reflect.defineMetadata(D,se(),this,Y),Reflect.hasMetadata(D,this,Y)?Reflect.getMetadata(D,this,Y):se()}function Ce(Oe){Reflect.defineMetadata(D,Oe,this,Y)}Object.defineProperty(re,Y,{configurable:!0,enumerable:!0,get:ye,set:Ce})}function E(re,Y){return function(se){return function(le,ye){var Ce=function(){return re.get(se)};oe(le,ye,Ce,Y)}}}G.makePropertyInjectDecorator=E;function ce(re,Y){return function(se,le){return function(ye,Ce){var Oe=function(){return re.getNamed(se,le)};oe(ye,Ce,Oe,Y)}}}G.makePropertyInjectNamedDecorator=ce;function J(re,Y){return function(se,le,ye){return function(Ce,Oe){var Ue=function(){return re.getTagged(se,le,ye)};oe(Ce,Oe,Ue,Y)}}}G.makePropertyInjectTaggedDecorator=J;function U(re,Y){return function(se){return function(le,ye){var Ce=function(){return re.getAll(se)};oe(le,ye,Ce,Y)}}}G.makePropertyMultiInjectDecorator=U},84879:function(rr,G,D){"use strict";var oe;oe={value:!0};var E=D(7375);function ce(J,U){U===void 0&&(U=!0);var re=E.makePropertyInjectDecorator(J,U),Y=E.makePropertyInjectNamedDecorator(J,U),se=E.makePropertyInjectTaggedDecorator(J,U),le=E.makePropertyMultiInjectDecorator(J,U);return{lazyInject:re,lazyInjectNamed:Y,lazyInjectTagged:se,lazyMultiInject:le}}G.Z=ce},99934:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.tagProperty=G.tagParameter=G.decorate=void 0;var oe=D(16674),E=D(6867);function ce(le,ye,Ce,Oe){var Ue=E.TAGGED;U(Ue,le,ye,Oe,Ce)}G.tagParameter=ce;function J(le,ye,Ce){var Oe=E.TAGGED_PROP;U(Oe,le.constructor,ye,Ce)}G.tagProperty=J;function U(le,ye,Ce,Oe,Ue){var pt={},Ge=typeof Ue=="number",lt=Ue!==void 0&&Ge?Ue.toString():Ce;if(Ge&&Ce!==void 0)throw new Error(oe.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(le,ye)&&(pt=Reflect.getMetadata(le,ye));var Je=pt[lt];if(!Array.isArray(Je))Je=[];else for(var Ye=0,Ke=Je;Ye<Ke.length;Ye++){var xt=Ke[Ye];if(xt.key===Oe.key)throw new Error(oe.DUPLICATED_METADATA+" "+xt.key.toString())}Je.push(Oe),pt[lt]=Je,Reflect.defineMetadata(le,pt,ye)}function re(le,ye){Reflect.decorate(le,ye)}function Y(le,ye){return function(Ce,Oe){ye(Ce,Oe,le)}}function se(le,ye,Ce){typeof Ce=="number"?re([Y(Ce,le)],ye):typeof Ce=="string"?Reflect.decorate([le],ye,Ce):re([le],ye)}G.decorate=se},5744:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.inject=G.LazyServiceIdentifer=void 0;var oe=D(16674),E=D(6867),ce=D(47738),J=D(99934),U=function(){function Y(se){this._cb=se}return Y.prototype.unwrap=function(){return this._cb()},Y}();G.LazyServiceIdentifer=U;function re(Y){return function(se,le,ye){if(Y===void 0)throw new Error(oe.UNDEFINED_INJECT_ANNOTATION(se.name));var Ce=new ce.Metadata(E.INJECT_TAG,Y);typeof ye=="number"?J.tagParameter(se,le,ye,Ce):J.tagProperty(se,le,Ce)}}G.inject=re},64315:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.injectable=void 0;var oe=D(16674),E=D(6867);function ce(){return function(J){if(Reflect.hasOwnMetadata(E.PARAM_TYPES,J))throw new Error(oe.DUPLICATED_INJECTABLE_DECORATOR);var U=Reflect.getMetadata(E.DESIGN_PARAM_TYPES,J)||[];return Reflect.defineMetadata(E.PARAM_TYPES,U,J),J}}G.injectable=ce},71693:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.multiInject=void 0;var oe=D(6867),E=D(47738),ce=D(99934);function J(U){return function(re,Y,se){var le=new E.Metadata(oe.MULTI_INJECT_TAG,U);typeof se=="number"?ce.tagParameter(re,Y,se,le):ce.tagProperty(re,Y,le)}}G.multiInject=J},38085:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.named=void 0;var oe=D(6867),E=D(47738),ce=D(99934);function J(U){return function(re,Y,se){var le=new E.Metadata(oe.NAMED_TAG,U);typeof se=="number"?ce.tagParameter(re,Y,se,le):ce.tagProperty(re,Y,le)}}G.named=J},6515:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.optional=void 0;var oe=D(6867),E=D(47738),ce=D(99934);function J(){return function(U,re,Y){var se=new E.Metadata(oe.OPTIONAL_TAG,!0);typeof Y=="number"?ce.tagParameter(U,re,Y,se):ce.tagProperty(U,re,se)}}G.optional=J},7014:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.postConstruct=void 0;var oe=D(16674),E=D(6867),ce=D(47738);function J(){return function(U,re,Y){var se=new ce.Metadata(E.POST_CONSTRUCT,re);if(Reflect.hasOwnMetadata(E.POST_CONSTRUCT,U.constructor))throw new Error(oe.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(E.POST_CONSTRUCT,se,U.constructor)}}G.postConstruct=J},32052:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.tagged=void 0;var oe=D(47738),E=D(99934);function ce(J,U){return function(re,Y,se){var le=new oe.Metadata(J,U);typeof se=="number"?E.tagParameter(re,Y,se,le):E.tagProperty(re,Y,le)}}G.tagged=ce},55638:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.targetName=void 0;var oe=D(6867),E=D(47738),ce=D(99934);function J(U){return function(re,Y,se){var le=new E.Metadata(oe.NAME_TAG,U);ce.tagParameter(re,Y,se,le)}}G.targetName=J},86757:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.unmanaged=void 0;var oe=D(6867),E=D(47738),ce=D(99934);function J(){return function(U,re,Y){var se=new E.Metadata(oe.UNMANAGED_TAG,!0);ce.tagParameter(U,re,Y,se)}}G.unmanaged=J},44290:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.Binding=void 0;var oe=D(28421),E=D(37791),ce=function(){function J(U,re){this.id=E.id(),this.activated=!1,this.serviceIdentifier=U,this.scope=re,this.type=oe.BindingTypeEnum.Invalid,this.constraint=function(Y){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return J.prototype.clone=function(){var U=new J(this.serviceIdentifier,this.scope);return U.activated=U.scope===oe.BindingScopeEnum.Singleton?this.activated:!1,U.implementationType=this.implementationType,U.dynamicValue=this.dynamicValue,U.scope=this.scope,U.type=this.type,U.factory=this.factory,U.provider=this.provider,U.constraint=this.constraint,U.onActivation=this.onActivation,U.cache=this.cache,U},J}();G.Binding=ce},23184:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.BindingCount=void 0;var D={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};G.BindingCount=D},16674:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.STACK_OVERFLOW=G.CIRCULAR_DEPENDENCY_IN_FACTORY=G.POST_CONSTRUCT_ERROR=G.MULTIPLE_POST_CONSTRUCT_METHODS=G.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=G.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=G.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=G.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=G.ARGUMENTS_LENGTH_MISMATCH=G.INVALID_DECORATOR_OPERATION=G.INVALID_TO_SELF_VALUE=G.INVALID_FUNCTION_BINDING=G.INVALID_MIDDLEWARE_RETURN=G.NO_MORE_SNAPSHOTS_AVAILABLE=G.INVALID_BINDING_TYPE=G.NOT_IMPLEMENTED=G.CIRCULAR_DEPENDENCY=G.UNDEFINED_INJECT_ANNOTATION=G.MISSING_INJECT_ANNOTATION=G.MISSING_INJECTABLE_ANNOTATION=G.NOT_REGISTERED=G.CANNOT_UNBIND=G.AMBIGUOUS_MATCH=G.KEY_NOT_FOUND=G.NULL_ARGUMENT=G.DUPLICATED_METADATA=G.DUPLICATED_INJECTABLE_DECORATOR=void 0,G.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",G.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",G.NULL_ARGUMENT="NULL argument",G.KEY_NOT_FOUND="Key Not Found",G.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",G.CANNOT_UNBIND="Could not unbind serviceIdentifier:",G.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",G.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",G.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var D=function(J){return"@inject called with undefined this could mean that the class "+J+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};G.UNDEFINED_INJECT_ANNOTATION=D,G.CIRCULAR_DEPENDENCY="Circular dependency found:",G.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",G.INVALID_BINDING_TYPE="Invalid binding type:",G.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",G.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",G.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",G.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",G.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var oe=function(){for(var J=[],U=0;U<arguments.length;U++)J[U]=arguments[U];return"The number of constructor arguments in the derived class "+(J[0]+" must be >= than the number of constructor arguments of its base class.")};G.ARGUMENTS_LENGTH_MISMATCH=oe,G.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",G.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",G.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",G.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",G.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var E=function(){for(var J=[],U=0;U<arguments.length;U++)J[U]=arguments[U];return"@postConstruct error in class "+J[0]+": "+J[1]};G.POST_CONSTRUCT_ERROR=E;var ce=function(){for(var J=[],U=0;U<arguments.length;U++)J[U]=arguments[U];return"It looks like there is a circular dependency "+("in one of the '"+J[0]+"' bindings. Please investigate bindings with")+("service identifier '"+J[1]+"'.")};G.CIRCULAR_DEPENDENCY_IN_FACTORY=ce,G.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.TargetTypeEnum=G.BindingTypeEnum=G.BindingScopeEnum=void 0;var D={Request:"Request",Singleton:"Singleton",Transient:"Transient"};G.BindingScopeEnum=D;var oe={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};G.BindingTypeEnum=oe;var E={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};G.TargetTypeEnum=E},6867:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.NON_CUSTOM_TAG_KEYS=G.POST_CONSTRUCT=G.DESIGN_PARAM_TYPES=G.PARAM_TYPES=G.TAGGED_PROP=G.TAGGED=G.MULTI_INJECT_TAG=G.INJECT_TAG=G.OPTIONAL_TAG=G.UNMANAGED_TAG=G.NAME_TAG=G.NAMED_TAG=void 0,G.NAMED_TAG="named",G.NAME_TAG="name",G.UNMANAGED_TAG="unmanaged",G.OPTIONAL_TAG="optional",G.INJECT_TAG="inject",G.MULTI_INJECT_TAG="multi_inject",G.TAGGED="inversify:tagged",G.TAGGED_PROP="inversify:tagged_props",G.PARAM_TYPES="inversify:paramtypes",G.DESIGN_PARAM_TYPES="design:paramtypes",G.POST_CONSTRUCT="post_construct";function D(){return[G.INJECT_TAG,G.MULTI_INJECT_TAG,G.NAME_TAG,G.UNMANAGED_TAG,G.NAMED_TAG,G.OPTIONAL_TAG]}G.NON_CUSTOM_TAG_KEYS=D()},51389:function(rr,G,D){"use strict";var oe=this&&this.__awaiter||function(Je,Ye,Ke,xt){function I(ht){return ht instanceof Ke?ht:new Ke(function(Fe){Fe(ht)})}return new(Ke||(Ke=Promise))(function(ht,Fe){function ge(tt){try{Be(xt.next(tt))}catch(_t){Fe(_t)}}function je(tt){try{Be(xt.throw(tt))}catch(_t){Fe(_t)}}function Be(tt){tt.done?ht(tt.value):I(tt.value).then(ge,je)}Be((xt=xt.apply(Je,Ye||[])).next())})},E=this&&this.__generator||function(Je,Ye){var Ke={label:0,sent:function(){if(ht[0]&1)throw ht[1];return ht[1]},trys:[],ops:[]},xt,I,ht,Fe;return Fe={next:ge(0),throw:ge(1),return:ge(2)},typeof Symbol=="function"&&(Fe[Symbol.iterator]=function(){return this}),Fe;function ge(Be){return function(tt){return je([Be,tt])}}function je(Be){if(xt)throw new TypeError("Generator is already executing.");for(;Ke;)try{if(xt=1,I&&(ht=Be[0]&2?I.return:Be[0]?I.throw||((ht=I.return)&&ht.call(I),0):I.next)&&!(ht=ht.call(I,Be[1])).done)return ht;switch(I=0,ht&&(Be=[Be[0]&2,ht.value]),Be[0]){case 0:case 1:ht=Be;break;case 4:return Ke.label++,{value:Be[1],done:!1};case 5:Ke.label++,I=Be[1],Be=[0];continue;case 7:Be=Ke.ops.pop(),Ke.trys.pop();continue;default:if(ht=Ke.trys,!(ht=ht.length>0&&ht[ht.length-1])&&(Be[0]===6||Be[0]===2)){Ke=0;continue}if(Be[0]===3&&(!ht||Be[1]>ht[0]&&Be[1]<ht[3])){Ke.label=Be[1];break}if(Be[0]===6&&Ke.label<ht[1]){Ke.label=ht[1],ht=Be;break}if(ht&&Ke.label<ht[2]){Ke.label=ht[2],Ke.ops.push(Be);break}ht[2]&&Ke.ops.pop(),Ke.trys.pop();continue}Be=Ye.call(Je,Ke)}catch(tt){Be=[6,tt],I=0}finally{xt=ht=0}if(Be[0]&5)throw Be[1];return{value:Be[0]?Be[1]:void 0,done:!0}}},ce=this&&this.__spreadArray||function(Je,Ye){for(var Ke=0,xt=Ye.length,I=Je.length;Ke<xt;Ke++,I++)Je[I]=Ye[Ke];return Je};Object.defineProperty(G,"__esModule",{value:!0}),G.Container=void 0;var J=D(44290),U=D(16674),re=D(28421),Y=D(6867),se=D(51377),le=D(86311),ye=D(31927),Ce=D(51860),Oe=D(37791),Ue=D(55800),pt=D(85700),Ge=D(80175),lt=function(){function Je(Ye){this._appliedMiddleware=[];var Ke=Ye||{};if(typeof Ke!="object")throw new Error(""+U.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Ke.defaultScope===void 0)Ke.defaultScope=re.BindingScopeEnum.Transient;else if(Ke.defaultScope!==re.BindingScopeEnum.Singleton&&Ke.defaultScope!==re.BindingScopeEnum.Transient&&Ke.defaultScope!==re.BindingScopeEnum.Request)throw new Error(""+U.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Ke.autoBindInjectable===void 0)Ke.autoBindInjectable=!1;else if(typeof Ke.autoBindInjectable!="boolean")throw new Error(""+U.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Ke.skipBaseClassChecks===void 0)Ke.skipBaseClassChecks=!1;else if(typeof Ke.skipBaseClassChecks!="boolean")throw new Error(""+U.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Ke.autoBindInjectable,defaultScope:Ke.defaultScope,skipBaseClassChecks:Ke.skipBaseClassChecks},this.id=Oe.id(),this._bindingDictionary=new Ge.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new se.MetadataReader}return Je.merge=function(Ye,Ke){for(var xt=[],I=2;I<arguments.length;I++)xt[I-2]=arguments[I];var ht=new Je,Fe=ce([Ye,Ke],xt).map(function(Be){return le.getBindingDictionary(Be)}),ge=le.getBindingDictionary(ht);function je(Be,tt){Be.traverse(function(_t,k){k.forEach(function(ne){tt.add(ne.serviceIdentifier,ne.clone())})})}return Fe.forEach(function(Be){je(Be,ge)}),ht},Je.prototype.load=function(){for(var Ye=[],Ke=0;Ke<arguments.length;Ke++)Ye[Ke]=arguments[Ke];for(var xt=this._getContainerModuleHelpersFactory(),I=0,ht=Ye;I<ht.length;I++){var Fe=ht[I],ge=xt(Fe.id);Fe.registry(ge.bindFunction,ge.unbindFunction,ge.isboundFunction,ge.rebindFunction)}},Je.prototype.loadAsync=function(){for(var Ye=[],Ke=0;Ke<arguments.length;Ke++)Ye[Ke]=arguments[Ke];return oe(this,void 0,void 0,function(){var xt,I,ht,Fe,ge;return E(this,function(je){switch(je.label){case 0:xt=this._getContainerModuleHelpersFactory(),I=0,ht=Ye,je.label=1;case 1:return I<ht.length?(Fe=ht[I],ge=xt(Fe.id),[4,Fe.registry(ge.bindFunction,ge.unbindFunction,ge.isboundFunction,ge.rebindFunction)]):[3,4];case 2:je.sent(),je.label=3;case 3:return I++,[3,1];case 4:return[2]}})})},Je.prototype.unload=function(){for(var Ye=this,Ke=[],xt=0;xt<arguments.length;xt++)Ke[xt]=arguments[xt];var I=function(ht){return function(Fe){return Fe.moduleId===ht}};Ke.forEach(function(ht){var Fe=I(ht.id);Ye._bindingDictionary.removeByCondition(Fe)})},Je.prototype.bind=function(Ye){var Ke=this.options.defaultScope||re.BindingScopeEnum.Transient,xt=new J.Binding(Ye,Ke);return this._bindingDictionary.add(Ye,xt),new Ce.BindingToSyntax(xt)},Je.prototype.rebind=function(Ye){return this.unbind(Ye),this.bind(Ye)},Je.prototype.unbind=function(Ye){try{this._bindingDictionary.remove(Ye)}catch(Ke){throw new Error(U.CANNOT_UNBIND+" "+Ue.getServiceIdentifierAsString(Ye))}},Je.prototype.unbindAll=function(){this._bindingDictionary=new Ge.Lookup},Je.prototype.isBound=function(Ye){var Ke=this._bindingDictionary.hasKey(Ye);return!Ke&&this.parent&&(Ke=this.parent.isBound(Ye)),Ke},Je.prototype.isBoundNamed=function(Ye,Ke){return this.isBoundTagged(Ye,Y.NAMED_TAG,Ke)},Je.prototype.isBoundTagged=function(Ye,Ke,xt){var I=!1;if(this._bindingDictionary.hasKey(Ye)){var ht=this._bindingDictionary.get(Ye),Fe=le.createMockRequest(this,Ye,Ke,xt);I=ht.some(function(ge){return ge.constraint(Fe)})}return!I&&this.parent&&(I=this.parent.isBoundTagged(Ye,Ke,xt)),I},Je.prototype.snapshot=function(){this._snapshots.push(pt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},Je.prototype.restore=function(){var Ye=this._snapshots.pop();if(Ye===void 0)throw new Error(U.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Ye.bindings,this._middleware=Ye.middleware},Je.prototype.createChild=function(Ye){var Ke=new Je(Ye||this.options);return Ke.parent=this,Ke},Je.prototype.applyMiddleware=function(){for(var Ye=[],Ke=0;Ke<arguments.length;Ke++)Ye[Ke]=arguments[Ke];this._appliedMiddleware=this._appliedMiddleware.concat(Ye);var xt=this._middleware?this._middleware:this._planAndResolve();this._middleware=Ye.reduce(function(I,ht){return ht(I)},xt)},Je.prototype.applyCustomMetadataReader=function(Ye){this._metadataReader=Ye},Je.prototype.get=function(Ye){return this._get(!1,!1,re.TargetTypeEnum.Variable,Ye)},Je.prototype.getTagged=function(Ye,Ke,xt){return this._get(!1,!1,re.TargetTypeEnum.Variable,Ye,Ke,xt)},Je.prototype.getNamed=function(Ye,Ke){return this.getTagged(Ye,Y.NAMED_TAG,Ke)},Je.prototype.getAll=function(Ye){return this._get(!0,!0,re.TargetTypeEnum.Variable,Ye)},Je.prototype.getAllTagged=function(Ye,Ke,xt){return this._get(!1,!0,re.TargetTypeEnum.Variable,Ye,Ke,xt)},Je.prototype.getAllNamed=function(Ye,Ke){return this.getAllTagged(Ye,Y.NAMED_TAG,Ke)},Je.prototype.resolve=function(Ye){var Ke=this.createChild();return Ke.bind(Ye).toSelf(),this._appliedMiddleware.forEach(function(xt){Ke.applyMiddleware(xt)}),Ke.get(Ye)},Je.prototype._getContainerModuleHelpersFactory=function(){var Ye=this,Ke=function(ge,je){ge._binding.moduleId=je},xt=function(ge){return function(je){var Be=Ye.bind.bind(Ye),tt=Be(je);return Ke(tt,ge),tt}},I=function(ge){return function(je){var Be=Ye.unbind.bind(Ye);Be(je)}},ht=function(ge){return function(je){var Be=Ye.isBound.bind(Ye);return Be(je)}},Fe=function(ge){return function(je){var Be=Ye.rebind.bind(Ye),tt=Be(je);return Ke(tt,ge),tt}};return function(ge){return{bindFunction:xt(ge),isboundFunction:ht(ge),rebindFunction:Fe(ge),unbindFunction:I(ge)}}},Je.prototype._get=function(Ye,Ke,xt,I,ht,Fe){var ge=null,je={avoidConstraints:Ye,contextInterceptor:function(Be){return Be},isMultiInject:Ke,key:ht,serviceIdentifier:I,targetType:xt,value:Fe};if(this._middleware){if(ge=this._middleware(je),ge==null)throw new Error(U.INVALID_MIDDLEWARE_RETURN)}else ge=this._planAndResolve()(je);return ge},Je.prototype._planAndResolve=function(){var Ye=this;return function(Ke){var xt=le.plan(Ye._metadataReader,Ye,Ke.isMultiInject,Ke.targetType,Ke.serviceIdentifier,Ke.key,Ke.value,Ke.avoidConstraints);xt=Ke.contextInterceptor(xt);var I=ye.resolve(xt);return I}},Je}();G.Container=lt},33244:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.AsyncContainerModule=G.ContainerModule=void 0;var oe=D(37791),E=function(){function J(U){this.id=oe.id(),this.registry=U}return J}();G.ContainerModule=E;var ce=function(){function J(U){this.id=oe.id(),this.registry=U}return J}();G.AsyncContainerModule=ce},85700:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.ContainerSnapshot=void 0;var D=function(){function oe(){}return oe.of=function(E,ce){var J=new oe;return J.bindings=E,J.middleware=ce,J},oe}();G.ContainerSnapshot=D},80175:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.Lookup=void 0;var oe=D(16674),E=function(){function ce(){this._map=new Map}return ce.prototype.getMap=function(){return this._map},ce.prototype.add=function(J,U){if(J==null)throw new Error(oe.NULL_ARGUMENT);if(U==null)throw new Error(oe.NULL_ARGUMENT);var re=this._map.get(J);re!==void 0?(re.push(U),this._map.set(J,re)):this._map.set(J,[U])},ce.prototype.get=function(J){if(J==null)throw new Error(oe.NULL_ARGUMENT);var U=this._map.get(J);if(U!==void 0)return U;throw new Error(oe.KEY_NOT_FOUND)},ce.prototype.remove=function(J){if(J==null)throw new Error(oe.NULL_ARGUMENT);if(!this._map.delete(J))throw new Error(oe.KEY_NOT_FOUND)},ce.prototype.removeByCondition=function(J){var U=this;this._map.forEach(function(re,Y){var se=re.filter(function(le){return!J(le)});se.length>0?U._map.set(Y,se):U._map.delete(Y)})},ce.prototype.hasKey=function(J){if(J==null)throw new Error(oe.NULL_ARGUMENT);return this._map.has(J)},ce.prototype.clone=function(){var J=new ce;return this._map.forEach(function(U,re){U.forEach(function(Y){return J.add(re,Y.clone())})}),J},ce.prototype.traverse=function(J){this._map.forEach(function(U,re){J(re,U)})},ce}();G.Lookup=E},86700:function(rr,G,D){"use strict";var oe;oe={value:!0},oe=oe=oe=oe=oe=oe=G.GW=oe=oe=G.zY=oe=oe=oe=oe=oe=G.f3=oe=oe=G.b2=oe=oe=oe=oe=oe=G.W2=oe=void 0;var E=D(6867);oe=E;var ce=D(51389);Object.defineProperty(G,"W2",{enumerable:!0,get:function(){return ce.Container}});var J=D(28421);oe={enumerable:!0,get:function(){return J.BindingScopeEnum}},oe={enumerable:!0,get:function(){return J.BindingTypeEnum}},oe={enumerable:!0,get:function(){return J.TargetTypeEnum}};var U=D(33244);oe={enumerable:!0,get:function(){return U.AsyncContainerModule}},oe={enumerable:!0,get:function(){return U.ContainerModule}};var re=D(64315);Object.defineProperty(G,"b2",{enumerable:!0,get:function(){return re.injectable}});var Y=D(32052);oe={enumerable:!0,get:function(){return Y.tagged}};var se=D(38085);oe={enumerable:!0,get:function(){return se.named}};var le=D(5744);Object.defineProperty(G,"f3",{enumerable:!0,get:function(){return le.inject}}),oe={enumerable:!0,get:function(){return le.LazyServiceIdentifer}};var ye=D(6515);oe={enumerable:!0,get:function(){return ye.optional}};var Ce=D(86757);oe={enumerable:!0,get:function(){return Ce.unmanaged}};var Oe=D(71693);oe={enumerable:!0,get:function(){return Oe.multiInject}};var Ue=D(55638);oe={enumerable:!0,get:function(){return Ue.targetName}};var pt=D(7014);Object.defineProperty(G,"zY",{enumerable:!0,get:function(){return pt.postConstruct}});var Ge=D(51377);oe={enumerable:!0,get:function(){return Ge.MetadataReader}};var lt=D(37791);oe={enumerable:!0,get:function(){return lt.id}};var Je=D(99934);Object.defineProperty(G,"GW",{enumerable:!0,get:function(){return Je.decorate}});var Ye=D(80758);oe={enumerable:!0,get:function(){return Ye.traverseAncerstors}},oe={enumerable:!0,get:function(){return Ye.taggedConstraint}},oe={enumerable:!0,get:function(){return Ye.namedConstraint}},oe={enumerable:!0,get:function(){return Ye.typeConstraint}};var Ke=D(55800);oe={enumerable:!0,get:function(){return Ke.getServiceIdentifierAsString}};var xt=D(70600);oe={enumerable:!0,get:function(){return xt.multiBindToService}}},95228:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.Context=void 0;var oe=D(37791),E=function(){function ce(J){this.id=oe.id(),this.container=J}return ce.prototype.addPlan=function(J){this.plan=J},ce.prototype.setCurrentRequest=function(J){this.currentRequest=J},ce}();G.Context=E},47738:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.Metadata=void 0;var oe=D(6867),E=function(){function ce(J,U){this.key=J,this.value=U}return ce.prototype.toString=function(){return this.key===oe.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},ce}();G.Metadata=E},51377:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.MetadataReader=void 0;var oe=D(6867),E=function(){function ce(){}return ce.prototype.getConstructorMetadata=function(J){var U=Reflect.getMetadata(oe.PARAM_TYPES,J),re=Reflect.getMetadata(oe.TAGGED,J);return{compilerGeneratedMetadata:U,userGeneratedMetadata:re||{}}},ce.prototype.getPropertiesMetadata=function(J){var U=Reflect.getMetadata(oe.TAGGED_PROP,J)||[];return U},ce}();G.MetadataReader=E},55314:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.Plan=void 0;var D=function(){function oe(E,ce){this.parentContext=E,this.rootRequest=ce}return oe}();G.Plan=D},86311:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.getBindingDictionary=G.createMockRequest=G.plan=void 0;var oe=D(23184),E=D(16674),ce=D(28421),J=D(6867),U=D(85265),re=D(55800),Y=D(95228),se=D(47738),le=D(55314),ye=D(6e3),Ce=D(6748),Oe=D(18924);function Ue(I){return I._bindingDictionary}G.getBindingDictionary=Ue;function pt(I,ht,Fe,ge,je,Be){var tt=I?J.MULTI_INJECT_TAG:J.INJECT_TAG,_t=new se.Metadata(tt,Fe),k=new Oe.Target(ht,ge,Fe,_t);if(je!==void 0){var ne=new se.Metadata(je,Be);k.metadata.push(ne)}return k}function Ge(I,ht,Fe,ge,je){var Be=Ye(Fe.container,je.serviceIdentifier),tt=[];return Be.length===oe.BindingCount.NoBindingsAvailable&&Fe.container.options.autoBindInjectable&&typeof je.serviceIdentifier=="function"&&I.getConstructorMetadata(je.serviceIdentifier).compilerGeneratedMetadata&&(Fe.container.bind(je.serviceIdentifier).toSelf(),Be=Ye(Fe.container,je.serviceIdentifier)),ht?tt=Be:tt=Be.filter(function(_t){var k=new Ce.Request(_t.serviceIdentifier,Fe,ge,_t,je);return _t.constraint(k)}),lt(je.serviceIdentifier,tt,je,Fe.container),tt}function lt(I,ht,Fe,ge){switch(ht.length){case oe.BindingCount.NoBindingsAvailable:if(Fe.isOptional())return ht;var je=re.getServiceIdentifierAsString(I),Be=E.NOT_REGISTERED;throw Be+=re.listMetadataForTarget(je,Fe),Be+=re.listRegisteredBindingsForServiceIdentifier(ge,je,Ye),new Error(Be);case oe.BindingCount.OnlyOneBindingAvailable:if(!Fe.isArray())return ht;case oe.BindingCount.MultipleBindingsAvailable:default:if(Fe.isArray())return ht;var je=re.getServiceIdentifierAsString(I),Be=E.AMBIGUOUS_MATCH+" "+je;throw Be+=re.listRegisteredBindingsForServiceIdentifier(ge,je,Ye),new Error(Be)}}function Je(I,ht,Fe,ge,je,Be){var tt,_t;if(je===null){tt=Ge(I,ht,ge,null,Be),_t=new Ce.Request(Fe,ge,null,tt,Be);var k=new le.Plan(ge,_t);ge.addPlan(k)}else tt=Ge(I,ht,ge,je,Be),_t=je.addChildRequest(Be.serviceIdentifier,tt,Be);tt.forEach(function(ne){var P=null;if(Be.isArray())P=_t.addChildRequest(ne.serviceIdentifier,ne,Be);else{if(ne.cache)return;P=_t}if(ne.type===ce.BindingTypeEnum.Instance&&ne.implementationType!==null){var L=ye.getDependencies(I,ne.implementationType);if(!ge.container.options.skipBaseClassChecks){var b=ye.getBaseClassDependencyCount(I,ne.implementationType);if(L.length<b){var de=E.ARGUMENTS_LENGTH_MISMATCH(ye.getFunctionName(ne.implementationType));throw new Error(de)}}L.forEach(function(Te){Je(I,!1,Te.serviceIdentifier,ge,P,Te)})}})}function Ye(I,ht){var Fe=[],ge=Ue(I);return ge.hasKey(ht)?Fe=ge.get(ht):I.parent!==null&&(Fe=Ye(I.parent,ht)),Fe}function Ke(I,ht,Fe,ge,je,Be,tt,_t){_t===void 0&&(_t=!1);var k=new Y.Context(ht),ne=pt(Fe,ge,je,"",Be,tt);try{return Je(I,_t,je,k,null,ne),k}catch(P){throw U.isStackOverflowExeption(P)&&k.plan&&re.circularDependencyToException(k.plan.rootRequest),P}}G.plan=Ke;function xt(I,ht,Fe,ge){var je=new Oe.Target(ce.TargetTypeEnum.Variable,"",ht,new se.Metadata(Fe,ge)),Be=new Y.Context(I),tt=new Ce.Request(ht,Be,null,[],je);return tt}G.createMockRequest=xt},88460:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.QueryableString=void 0;var D=function(){function oe(E){this.str=E}return oe.prototype.startsWith=function(E){return this.str.indexOf(E)===0},oe.prototype.endsWith=function(E){var ce="",J=E.split("").reverse().join("");return ce=this.str.split("").reverse().join(""),this.startsWith.call({str:ce},J)},oe.prototype.contains=function(E){return this.str.indexOf(E)!==-1},oe.prototype.equals=function(E){return this.str===E},oe.prototype.value=function(){return this.str},oe}();G.QueryableString=D},6e3:function(rr,G,D){"use strict";var oe=this&&this.__spreadArray||function(Ge,lt){for(var Je=0,Ye=lt.length,Ke=Ge.length;Je<Ye;Je++,Ke++)Ge[Ke]=lt[Je];return Ge};Object.defineProperty(G,"__esModule",{value:!0}),G.getFunctionName=G.getBaseClassDependencyCount=G.getDependencies=void 0;var E=D(5744),ce=D(16674),J=D(28421),U=D(6867),re=D(55800);Object.defineProperty(G,"getFunctionName",{enumerable:!0,get:function(){return re.getFunctionName}});var Y=D(18924);function se(Ge,lt){var Je=re.getFunctionName(lt),Ye=le(Ge,Je,lt,!1);return Ye}G.getDependencies=se;function le(Ge,lt,Je,Ye){var Ke=Ge.getConstructorMetadata(Je),xt=Ke.compilerGeneratedMetadata;if(xt===void 0){var I=ce.MISSING_INJECTABLE_ANNOTATION+" "+lt+".";throw new Error(I)}var ht=Ke.userGeneratedMetadata,Fe=Object.keys(ht),ge=Je.length===0&&Fe.length>0,je=Fe.length>Je.length,Be=ge||je?Fe.length:Je.length,tt=Ce(Ye,lt,xt,ht,Be),_t=Oe(Ge,Je),k=oe(oe([],tt),_t);return k}function ye(Ge,lt,Je,Ye,Ke){var xt=Ke[Ge.toString()]||[],I=pt(xt),ht=I.unmanaged!==!0,Fe=Ye[Ge],ge=I.inject||I.multiInject;if(Fe=ge||Fe,Fe instanceof E.LazyServiceIdentifer&&(Fe=Fe.unwrap()),ht){var je=Fe===Object,Be=Fe===Function,tt=Fe===void 0,_t=je||Be||tt;if(!lt&&_t){var k=ce.MISSING_INJECT_ANNOTATION+" argument "+Ge+" in class "+Je+".";throw new Error(k)}var ne=new Y.Target(J.TargetTypeEnum.ConstructorArgument,I.targetName,Fe);return ne.metadata=xt,ne}return null}function Ce(Ge,lt,Je,Ye,Ke){for(var xt=[],I=0;I<Ke;I++){var ht=I,Fe=ye(ht,Ge,lt,Je,Ye);Fe!==null&&xt.push(Fe)}return xt}function Oe(Ge,lt){for(var Je=Ge.getPropertiesMetadata(lt),Ye=[],Ke=Object.keys(Je),xt=0,I=Ke;xt<I.length;xt++){var ht=I[xt],Fe=Je[ht],ge=pt(Je[ht]),je=ge.targetName||ht,Be=ge.inject||ge.multiInject,tt=new Y.Target(J.TargetTypeEnum.ClassProperty,je,Be);tt.metadata=Fe,Ye.push(tt)}var _t=Object.getPrototypeOf(lt.prototype).constructor;if(_t!==Object){var k=Oe(Ge,_t);Ye=oe(oe([],Ye),k)}return Ye}function Ue(Ge,lt){var Je=Object.getPrototypeOf(lt.prototype).constructor;if(Je!==Object){var Ye=re.getFunctionName(Je),Ke=le(Ge,Ye,Je,!0),xt=Ke.map(function(Fe){return Fe.metadata.filter(function(ge){return ge.key===U.UNMANAGED_TAG})}),I=[].concat.apply([],xt).length,ht=Ke.length-I;return ht>0?ht:Ue(Ge,Je)}else return 0}G.getBaseClassDependencyCount=Ue;function pt(Ge){var lt={};return Ge.forEach(function(Je){lt[Je.key.toString()]=Je.value}),{inject:lt[U.INJECT_TAG],multiInject:lt[U.MULTI_INJECT_TAG],targetName:lt[U.NAME_TAG],unmanaged:lt[U.UNMANAGED_TAG]}}},6748:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.Request=void 0;var oe=D(37791),E=function(){function ce(J,U,re,Y,se){this.id=oe.id(),this.serviceIdentifier=J,this.parentContext=U,this.parentRequest=re,this.target=se,this.childRequests=[],this.bindings=Array.isArray(Y)?Y:[Y],this.requestScope=re===null?new Map:null}return ce.prototype.addChildRequest=function(J,U,re){var Y=new ce(J,this.parentContext,this,U,re);return this.childRequests.push(Y),Y},ce}();G.Request=E},18924:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.Target=void 0;var oe=D(6867),E=D(37791),ce=D(47738),J=D(88460),U=function(){function re(Y,se,le,ye){this.id=E.id(),this.type=Y,this.serviceIdentifier=le,this.name=new J.QueryableString(se||""),this.metadata=new Array;var Ce=null;typeof ye=="string"?Ce=new ce.Metadata(oe.NAMED_TAG,ye):ye instanceof ce.Metadata&&(Ce=ye),Ce!==null&&this.metadata.push(Ce)}return re.prototype.hasTag=function(Y){for(var se=0,le=this.metadata;se<le.length;se++){var ye=le[se];if(ye.key===Y)return!0}return!1},re.prototype.isArray=function(){return this.hasTag(oe.MULTI_INJECT_TAG)},re.prototype.matchesArray=function(Y){return this.matchesTag(oe.MULTI_INJECT_TAG)(Y)},re.prototype.isNamed=function(){return this.hasTag(oe.NAMED_TAG)},re.prototype.isTagged=function(){return this.metadata.some(function(Y){return oe.NON_CUSTOM_TAG_KEYS.every(function(se){return Y.key!==se})})},re.prototype.isOptional=function(){return this.matchesTag(oe.OPTIONAL_TAG)(!0)},re.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(Y){return Y.key===oe.NAMED_TAG})[0]:null},re.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(Y){return oe.NON_CUSTOM_TAG_KEYS.every(function(se){return Y.key!==se})}):null},re.prototype.matchesNamedTag=function(Y){return this.matchesTag(oe.NAMED_TAG)(Y)},re.prototype.matchesTag=function(Y){var se=this;return function(le){for(var ye=0,Ce=se.metadata;ye<Ce.length;ye++){var Oe=Ce[ye];if(Oe.key===Y&&Oe.value===le)return!0}return!1}},re}();G.Target=U},52279:function(rr,G,D){"use strict";var oe=this&&this.__spreadArray||function(le,ye){for(var Ce=0,Oe=ye.length,Ue=le.length;Ce<Oe;Ce++,Ue++)le[Ue]=ye[Ce];return le};Object.defineProperty(G,"__esModule",{value:!0}),G.resolveInstance=void 0;var E=D(16674),ce=D(28421),J=D(6867);function U(le,ye,Ce){var Oe=ye.filter(function(pt){return pt.target!==null&&pt.target.type===ce.TargetTypeEnum.ClassProperty}),Ue=Oe.map(Ce);return Oe.forEach(function(pt,Ge){var lt="";lt=pt.target.name.value();var Je=Ue[Ge];le[lt]=Je}),le}function re(le,ye){return new(le.bind.apply(le,oe([void 0],ye)))}function Y(le,ye){if(Reflect.hasMetadata(J.POST_CONSTRUCT,le)){var Ce=Reflect.getMetadata(J.POST_CONSTRUCT,le);try{ye[Ce.value]()}catch(Oe){throw new Error(E.POST_CONSTRUCT_ERROR(le.name,Oe.message))}}}function se(le,ye,Ce){var Oe=null;if(ye.length>0){var Ue=ye.filter(function(Ge){return Ge.target!==null&&Ge.target.type===ce.TargetTypeEnum.ConstructorArgument}),pt=Ue.map(Ce);Oe=re(le,pt),Oe=U(Oe,ye,Ce)}else Oe=new le;return Y(le,Oe),Oe}G.resolveInstance=se},31927:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.resolve=void 0;var oe=D(16674),E=D(28421),ce=D(85265),J=D(55800),U=D(52279),re=function(le,ye,Ce){try{return Ce()}catch(Oe){throw ce.isStackOverflowExeption(Oe)?new Error(oe.CIRCULAR_DEPENDENCY_IN_FACTORY(le,ye.toString())):Oe}},Y=function(le){return function(ye){ye.parentContext.setCurrentRequest(ye);var Ce=ye.bindings,Oe=ye.childRequests,Ue=ye.target&&ye.target.isArray(),pt=!ye.parentRequest||!ye.parentRequest.target||!ye.target||!ye.parentRequest.target.matchesArray(ye.target.serviceIdentifier);if(Ue&&pt)return Oe.map(function(xt){var I=Y(le);return I(xt)});var Ge=null;if(ye.target.isOptional()&&Ce.length===0)return;var lt=Ce[0],Je=lt.scope===E.BindingScopeEnum.Singleton,Ye=lt.scope===E.BindingScopeEnum.Request;if(Je&&lt.activated)return lt.cache;if(Ye&&le!==null&&le.has(lt.id))return le.get(lt.id);if(lt.type===E.BindingTypeEnum.ConstantValue)Ge=lt.cache,lt.activated=!0;else if(lt.type===E.BindingTypeEnum.Function)Ge=lt.cache,lt.activated=!0;else if(lt.type===E.BindingTypeEnum.Constructor)Ge=lt.implementationType;else if(lt.type===E.BindingTypeEnum.DynamicValue&&lt.dynamicValue!==null)Ge=re("toDynamicValue",lt.serviceIdentifier,function(){return lt.dynamicValue(ye.parentContext)});else if(lt.type===E.BindingTypeEnum.Factory&&lt.factory!==null)Ge=re("toFactory",lt.serviceIdentifier,function(){return lt.factory(ye.parentContext)});else if(lt.type===E.BindingTypeEnum.Provider&&lt.provider!==null)Ge=re("toProvider",lt.serviceIdentifier,function(){return lt.provider(ye.parentContext)});else if(lt.type===E.BindingTypeEnum.Instance&&lt.implementationType!==null)Ge=U.resolveInstance(lt.implementationType,Oe,Y(le));else{var Ke=J.getServiceIdentifierAsString(ye.serviceIdentifier);throw new Error(oe.INVALID_BINDING_TYPE+" "+Ke)}return typeof lt.onActivation=="function"&&(Ge=lt.onActivation(ye.parentContext,Ge)),Je&&(lt.cache=Ge,lt.activated=!0),Ye&&le!==null&&!le.has(lt.id)&&le.set(lt.id,Ge),Ge}};function se(le){var ye=Y(le.plan.rootRequest.requestScope);return ye(le.plan.rootRequest)}G.resolve=se},83366:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.BindingInSyntax=void 0;var oe=D(28421),E=D(71325),ce=function(){function J(U){this._binding=U}return J.prototype.inRequestScope=function(){return this._binding.scope=oe.BindingScopeEnum.Request,new E.BindingWhenOnSyntax(this._binding)},J.prototype.inSingletonScope=function(){return this._binding.scope=oe.BindingScopeEnum.Singleton,new E.BindingWhenOnSyntax(this._binding)},J.prototype.inTransientScope=function(){return this._binding.scope=oe.BindingScopeEnum.Transient,new E.BindingWhenOnSyntax(this._binding)},J}();G.BindingInSyntax=ce},99812:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.BindingInWhenOnSyntax=void 0;var oe=D(83366),E=D(51811),ce=D(98370),J=function(){function U(re){this._binding=re,this._bindingWhenSyntax=new ce.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new E.BindingOnSyntax(this._binding),this._bindingInSyntax=new oe.BindingInSyntax(re)}return U.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},U.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},U.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},U.prototype.when=function(re){return this._bindingWhenSyntax.when(re)},U.prototype.whenTargetNamed=function(re){return this._bindingWhenSyntax.whenTargetNamed(re)},U.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},U.prototype.whenTargetTagged=function(re,Y){return this._bindingWhenSyntax.whenTargetTagged(re,Y)},U.prototype.whenInjectedInto=function(re){return this._bindingWhenSyntax.whenInjectedInto(re)},U.prototype.whenParentNamed=function(re){return this._bindingWhenSyntax.whenParentNamed(re)},U.prototype.whenParentTagged=function(re,Y){return this._bindingWhenSyntax.whenParentTagged(re,Y)},U.prototype.whenAnyAncestorIs=function(re){return this._bindingWhenSyntax.whenAnyAncestorIs(re)},U.prototype.whenNoAncestorIs=function(re){return this._bindingWhenSyntax.whenNoAncestorIs(re)},U.prototype.whenAnyAncestorNamed=function(re){return this._bindingWhenSyntax.whenAnyAncestorNamed(re)},U.prototype.whenAnyAncestorTagged=function(re,Y){return this._bindingWhenSyntax.whenAnyAncestorTagged(re,Y)},U.prototype.whenNoAncestorNamed=function(re){return this._bindingWhenSyntax.whenNoAncestorNamed(re)},U.prototype.whenNoAncestorTagged=function(re,Y){return this._bindingWhenSyntax.whenNoAncestorTagged(re,Y)},U.prototype.whenAnyAncestorMatches=function(re){return this._bindingWhenSyntax.whenAnyAncestorMatches(re)},U.prototype.whenNoAncestorMatches=function(re){return this._bindingWhenSyntax.whenNoAncestorMatches(re)},U.prototype.onActivation=function(re){return this._bindingOnSyntax.onActivation(re)},U}();G.BindingInWhenOnSyntax=J},51811:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.BindingOnSyntax=void 0;var oe=D(98370),E=function(){function ce(J){this._binding=J}return ce.prototype.onActivation=function(J){return this._binding.onActivation=J,new oe.BindingWhenSyntax(this._binding)},ce}();G.BindingOnSyntax=E},51860:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.BindingToSyntax=void 0;var oe=D(16674),E=D(28421),ce=D(99812),J=D(71325),U=function(){function re(Y){this._binding=Y}return re.prototype.to=function(Y){return this._binding.type=E.BindingTypeEnum.Instance,this._binding.implementationType=Y,new ce.BindingInWhenOnSyntax(this._binding)},re.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+oe.INVALID_TO_SELF_VALUE);var Y=this._binding.serviceIdentifier;return this.to(Y)},re.prototype.toConstantValue=function(Y){return this._binding.type=E.BindingTypeEnum.ConstantValue,this._binding.cache=Y,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=E.BindingScopeEnum.Singleton,new J.BindingWhenOnSyntax(this._binding)},re.prototype.toDynamicValue=function(Y){return this._binding.type=E.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=Y,this._binding.implementationType=null,new ce.BindingInWhenOnSyntax(this._binding)},re.prototype.toConstructor=function(Y){return this._binding.type=E.BindingTypeEnum.Constructor,this._binding.implementationType=Y,this._binding.scope=E.BindingScopeEnum.Singleton,new J.BindingWhenOnSyntax(this._binding)},re.prototype.toFactory=function(Y){return this._binding.type=E.BindingTypeEnum.Factory,this._binding.factory=Y,this._binding.scope=E.BindingScopeEnum.Singleton,new J.BindingWhenOnSyntax(this._binding)},re.prototype.toFunction=function(Y){if(typeof Y!="function")throw new Error(oe.INVALID_FUNCTION_BINDING);var se=this.toConstantValue(Y);return this._binding.type=E.BindingTypeEnum.Function,this._binding.scope=E.BindingScopeEnum.Singleton,se},re.prototype.toAutoFactory=function(Y){return this._binding.type=E.BindingTypeEnum.Factory,this._binding.factory=function(se){var le=function(){return se.container.get(Y)};return le},this._binding.scope=E.BindingScopeEnum.Singleton,new J.BindingWhenOnSyntax(this._binding)},re.prototype.toProvider=function(Y){return this._binding.type=E.BindingTypeEnum.Provider,this._binding.provider=Y,this._binding.scope=E.BindingScopeEnum.Singleton,new J.BindingWhenOnSyntax(this._binding)},re.prototype.toService=function(Y){this.toDynamicValue(function(se){return se.container.get(Y)})},re}();G.BindingToSyntax=U},71325:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.BindingWhenOnSyntax=void 0;var oe=D(51811),E=D(98370),ce=function(){function J(U){this._binding=U,this._bindingWhenSyntax=new E.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new oe.BindingOnSyntax(this._binding)}return J.prototype.when=function(U){return this._bindingWhenSyntax.when(U)},J.prototype.whenTargetNamed=function(U){return this._bindingWhenSyntax.whenTargetNamed(U)},J.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},J.prototype.whenTargetTagged=function(U,re){return this._bindingWhenSyntax.whenTargetTagged(U,re)},J.prototype.whenInjectedInto=function(U){return this._bindingWhenSyntax.whenInjectedInto(U)},J.prototype.whenParentNamed=function(U){return this._bindingWhenSyntax.whenParentNamed(U)},J.prototype.whenParentTagged=function(U,re){return this._bindingWhenSyntax.whenParentTagged(U,re)},J.prototype.whenAnyAncestorIs=function(U){return this._bindingWhenSyntax.whenAnyAncestorIs(U)},J.prototype.whenNoAncestorIs=function(U){return this._bindingWhenSyntax.whenNoAncestorIs(U)},J.prototype.whenAnyAncestorNamed=function(U){return this._bindingWhenSyntax.whenAnyAncestorNamed(U)},J.prototype.whenAnyAncestorTagged=function(U,re){return this._bindingWhenSyntax.whenAnyAncestorTagged(U,re)},J.prototype.whenNoAncestorNamed=function(U){return this._bindingWhenSyntax.whenNoAncestorNamed(U)},J.prototype.whenNoAncestorTagged=function(U,re){return this._bindingWhenSyntax.whenNoAncestorTagged(U,re)},J.prototype.whenAnyAncestorMatches=function(U){return this._bindingWhenSyntax.whenAnyAncestorMatches(U)},J.prototype.whenNoAncestorMatches=function(U){return this._bindingWhenSyntax.whenNoAncestorMatches(U)},J.prototype.onActivation=function(U){return this._bindingOnSyntax.onActivation(U)},J}();G.BindingWhenOnSyntax=ce},98370:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.BindingWhenSyntax=void 0;var oe=D(51811),E=D(80758),ce=function(){function J(U){this._binding=U}return J.prototype.when=function(U){return this._binding.constraint=U,new oe.BindingOnSyntax(this._binding)},J.prototype.whenTargetNamed=function(U){return this._binding.constraint=E.namedConstraint(U),new oe.BindingOnSyntax(this._binding)},J.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(U){var re=U.target!==null&&!U.target.isNamed()&&!U.target.isTagged();return re},new oe.BindingOnSyntax(this._binding)},J.prototype.whenTargetTagged=function(U,re){return this._binding.constraint=E.taggedConstraint(U)(re),new oe.BindingOnSyntax(this._binding)},J.prototype.whenInjectedInto=function(U){return this._binding.constraint=function(re){return E.typeConstraint(U)(re.parentRequest)},new oe.BindingOnSyntax(this._binding)},J.prototype.whenParentNamed=function(U){return this._binding.constraint=function(re){return E.namedConstraint(U)(re.parentRequest)},new oe.BindingOnSyntax(this._binding)},J.prototype.whenParentTagged=function(U,re){return this._binding.constraint=function(Y){return E.taggedConstraint(U)(re)(Y.parentRequest)},new oe.BindingOnSyntax(this._binding)},J.prototype.whenAnyAncestorIs=function(U){return this._binding.constraint=function(re){return E.traverseAncerstors(re,E.typeConstraint(U))},new oe.BindingOnSyntax(this._binding)},J.prototype.whenNoAncestorIs=function(U){return this._binding.constraint=function(re){return!E.traverseAncerstors(re,E.typeConstraint(U))},new oe.BindingOnSyntax(this._binding)},J.prototype.whenAnyAncestorNamed=function(U){return this._binding.constraint=function(re){return E.traverseAncerstors(re,E.namedConstraint(U))},new oe.BindingOnSyntax(this._binding)},J.prototype.whenNoAncestorNamed=function(U){return this._binding.constraint=function(re){return!E.traverseAncerstors(re,E.namedConstraint(U))},new oe.BindingOnSyntax(this._binding)},J.prototype.whenAnyAncestorTagged=function(U,re){return this._binding.constraint=function(Y){return E.traverseAncerstors(Y,E.taggedConstraint(U)(re))},new oe.BindingOnSyntax(this._binding)},J.prototype.whenNoAncestorTagged=function(U,re){return this._binding.constraint=function(Y){return!E.traverseAncerstors(Y,E.taggedConstraint(U)(re))},new oe.BindingOnSyntax(this._binding)},J.prototype.whenAnyAncestorMatches=function(U){return this._binding.constraint=function(re){return E.traverseAncerstors(re,U)},new oe.BindingOnSyntax(this._binding)},J.prototype.whenNoAncestorMatches=function(U){return this._binding.constraint=function(re){return!E.traverseAncerstors(re,U)},new oe.BindingOnSyntax(this._binding)},J}();G.BindingWhenSyntax=ce},80758:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.typeConstraint=G.namedConstraint=G.taggedConstraint=G.traverseAncerstors=void 0;var oe=D(6867),E=D(47738),ce=function(Y,se){var le=Y.parentRequest;return le!==null?se(le)?!0:ce(le,se):!1};G.traverseAncerstors=ce;var J=function(Y){return function(se){var le=function(ye){return ye!==null&&ye.target!==null&&ye.target.matchesTag(Y)(se)};return le.metaData=new E.Metadata(Y,se),le}};G.taggedConstraint=J;var U=J(oe.NAMED_TAG);G.namedConstraint=U;var re=function(Y){return function(se){var le=null;if(se!==null)if(le=se.bindings[0],typeof Y=="string"){var ye=le.serviceIdentifier;return ye===Y}else{var Ce=se.bindings[0].implementationType;return Y===Ce}return!1}};G.typeConstraint=re},70600:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.multiBindToService=void 0;var D=function(oe){return function(E){return function(){for(var ce=[],J=0;J<arguments.length;J++)ce[J]=arguments[J];return ce.forEach(function(U){return oe.bind(U).toService(E)})}}};G.multiBindToService=D},85265:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.isStackOverflowExeption=void 0;var oe=D(16674);function E(ce){return ce instanceof RangeError||ce.message===oe.STACK_OVERFLOW}G.isStackOverflowExeption=E},37791:function(rr,G){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.id=void 0;var D=0;function oe(){return D++}G.id=oe},55800:function(rr,G,D){"use strict";Object.defineProperty(G,"__esModule",{value:!0}),G.circularDependencyToException=G.listMetadataForTarget=G.listRegisteredBindingsForServiceIdentifier=G.getServiceIdentifierAsString=G.getFunctionName=void 0;var oe=D(16674);function E(le){if(typeof le=="function"){var ye=le;return ye.name}else{if(typeof le=="symbol")return le.toString();var ye=le;return ye}}G.getServiceIdentifierAsString=E;function ce(le,ye,Ce){var Oe="",Ue=Ce(le,ye);return Ue.length!==0&&(Oe=`
Registered bindings:`,Ue.forEach(function(pt){var Ge="Object";pt.implementationType!==null&&(Ge=se(pt.implementationType)),Oe=Oe+`
 `+Ge,pt.constraint.metaData&&(Oe=Oe+" - "+pt.constraint.metaData)})),Oe}G.listRegisteredBindingsForServiceIdentifier=ce;function J(le,ye){return le.parentRequest===null?!1:le.parentRequest.serviceIdentifier===ye?!0:J(le.parentRequest,ye)}function U(le){function ye(Oe,Ue){Ue===void 0&&(Ue=[]);var pt=E(Oe.serviceIdentifier);return Ue.push(pt),Oe.parentRequest!==null?ye(Oe.parentRequest,Ue):Ue}var Ce=ye(le);return Ce.reverse().join(" --> ")}function re(le){le.childRequests.forEach(function(ye){if(J(ye,ye.serviceIdentifier)){var Ce=U(ye);throw new Error(oe.CIRCULAR_DEPENDENCY+" "+Ce)}else re(ye)})}G.circularDependencyToException=re;function Y(le,ye){if(ye.isTagged()||ye.isNamed()){var Ce="",Oe=ye.getNamedTag(),Ue=ye.getCustomTags();return Oe!==null&&(Ce+=Oe.toString()+`
`),Ue!==null&&Ue.forEach(function(pt){Ce+=pt.toString()+`
`})," "+le+`
 `+le+" - "+Ce}else return" "+le}G.listMetadataForTarget=Y;function se(le){if(le.name)return le.name;var ye=le.toString(),Ce=ye.match(/^function\s*([^\s(]+)/);return Ce?Ce[1]:"Anonymous function: "+ye}G.getFunctionName=se},31745:function(rr){"use strict";rr.exports=D,rr.exports.default=D;var G=1e20;function D(U,re,Y,se,le,ye){this.fontSize=U||24,this.buffer=re===void 0?3:re,this.cutoff=se||.25,this.fontFamily=le||"sans-serif",this.fontWeight=ye||"normal",this.radius=Y||8;var Ce=this.size=this.fontSize+this.buffer*2,Oe=Ce+this.buffer*2,Ue=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;Ue?this.canvas=my.createOffscreenCanvas(Ce,Ce,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Ce),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Oe*Oe),this.gridInner=new Float64Array(Oe*Oe),this.f=new Float64Array(Oe),this.z=new Float64Array(Oe+1),this.v=new Uint16Array(Oe),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,Ue?this.middle=Math.round(Ce/2*1):this.middle=Math.round(Ce/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function oe(U,re,Y,se,le,ye,Ce){ye.fill(G,0,re*Y),Ce.fill(0,0,re*Y);for(var Oe=(re-se)/2,Ue=0;Ue<le;Ue++)for(var pt=0;pt<se;pt++){var Ge=(Ue+Oe)*re+pt+Oe,lt=U.data[4*(Ue*se+pt)+3]/255;if(lt===1)ye[Ge]=0,Ce[Ge]=G;else if(lt===0)ye[Ge]=G,Ce[Ge]=0;else{var Je=Math.max(0,.5-lt),Ye=Math.max(0,lt-.5);ye[Ge]=Je*Je,Ce[Ge]=Ye*Ye}}}function E(U,re,Y,se,le,ye,Ce){for(var Oe=0;Oe<re*Y;Oe++){var Ue=Math.sqrt(se[Oe])-Math.sqrt(le[Oe]);U[Oe]=Math.round(255-255*(Ue/ye+Ce))}}D.prototype._draw=function(U,re){var Y=this.ctx.measureText(U),se=Y.width,le=2*this.buffer,ye,Ce,Oe,Ue,pt,Ge,lt,Je;re&&this.useMetrics?(pt=Math.floor(Y.actualBoundingBoxAscent),Je=this.buffer+Math.ceil(Y.actualBoundingBoxAscent),Ge=this.buffer,lt=this.buffer,Ce=Math.min(this.size,Math.ceil(Y.actualBoundingBoxRight-Y.actualBoundingBoxLeft)),Ue=Math.min(this.size-Ge,Math.ceil(Y.actualBoundingBoxAscent+Y.actualBoundingBoxDescent)),ye=Ce+le,Oe=Ue+le,this.ctx.textBaseline="alphabetic"):(ye=Ce=this.size,Oe=Ue=this.size,pt=19*this.fontSize/24,Ge=lt=0,Je=this.middle,this.ctx.textBaseline="middle");var Ye;Ce&&Ue&&(this.ctx.clearRect(lt,Ge,Ce,Ue),this.ctx.fillText(U,this.buffer,Je),Ye=this.ctx.getImageData(lt,Ge,Ce,Ue));var Ke=new Uint8ClampedArray(ye*Oe);return oe(Ye,ye,Oe,Ce,Ue,this.gridOuter,this.gridInner),ce(this.gridOuter,ye,Oe,this.f,this.v,this.z),ce(this.gridInner,ye,Oe,this.f,this.v,this.z),E(Ke,ye,Oe,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Ke,metrics:{width:Ce,height:Ue,sdfWidth:ye,sdfHeight:Oe,top:pt,left:0,advance:se}}},D.prototype.draw=function(U){return this._draw(U,!1).data},D.prototype.drawWithMetrics=function(U){return this._draw(U,!0)};function ce(U,re,Y,se,le,ye){for(var Ce=0;Ce<re;Ce++)J(U,Ce,re,Y,se,le,ye);for(var Oe=0;Oe<Y;Oe++)J(U,Oe*re,1,re,se,le,ye)}function J(U,re,Y,se,le,ye,Ce){var Oe,Ue,pt,Ge;for(ye[0]=0,Ce[0]=-G,Ce[1]=G,Oe=0;Oe<se;Oe++)le[Oe]=U[re+Oe*Y];for(Oe=1,Ue=0,pt=0;Oe<se;Oe++){do Ge=ye[Ue],pt=(le[Oe]-le[Ge]+Oe*Oe-Ge*Ge)/(Oe-Ge)/2;while(pt<=Ce[Ue]&&--Ue>-1);Ue++,ye[Ue]=Oe,Ce[Ue]=pt,Ce[Ue+1]=G}for(Oe=0,Ue=0;Oe<se;Oe++){for(;Ce[Ue+1]<Oe;)Ue++;Ge=ye[Ue],U[re+Oe*Y]=le[Ge]+(Oe-Ge)*(Oe-Ge)}}},18857:function(rr,G,D){"use strict";D.r(G),D.d(G,{Function:function(){return Fa},Interpreter:function(){return Cn},default:function(){return pe},evaluate:function(){return js},vm:function(){return oe}});var oe={};D.r(oe),D.d(oe,{Script:function(){return Pl},compileFunction:function(){return ss},createContext:function(){return Jn},runInContext:function(){return Nu},runInNewContext:function(){return ka}});var E={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},ce="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",J={5:ce,"5module":ce+" export import",6:ce+" const class extends export import super"},U=/^in(stanceof)?$/,re="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",Y="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",se=new RegExp("["+re+"]"),le=new RegExp("["+re+Y+"]");re=Y=null;var ye=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],Ce=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function Oe(p,g){for(var w=65536,_=0;_<g.length;_+=2){if(w+=g[_],w>p)return!1;if(w+=g[_+1],w>=p)return!0}}function Ue(p,g){return p<65?p===36:p<91?!0:p<97?p===95:p<123?!0:p<=65535?p>=170&&se.test(String.fromCharCode(p)):g===!1?!1:Oe(p,ye)}function pt(p,g){return p<48?p===36:p<58?!0:p<65?!1:p<91?!0:p<97?p===95:p<123?!0:p<=65535?p>=170&&le.test(String.fromCharCode(p)):g===!1?!1:Oe(p,ye)||Oe(p,Ce)}var Ge=function(g,w){w===void 0&&(w={}),this.label=g,this.keyword=w.keyword,this.beforeExpr=!!w.beforeExpr,this.startsExpr=!!w.startsExpr,this.isLoop=!!w.isLoop,this.isAssign=!!w.isAssign,this.prefix=!!w.prefix,this.postfix=!!w.postfix,this.binop=w.binop||null,this.updateContext=null};function lt(p,g){return new Ge(p,{beforeExpr:!0,binop:g})}var Je={beforeExpr:!0},Ye={startsExpr:!0},Ke={};function xt(p,g){return g===void 0&&(g={}),g.keyword=p,Ke[p]=new Ge(p,g)}var I={num:new Ge("num",Ye),regexp:new Ge("regexp",Ye),string:new Ge("string",Ye),name:new Ge("name",Ye),eof:new Ge("eof"),bracketL:new Ge("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Ge("]"),braceL:new Ge("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Ge("}"),parenL:new Ge("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Ge(")"),comma:new Ge(",",Je),semi:new Ge(";",Je),colon:new Ge(":",Je),dot:new Ge("."),question:new Ge("?",Je),questionDot:new Ge("?."),arrow:new Ge("=>",Je),template:new Ge("template"),invalidTemplate:new Ge("invalidTemplate"),ellipsis:new Ge("...",Je),backQuote:new Ge("`",Ye),dollarBraceL:new Ge("${",{beforeExpr:!0,startsExpr:!0}),eq:new Ge("=",{beforeExpr:!0,isAssign:!0}),assign:new Ge("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Ge("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Ge("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:lt("||",1),logicalAND:lt("&&",2),bitwiseOR:lt("|",3),bitwiseXOR:lt("^",4),bitwiseAND:lt("&",5),equality:lt("==/!=/===/!==",6),relational:lt("</>/<=/>=",7),bitShift:lt("<</>>/>>>",8),plusMin:new Ge("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:lt("%",10),star:lt("*",10),slash:lt("/",10),starstar:new Ge("**",{beforeExpr:!0}),coalesce:lt("??",1),_break:xt("break"),_case:xt("case",Je),_catch:xt("catch"),_continue:xt("continue"),_debugger:xt("debugger"),_default:xt("default",Je),_do:xt("do",{isLoop:!0,beforeExpr:!0}),_else:xt("else",Je),_finally:xt("finally"),_for:xt("for",{isLoop:!0}),_function:xt("function",Ye),_if:xt("if"),_return:xt("return",Je),_switch:xt("switch"),_throw:xt("throw",Je),_try:xt("try"),_var:xt("var"),_const:xt("const"),_while:xt("while",{isLoop:!0}),_with:xt("with"),_new:xt("new",{beforeExpr:!0,startsExpr:!0}),_this:xt("this",Ye),_super:xt("super",Ye),_class:xt("class",Ye),_extends:xt("extends",Je),_export:xt("export"),_import:xt("import",Ye),_null:xt("null",Ye),_true:xt("true",Ye),_false:xt("false",Ye),_in:xt("in",{beforeExpr:!0,binop:7}),_instanceof:xt("instanceof",{beforeExpr:!0,binop:7}),_typeof:xt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:xt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:xt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},ht=/\r\n?|\n|\u2028|\u2029/,Fe=new RegExp(ht.source,"g");function ge(p,g){return p===10||p===13||!g&&(p===8232||p===8233)}var je=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Be=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,tt=Object.prototype,_t=tt.hasOwnProperty,k=tt.toString;function ne(p,g){return _t.call(p,g)}var P=Array.isArray||function(p){return k.call(p)==="[object Array]"};function L(p){return new RegExp("^(?:"+p.replace(/ /g,"|")+")$")}var b=function(g,w){this.line=g,this.column=w};b.prototype.offset=function(g){return new b(this.line,this.column+g)};var de=function(g,w,_){this.start=w,this.end=_,g.sourceFile!==null&&(this.source=g.sourceFile)};function Te(p,g){for(var w=1,_=0;;){Fe.lastIndex=_;var F=Fe.exec(p);if(F&&F.index<g)++w,_=F.index+F[0].length;else return new b(w,g-_)}}var we={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function We(p){var g={};for(var w in we)g[w]=p&&ne(p,w)?p[w]:we[w];if(g.ecmaVersion>=2015&&(g.ecmaVersion-=2009),g.allowReserved==null&&(g.allowReserved=g.ecmaVersion<5),P(g.onToken)){var _=g.onToken;g.onToken=function(F){return _.push(F)}}return P(g.onComment)&&(g.onComment=St(g,g.onComment)),g}function St(p,g){return function(w,_,F,ae,Ee,Qe){var et={type:w?"Block":"Line",value:_,start:F,end:ae};p.locations&&(et.loc=new de(this,Ee,Qe)),p.ranges&&(et.range=[F,ae]),g.push(et)}}var ar=1,jt=2,Or=ar|jt,Wr=4,Zr=8,pn=16,an=32,Fn=64,ln=128;function gn(p,g){return jt|(p?Wr:0)|(g?Zr:0)}var nn=0,Tr=1,Vr=2,fi=3,ti=4,Zn=5,Ne=function(g,w,_){this.options=g=We(g),this.sourceFile=g.sourceFile,this.keywords=L(J[g.ecmaVersion>=6?6:g.sourceType==="module"?"5module":5]);var F="";if(g.allowReserved!==!0){for(var ae=g.ecmaVersion;!(F=E[ae]);ae--);g.sourceType==="module"&&(F+=" await")}this.reservedWords=L(F);var Ee=(F?F+" ":"")+E.strict;this.reservedWordsStrict=L(Ee),this.reservedWordsStrictBind=L(Ee+" "+E.strictBind),this.input=String(w),this.containsEsc=!1,_?(this.pos=_,this.lineStart=this.input.lastIndexOf(`
`,_-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(ht).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=I.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=g.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&g.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(ar),this.regexpState=null},V={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Ne.prototype.parse=function(){var g=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(g)},V.inFunction.get=function(){return(this.currentVarScope().flags&jt)>0},V.inGenerator.get=function(){return(this.currentVarScope().flags&Zr)>0},V.inAsync.get=function(){return(this.currentVarScope().flags&Wr)>0},V.allowSuper.get=function(){return(this.currentThisScope().flags&Fn)>0},V.allowDirectSuper.get=function(){return(this.currentThisScope().flags&ln)>0},V.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Ne.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&jt)>0},Ne.extend=function(){for(var g=[],w=arguments.length;w--;)g[w]=arguments[w];for(var _=this,F=0;F<g.length;F++)_=g[F](_);return _},Ne.parse=function(g,w){return new this(w,g).parse()},Ne.parseExpressionAt=function(g,w,_){var F=new this(_,g,w);return F.nextToken(),F.parseExpression()},Ne.tokenizer=function(g,w){return new this(w,g)},Object.defineProperties(Ne.prototype,V);var Z=Ne.prototype,$=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;Z.strictDirective=function(p){for(;;){Be.lastIndex=p,p+=Be.exec(this.input)[0].length;var g=$.exec(this.input.slice(p));if(!g)return!1;if((g[1]||g[2])==="use strict"){Be.lastIndex=p+g[0].length;var w=Be.exec(this.input),_=w.index+w[0].length,F=this.input.charAt(_);return F===";"||F==="}"||ht.test(w[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(F)||F==="!"&&this.input.charAt(_+1)==="=")}p+=g[0].length,Be.lastIndex=p,p+=Be.exec(this.input)[0].length,this.input[p]===";"&&p++}},Z.eat=function(p){return this.type===p?(this.next(),!0):!1},Z.isContextual=function(p){return this.type===I.name&&this.value===p&&!this.containsEsc},Z.eatContextual=function(p){return this.isContextual(p)?(this.next(),!0):!1},Z.expectContextual=function(p){this.eatContextual(p)||this.unexpected()},Z.canInsertSemicolon=function(){return this.type===I.eof||this.type===I.braceR||ht.test(this.input.slice(this.lastTokEnd,this.start))},Z.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},Z.semicolon=function(){!this.eat(I.semi)&&!this.insertSemicolon()&&this.unexpected()},Z.afterTrailingComma=function(p,g){if(this.type===p)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),g||this.next(),!0},Z.expect=function(p){this.eat(p)||this.unexpected()},Z.unexpected=function(p){this.raise(p!=null?p:this.start,"Unexpected token")};function T(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}Z.checkPatternErrors=function(p,g){if(!!p){p.trailingComma>-1&&this.raiseRecoverable(p.trailingComma,"Comma is not permitted after the rest element");var w=g?p.parenthesizedAssign:p.parenthesizedBind;w>-1&&this.raiseRecoverable(w,"Parenthesized pattern")}},Z.checkExpressionErrors=function(p,g){if(!p)return!1;var w=p.shorthandAssign,_=p.doubleProto;if(!g)return w>=0||_>=0;w>=0&&this.raise(w,"Shorthand property assignments are valid only in destructuring patterns"),_>=0&&this.raiseRecoverable(_,"Redefinition of __proto__ property")},Z.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},Z.isSimpleAssignTarget=function(p){return p.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(p.expression):p.type==="Identifier"||p.type==="MemberExpression"};var xe=Ne.prototype;xe.parseTopLevel=function(p){var g={};for(p.body||(p.body=[]);this.type!==I.eof;){var w=this.parseStatement(null,!0,g);p.body.push(w)}if(this.inModule)for(var _=0,F=Object.keys(this.undefinedExports);_<F.length;_+=1){var ae=F[_];this.raiseRecoverable(this.undefinedExports[ae].start,"Export '"+ae+"' is not defined")}return this.adaptDirectivePrologue(p.body),this.next(),p.sourceType=this.options.sourceType,this.finishNode(p,"Program")};var vt={kind:"loop"},Gt={kind:"switch"};xe.isLet=function(p){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Be.lastIndex=this.pos;var g=Be.exec(this.input),w=this.pos+g[0].length,_=this.input.charCodeAt(w);if(_===91)return!0;if(p)return!1;if(_===123)return!0;if(Ue(_,!0)){for(var F=w+1;pt(this.input.charCodeAt(F),!0);)++F;var ae=this.input.slice(w,F);if(!U.test(ae))return!0}return!1},xe.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Be.lastIndex=this.pos;var p=Be.exec(this.input),g=this.pos+p[0].length;return!ht.test(this.input.slice(this.pos,g))&&this.input.slice(g,g+8)==="function"&&(g+8===this.input.length||!pt(this.input.charAt(g+8)))},xe.parseStatement=function(p,g,w){var _=this.type,F=this.startNode(),ae;switch(this.isLet(p)&&(_=I._var,ae="let"),_){case I._break:case I._continue:return this.parseBreakContinueStatement(F,_.keyword);case I._debugger:return this.parseDebuggerStatement(F);case I._do:return this.parseDoStatement(F);case I._for:return this.parseForStatement(F);case I._function:return p&&(this.strict||p!=="if"&&p!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(F,!1,!p);case I._class:return p&&this.unexpected(),this.parseClass(F,!0);case I._if:return this.parseIfStatement(F);case I._return:return this.parseReturnStatement(F);case I._switch:return this.parseSwitchStatement(F);case I._throw:return this.parseThrowStatement(F);case I._try:return this.parseTryStatement(F);case I._const:case I._var:return ae=ae||this.value,p&&ae!=="var"&&this.unexpected(),this.parseVarStatement(F,ae);case I._while:return this.parseWhileStatement(F);case I._with:return this.parseWithStatement(F);case I.braceL:return this.parseBlock(!0,F);case I.semi:return this.parseEmptyStatement(F);case I._export:case I._import:if(this.options.ecmaVersion>10&&_===I._import){Be.lastIndex=this.pos;var Ee=Be.exec(this.input),Qe=this.pos+Ee[0].length,et=this.input.charCodeAt(Qe);if(et===40||et===46)return this.parseExpressionStatement(F,this.parseExpression())}return this.options.allowImportExportEverywhere||(g||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),_===I._import?this.parseImport(F):this.parseExport(F,w);default:if(this.isAsyncFunction())return p&&this.unexpected(),this.next(),this.parseFunctionStatement(F,!0,!p);var Nt=this.value,$t=this.parseExpression();return _===I.name&&$t.type==="Identifier"&&this.eat(I.colon)?this.parseLabeledStatement(F,Nt,$t,p):this.parseExpressionStatement(F,$t)}},xe.parseBreakContinueStatement=function(p,g){var w=g==="break";this.next(),this.eat(I.semi)||this.insertSemicolon()?p.label=null:this.type!==I.name?this.unexpected():(p.label=this.parseIdent(),this.semicolon());for(var _=0;_<this.labels.length;++_){var F=this.labels[_];if((p.label==null||F.name===p.label.name)&&(F.kind!=null&&(w||F.kind==="loop")||p.label&&w))break}return _===this.labels.length&&this.raise(p.start,"Unsyntactic "+g),this.finishNode(p,w?"BreakStatement":"ContinueStatement")},xe.parseDebuggerStatement=function(p){return this.next(),this.semicolon(),this.finishNode(p,"DebuggerStatement")},xe.parseDoStatement=function(p){return this.next(),this.labels.push(vt),p.body=this.parseStatement("do"),this.labels.pop(),this.expect(I._while),p.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(I.semi):this.semicolon(),this.finishNode(p,"DoWhileStatement")},xe.parseForStatement=function(p){this.next();var g=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(vt),this.enterScope(0),this.expect(I.parenL),this.type===I.semi)return g>-1&&this.unexpected(g),this.parseFor(p,null);var w=this.isLet();if(this.type===I._var||this.type===I._const||w){var _=this.startNode(),F=w?"let":this.value;return this.next(),this.parseVar(_,!0,F),this.finishNode(_,"VariableDeclaration"),(this.type===I._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&_.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===I._in?g>-1&&this.unexpected(g):p.await=g>-1),this.parseForIn(p,_)):(g>-1&&this.unexpected(g),this.parseFor(p,_))}var ae=new T,Ee=this.parseExpression(!0,ae);return this.type===I._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===I._in?g>-1&&this.unexpected(g):p.await=g>-1),this.toAssignable(Ee,!1,ae),this.checkLVal(Ee),this.parseForIn(p,Ee)):(this.checkExpressionErrors(ae,!0),g>-1&&this.unexpected(g),this.parseFor(p,Ee))},xe.parseFunctionStatement=function(p,g,w){return this.next(),this.parseFunction(p,$e|(w?0:At),!1,g)},xe.parseIfStatement=function(p){return this.next(),p.test=this.parseParenExpression(),p.consequent=this.parseStatement("if"),p.alternate=this.eat(I._else)?this.parseStatement("if"):null,this.finishNode(p,"IfStatement")},xe.parseReturnStatement=function(p){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(I.semi)||this.insertSemicolon()?p.argument=null:(p.argument=this.parseExpression(),this.semicolon()),this.finishNode(p,"ReturnStatement")},xe.parseSwitchStatement=function(p){this.next(),p.discriminant=this.parseParenExpression(),p.cases=[],this.expect(I.braceL),this.labels.push(Gt),this.enterScope(0);for(var g,w=!1;this.type!==I.braceR;)if(this.type===I._case||this.type===I._default){var _=this.type===I._case;g&&this.finishNode(g,"SwitchCase"),p.cases.push(g=this.startNode()),g.consequent=[],this.next(),_?g.test=this.parseExpression():(w&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),w=!0,g.test=null),this.expect(I.colon)}else g||this.unexpected(),g.consequent.push(this.parseStatement(null));return this.exitScope(),g&&this.finishNode(g,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(p,"SwitchStatement")},xe.parseThrowStatement=function(p){return this.next(),ht.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),p.argument=this.parseExpression(),this.semicolon(),this.finishNode(p,"ThrowStatement")};var _e=[];xe.parseTryStatement=function(p){if(this.next(),p.block=this.parseBlock(),p.handler=null,this.type===I._catch){var g=this.startNode();if(this.next(),this.eat(I.parenL)){g.param=this.parseBindingAtom();var w=g.param.type==="Identifier";this.enterScope(w?an:0),this.checkLVal(g.param,w?ti:Vr),this.expect(I.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),g.param=null,this.enterScope(0);g.body=this.parseBlock(!1),this.exitScope(),p.handler=this.finishNode(g,"CatchClause")}return p.finalizer=this.eat(I._finally)?this.parseBlock():null,!p.handler&&!p.finalizer&&this.raise(p.start,"Missing catch or finally clause"),this.finishNode(p,"TryStatement")},xe.parseVarStatement=function(p,g){return this.next(),this.parseVar(p,!1,g),this.semicolon(),this.finishNode(p,"VariableDeclaration")},xe.parseWhileStatement=function(p){return this.next(),p.test=this.parseParenExpression(),this.labels.push(vt),p.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(p,"WhileStatement")},xe.parseWithStatement=function(p){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),p.object=this.parseParenExpression(),p.body=this.parseStatement("with"),this.finishNode(p,"WithStatement")},xe.parseEmptyStatement=function(p){return this.next(),this.finishNode(p,"EmptyStatement")},xe.parseLabeledStatement=function(p,g,w,_){for(var F=0,ae=this.labels;F<ae.length;F+=1){var Ee=ae[F];Ee.name===g&&this.raise(w.start,"Label '"+g+"' is already declared")}for(var Qe=this.type.isLoop?"loop":this.type===I._switch?"switch":null,et=this.labels.length-1;et>=0;et--){var Nt=this.labels[et];if(Nt.statementStart===p.start)Nt.statementStart=this.start,Nt.kind=Qe;else break}return this.labels.push({name:g,kind:Qe,statementStart:this.start}),p.body=this.parseStatement(_?_.indexOf("label")===-1?_+"label":_:"label"),this.labels.pop(),p.label=w,this.finishNode(p,"LabeledStatement")},xe.parseExpressionStatement=function(p,g){return p.expression=g,this.semicolon(),this.finishNode(p,"ExpressionStatement")},xe.parseBlock=function(p,g,w){for(p===void 0&&(p=!0),g===void 0&&(g=this.startNode()),g.body=[],this.expect(I.braceL),p&&this.enterScope(0);this.type!==I.braceR;){var _=this.parseStatement(null);g.body.push(_)}return w&&(this.strict=!1),this.next(),p&&this.exitScope(),this.finishNode(g,"BlockStatement")},xe.parseFor=function(p,g){return p.init=g,this.expect(I.semi),p.test=this.type===I.semi?null:this.parseExpression(),this.expect(I.semi),p.update=this.type===I.parenR?null:this.parseExpression(),this.expect(I.parenR),p.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(p,"ForStatement")},xe.parseForIn=function(p,g){var w=this.type===I._in;return this.next(),g.type==="VariableDeclaration"&&g.declarations[0].init!=null&&(!w||this.options.ecmaVersion<8||this.strict||g.kind!=="var"||g.declarations[0].id.type!=="Identifier")?this.raise(g.start,(w?"for-in":"for-of")+" loop variable declaration may not have an initializer"):g.type==="AssignmentPattern"&&this.raise(g.start,"Invalid left-hand side in for-loop"),p.left=g,p.right=w?this.parseExpression():this.parseMaybeAssign(),this.expect(I.parenR),p.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(p,w?"ForInStatement":"ForOfStatement")},xe.parseVar=function(p,g,w){for(p.declarations=[],p.kind=w;;){var _=this.startNode();if(this.parseVarId(_,w),this.eat(I.eq)?_.init=this.parseMaybeAssign(g):w==="const"&&!(this.type===I._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():_.id.type!=="Identifier"&&!(g&&(this.type===I._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):_.init=null,p.declarations.push(this.finishNode(_,"VariableDeclarator")),!this.eat(I.comma))break}return p},xe.parseVarId=function(p,g){p.id=this.parseBindingAtom(),this.checkLVal(p.id,g==="var"?Tr:Vr,!1)};var $e=1,At=2,Zt=4;xe.parseFunction=function(p,g,w,_){this.initFunction(p),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!_)&&(this.type===I.star&&g&At&&this.unexpected(),p.generator=this.eat(I.star)),this.options.ecmaVersion>=8&&(p.async=!!_),g&$e&&(p.id=g&Zt&&this.type!==I.name?null:this.parseIdent(),p.id&&!(g&At)&&this.checkLVal(p.id,this.strict||p.generator||p.async?this.treatFunctionsAsVar?Tr:Vr:fi));var F=this.yieldPos,ae=this.awaitPos,Ee=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(gn(p.async,p.generator)),g&$e||(p.id=this.type===I.name?this.parseIdent():null),this.parseFunctionParams(p),this.parseFunctionBody(p,w,!1),this.yieldPos=F,this.awaitPos=ae,this.awaitIdentPos=Ee,this.finishNode(p,g&$e?"FunctionDeclaration":"FunctionExpression")},xe.parseFunctionParams=function(p){this.expect(I.parenL),p.params=this.parseBindingList(I.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},xe.parseClass=function(p,g){this.next();var w=this.strict;this.strict=!0,this.parseClassId(p,g),this.parseClassSuper(p);var _=this.startNode(),F=!1;for(_.body=[],this.expect(I.braceL);this.type!==I.braceR;){var ae=this.parseClassElement(p.superClass!==null);ae&&(_.body.push(ae),ae.type==="MethodDefinition"&&ae.kind==="constructor"&&(F&&this.raise(ae.start,"Duplicate constructor in the same class"),F=!0))}return this.strict=w,this.next(),p.body=this.finishNode(_,"ClassBody"),this.finishNode(p,g?"ClassDeclaration":"ClassExpression")},xe.parseClassElement=function(p){var g=this;if(this.eat(I.semi))return null;var w=this.startNode(),_=function(et,Nt){Nt===void 0&&(Nt=!1);var $t=g.start,Hr=g.startLoc;return g.eatContextual(et)?g.type!==I.parenL&&(!Nt||!g.canInsertSemicolon())?!0:(w.key&&g.unexpected(),w.computed=!1,w.key=g.startNodeAt($t,Hr),w.key.name=et,g.finishNode(w.key,"Identifier"),!1):!1};w.kind="method",w.static=_("static");var F=this.eat(I.star),ae=!1;F||(this.options.ecmaVersion>=8&&_("async",!0)?(ae=!0,F=this.options.ecmaVersion>=9&&this.eat(I.star)):_("get")?w.kind="get":_("set")&&(w.kind="set")),w.key||this.parsePropertyName(w);var Ee=w.key,Qe=!1;return!w.computed&&!w.static&&(Ee.type==="Identifier"&&Ee.name==="constructor"||Ee.type==="Literal"&&Ee.value==="constructor")?(w.kind!=="method"&&this.raise(Ee.start,"Constructor can't have get/set modifier"),F&&this.raise(Ee.start,"Constructor can't be a generator"),ae&&this.raise(Ee.start,"Constructor can't be an async method"),w.kind="constructor",Qe=p):w.static&&Ee.type==="Identifier"&&Ee.name==="prototype"&&this.raise(Ee.start,"Classes may not have a static property named prototype"),this.parseClassMethod(w,F,ae,Qe),w.kind==="get"&&w.value.params.length!==0&&this.raiseRecoverable(w.value.start,"getter should have no params"),w.kind==="set"&&w.value.params.length!==1&&this.raiseRecoverable(w.value.start,"setter should have exactly one param"),w.kind==="set"&&w.value.params[0].type==="RestElement"&&this.raiseRecoverable(w.value.params[0].start,"Setter cannot use rest params"),w},xe.parseClassMethod=function(p,g,w,_){return p.value=this.parseMethod(g,w,_),this.finishNode(p,"MethodDefinition")},xe.parseClassId=function(p,g){this.type===I.name?(p.id=this.parseIdent(),g&&this.checkLVal(p.id,Vr,!1)):(g===!0&&this.unexpected(),p.id=null)},xe.parseClassSuper=function(p){p.superClass=this.eat(I._extends)?this.parseExprSubscripts():null},xe.parseExport=function(p,g){if(this.next(),this.eat(I.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(p.exported=this.parseIdent(!0),this.checkExport(g,p.exported.name,this.lastTokStart)):p.exported=null),this.expectContextual("from"),this.type!==I.string&&this.unexpected(),p.source=this.parseExprAtom(),this.semicolon(),this.finishNode(p,"ExportAllDeclaration");if(this.eat(I._default)){this.checkExport(g,"default",this.lastTokStart);var w;if(this.type===I._function||(w=this.isAsyncFunction())){var _=this.startNode();this.next(),w&&this.next(),p.declaration=this.parseFunction(_,$e|Zt,!1,w)}else if(this.type===I._class){var F=this.startNode();p.declaration=this.parseClass(F,"nullableID")}else p.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(p,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())p.declaration=this.parseStatement(null),p.declaration.type==="VariableDeclaration"?this.checkVariableExport(g,p.declaration.declarations):this.checkExport(g,p.declaration.id.name,p.declaration.id.start),p.specifiers=[],p.source=null;else{if(p.declaration=null,p.specifiers=this.parseExportSpecifiers(g),this.eatContextual("from"))this.type!==I.string&&this.unexpected(),p.source=this.parseExprAtom();else{for(var ae=0,Ee=p.specifiers;ae<Ee.length;ae+=1){var Qe=Ee[ae];this.checkUnreserved(Qe.local),this.checkLocalExport(Qe.local)}p.source=null}this.semicolon()}return this.finishNode(p,"ExportNamedDeclaration")},xe.checkExport=function(p,g,w){!p||(ne(p,g)&&this.raiseRecoverable(w,"Duplicate export '"+g+"'"),p[g]=!0)},xe.checkPatternExport=function(p,g){var w=g.type;if(w==="Identifier")this.checkExport(p,g.name,g.start);else if(w==="ObjectPattern")for(var _=0,F=g.properties;_<F.length;_+=1){var ae=F[_];this.checkPatternExport(p,ae)}else if(w==="ArrayPattern")for(var Ee=0,Qe=g.elements;Ee<Qe.length;Ee+=1){var et=Qe[Ee];et&&this.checkPatternExport(p,et)}else w==="Property"?this.checkPatternExport(p,g.value):w==="AssignmentPattern"?this.checkPatternExport(p,g.left):w==="RestElement"?this.checkPatternExport(p,g.argument):w==="ParenthesizedExpression"&&this.checkPatternExport(p,g.expression)},xe.checkVariableExport=function(p,g){if(!!p)for(var w=0,_=g;w<_.length;w+=1){var F=_[w];this.checkPatternExport(p,F.id)}},xe.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},xe.parseExportSpecifiers=function(p){var g=[],w=!0;for(this.expect(I.braceL);!this.eat(I.braceR);){if(w)w=!1;else if(this.expect(I.comma),this.afterTrailingComma(I.braceR))break;var _=this.startNode();_.local=this.parseIdent(!0),_.exported=this.eatContextual("as")?this.parseIdent(!0):_.local,this.checkExport(p,_.exported.name,_.exported.start),g.push(this.finishNode(_,"ExportSpecifier"))}return g},xe.parseImport=function(p){return this.next(),this.type===I.string?(p.specifiers=_e,p.source=this.parseExprAtom()):(p.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),p.source=this.type===I.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(p,"ImportDeclaration")},xe.parseImportSpecifiers=function(){var p=[],g=!0;if(this.type===I.name){var w=this.startNode();if(w.local=this.parseIdent(),this.checkLVal(w.local,Vr),p.push(this.finishNode(w,"ImportDefaultSpecifier")),!this.eat(I.comma))return p}if(this.type===I.star){var _=this.startNode();return this.next(),this.expectContextual("as"),_.local=this.parseIdent(),this.checkLVal(_.local,Vr),p.push(this.finishNode(_,"ImportNamespaceSpecifier")),p}for(this.expect(I.braceL);!this.eat(I.braceR);){if(g)g=!1;else if(this.expect(I.comma),this.afterTrailingComma(I.braceR))break;var F=this.startNode();F.imported=this.parseIdent(!0),this.eatContextual("as")?F.local=this.parseIdent():(this.checkUnreserved(F.imported),F.local=F.imported),this.checkLVal(F.local,Vr),p.push(this.finishNode(F,"ImportSpecifier"))}return p},xe.adaptDirectivePrologue=function(p){for(var g=0;g<p.length&&this.isDirectiveCandidate(p[g]);++g)p[g].directive=p[g].expression.raw.slice(1,-1)},xe.isDirectiveCandidate=function(p){return p.type==="ExpressionStatement"&&p.expression.type==="Literal"&&typeof p.expression.value=="string"&&(this.input[p.start]==='"'||this.input[p.start]==="'")};var er=Ne.prototype;er.toAssignable=function(p,g,w){if(this.options.ecmaVersion>=6&&p)switch(p.type){case"Identifier":this.inAsync&&p.name==="await"&&this.raise(p.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":p.type="ObjectPattern",w&&this.checkPatternErrors(w,!0);for(var _=0,F=p.properties;_<F.length;_+=1){var ae=F[_];this.toAssignable(ae,g),ae.type==="RestElement"&&(ae.argument.type==="ArrayPattern"||ae.argument.type==="ObjectPattern")&&this.raise(ae.argument.start,"Unexpected token")}break;case"Property":p.kind!=="init"&&this.raise(p.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(p.value,g);break;case"ArrayExpression":p.type="ArrayPattern",w&&this.checkPatternErrors(w,!0),this.toAssignableList(p.elements,g);break;case"SpreadElement":p.type="RestElement",this.toAssignable(p.argument,g),p.argument.type==="AssignmentPattern"&&this.raise(p.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":p.operator!=="="&&this.raise(p.left.end,"Only '=' operator can be used for specifying default value."),p.type="AssignmentPattern",delete p.operator,this.toAssignable(p.left,g);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(p.expression,g,w);break;case"ChainExpression":this.raiseRecoverable(p.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!g)break;default:this.raise(p.start,"Assigning to rvalue")}else w&&this.checkPatternErrors(w,!0);return p},er.toAssignableList=function(p,g){for(var w=p.length,_=0;_<w;_++){var F=p[_];F&&this.toAssignable(F,g)}if(w){var ae=p[w-1];this.options.ecmaVersion===6&&g&&ae&&ae.type==="RestElement"&&ae.argument.type!=="Identifier"&&this.unexpected(ae.argument.start)}return p},er.parseSpread=function(p){var g=this.startNode();return this.next(),g.argument=this.parseMaybeAssign(!1,p),this.finishNode(g,"SpreadElement")},er.parseRestBinding=function(){var p=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==I.name&&this.unexpected(),p.argument=this.parseBindingAtom(),this.finishNode(p,"RestElement")},er.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case I.bracketL:var p=this.startNode();return this.next(),p.elements=this.parseBindingList(I.bracketR,!0,!0),this.finishNode(p,"ArrayPattern");case I.braceL:return this.parseObj(!0)}return this.parseIdent()},er.parseBindingList=function(p,g,w){for(var _=[],F=!0;!this.eat(p);)if(F?F=!1:this.expect(I.comma),g&&this.type===I.comma)_.push(null);else{if(w&&this.afterTrailingComma(p))break;if(this.type===I.ellipsis){var ae=this.parseRestBinding();this.parseBindingListItem(ae),_.push(ae),this.type===I.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(p);break}else{var Ee=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(Ee),_.push(Ee)}}return _},er.parseBindingListItem=function(p){return p},er.parseMaybeDefault=function(p,g,w){if(w=w||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(I.eq))return w;var _=this.startNodeAt(p,g);return _.left=w,_.right=this.parseMaybeAssign(),this.finishNode(_,"AssignmentPattern")},er.checkLVal=function(p,g,w){switch(g===void 0&&(g=nn),p.type){case"Identifier":g===Vr&&p.name==="let"&&this.raiseRecoverable(p.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(p.name)&&this.raiseRecoverable(p.start,(g?"Binding ":"Assigning to ")+p.name+" in strict mode"),w&&(ne(w,p.name)&&this.raiseRecoverable(p.start,"Argument name clash"),w[p.name]=!0),g!==nn&&g!==Zn&&this.declareName(p.name,g,p.start);break;case"ChainExpression":this.raiseRecoverable(p.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":g&&this.raiseRecoverable(p.start,"Binding member expression");break;case"ObjectPattern":for(var _=0,F=p.properties;_<F.length;_+=1){var ae=F[_];this.checkLVal(ae,g,w)}break;case"Property":this.checkLVal(p.value,g,w);break;case"ArrayPattern":for(var Ee=0,Qe=p.elements;Ee<Qe.length;Ee+=1){var et=Qe[Ee];et&&this.checkLVal(et,g,w)}break;case"AssignmentPattern":this.checkLVal(p.left,g,w);break;case"RestElement":this.checkLVal(p.argument,g,w);break;case"ParenthesizedExpression":this.checkLVal(p.expression,g,w);break;default:this.raise(p.start,(g?"Binding":"Assigning to")+" rvalue")}};var lr=Ne.prototype;lr.checkPropClash=function(p,g,w){if(!(this.options.ecmaVersion>=9&&p.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(p.computed||p.method||p.shorthand))){var _=p.key,F;switch(_.type){case"Identifier":F=_.name;break;case"Literal":F=String(_.value);break;default:return}var ae=p.kind;if(this.options.ecmaVersion>=6){F==="__proto__"&&ae==="init"&&(g.proto&&(w?w.doubleProto<0&&(w.doubleProto=_.start):this.raiseRecoverable(_.start,"Redefinition of __proto__ property")),g.proto=!0);return}F="$"+F;var Ee=g[F];if(Ee){var Qe;ae==="init"?Qe=this.strict&&Ee.init||Ee.get||Ee.set:Qe=Ee.init||Ee[ae],Qe&&this.raiseRecoverable(_.start,"Redefinition of property")}else Ee=g[F]={init:!1,get:!1,set:!1};Ee[ae]=!0}},lr.parseExpression=function(p,g){var w=this.start,_=this.startLoc,F=this.parseMaybeAssign(p,g);if(this.type===I.comma){var ae=this.startNodeAt(w,_);for(ae.expressions=[F];this.eat(I.comma);)ae.expressions.push(this.parseMaybeAssign(p,g));return this.finishNode(ae,"SequenceExpression")}return F},lr.parseMaybeAssign=function(p,g,w){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(p);this.exprAllowed=!1}var _=!1,F=-1,ae=-1;g?(F=g.parenthesizedAssign,ae=g.trailingComma,g.parenthesizedAssign=g.trailingComma=-1):(g=new T,_=!0);var Ee=this.start,Qe=this.startLoc;(this.type===I.parenL||this.type===I.name)&&(this.potentialArrowAt=this.start);var et=this.parseMaybeConditional(p,g);if(w&&(et=w.call(this,et,Ee,Qe)),this.type.isAssign){var Nt=this.startNodeAt(Ee,Qe);return Nt.operator=this.value,Nt.left=this.type===I.eq?this.toAssignable(et,!1,g):et,_||(g.parenthesizedAssign=g.trailingComma=g.doubleProto=-1),g.shorthandAssign>=Nt.left.start&&(g.shorthandAssign=-1),this.checkLVal(et),this.next(),Nt.right=this.parseMaybeAssign(p),this.finishNode(Nt,"AssignmentExpression")}else _&&this.checkExpressionErrors(g,!0);return F>-1&&(g.parenthesizedAssign=F),ae>-1&&(g.trailingComma=ae),et},lr.parseMaybeConditional=function(p,g){var w=this.start,_=this.startLoc,F=this.parseExprOps(p,g);if(this.checkExpressionErrors(g))return F;if(this.eat(I.question)){var ae=this.startNodeAt(w,_);return ae.test=F,ae.consequent=this.parseMaybeAssign(),this.expect(I.colon),ae.alternate=this.parseMaybeAssign(p),this.finishNode(ae,"ConditionalExpression")}return F},lr.parseExprOps=function(p,g){var w=this.start,_=this.startLoc,F=this.parseMaybeUnary(g,!1);return this.checkExpressionErrors(g)||F.start===w&&F.type==="ArrowFunctionExpression"?F:this.parseExprOp(F,w,_,-1,p)},lr.parseExprOp=function(p,g,w,_,F){var ae=this.type.binop;if(ae!=null&&(!F||this.type!==I._in)&&ae>_){var Ee=this.type===I.logicalOR||this.type===I.logicalAND,Qe=this.type===I.coalesce;Qe&&(ae=I.logicalAND.binop);var et=this.value;this.next();var Nt=this.start,$t=this.startLoc,Hr=this.parseExprOp(this.parseMaybeUnary(null,!1),Nt,$t,ae,F),cn=this.buildBinary(g,w,p,Hr,et,Ee||Qe);return(Ee&&this.type===I.coalesce||Qe&&(this.type===I.logicalOR||this.type===I.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(cn,g,w,_,F)}return p},lr.buildBinary=function(p,g,w,_,F,ae){var Ee=this.startNodeAt(p,g);return Ee.left=w,Ee.operator=F,Ee.right=_,this.finishNode(Ee,ae?"LogicalExpression":"BinaryExpression")},lr.parseMaybeUnary=function(p,g){var w=this.start,_=this.startLoc,F;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))F=this.parseAwait(),g=!0;else if(this.type.prefix){var ae=this.startNode(),Ee=this.type===I.incDec;ae.operator=this.value,ae.prefix=!0,this.next(),ae.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(p,!0),Ee?this.checkLVal(ae.argument):this.strict&&ae.operator==="delete"&&ae.argument.type==="Identifier"?this.raiseRecoverable(ae.start,"Deleting local variable in strict mode"):g=!0,F=this.finishNode(ae,Ee?"UpdateExpression":"UnaryExpression")}else{if(F=this.parseExprSubscripts(p),this.checkExpressionErrors(p))return F;for(;this.type.postfix&&!this.canInsertSemicolon();){var Qe=this.startNodeAt(w,_);Qe.operator=this.value,Qe.prefix=!1,Qe.argument=F,this.checkLVal(F),this.next(),F=this.finishNode(Qe,"UpdateExpression")}}return!g&&this.eat(I.starstar)?this.buildBinary(w,_,F,this.parseMaybeUnary(null,!1),"**",!1):F},lr.parseExprSubscripts=function(p){var g=this.start,w=this.startLoc,_=this.parseExprAtom(p);if(_.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return _;var F=this.parseSubscripts(_,g,w);return p&&F.type==="MemberExpression"&&(p.parenthesizedAssign>=F.start&&(p.parenthesizedAssign=-1),p.parenthesizedBind>=F.start&&(p.parenthesizedBind=-1)),F},lr.parseSubscripts=function(p,g,w,_){for(var F=this.options.ecmaVersion>=8&&p.type==="Identifier"&&p.name==="async"&&this.lastTokEnd===p.end&&!this.canInsertSemicolon()&&p.end-p.start==5&&this.potentialArrowAt===p.start,ae=!1;;){var Ee=this.parseSubscript(p,g,w,_,F,ae);if(Ee.optional&&(ae=!0),Ee===p||Ee.type==="ArrowFunctionExpression"){if(ae){var Qe=this.startNodeAt(g,w);Qe.expression=Ee,Ee=this.finishNode(Qe,"ChainExpression")}return Ee}p=Ee}},lr.parseSubscript=function(p,g,w,_,F,ae){var Ee=this.options.ecmaVersion>=11,Qe=Ee&&this.eat(I.questionDot);_&&Qe&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var et=this.eat(I.bracketL);if(et||Qe&&this.type!==I.parenL&&this.type!==I.backQuote||this.eat(I.dot)){var Nt=this.startNodeAt(g,w);Nt.object=p,Nt.property=et?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),Nt.computed=!!et,et&&this.expect(I.bracketR),Ee&&(Nt.optional=Qe),p=this.finishNode(Nt,"MemberExpression")}else if(!_&&this.eat(I.parenL)){var $t=new T,Hr=this.yieldPos,cn=this.awaitPos,jr=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Dn=this.parseExprList(I.parenR,this.options.ecmaVersion>=8,!1,$t);if(F&&!Qe&&!this.canInsertSemicolon()&&this.eat(I.arrow))return this.checkPatternErrors($t,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Hr,this.awaitPos=cn,this.awaitIdentPos=jr,this.parseArrowExpression(this.startNodeAt(g,w),Dn,!0);this.checkExpressionErrors($t,!0),this.yieldPos=Hr||this.yieldPos,this.awaitPos=cn||this.awaitPos,this.awaitIdentPos=jr||this.awaitIdentPos;var yn=this.startNodeAt(g,w);yn.callee=p,yn.arguments=Dn,Ee&&(yn.optional=Qe),p=this.finishNode(yn,"CallExpression")}else if(this.type===I.backQuote){(Qe||ae)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var jn=this.startNodeAt(g,w);jn.tag=p,jn.quasi=this.parseTemplate({isTagged:!0}),p=this.finishNode(jn,"TaggedTemplateExpression")}return p},lr.parseExprAtom=function(p){this.type===I.slash&&this.readRegexp();var g,w=this.potentialArrowAt===this.start;switch(this.type){case I._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),g=this.startNode(),this.next(),this.type===I.parenL&&!this.allowDirectSuper&&this.raise(g.start,"super() call outside constructor of a subclass"),this.type!==I.dot&&this.type!==I.bracketL&&this.type!==I.parenL&&this.unexpected(),this.finishNode(g,"Super");case I._this:return g=this.startNode(),this.next(),this.finishNode(g,"ThisExpression");case I.name:var _=this.start,F=this.startLoc,ae=this.containsEsc,Ee=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!ae&&Ee.name==="async"&&!this.canInsertSemicolon()&&this.eat(I._function))return this.parseFunction(this.startNodeAt(_,F),0,!1,!0);if(w&&!this.canInsertSemicolon()){if(this.eat(I.arrow))return this.parseArrowExpression(this.startNodeAt(_,F),[Ee],!1);if(this.options.ecmaVersion>=8&&Ee.name==="async"&&this.type===I.name&&!ae)return Ee=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(I.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(_,F),[Ee],!0)}return Ee;case I.regexp:var Qe=this.value;return g=this.parseLiteral(Qe.value),g.regex={pattern:Qe.pattern,flags:Qe.flags},g;case I.num:case I.string:return this.parseLiteral(this.value);case I._null:case I._true:case I._false:return g=this.startNode(),g.value=this.type===I._null?null:this.type===I._true,g.raw=this.type.keyword,this.next(),this.finishNode(g,"Literal");case I.parenL:var et=this.start,Nt=this.parseParenAndDistinguishExpression(w);return p&&(p.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Nt)&&(p.parenthesizedAssign=et),p.parenthesizedBind<0&&(p.parenthesizedBind=et)),Nt;case I.bracketL:return g=this.startNode(),this.next(),g.elements=this.parseExprList(I.bracketR,!0,!0,p),this.finishNode(g,"ArrayExpression");case I.braceL:return this.parseObj(!1,p);case I._function:return g=this.startNode(),this.next(),this.parseFunction(g,0);case I._class:return this.parseClass(this.startNode(),!1);case I._new:return this.parseNew();case I.backQuote:return this.parseTemplate();case I._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},lr.parseExprImport=function(){var p=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var g=this.parseIdent(!0);switch(this.type){case I.parenL:return this.parseDynamicImport(p);case I.dot:return p.meta=g,this.parseImportMeta(p);default:this.unexpected()}},lr.parseDynamicImport=function(p){if(this.next(),p.source=this.parseMaybeAssign(),!this.eat(I.parenR)){var g=this.start;this.eat(I.comma)&&this.eat(I.parenR)?this.raiseRecoverable(g,"Trailing comma is not allowed in import()"):this.unexpected(g)}return this.finishNode(p,"ImportExpression")},lr.parseImportMeta=function(p){this.next();var g=this.containsEsc;return p.property=this.parseIdent(!0),p.property.name!=="meta"&&this.raiseRecoverable(p.property.start,"The only valid meta property for import is 'import.meta'"),g&&this.raiseRecoverable(p.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(p.start,"Cannot use 'import.meta' outside a module"),this.finishNode(p,"MetaProperty")},lr.parseLiteral=function(p){var g=this.startNode();return g.value=p,g.raw=this.input.slice(this.start,this.end),g.raw.charCodeAt(g.raw.length-1)===110&&(g.bigint=g.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(g,"Literal")},lr.parseParenExpression=function(){this.expect(I.parenL);var p=this.parseExpression();return this.expect(I.parenR),p},lr.parseParenAndDistinguishExpression=function(p){var g=this.start,w=this.startLoc,_,F=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var ae=this.start,Ee=this.startLoc,Qe=[],et=!0,Nt=!1,$t=new T,Hr=this.yieldPos,cn=this.awaitPos,jr;for(this.yieldPos=0,this.awaitPos=0;this.type!==I.parenR;)if(et?et=!1:this.expect(I.comma),F&&this.afterTrailingComma(I.parenR,!0)){Nt=!0;break}else if(this.type===I.ellipsis){jr=this.start,Qe.push(this.parseParenItem(this.parseRestBinding())),this.type===I.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else Qe.push(this.parseMaybeAssign(!1,$t,this.parseParenItem));var Dn=this.start,yn=this.startLoc;if(this.expect(I.parenR),p&&!this.canInsertSemicolon()&&this.eat(I.arrow))return this.checkPatternErrors($t,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Hr,this.awaitPos=cn,this.parseParenArrowList(g,w,Qe);(!Qe.length||Nt)&&this.unexpected(this.lastTokStart),jr&&this.unexpected(jr),this.checkExpressionErrors($t,!0),this.yieldPos=Hr||this.yieldPos,this.awaitPos=cn||this.awaitPos,Qe.length>1?(_=this.startNodeAt(ae,Ee),_.expressions=Qe,this.finishNodeAt(_,"SequenceExpression",Dn,yn)):_=Qe[0]}else _=this.parseParenExpression();if(this.options.preserveParens){var jn=this.startNodeAt(g,w);return jn.expression=_,this.finishNode(jn,"ParenthesizedExpression")}else return _},lr.parseParenItem=function(p){return p},lr.parseParenArrowList=function(p,g,w){return this.parseArrowExpression(this.startNodeAt(p,g),w)};var Nr=[];lr.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var p=this.startNode(),g=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(I.dot)){p.meta=g;var w=this.containsEsc;return p.property=this.parseIdent(!0),p.property.name!=="target"&&this.raiseRecoverable(p.property.start,"The only valid meta property for new is 'new.target'"),w&&this.raiseRecoverable(p.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(p.start,"'new.target' can only be used in functions"),this.finishNode(p,"MetaProperty")}var _=this.start,F=this.startLoc,ae=this.type===I._import;return p.callee=this.parseSubscripts(this.parseExprAtom(),_,F,!0),ae&&p.callee.type==="ImportExpression"&&this.raise(_,"Cannot use new with import()"),this.eat(I.parenL)?p.arguments=this.parseExprList(I.parenR,this.options.ecmaVersion>=8,!1):p.arguments=Nr,this.finishNode(p,"NewExpression")},lr.parseTemplateElement=function(p){var g=p.isTagged,w=this.startNode();return this.type===I.invalidTemplate?(g||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),w.value={raw:this.value,cooked:null}):w.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),w.tail=this.type===I.backQuote,this.finishNode(w,"TemplateElement")},lr.parseTemplate=function(p){p===void 0&&(p={});var g=p.isTagged;g===void 0&&(g=!1);var w=this.startNode();this.next(),w.expressions=[];var _=this.parseTemplateElement({isTagged:g});for(w.quasis=[_];!_.tail;)this.type===I.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(I.dollarBraceL),w.expressions.push(this.parseExpression()),this.expect(I.braceR),w.quasis.push(_=this.parseTemplateElement({isTagged:g}));return this.next(),this.finishNode(w,"TemplateLiteral")},lr.isAsyncProp=function(p){return!p.computed&&p.key.type==="Identifier"&&p.key.name==="async"&&(this.type===I.name||this.type===I.num||this.type===I.string||this.type===I.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===I.star)&&!ht.test(this.input.slice(this.lastTokEnd,this.start))},lr.parseObj=function(p,g){var w=this.startNode(),_=!0,F={};for(w.properties=[],this.next();!this.eat(I.braceR);){if(_)_=!1;else if(this.expect(I.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(I.braceR))break;var ae=this.parseProperty(p,g);p||this.checkPropClash(ae,F,g),w.properties.push(ae)}return this.finishNode(w,p?"ObjectPattern":"ObjectExpression")},lr.parseProperty=function(p,g){var w=this.startNode(),_,F,ae,Ee;if(this.options.ecmaVersion>=9&&this.eat(I.ellipsis))return p?(w.argument=this.parseIdent(!1),this.type===I.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(w,"RestElement")):(this.type===I.parenL&&g&&(g.parenthesizedAssign<0&&(g.parenthesizedAssign=this.start),g.parenthesizedBind<0&&(g.parenthesizedBind=this.start)),w.argument=this.parseMaybeAssign(!1,g),this.type===I.comma&&g&&g.trailingComma<0&&(g.trailingComma=this.start),this.finishNode(w,"SpreadElement"));this.options.ecmaVersion>=6&&(w.method=!1,w.shorthand=!1,(p||g)&&(ae=this.start,Ee=this.startLoc),p||(_=this.eat(I.star)));var Qe=this.containsEsc;return this.parsePropertyName(w),!p&&!Qe&&this.options.ecmaVersion>=8&&!_&&this.isAsyncProp(w)?(F=!0,_=this.options.ecmaVersion>=9&&this.eat(I.star),this.parsePropertyName(w,g)):F=!1,this.parsePropertyValue(w,p,_,F,ae,Ee,g,Qe),this.finishNode(w,"Property")},lr.parsePropertyValue=function(p,g,w,_,F,ae,Ee,Qe){if((w||_)&&this.type===I.colon&&this.unexpected(),this.eat(I.colon))p.value=g?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Ee),p.kind="init";else if(this.options.ecmaVersion>=6&&this.type===I.parenL)g&&this.unexpected(),p.kind="init",p.method=!0,p.value=this.parseMethod(w,_);else if(!g&&!Qe&&this.options.ecmaVersion>=5&&!p.computed&&p.key.type==="Identifier"&&(p.key.name==="get"||p.key.name==="set")&&this.type!==I.comma&&this.type!==I.braceR&&this.type!==I.eq){(w||_)&&this.unexpected(),p.kind=p.key.name,this.parsePropertyName(p),p.value=this.parseMethod(!1);var et=p.kind==="get"?0:1;if(p.value.params.length!==et){var Nt=p.value.start;p.kind==="get"?this.raiseRecoverable(Nt,"getter should have no params"):this.raiseRecoverable(Nt,"setter should have exactly one param")}else p.kind==="set"&&p.value.params[0].type==="RestElement"&&this.raiseRecoverable(p.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!p.computed&&p.key.type==="Identifier"?((w||_)&&this.unexpected(),this.checkUnreserved(p.key),p.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=F),p.kind="init",g?p.value=this.parseMaybeDefault(F,ae,p.key):this.type===I.eq&&Ee?(Ee.shorthandAssign<0&&(Ee.shorthandAssign=this.start),p.value=this.parseMaybeDefault(F,ae,p.key)):p.value=p.key,p.shorthand=!0):this.unexpected()},lr.parsePropertyName=function(p){if(this.options.ecmaVersion>=6){if(this.eat(I.bracketL))return p.computed=!0,p.key=this.parseMaybeAssign(),this.expect(I.bracketR),p.key;p.computed=!1}return p.key=this.type===I.num||this.type===I.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},lr.initFunction=function(p){p.id=null,this.options.ecmaVersion>=6&&(p.generator=p.expression=!1),this.options.ecmaVersion>=8&&(p.async=!1)},lr.parseMethod=function(p,g,w){var _=this.startNode(),F=this.yieldPos,ae=this.awaitPos,Ee=this.awaitIdentPos;return this.initFunction(_),this.options.ecmaVersion>=6&&(_.generator=p),this.options.ecmaVersion>=8&&(_.async=!!g),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(gn(g,_.generator)|Fn|(w?ln:0)),this.expect(I.parenL),_.params=this.parseBindingList(I.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(_,!1,!0),this.yieldPos=F,this.awaitPos=ae,this.awaitIdentPos=Ee,this.finishNode(_,"FunctionExpression")},lr.parseArrowExpression=function(p,g,w){var _=this.yieldPos,F=this.awaitPos,ae=this.awaitIdentPos;return this.enterScope(gn(w,!1)|pn),this.initFunction(p),this.options.ecmaVersion>=8&&(p.async=!!w),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,p.params=this.toAssignableList(g,!0),this.parseFunctionBody(p,!0,!1),this.yieldPos=_,this.awaitPos=F,this.awaitIdentPos=ae,this.finishNode(p,"ArrowFunctionExpression")},lr.parseFunctionBody=function(p,g,w){var _=g&&this.type!==I.braceL,F=this.strict,ae=!1;if(_)p.body=this.parseMaybeAssign(),p.expression=!0,this.checkParams(p,!1);else{var Ee=this.options.ecmaVersion>=7&&!this.isSimpleParamList(p.params);(!F||Ee)&&(ae=this.strictDirective(this.end),ae&&Ee&&this.raiseRecoverable(p.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var Qe=this.labels;this.labels=[],ae&&(this.strict=!0),this.checkParams(p,!F&&!ae&&!g&&!w&&this.isSimpleParamList(p.params)),this.strict&&p.id&&this.checkLVal(p.id,Zn),p.body=this.parseBlock(!1,void 0,ae&&!F),p.expression=!1,this.adaptDirectivePrologue(p.body.body),this.labels=Qe}this.exitScope()},lr.isSimpleParamList=function(p){for(var g=0,w=p;g<w.length;g+=1){var _=w[g];if(_.type!=="Identifier")return!1}return!0},lr.checkParams=function(p,g){for(var w={},_=0,F=p.params;_<F.length;_+=1){var ae=F[_];this.checkLVal(ae,Tr,g?null:w)}},lr.parseExprList=function(p,g,w,_){for(var F=[],ae=!0;!this.eat(p);){if(ae)ae=!1;else if(this.expect(I.comma),g&&this.afterTrailingComma(p))break;var Ee=void 0;w&&this.type===I.comma?Ee=null:this.type===I.ellipsis?(Ee=this.parseSpread(_),_&&this.type===I.comma&&_.trailingComma<0&&(_.trailingComma=this.start)):Ee=this.parseMaybeAssign(!1,_),F.push(Ee)}return F},lr.checkUnreserved=function(p){var g=p.start,w=p.end,_=p.name;if(this.inGenerator&&_==="yield"&&this.raiseRecoverable(g,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&_==="await"&&this.raiseRecoverable(g,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(_)&&this.raise(g,"Unexpected keyword '"+_+"'"),!(this.options.ecmaVersion<6&&this.input.slice(g,w).indexOf("\\")!==-1)){var F=this.strict?this.reservedWordsStrict:this.reservedWords;F.test(_)&&(!this.inAsync&&_==="await"&&this.raiseRecoverable(g,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(g,"The keyword '"+_+"' is reserved"))}},lr.parseIdent=function(p,g){var w=this.startNode();return this.type===I.name?w.name=this.value:this.type.keyword?(w.name=this.type.keyword,(w.name==="class"||w.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!p),this.finishNode(w,"Identifier"),p||(this.checkUnreserved(w),w.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=w.start)),w},lr.parseYield=function(p){this.yieldPos||(this.yieldPos=this.start);var g=this.startNode();return this.next(),this.type===I.semi||this.canInsertSemicolon()||this.type!==I.star&&!this.type.startsExpr?(g.delegate=!1,g.argument=null):(g.delegate=this.eat(I.star),g.argument=this.parseMaybeAssign(p)),this.finishNode(g,"YieldExpression")},lr.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var p=this.startNode();return this.next(),p.argument=this.parseMaybeUnary(null,!1),this.finishNode(p,"AwaitExpression")};var Ir=Ne.prototype;Ir.raise=function(p,g){var w=Te(this.input,p);g+=" ("+w.line+":"+w.column+")";var _=new SyntaxError(g);throw _.pos=p,_.loc=w,_.raisedAt=this.pos,_},Ir.raiseRecoverable=Ir.raise,Ir.curPosition=function(){if(this.options.locations)return new b(this.curLine,this.pos-this.lineStart)};var cr=Ne.prototype,Yr=function(g){this.flags=g,this.var=[],this.lexical=[],this.functions=[]};cr.enterScope=function(p){this.scopeStack.push(new Yr(p))},cr.exitScope=function(){this.scopeStack.pop()},cr.treatFunctionsAsVarInScope=function(p){return p.flags&jt||!this.inModule&&p.flags&ar},cr.declareName=function(p,g,w){var _=!1;if(g===Vr){var F=this.currentScope();_=F.lexical.indexOf(p)>-1||F.functions.indexOf(p)>-1||F.var.indexOf(p)>-1,F.lexical.push(p),this.inModule&&F.flags&ar&&delete this.undefinedExports[p]}else if(g===ti){var ae=this.currentScope();ae.lexical.push(p)}else if(g===fi){var Ee=this.currentScope();this.treatFunctionsAsVar?_=Ee.lexical.indexOf(p)>-1:_=Ee.lexical.indexOf(p)>-1||Ee.var.indexOf(p)>-1,Ee.functions.push(p)}else for(var Qe=this.scopeStack.length-1;Qe>=0;--Qe){var et=this.scopeStack[Qe];if(et.lexical.indexOf(p)>-1&&!(et.flags&an&&et.lexical[0]===p)||!this.treatFunctionsAsVarInScope(et)&&et.functions.indexOf(p)>-1){_=!0;break}if(et.var.push(p),this.inModule&&et.flags&ar&&delete this.undefinedExports[p],et.flags&Or)break}_&&this.raiseRecoverable(w,"Identifier '"+p+"' has already been declared")},cr.checkLocalExport=function(p){this.scopeStack[0].lexical.indexOf(p.name)===-1&&this.scopeStack[0].var.indexOf(p.name)===-1&&(this.undefinedExports[p.name]=p)},cr.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},cr.currentVarScope=function(){for(var p=this.scopeStack.length-1;;p--){var g=this.scopeStack[p];if(g.flags&Or)return g}},cr.currentThisScope=function(){for(var p=this.scopeStack.length-1;;p--){var g=this.scopeStack[p];if(g.flags&Or&&!(g.flags&pn))return g}};var en=function(g,w,_){this.type="",this.start=w,this.end=0,g.options.locations&&(this.loc=new de(g,_)),g.options.directSourceFile&&(this.sourceFile=g.options.directSourceFile),g.options.ranges&&(this.range=[w,0])},Un=Ne.prototype;Un.startNode=function(){return new en(this,this.start,this.startLoc)},Un.startNodeAt=function(p,g){return new en(this,p,g)};function mi(p,g,w,_){return p.type=g,p.end=w,this.options.locations&&(p.loc.end=_),this.options.ranges&&(p.range[1]=w),p}Un.finishNode=function(p,g){return mi.call(this,p,g,this.lastTokEnd,this.lastTokEndLoc)},Un.finishNodeAt=function(p,g,w,_){return mi.call(this,p,g,w,_)};var di=function(g,w,_,F,ae){this.token=g,this.isExpr=!!w,this.preserveSpace=!!_,this.override=F,this.generator=!!ae},Yn={b_stat:new di("{",!1),b_expr:new di("{",!0),b_tmpl:new di("${",!1),p_stat:new di("(",!1),p_expr:new di("(",!0),q_tmpl:new di("`",!0,!0,function(p){return p.tryReadTemplateToken()}),f_stat:new di("function",!1),f_expr:new di("function",!0),f_expr_gen:new di("function",!0,!1,null,!0),f_gen:new di("function",!1,!1,null,!0)},Vi=Ne.prototype;Vi.initialContext=function(){return[Yn.b_stat]},Vi.braceIsBlock=function(p){var g=this.curContext();return g===Yn.f_expr||g===Yn.f_stat?!0:p===I.colon&&(g===Yn.b_stat||g===Yn.b_expr)?!g.isExpr:p===I._return||p===I.name&&this.exprAllowed?ht.test(this.input.slice(this.lastTokEnd,this.start)):p===I._else||p===I.semi||p===I.eof||p===I.parenR||p===I.arrow?!0:p===I.braceL?g===Yn.b_stat:p===I._var||p===I._const||p===I.name?!1:!this.exprAllowed},Vi.inGeneratorContext=function(){for(var p=this.context.length-1;p>=1;p--){var g=this.context[p];if(g.token==="function")return g.generator}return!1},Vi.updateContext=function(p){var g,w=this.type;w.keyword&&p===I.dot?this.exprAllowed=!1:(g=w.updateContext)?g.call(this,p):this.exprAllowed=w.beforeExpr},I.parenR.updateContext=I.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var p=this.context.pop();p===Yn.b_stat&&this.curContext().token==="function"&&(p=this.context.pop()),this.exprAllowed=!p.isExpr},I.braceL.updateContext=function(p){this.context.push(this.braceIsBlock(p)?Yn.b_stat:Yn.b_expr),this.exprAllowed=!0},I.dollarBraceL.updateContext=function(){this.context.push(Yn.b_tmpl),this.exprAllowed=!0},I.parenL.updateContext=function(p){var g=p===I._if||p===I._for||p===I._with||p===I._while;this.context.push(g?Yn.p_stat:Yn.p_expr),this.exprAllowed=!0},I.incDec.updateContext=function(){},I._function.updateContext=I._class.updateContext=function(p){p.beforeExpr&&p!==I.semi&&p!==I._else&&!(p===I._return&&ht.test(this.input.slice(this.lastTokEnd,this.start)))&&!((p===I.colon||p===I.braceL)&&this.curContext()===Yn.b_stat)?this.context.push(Yn.f_expr):this.context.push(Yn.f_stat),this.exprAllowed=!1},I.backQuote.updateContext=function(){this.curContext()===Yn.q_tmpl?this.context.pop():this.context.push(Yn.q_tmpl),this.exprAllowed=!1},I.star.updateContext=function(p){if(p===I._function){var g=this.context.length-1;this.context[g]===Yn.f_expr?this.context[g]=Yn.f_expr_gen:this.context[g]=Yn.f_gen}this.exprAllowed=!0},I.name.updateContext=function(p){var g=!1;this.options.ecmaVersion>=6&&p!==I.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(g=!0),this.exprAllowed=g};var ja="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ea=ja+" Extended_Pictographic",Ra=ea,Wa={9:ja,10:ea,11:Ra},ia="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Ei="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ho=Ei+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Mu=ho+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Ru={9:Ei,10:ho,11:Mu},Rl={};function Lu(p){var g=Rl[p]={binary:L(Wa[p]+" "+ia),nonBinary:{General_Category:L(ia),Script:L(Ru[p])}};g.nonBinary.Script_Extensions=g.nonBinary.Script,g.nonBinary.gc=g.nonBinary.General_Category,g.nonBinary.sc=g.nonBinary.Script,g.nonBinary.scx=g.nonBinary.Script_Extensions}Lu(9),Lu(10),Lu(11);var rn=Ne.prototype,aa=function(g){this.parser=g,this.validFlags="gim"+(g.options.ecmaVersion>=6?"uy":"")+(g.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Rl[g.options.ecmaVersion>=11?11:g.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};aa.prototype.reset=function(g,w,_){var F=_.indexOf("u")!==-1;this.start=g|0,this.source=w+"",this.flags=_,this.switchU=F&&this.parser.options.ecmaVersion>=6,this.switchN=F&&this.parser.options.ecmaVersion>=9},aa.prototype.raise=function(g){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+g)},aa.prototype.at=function(g,w){w===void 0&&(w=!1);var _=this.source,F=_.length;if(g>=F)return-1;var ae=_.charCodeAt(g);if(!(w||this.switchU)||ae<=55295||ae>=57344||g+1>=F)return ae;var Ee=_.charCodeAt(g+1);return Ee>=56320&&Ee<=57343?(ae<<10)+Ee-56613888:ae},aa.prototype.nextIndex=function(g,w){w===void 0&&(w=!1);var _=this.source,F=_.length;if(g>=F)return F;var ae=_.charCodeAt(g),Ee;return!(w||this.switchU)||ae<=55295||ae>=57344||g+1>=F||(Ee=_.charCodeAt(g+1))<56320||Ee>57343?g+1:g+2},aa.prototype.current=function(g){return g===void 0&&(g=!1),this.at(this.pos,g)},aa.prototype.lookahead=function(g){return g===void 0&&(g=!1),this.at(this.nextIndex(this.pos,g),g)},aa.prototype.advance=function(g){g===void 0&&(g=!1),this.pos=this.nextIndex(this.pos,g)},aa.prototype.eat=function(g,w){return w===void 0&&(w=!1),this.current(w)===g?(this.advance(w),!0):!1};function Pu(p){return p<=65535?String.fromCharCode(p):(p-=65536,String.fromCharCode((p>>10)+55296,(p&1023)+56320))}rn.validateRegExpFlags=function(p){for(var g=p.validFlags,w=p.flags,_=0;_<w.length;_++){var F=w.charAt(_);g.indexOf(F)===-1&&this.raise(p.start,"Invalid regular expression flag"),w.indexOf(F,_+1)>-1&&this.raise(p.start,"Duplicate regular expression flag")}},rn.validateRegExpPattern=function(p){this.regexp_pattern(p),!p.switchN&&this.options.ecmaVersion>=9&&p.groupNames.length>0&&(p.switchN=!0,this.regexp_pattern(p))},rn.regexp_pattern=function(p){p.pos=0,p.lastIntValue=0,p.lastStringValue="",p.lastAssertionIsQuantifiable=!1,p.numCapturingParens=0,p.maxBackReference=0,p.groupNames.length=0,p.backReferenceNames.length=0,this.regexp_disjunction(p),p.pos!==p.source.length&&(p.eat(41)&&p.raise("Unmatched ')'"),(p.eat(93)||p.eat(125))&&p.raise("Lone quantifier brackets")),p.maxBackReference>p.numCapturingParens&&p.raise("Invalid escape");for(var g=0,w=p.backReferenceNames;g<w.length;g+=1){var _=w[g];p.groupNames.indexOf(_)===-1&&p.raise("Invalid named capture referenced")}},rn.regexp_disjunction=function(p){for(this.regexp_alternative(p);p.eat(124);)this.regexp_alternative(p);this.regexp_eatQuantifier(p,!0)&&p.raise("Nothing to repeat"),p.eat(123)&&p.raise("Lone quantifier brackets")},rn.regexp_alternative=function(p){for(;p.pos<p.source.length&&this.regexp_eatTerm(p););},rn.regexp_eatTerm=function(p){return this.regexp_eatAssertion(p)?(p.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(p)&&p.switchU&&p.raise("Invalid quantifier"),!0):(p.switchU?this.regexp_eatAtom(p):this.regexp_eatExtendedAtom(p))?(this.regexp_eatQuantifier(p),!0):!1},rn.regexp_eatAssertion=function(p){var g=p.pos;if(p.lastAssertionIsQuantifiable=!1,p.eat(94)||p.eat(36))return!0;if(p.eat(92)){if(p.eat(66)||p.eat(98))return!0;p.pos=g}if(p.eat(40)&&p.eat(63)){var w=!1;if(this.options.ecmaVersion>=9&&(w=p.eat(60)),p.eat(61)||p.eat(33))return this.regexp_disjunction(p),p.eat(41)||p.raise("Unterminated group"),p.lastAssertionIsQuantifiable=!w,!0}return p.pos=g,!1},rn.regexp_eatQuantifier=function(p,g){return g===void 0&&(g=!1),this.regexp_eatQuantifierPrefix(p,g)?(p.eat(63),!0):!1},rn.regexp_eatQuantifierPrefix=function(p,g){return p.eat(42)||p.eat(43)||p.eat(63)||this.regexp_eatBracedQuantifier(p,g)},rn.regexp_eatBracedQuantifier=function(p,g){var w=p.pos;if(p.eat(123)){var _=0,F=-1;if(this.regexp_eatDecimalDigits(p)&&(_=p.lastIntValue,p.eat(44)&&this.regexp_eatDecimalDigits(p)&&(F=p.lastIntValue),p.eat(125)))return F!==-1&&F<_&&!g&&p.raise("numbers out of order in {} quantifier"),!0;p.switchU&&!g&&p.raise("Incomplete quantifier"),p.pos=w}return!1},rn.regexp_eatAtom=function(p){return this.regexp_eatPatternCharacters(p)||p.eat(46)||this.regexp_eatReverseSolidusAtomEscape(p)||this.regexp_eatCharacterClass(p)||this.regexp_eatUncapturingGroup(p)||this.regexp_eatCapturingGroup(p)},rn.regexp_eatReverseSolidusAtomEscape=function(p){var g=p.pos;if(p.eat(92)){if(this.regexp_eatAtomEscape(p))return!0;p.pos=g}return!1},rn.regexp_eatUncapturingGroup=function(p){var g=p.pos;if(p.eat(40)){if(p.eat(63)&&p.eat(58)){if(this.regexp_disjunction(p),p.eat(41))return!0;p.raise("Unterminated group")}p.pos=g}return!1},rn.regexp_eatCapturingGroup=function(p){if(p.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(p):p.current()===63&&p.raise("Invalid group"),this.regexp_disjunction(p),p.eat(41))return p.numCapturingParens+=1,!0;p.raise("Unterminated group")}return!1},rn.regexp_eatExtendedAtom=function(p){return p.eat(46)||this.regexp_eatReverseSolidusAtomEscape(p)||this.regexp_eatCharacterClass(p)||this.regexp_eatUncapturingGroup(p)||this.regexp_eatCapturingGroup(p)||this.regexp_eatInvalidBracedQuantifier(p)||this.regexp_eatExtendedPatternCharacter(p)},rn.regexp_eatInvalidBracedQuantifier=function(p){return this.regexp_eatBracedQuantifier(p,!0)&&p.raise("Nothing to repeat"),!1},rn.regexp_eatSyntaxCharacter=function(p){var g=p.current();return Oo(g)?(p.lastIntValue=g,p.advance(),!0):!1};function Oo(p){return p===36||p>=40&&p<=43||p===46||p===63||p>=91&&p<=94||p>=123&&p<=125}rn.regexp_eatPatternCharacters=function(p){for(var g=p.pos,w=0;(w=p.current())!==-1&&!Oo(w);)p.advance();return p.pos!==g},rn.regexp_eatExtendedPatternCharacter=function(p){var g=p.current();return g!==-1&&g!==36&&!(g>=40&&g<=43)&&g!==46&&g!==63&&g!==91&&g!==94&&g!==124?(p.advance(),!0):!1},rn.regexp_groupSpecifier=function(p){if(p.eat(63)){if(this.regexp_eatGroupName(p)){p.groupNames.indexOf(p.lastStringValue)!==-1&&p.raise("Duplicate capture group name"),p.groupNames.push(p.lastStringValue);return}p.raise("Invalid group")}},rn.regexp_eatGroupName=function(p){if(p.lastStringValue="",p.eat(60)){if(this.regexp_eatRegExpIdentifierName(p)&&p.eat(62))return!0;p.raise("Invalid capture group name")}return!1},rn.regexp_eatRegExpIdentifierName=function(p){if(p.lastStringValue="",this.regexp_eatRegExpIdentifierStart(p)){for(p.lastStringValue+=Pu(p.lastIntValue);this.regexp_eatRegExpIdentifierPart(p);)p.lastStringValue+=Pu(p.lastIntValue);return!0}return!1},rn.regexp_eatRegExpIdentifierStart=function(p){var g=p.pos,w=this.options.ecmaVersion>=11,_=p.current(w);return p.advance(w),_===92&&this.regexp_eatRegExpUnicodeEscapeSequence(p,w)&&(_=p.lastIntValue),as(_)?(p.lastIntValue=_,!0):(p.pos=g,!1)};function as(p){return Ue(p,!0)||p===36||p===95}rn.regexp_eatRegExpIdentifierPart=function(p){var g=p.pos,w=this.options.ecmaVersion>=11,_=p.current(w);return p.advance(w),_===92&&this.regexp_eatRegExpUnicodeEscapeSequence(p,w)&&(_=p.lastIntValue),oi(_)?(p.lastIntValue=_,!0):(p.pos=g,!1)};function oi(p){return pt(p,!0)||p===36||p===95||p===8204||p===8205}rn.regexp_eatAtomEscape=function(p){return this.regexp_eatBackReference(p)||this.regexp_eatCharacterClassEscape(p)||this.regexp_eatCharacterEscape(p)||p.switchN&&this.regexp_eatKGroupName(p)?!0:(p.switchU&&(p.current()===99&&p.raise("Invalid unicode escape"),p.raise("Invalid escape")),!1)},rn.regexp_eatBackReference=function(p){var g=p.pos;if(this.regexp_eatDecimalEscape(p)){var w=p.lastIntValue;if(p.switchU)return w>p.maxBackReference&&(p.maxBackReference=w),!0;if(w<=p.numCapturingParens)return!0;p.pos=g}return!1},rn.regexp_eatKGroupName=function(p){if(p.eat(107)){if(this.regexp_eatGroupName(p))return p.backReferenceNames.push(p.lastStringValue),!0;p.raise("Invalid named reference")}return!1},rn.regexp_eatCharacterEscape=function(p){return this.regexp_eatControlEscape(p)||this.regexp_eatCControlLetter(p)||this.regexp_eatZero(p)||this.regexp_eatHexEscapeSequence(p)||this.regexp_eatRegExpUnicodeEscapeSequence(p,!1)||!p.switchU&&this.regexp_eatLegacyOctalEscapeSequence(p)||this.regexp_eatIdentityEscape(p)},rn.regexp_eatCControlLetter=function(p){var g=p.pos;if(p.eat(99)){if(this.regexp_eatControlLetter(p))return!0;p.pos=g}return!1},rn.regexp_eatZero=function(p){return p.current()===48&&!uu(p.lookahead())?(p.lastIntValue=0,p.advance(),!0):!1},rn.regexp_eatControlEscape=function(p){var g=p.current();return g===116?(p.lastIntValue=9,p.advance(),!0):g===110?(p.lastIntValue=10,p.advance(),!0):g===118?(p.lastIntValue=11,p.advance(),!0):g===102?(p.lastIntValue=12,p.advance(),!0):g===114?(p.lastIntValue=13,p.advance(),!0):!1},rn.regexp_eatControlLetter=function(p){var g=p.current();return Vs(g)?(p.lastIntValue=g%32,p.advance(),!0):!1};function Vs(p){return p>=65&&p<=90||p>=97&&p<=122}rn.regexp_eatRegExpUnicodeEscapeSequence=function(p,g){g===void 0&&(g=!1);var w=p.pos,_=g||p.switchU;if(p.eat(117)){if(this.regexp_eatFixedHexDigits(p,4)){var F=p.lastIntValue;if(_&&F>=55296&&F<=56319){var ae=p.pos;if(p.eat(92)&&p.eat(117)&&this.regexp_eatFixedHexDigits(p,4)){var Ee=p.lastIntValue;if(Ee>=56320&&Ee<=57343)return p.lastIntValue=(F-55296)*1024+(Ee-56320)+65536,!0}p.pos=ae,p.lastIntValue=F}return!0}if(_&&p.eat(123)&&this.regexp_eatHexDigits(p)&&p.eat(125)&&st(p.lastIntValue))return!0;_&&p.raise("Invalid unicode escape"),p.pos=w}return!1};function st(p){return p>=0&&p<=1114111}rn.regexp_eatIdentityEscape=function(p){if(p.switchU)return this.regexp_eatSyntaxCharacter(p)?!0:p.eat(47)?(p.lastIntValue=47,!0):!1;var g=p.current();return g!==99&&(!p.switchN||g!==107)?(p.lastIntValue=g,p.advance(),!0):!1},rn.regexp_eatDecimalEscape=function(p){p.lastIntValue=0;var g=p.current();if(g>=49&&g<=57){do p.lastIntValue=10*p.lastIntValue+(g-48),p.advance();while((g=p.current())>=48&&g<=57);return!0}return!1},rn.regexp_eatCharacterClassEscape=function(p){var g=p.current();if(Hs(g))return p.lastIntValue=-1,p.advance(),!0;if(p.switchU&&this.options.ecmaVersion>=9&&(g===80||g===112)){if(p.lastIntValue=-1,p.advance(),p.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(p)&&p.eat(125))return!0;p.raise("Invalid property name")}return!1};function Hs(p){return p===100||p===68||p===115||p===83||p===119||p===87}rn.regexp_eatUnicodePropertyValueExpression=function(p){var g=p.pos;if(this.regexp_eatUnicodePropertyName(p)&&p.eat(61)){var w=p.lastStringValue;if(this.regexp_eatUnicodePropertyValue(p)){var _=p.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(p,w,_),!0}}if(p.pos=g,this.regexp_eatLoneUnicodePropertyNameOrValue(p)){var F=p.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(p,F),!0}return!1},rn.regexp_validateUnicodePropertyNameAndValue=function(p,g,w){ne(p.unicodeProperties.nonBinary,g)||p.raise("Invalid property name"),p.unicodeProperties.nonBinary[g].test(w)||p.raise("Invalid property value")},rn.regexp_validateUnicodePropertyNameOrValue=function(p,g){p.unicodeProperties.binary.test(g)||p.raise("Invalid property name")},rn.regexp_eatUnicodePropertyName=function(p){var g=0;for(p.lastStringValue="";q(g=p.current());)p.lastStringValue+=Pu(g),p.advance();return p.lastStringValue!==""};function q(p){return Vs(p)||p===95}rn.regexp_eatUnicodePropertyValue=function(p){var g=0;for(p.lastStringValue="";Iu(g=p.current());)p.lastStringValue+=Pu(g),p.advance();return p.lastStringValue!==""};function Iu(p){return q(p)||uu(p)}rn.regexp_eatLoneUnicodePropertyNameOrValue=function(p){return this.regexp_eatUnicodePropertyValue(p)},rn.regexp_eatCharacterClass=function(p){if(p.eat(91)){if(p.eat(94),this.regexp_classRanges(p),p.eat(93))return!0;p.raise("Unterminated character class")}return!1},rn.regexp_classRanges=function(p){for(;this.regexp_eatClassAtom(p);){var g=p.lastIntValue;if(p.eat(45)&&this.regexp_eatClassAtom(p)){var w=p.lastIntValue;p.switchU&&(g===-1||w===-1)&&p.raise("Invalid character class"),g!==-1&&w!==-1&&g>w&&p.raise("Range out of order in character class")}}},rn.regexp_eatClassAtom=function(p){var g=p.pos;if(p.eat(92)){if(this.regexp_eatClassEscape(p))return!0;if(p.switchU){var w=p.current();(w===99||La(w))&&p.raise("Invalid class escape"),p.raise("Invalid escape")}p.pos=g}var _=p.current();return _!==93?(p.lastIntValue=_,p.advance(),!0):!1},rn.regexp_eatClassEscape=function(p){var g=p.pos;if(p.eat(98))return p.lastIntValue=8,!0;if(p.switchU&&p.eat(45))return p.lastIntValue=45,!0;if(!p.switchU&&p.eat(99)){if(this.regexp_eatClassControlLetter(p))return!0;p.pos=g}return this.regexp_eatCharacterClassEscape(p)||this.regexp_eatCharacterEscape(p)},rn.regexp_eatClassControlLetter=function(p){var g=p.current();return uu(g)||g===95?(p.lastIntValue=g%32,p.advance(),!0):!1},rn.regexp_eatHexEscapeSequence=function(p){var g=p.pos;if(p.eat(120)){if(this.regexp_eatFixedHexDigits(p,2))return!0;p.switchU&&p.raise("Invalid escape"),p.pos=g}return!1},rn.regexp_eatDecimalDigits=function(p){var g=p.pos,w=0;for(p.lastIntValue=0;uu(w=p.current());)p.lastIntValue=10*p.lastIntValue+(w-48),p.advance();return p.pos!==g};function uu(p){return p>=48&&p<=57}rn.regexp_eatHexDigits=function(p){var g=p.pos,w=0;for(p.lastIntValue=0;ko(w=p.current());)p.lastIntValue=16*p.lastIntValue+Ou(w),p.advance();return p.pos!==g};function ko(p){return p>=48&&p<=57||p>=65&&p<=70||p>=97&&p<=102}function Ou(p){return p>=65&&p<=70?10+(p-65):p>=97&&p<=102?10+(p-97):p-48}rn.regexp_eatLegacyOctalEscapeSequence=function(p){if(this.regexp_eatOctalDigit(p)){var g=p.lastIntValue;if(this.regexp_eatOctalDigit(p)){var w=p.lastIntValue;g<=3&&this.regexp_eatOctalDigit(p)?p.lastIntValue=g*64+w*8+p.lastIntValue:p.lastIntValue=g*8+w}else p.lastIntValue=g;return!0}return!1},rn.regexp_eatOctalDigit=function(p){var g=p.current();return La(g)?(p.lastIntValue=g-48,p.advance(),!0):(p.lastIntValue=0,!1)};function La(p){return p>=48&&p<=55}rn.regexp_eatFixedHexDigits=function(p,g){var w=p.pos;p.lastIntValue=0;for(var _=0;_<g;++_){var F=p.current();if(!ko(F))return p.pos=w,!1;p.lastIntValue=16*p.lastIntValue+Ou(F),p.advance()}return!0};var Pa=function(g){this.type=g.type,this.value=g.value,this.start=g.start,this.end=g.end,g.options.locations&&(this.loc=new de(g,g.startLoc,g.endLoc)),g.options.ranges&&(this.range=[g.start,g.end])},dn=Ne.prototype;dn.next=function(p){!p&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Pa(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},dn.getToken=function(){return this.next(),new Pa(this)},typeof Symbol!="undefined"&&(dn[Symbol.iterator]=function(){var p=this;return{next:function(){var g=p.getToken();return{done:g.type===I.eof,value:g}}}}),dn.curContext=function(){return this.context[this.context.length-1]},dn.nextToken=function(){var p=this.curContext();if((!p||!p.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(I.eof);if(p.override)return p.override(this);this.readToken(this.fullCharCodeAtPos())},dn.readToken=function(p){return Ue(p,this.options.ecmaVersion>=6)||p===92?this.readWord():this.getTokenFromCode(p)},dn.fullCharCodeAtPos=function(){var p=this.input.charCodeAt(this.pos);if(p<=55295||p>=57344)return p;var g=this.input.charCodeAt(this.pos+1);return(p<<10)+g-56613888},dn.skipBlockComment=function(){var p=this.options.onComment&&this.curPosition(),g=this.pos,w=this.input.indexOf("*/",this.pos+=2);if(w===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=w+2,this.options.locations){Fe.lastIndex=g;for(var _;(_=Fe.exec(this.input))&&_.index<this.pos;)++this.curLine,this.lineStart=_.index+_[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(g+2,w),g,this.pos,p,this.curPosition())},dn.skipLineComment=function(p){for(var g=this.pos,w=this.options.onComment&&this.curPosition(),_=this.input.charCodeAt(this.pos+=p);this.pos<this.input.length&&!ge(_);)_=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(g+p,this.pos),g,this.pos,w,this.curPosition())},dn.skipSpace=function(){e:for(;this.pos<this.input.length;){var p=this.input.charCodeAt(this.pos);switch(p){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(p>8&&p<14||p>=5760&&je.test(String.fromCharCode(p)))++this.pos;else break e}}},dn.finishToken=function(p,g){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var w=this.type;this.type=p,this.value=g,this.updateContext(w)},dn.readToken_dot=function(){var p=this.input.charCodeAt(this.pos+1);if(p>=48&&p<=57)return this.readNumber(!0);var g=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&p===46&&g===46?(this.pos+=3,this.finishToken(I.ellipsis)):(++this.pos,this.finishToken(I.dot))},dn.readToken_slash=function(){var p=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):p===61?this.finishOp(I.assign,2):this.finishOp(I.slash,1)},dn.readToken_mult_modulo_exp=function(p){var g=this.input.charCodeAt(this.pos+1),w=1,_=p===42?I.star:I.modulo;return this.options.ecmaVersion>=7&&p===42&&g===42&&(++w,_=I.starstar,g=this.input.charCodeAt(this.pos+2)),g===61?this.finishOp(I.assign,w+1):this.finishOp(_,w)},dn.readToken_pipe_amp=function(p){var g=this.input.charCodeAt(this.pos+1);if(g===p){if(this.options.ecmaVersion>=12){var w=this.input.charCodeAt(this.pos+2);if(w===61)return this.finishOp(I.assign,3)}return this.finishOp(p===124?I.logicalOR:I.logicalAND,2)}return g===61?this.finishOp(I.assign,2):this.finishOp(p===124?I.bitwiseOR:I.bitwiseAND,1)},dn.readToken_caret=function(){var p=this.input.charCodeAt(this.pos+1);return p===61?this.finishOp(I.assign,2):this.finishOp(I.bitwiseXOR,1)},dn.readToken_plus_min=function(p){var g=this.input.charCodeAt(this.pos+1);return g===p?g===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||ht.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(I.incDec,2):g===61?this.finishOp(I.assign,2):this.finishOp(I.plusMin,1)},dn.readToken_lt_gt=function(p){var g=this.input.charCodeAt(this.pos+1),w=1;return g===p?(w=p===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+w)===61?this.finishOp(I.assign,w+1):this.finishOp(I.bitShift,w)):g===33&&p===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(g===61&&(w=2),this.finishOp(I.relational,w))},dn.readToken_eq_excl=function(p){var g=this.input.charCodeAt(this.pos+1);return g===61?this.finishOp(I.equality,this.input.charCodeAt(this.pos+2)===61?3:2):p===61&&g===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(I.arrow)):this.finishOp(p===61?I.eq:I.prefix,1)},dn.readToken_question=function(){var p=this.options.ecmaVersion;if(p>=11){var g=this.input.charCodeAt(this.pos+1);if(g===46){var w=this.input.charCodeAt(this.pos+2);if(w<48||w>57)return this.finishOp(I.questionDot,2)}if(g===63){if(p>=12){var _=this.input.charCodeAt(this.pos+2);if(_===61)return this.finishOp(I.assign,3)}return this.finishOp(I.coalesce,2)}}return this.finishOp(I.question,1)},dn.getTokenFromCode=function(p){switch(p){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(I.parenL);case 41:return++this.pos,this.finishToken(I.parenR);case 59:return++this.pos,this.finishToken(I.semi);case 44:return++this.pos,this.finishToken(I.comma);case 91:return++this.pos,this.finishToken(I.bracketL);case 93:return++this.pos,this.finishToken(I.bracketR);case 123:return++this.pos,this.finishToken(I.braceL);case 125:return++this.pos,this.finishToken(I.braceR);case 58:return++this.pos,this.finishToken(I.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(I.backQuote);case 48:var g=this.input.charCodeAt(this.pos+1);if(g===120||g===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(g===111||g===79)return this.readRadixNumber(8);if(g===98||g===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(p);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(p);case 124:case 38:return this.readToken_pipe_amp(p);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(p);case 60:case 62:return this.readToken_lt_gt(p);case 61:case 33:return this.readToken_eq_excl(p);case 63:return this.readToken_question();case 126:return this.finishOp(I.prefix,1)}this.raise(this.pos,"Unexpected character '"+su(p)+"'")},dn.finishOp=function(p,g){var w=this.input.slice(this.pos,this.pos+g);return this.pos+=g,this.finishToken(p,w)},dn.readRegexp=function(){for(var p,g,w=this.pos;;){this.pos>=this.input.length&&this.raise(w,"Unterminated regular expression");var _=this.input.charAt(this.pos);if(ht.test(_)&&this.raise(w,"Unterminated regular expression"),p)p=!1;else{if(_==="[")g=!0;else if(_==="]"&&g)g=!1;else if(_==="/"&&!g)break;p=_==="\\"}++this.pos}var F=this.input.slice(w,this.pos);++this.pos;var ae=this.pos,Ee=this.readWord1();this.containsEsc&&this.unexpected(ae);var Qe=this.regexpState||(this.regexpState=new aa(this));Qe.reset(w,F,Ee),this.validateRegExpFlags(Qe),this.validateRegExpPattern(Qe);var et=null;try{et=new RegExp(F,Ee)}catch(Nt){}return this.finishToken(I.regexp,{pattern:F,flags:Ee,value:et})},dn.readInt=function(p,g,w){for(var _=this.options.ecmaVersion>=12&&g===void 0,F=w&&this.input.charCodeAt(this.pos)===48,ae=this.pos,Ee=0,Qe=0,et=0,Nt=g==null?Infinity:g;et<Nt;++et,++this.pos){var $t=this.input.charCodeAt(this.pos),Hr=void 0;if(_&&$t===95){F&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),Qe===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),et===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Qe=$t;continue}if($t>=97?Hr=$t-97+10:$t>=65?Hr=$t-65+10:$t>=48&&$t<=57?Hr=$t-48:Hr=Infinity,Hr>=p)break;Qe=$t,Ee=Ee*p+Hr}return _&&Qe===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===ae||g!=null&&this.pos-ae!==g?null:Ee};function po(p,g){return g?parseInt(p,8):parseFloat(p.replace(/_/g,""))}function jo(p){return typeof BigInt!="function"?null:BigInt(p.replace(/_/g,""))}dn.readRadixNumber=function(p){var g=this.pos;this.pos+=2;var w=this.readInt(p);return w==null&&this.raise(this.start+2,"Expected number in radix "+p),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(w=jo(this.input.slice(g,this.pos)),++this.pos):Ue(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(I.num,w)},dn.readNumber=function(p){var g=this.pos;!p&&this.readInt(10,void 0,!0)===null&&this.raise(g,"Invalid number");var w=this.pos-g>=2&&this.input.charCodeAt(g)===48;w&&this.strict&&this.raise(g,"Invalid number");var _=this.input.charCodeAt(this.pos);if(!w&&!p&&this.options.ecmaVersion>=11&&_===110){var F=jo(this.input.slice(g,this.pos));return++this.pos,Ue(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(I.num,F)}w&&/[89]/.test(this.input.slice(g,this.pos))&&(w=!1),_===46&&!w&&(++this.pos,this.readInt(10),_=this.input.charCodeAt(this.pos)),(_===69||_===101)&&!w&&(_=this.input.charCodeAt(++this.pos),(_===43||_===45)&&++this.pos,this.readInt(10)===null&&this.raise(g,"Invalid number")),Ue(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var ae=po(this.input.slice(g,this.pos),w);return this.finishToken(I.num,ae)},dn.readCodePoint=function(){var p=this.input.charCodeAt(this.pos),g;if(p===123){this.options.ecmaVersion<6&&this.unexpected();var w=++this.pos;g=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,g>1114111&&this.invalidStringToken(w,"Code point out of bounds")}else g=this.readHexChar(4);return g};function su(p){return p<=65535?String.fromCharCode(p):(p-=65536,String.fromCharCode((p>>10)+55296,(p&1023)+56320))}dn.readString=function(p){for(var g="",w=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var _=this.input.charCodeAt(this.pos);if(_===p)break;_===92?(g+=this.input.slice(w,this.pos),g+=this.readEscapedChar(!1),w=this.pos):(ge(_,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return g+=this.input.slice(w,this.pos++),this.finishToken(I.string,g)};var os={};dn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(p){if(p===os)this.readInvalidTemplateToken();else throw p}this.inTemplateElement=!1},dn.invalidStringToken=function(p,g){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw os;this.raise(p,g)},dn.readTmplToken=function(){for(var p="",g=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var w=this.input.charCodeAt(this.pos);if(w===96||w===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===I.template||this.type===I.invalidTemplate)?w===36?(this.pos+=2,this.finishToken(I.dollarBraceL)):(++this.pos,this.finishToken(I.backQuote)):(p+=this.input.slice(g,this.pos),this.finishToken(I.template,p));if(w===92)p+=this.input.slice(g,this.pos),p+=this.readEscapedChar(!0),g=this.pos;else if(ge(w)){switch(p+=this.input.slice(g,this.pos),++this.pos,w){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:p+=`
`;break;default:p+=String.fromCharCode(w);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),g=this.pos}else++this.pos}},dn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(I.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},dn.readEscapedChar=function(p){var g=this.input.charCodeAt(++this.pos);switch(++this.pos,g){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return su(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(p){var w=this.pos-1;return this.invalidStringToken(w,"Invalid escape sequence in template string"),null}default:if(g>=48&&g<=55){var _=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],F=parseInt(_,8);return F>255&&(_=_.slice(0,-1),F=parseInt(_,8)),this.pos+=_.length-1,g=this.input.charCodeAt(this.pos),(_!=="0"||g===56||g===57)&&(this.strict||p)&&this.invalidStringToken(this.pos-1-_.length,p?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(F)}return ge(g)?"":String.fromCharCode(g)}},dn.readHexChar=function(p){var g=this.pos,w=this.readInt(16,p);return w===null&&this.invalidStringToken(g,"Bad character escape sequence"),w},dn.readWord1=function(){this.containsEsc=!1;for(var p="",g=!0,w=this.pos,_=this.options.ecmaVersion>=6;this.pos<this.input.length;){var F=this.fullCharCodeAtPos();if(pt(F,_))this.pos+=F<=65535?1:2;else if(F===92){this.containsEsc=!0,p+=this.input.slice(w,this.pos);var ae=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Ee=this.readCodePoint();(g?Ue:pt)(Ee,_)||this.invalidStringToken(ae,"Invalid Unicode escape"),p+=su(Ee),w=this.pos}else break;g=!1}return p+this.input.slice(w,this.pos)},dn.readWord=function(){var p=this.readWord1(),g=I.name;return this.keywords.test(p)&&(g=Ke[p]),this.finishToken(g,p)};var Wo="7.4.1";Ne.acorn={Parser:Ne,version:Wo,defaultOptions:we,Position:b,SourceLocation:de,getLineInfo:Te,Node:en,TokenType:Ge,tokTypes:I,keywordTypes:Ke,TokContext:di,tokContexts:Yn,isIdentifierChar:pt,isIdentifierStart:Ue,Token:Pa,isNewLine:ge,lineBreak:ht,lineBreakG:Fe,nonASCIIwhitespace:je};function gi(p,g){return Ne.parse(p,g)}function $o(p,g,w){return Ne.parseExpressionAt(p,g,w)}function vo(p,g){return Ne.tokenizer(p,g)}function Hi(p,g){p.prototype=Object.create(g.prototype),p.prototype.constructor=p,p.__proto__=g}function fa(p){var g=typeof Map=="function"?new Map:void 0;return fa=function(_){if(_===null||!us(_))return _;if(typeof _!="function")throw new TypeError("Super expression must either be null or a function");if(typeof g!="undefined"){if(g.has(_))return g.get(_);g.set(_,F)}function F(){return oa(_,arguments,$a(this).constructor)}return F.prototype=Object.create(_.prototype,{constructor:{value:F,enumerable:!1,writable:!0,configurable:!0}}),Xo(F,_)},fa(p)}function ha(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(p){return!1}}function oa(p,g,w){return ha()?oa=Reflect.construct:oa=function(F,ae,Ee){var Qe=[null];Qe.push.apply(Qe,ae);var et=Function.bind.apply(F,Qe),Nt=new et;return Ee&&Xo(Nt,Ee.prototype),Nt},oa.apply(null,arguments)}function us(p){return Function.toString.call(p).indexOf("[native code]")!==-1}function Xo(p,g){return Xo=Object.setPrototypeOf||function(_,F){return _.__proto__=F,_},Xo(p,g)}function $a(p){return $a=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)},$a(p)}var ua=function(p){Hi(g,p);function g(){return p.apply(this,arguments)||this}return g}(fa(Error)),Xa=function(p){Hi(g,p);function g(){return p.apply(this,arguments)||this}return g}(fa(SyntaxError)),Ia=function(p){Hi(g,p);function g(){return p.apply(this,arguments)||this}return g}(fa(ReferenceError)),ku=function(p){Hi(g,p);function g(){return p.apply(this,arguments)||this}return g}(fa(TypeError)),lu=function(p){Hi(g,p);function g(){return p.apply(this,arguments)||this}return g}(ua),Oa=function(p){Hi(g,p);function g(){return p.apply(this,arguments)||this}return g}(Xa),Fi=function(p){Hi(g,p);function g(){return p.apply(this,arguments)||this}return g}(Ia),ri={UnknownError:[3001,"%0",lu],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",lu],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Fi],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Fi],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Fi],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Fi],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Fi],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Fi],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Fi],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Fi],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Fi],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Fi],FunctionUndefinedReferenceError:[2001,"%0 is not a function",Ia],VariableUndefinedReferenceError:[2002,"%0 is not defined",Ia],IsNotConstructor:[2003,"%0 is not a constructor",ku]};function Yo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(p){return!1}}function mo(p,g,w){return Yo()?mo=Reflect.construct:mo=function(F,ae,Ee){var Qe=[null];Qe.push.apply(Qe,ae);var et=Function.bind.apply(F,Qe),Nt=new et;return Ee&&Fo(Nt,Ee.prototype),Nt},mo.apply(null,arguments)}function Fo(p,g){return Fo=Object.setPrototypeOf||function(_,F){return _.__proto__=F,_},Fo(p,g)}var ot="0.0.3";function at(p,g){Object.defineProperty(p,"name",{value:g,writable:!1,enumerable:!1,configurable:!0})}var R=Object.prototype.hasOwnProperty,z=Symbol("Break"),ee=Symbol("Continue"),Pe=Symbol("DefaultCase"),dt=Symbol("EmptyStatementReturn"),nr=Symbol("WithScopeName"),kr=Symbol("SuperScopeName"),Tn=Symbol("RootScopeName"),Ai=Symbol("GlobalScopeName");function yi(p){return typeof p=="function"}var Ot=function(){function p(w){this.interpreter=w}var g=p.prototype;return g.generator=function(){var _=this.interpreter;function F(){return this.getCurrentScope()}function ae(){return this.getGlobalScope()}function Ee(){return this.getCurrentContext()}return{getOptions:_.getOptions.bind(_),getCurrentScope:F.bind(_),getGlobalScope:ae.bind(_),getCurrentContext:Ee.bind(_),getExecStartTime:_.getExecStartTime.bind(_)}},p}();function zt(p,g,w){if(w===void 0&&(w=!0),!(p instanceof Ot))throw new Error("Illegal call");if(typeof g!="string")return g;if(!!g){var _=p.generator(),F=_.getOptions(),ae={timeout:F.timeout,_initEnv:function(){w||this.setCurrentContext(_.getCurrentContext()),this.execStartTime=_.getExecStartTime(),this.execEndTime=this.execStartTime}},Ee=w?_.getGlobalScope():_.getCurrentScope(),Qe=new Cn(Ee,ae);return Qe.evaluate(g)}}Object.defineProperty(zt,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function be(p){if(!(p instanceof Ot))throw new Error("Illegal call");for(var g=p.generator(),w=arguments.length,_=new Array(w>1?w-1:0),F=1;F<w;F++)_[F-1]=arguments[F];var ae=_.pop(),Ee=new Cn(g.getGlobalScope(),g.getOptions()),Qe=`
		    (function anonymous(`+_.join(",")+`){
		        `+ae+`
		    });
		    `;return Ee.evaluate(Qe)}Object.defineProperty(be,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var Ya=function(g){this.value=g},cu=function(g){this.value=g},go=function(g){this.value=g},Ka=function(g,w,_){w===void 0&&(w=null),this.name=_,this.parent=w,this.data=g,this.labelStack=[]};function Fu(){}function qa(p,g){return p===void 0&&(p=null),new Ka(Object.create(null),p,g)}function Ll(p){return Object.create(p)}var yo={NaN:NaN,Infinity:Infinity,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:zt,Function:be};typeof JSON!="undefined"&&(yo.JSON=JSON),typeof Promise!="undefined"&&(yo.Promise=Promise),typeof Set!="undefined"&&(yo.Set=Set),typeof Map!="undefined"&&(yo.Map=Map),typeof Symbol!="undefined"&&(yo.Symbol=Symbol),typeof Proxy!="undefined"&&(yo.Proxy=Proxy),typeof WeakMap!="undefined"&&(yo.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(yo.WeakSet=WeakSet),typeof Reflect!="undefined"&&(yo.Reflect=Reflect);var Cn=function(){function p(w,_){w===void 0&&(w=p.global),_===void 0&&(_={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:_.ecmaVersion||p.ecmaVersion,timeout:_.timeout||0,rootContext:_.rootContext,globalContextInFunction:_.globalContextInFunction===void 0?p.globalContextInFunction:_.globalContextInFunction,_initEnv:_._initEnv},this.context=w||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var g=p.prototype;return g.initEnvironment=function(_){var F;if(_ instanceof Ka)F=_;else{var ae=null,Ee=this.createSuperScope(_);this.options.rootContext&&(ae=new Ka(Ll(this.options.rootContext),Ee,Tn)),F=new Ka(_,ae||Ee,Ai)}this.globalScope=F,this.currentScope=this.globalScope,this.globalContext=F.data,this.currentContext=F.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var Qe=this.options._initEnv;Qe&&Qe.call(this)},g.getExecStartTime=function(){return this.execStartTime},g.getExecutionTime=function(){return this.execEndTime-this.execStartTime},g.setExecTimeout=function(_){_===void 0&&(_=0),this.options.timeout=_},g.getOptions=function(){return this.options},g.getGlobalScope=function(){return this.globalScope},g.getCurrentScope=function(){return this.currentScope},g.getCurrentContext=function(){return this.currentContext},g.isInterruptThrow=function(_){return _ instanceof lu||_ instanceof Fi||_ instanceof Oa},g.createSuperScope=function(_){var F=Object.assign({},yo),ae=Object.keys(F);return ae.forEach(function(Ee){Ee in _&&delete F[Ee]}),new Ka(F,null,kr)},g.setCurrentContext=function(_){this.currentContext=_},g.setCurrentScope=function(_){this.currentScope=_},g.evaluate=function(_){_===void 0&&(_="");var F;if(!!_)return F=gi(_,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||p.ecmaVersion}),this.evaluateNode(F,_)},g.appendCode=function(_){return this.evaluate(_)},g.evaluateNode=function(_,F){var ae=this;F===void 0&&(F=""),this.value=void 0,this.source=F,this.sourceList.push(F),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Ee=this.getCurrentScope(),Qe=this.getCurrentContext(),et=Ee.labelStack.concat([]),Nt=this.callStack.concat([]),$t=function(){ae.setCurrentScope(Ee),ae.setCurrentContext(Qe),Ee.labelStack=et,ae.callStack=Nt};try{var Hr=this.createClosure(_);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),Hr()}catch(cn){throw cn}finally{$t(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},g.createErrorMessage=function(_,F,ae){var Ee=_[1].replace("%0",String(F));return ae!==null&&(Ee+=this.getNodePosition(ae||this.lastExecNode)),Ee},g.createError=function(_,F){return new F(_)},g.createThrowError=function(_,F){return this.createError(_,F)},g.createInternalThrowError=function(_,F,ae){return this.createError(this.createErrorMessage(_,F,ae),_[2])},g.checkTimeout=function(){if(!this.isRunning)return!1;var _=this.options.timeout||0,F=Date.now();return F-this.execStartTime>_},g.getNodePosition=function(_){if(_){var F="";return _.loc?" ["+_.loc.start.line+":"+_.loc.start.column+"]"+F:""}return""},g.createClosure=function(_){var F=this,ae;switch(_.type){case"BinaryExpression":ae=this.binaryExpressionHandler(_);break;case"LogicalExpression":ae=this.logicalExpressionHandler(_);break;case"UnaryExpression":ae=this.unaryExpressionHandler(_);break;case"UpdateExpression":ae=this.updateExpressionHandler(_);break;case"ObjectExpression":ae=this.objectExpressionHandler(_);break;case"ArrayExpression":ae=this.arrayExpressionHandler(_);break;case"CallExpression":ae=this.callExpressionHandler(_);break;case"NewExpression":ae=this.newExpressionHandler(_);break;case"MemberExpression":ae=this.memberExpressionHandler(_);break;case"ThisExpression":ae=this.thisExpressionHandler(_);break;case"SequenceExpression":ae=this.sequenceExpressionHandler(_);break;case"Literal":ae=this.literalHandler(_);break;case"Identifier":ae=this.identifierHandler(_);break;case"AssignmentExpression":ae=this.assignmentExpressionHandler(_);break;case"FunctionDeclaration":ae=this.functionDeclarationHandler(_);break;case"VariableDeclaration":ae=this.variableDeclarationHandler(_);break;case"BlockStatement":case"Program":ae=this.programHandler(_);break;case"ExpressionStatement":ae=this.expressionStatementHandler(_);break;case"EmptyStatement":ae=this.emptyStatementHandler(_);break;case"ReturnStatement":ae=this.returnStatementHandler(_);break;case"FunctionExpression":ae=this.functionExpressionHandler(_);break;case"IfStatement":ae=this.ifStatementHandler(_);break;case"ConditionalExpression":ae=this.conditionalExpressionHandler(_);break;case"ForStatement":ae=this.forStatementHandler(_);break;case"WhileStatement":ae=this.whileStatementHandler(_);break;case"DoWhileStatement":ae=this.doWhileStatementHandler(_);break;case"ForInStatement":ae=this.forInStatementHandler(_);break;case"WithStatement":ae=this.withStatementHandler(_);break;case"ThrowStatement":ae=this.throwStatementHandler(_);break;case"TryStatement":ae=this.tryStatementHandler(_);break;case"ContinueStatement":ae=this.continueStatementHandler(_);break;case"BreakStatement":ae=this.breakStatementHandler(_);break;case"SwitchStatement":ae=this.switchStatementHandler(_);break;case"LabeledStatement":ae=this.labeledStatementHandler(_);break;case"DebuggerStatement":ae=this.debuggerStatementHandler(_);break;default:throw this.createInternalThrowError(ri.NodeTypeSyntaxError,_.type,_)}return function(){var Ee=F.options.timeout;if(Ee&&Ee>0&&F.checkTimeout())throw F.createInternalThrowError(ri.ExecutionTimeOutError,Ee,null);return F.lastExecNode=_,ae.apply(void 0,arguments)}},g.binaryExpressionHandler=function(_){var F=this,ae=this.createClosure(_.left),Ee=this.createClosure(_.right);return function(){var Qe=ae(),et=Ee();switch(_.operator){case"==":return Qe==et;case"!=":return Qe!=et;case"===":return Qe===et;case"!==":return Qe!==et;case"<":return Qe<et;case"<=":return Qe<=et;case">":return Qe>et;case">=":return Qe>=et;case"<<":return Qe<<et;case">>":return Qe>>et;case">>>":return Qe>>>et;case"+":return Qe+et;case"-":return Qe-et;case"*":return Qe*et;case"**":return Math.pow(Qe,et);case"/":return Qe/et;case"%":return Qe%et;case"|":return Qe|et;case"^":return Qe^et;case"&":return Qe&et;case"in":return Qe in et;case"instanceof":return Qe instanceof et;default:throw F.createInternalThrowError(ri.BinaryOperatorSyntaxError,_.operator,_)}}},g.logicalExpressionHandler=function(_){var F=this,ae=this.createClosure(_.left),Ee=this.createClosure(_.right);return function(){switch(_.operator){case"||":return ae()||Ee();case"&&":return ae()&&Ee();default:throw F.createInternalThrowError(ri.LogicalOperatorSyntaxError,_.operator,_)}}},g.unaryExpressionHandler=function(_){var F=this;switch(_.operator){case"delete":var ae=this.createObjectGetter(_.argument),Ee=this.createNameGetter(_.argument);return function(){var $t=ae(),Hr=Ee();return delete $t[Hr]};default:var Qe;if(_.operator==="typeof"&&_.argument.type==="Identifier"){var et=this.createObjectGetter(_.argument),Nt=this.createNameGetter(_.argument);Qe=function(){return et()[Nt()]}}else Qe=this.createClosure(_.argument);return function(){var $t=Qe();switch(_.operator){case"-":return-$t;case"+":return+$t;case"!":return!$t;case"~":return~$t;case"void":return;case"typeof":return typeof $t;default:throw F.createInternalThrowError(ri.UnaryOperatorSyntaxError,_.operator,_)}}}},g.updateExpressionHandler=function(_){var F=this,ae=this.createObjectGetter(_.argument),Ee=this.createNameGetter(_.argument);return function(){var Qe=ae(),et=Ee();switch(F.assertVariable(Qe,et,_),_.operator){case"++":return _.prefix?++Qe[et]:Qe[et]++;case"--":return _.prefix?--Qe[et]:Qe[et]--;default:throw F.createInternalThrowError(ri.UpdateOperatorSyntaxError,_.operator,_)}}},g.objectExpressionHandler=function(_){var F=this,ae=[];function Ee(et){return et.type==="Identifier"?et.name:et.type==="Literal"?et.value:this.throwError(ri.ObjectStructureSyntaxError,et.type,et)}var Qe=Object.create(null);return _.properties.forEach(function(et){var Nt=et.kind,$t=Ee(et.key);(!Qe[$t]||Nt==="init")&&(Qe[$t]={}),Qe[$t][Nt]=F.createClosure(et.value),ae.push({key:$t,property:et})}),function(){for(var et={},Nt=ae.length,$t=0;$t<Nt;$t++){var Hr=ae[$t],cn=Hr.key,jr=Qe[cn],Dn=jr.init?jr.init():void 0,yn=jr.get?jr.get():function(){},jn=jr.set?jr.set():function(_o){};if("set"in jr||"get"in jr){var Na={configurable:!0,enumerable:!0,get:yn,set:jn};Object.defineProperty(et,cn,Na)}else{var Si=Hr.property,xa=Si.kind;Si.key.type==="Identifier"&&Si.value.type==="FunctionExpression"&&xa==="init"&&!Si.value.id&&at(Dn,Si.key.name),et[cn]=Dn}}return et}},g.arrayExpressionHandler=function(_){var F=this,ae=_.elements.map(function(Ee){return Ee&&F.createClosure(Ee)});return function(){for(var Ee=ae.length,Qe=Array(Ee),et=0;et<Ee;et++){var Nt=ae[et];Nt&&(Qe[et]=Nt())}return Qe}},g.safeObjectGet=function(_,F,ae){return _[F]},g.createCallFunctionGetter=function(_){var F=this;switch(_.type){case"MemberExpression":var ae=this.createClosure(_.object),Ee=this.createMemberKeyGetter(_),Qe=this.source;return function(){var Nt=ae(),$t=Ee(),Hr=F.safeObjectGet(Nt,$t,_);if(!Hr||!yi(Hr)){var cn=Qe.slice(_.start,_.end);throw F.createInternalThrowError(ri.FunctionUndefinedReferenceError,cn,_)}return Hr.__IS_EVAL_FUNC?function(jr){return Hr(new Ot(F),jr,!0)}:Hr.__IS_FUNCTION_FUNC?function(){for(var jr=arguments.length,Dn=new Array(jr),yn=0;yn<jr;yn++)Dn[yn]=arguments[yn];return Hr.apply(void 0,[new Ot(F)].concat(Dn))}:Hr.bind(Nt)};default:var et=this.createClosure(_);return function(){var Nt="";_.type==="Identifier"&&(Nt=_.name);var $t=et();if(!$t||!yi($t))throw F.createInternalThrowError(ri.FunctionUndefinedReferenceError,Nt,_);if(_.type==="Identifier"&&$t.__IS_EVAL_FUNC&&Nt==="eval")return function(jr){var Dn=F.getScopeFromName(Nt,F.getCurrentScope()),yn=Dn.name===kr||Dn.name===Ai||Dn.name===Tn;return $t(new Ot(F),jr,!yn)};if($t.__IS_EVAL_FUNC)return function(jr){return $t(new Ot(F),jr,!0)};if($t.__IS_FUNCTION_FUNC)return function(){for(var jr=arguments.length,Dn=new Array(jr),yn=0;yn<jr;yn++)Dn[yn]=arguments[yn];return $t.apply(void 0,[new Ot(F)].concat(Dn))};var Hr=F.options.globalContextInFunction;if(_.type==="Identifier"){var cn=F.getIdentifierScope(_);cn.name===nr&&(Hr=cn.data)}return $t.bind(Hr)}}},g.callExpressionHandler=function(_){var F=this,ae=this.createCallFunctionGetter(_.callee),Ee=_.arguments.map(function(Qe){return F.createClosure(Qe)});return function(){return ae().apply(void 0,Ee.map(function(Qe){return Qe()}))}},g.functionExpressionHandler=function(_){var F=this,ae=this,Ee=this.source,Qe=this.collectDeclVars,et=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Nt=_.id?_.id.name:"",$t=_.params.length,Hr=_.params.map(function(yn){return F.createParamNameGetter(yn)}),cn=this.createClosure(_.body),jr=this.collectDeclVars,Dn=this.collectDeclFuncs;return this.collectDeclVars=Qe,this.collectDeclFuncs=et,function(){var yn=ae.getCurrentScope(),jn=function Na(){for(var Si=arguments.length,xa=new Array(Si),_o=0;_o<Si;_o++)xa[_o]=arguments[_o];ae.callStack.push(""+Nt);var ni=ae.getCurrentScope(),Sa=qa(yn,"FunctionScope("+Nt+")");ae.setCurrentScope(Sa),ae.addDeclarationsToScope(jr,Dn,Sa),Nt&&(Sa.data[Nt]=Na),Sa.data.arguments=arguments,Hr.forEach(function(Il,_c){Sa.data[Il()]=xa[_c]});var ls=ae.getCurrentContext();ae.setCurrentContext(this);var yc=cn();if(ae.setCurrentContext(ls),ae.setCurrentScope(ni),ae.callStack.pop(),yc instanceof Ya)return yc.value};return at(jn,Nt),Object.defineProperty(jn,"length",{value:$t,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(jn,"toString",{value:function(){return Ee.slice(_.start,_.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(jn,"valueOf",{value:function(){return Ee.slice(_.start,_.end)},writable:!0,configurable:!0,enumerable:!1}),jn}},g.newExpressionHandler=function(_){var F=this,ae=this.source,Ee=this.createClosure(_.callee),Qe=_.arguments.map(function(et){return F.createClosure(et)});return function(){var et=Ee();if(!yi(et)||et.__IS_EVAL_FUNC){var Nt=_.callee,$t=ae.slice(Nt.start,Nt.end);throw F.createInternalThrowError(ri.IsNotConstructor,$t,_)}return et.__IS_FUNCTION_FUNC?et.apply(void 0,[new Ot(F)].concat(Qe.map(function(Hr){return Hr()}))):mo(et,Qe.map(function(Hr){return Hr()}))}},g.memberExpressionHandler=function(_){var F=this.createClosure(_.object),ae=this.createMemberKeyGetter(_);return function(){var Ee=F(),Qe=ae();return Ee[Qe]}},g.thisExpressionHandler=function(_){var F=this;return function(){return F.getCurrentContext()}},g.sequenceExpressionHandler=function(_){var F=this,ae=_.expressions.map(function(Ee){return F.createClosure(Ee)});return function(){for(var Ee,Qe=ae.length,et=0;et<Qe;et++){var Nt=ae[et];Ee=Nt()}return Ee}},g.literalHandler=function(_){return function(){return _.regex?new RegExp(_.regex.pattern,_.regex.flags):_.value}},g.identifierHandler=function(_){var F=this;return function(){var ae=F.getCurrentScope(),Ee=F.getScopeDataFromName(_.name,ae);return F.assertVariable(Ee,_.name,_),Ee[_.name]}},g.getIdentifierScope=function(_){var F=this.getCurrentScope(),ae=this.getScopeFromName(_.name,F);return ae},g.assignmentExpressionHandler=function(_){var F=this;_.left.type==="Identifier"&&_.right.type==="FunctionExpression"&&!_.right.id&&(_.right.id={type:"Identifier",name:_.left.name});var ae=this.createObjectGetter(_.left),Ee=this.createNameGetter(_.left),Qe=this.createClosure(_.right);return function(){var et=ae(),Nt=Ee(),$t=Qe();switch(_.operator!=="="&&F.assertVariable(et,Nt,_),_.operator){case"=":return et[Nt]=$t;case"+=":return et[Nt]+=$t;case"-=":return et[Nt]-=$t;case"*=":return et[Nt]*=$t;case"**=":return et[Nt]=Math.pow(et[Nt],$t);case"/=":return et[Nt]/=$t;case"%=":return et[Nt]%=$t;case"<<=":return et[Nt]<<=$t;case">>=":return et[Nt]>>=$t;case">>>=":return et[Nt]>>>=$t;case"&=":return et[Nt]&=$t;case"^=":return et[Nt]^=$t;case"|=":return et[Nt]|=$t;default:throw F.createInternalThrowError(ri.AssignmentExpressionSyntaxError,_.type,_)}}},g.functionDeclarationHandler=function(_){if(_.id){var F=this.functionExpressionHandler(_);Object.defineProperty(F,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(_.id.name,F)}return function(){return dt}},g.getVariableName=function(_){if(_.type==="Identifier")return _.name;throw this.createInternalThrowError(ri.VariableTypeSyntaxError,_.type,_)},g.variableDeclarationHandler=function(_){for(var F=this,ae,Ee=[],Qe=0;Qe<_.declarations.length;Qe++){var et=_.declarations[Qe];this.varDeclaration(this.getVariableName(et.id)),et.init&&Ee.push({type:"AssignmentExpression",operator:"=",left:et.id,right:et.init})}return Ee.length&&(ae=this.createClosure({type:"BlockStatement",body:Ee})),function(){if(ae){var Nt=F.isVarDeclMode;F.isVarDeclMode=!0,ae(),F.isVarDeclMode=Nt}return dt}},g.assertVariable=function(_,F,ae){if(_===this.globalScope.data&&!(F in _))throw this.createInternalThrowError(ri.VariableUndefinedReferenceError,F,ae)},g.programHandler=function(_){var F=this,ae=_.body.map(function(Ee){return F.createClosure(Ee)});return function(){for(var Ee=dt,Qe=0;Qe<ae.length;Qe++){var et=ae[Qe],Nt=F.setValue(et());if(Nt!==dt&&(Ee=Nt,Ee instanceof Ya||Ee instanceof cu||Ee instanceof go||Ee===z||Ee===ee))break}return Ee}},g.expressionStatementHandler=function(_){return this.createClosure(_.expression)},g.emptyStatementHandler=function(_){return function(){return dt}},g.returnStatementHandler=function(_){var F=_.argument?this.createClosure(_.argument):Fu;return function(){return new Ya(F())}},g.ifStatementHandler=function(_){var F=this.createClosure(_.test),ae=this.createClosure(_.consequent),Ee=_.alternate?this.createClosure(_.alternate):function(){return dt};return function(){return F()?ae():Ee()}},g.conditionalExpressionHandler=function(_){return this.ifStatementHandler(_)},g.forStatementHandler=function(_){var F=this,ae=Fu,Ee=_.test?this.createClosure(_.test):function(){return!0},Qe=Fu,et=this.createClosure(_.body);return _.type==="ForStatement"&&(ae=_.init?this.createClosure(_.init):ae,Qe=_.update?this.createClosure(_.update):Fu),function(Nt){var $t,Hr=dt,cn=_.type==="DoWhileStatement";for(Nt&&Nt.type==="LabeledStatement"&&($t=Nt.label.name),ae();cn||Ee();Qe()){cn=!1;var jr=F.setValue(et());if(!(jr===dt||jr===ee)){if(jr===z)break;if(Hr=jr,Hr instanceof go&&Hr.value===$t){Hr=dt;continue}if(Hr instanceof Ya||Hr instanceof cu||Hr instanceof go)break}}return Hr}},g.whileStatementHandler=function(_){return this.forStatementHandler(_)},g.doWhileStatementHandler=function(_){return this.forStatementHandler(_)},g.forInStatementHandler=function(_){var F=this,ae=_.left,Ee=this.createClosure(_.right),Qe=this.createClosure(_.body);return _.left.type==="VariableDeclaration"&&(this.createClosure(_.left)(),ae=_.left.declarations[0].id),function(et){var Nt,$t=dt,Hr;et&&et.type==="LabeledStatement"&&(Nt=et.label.name);var cn=Ee();for(Hr in cn){F.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:ae,right:{type:"Literal",value:Hr}})();var jr=F.setValue(Qe());if(!(jr===dt||jr===ee)){if(jr===z)break;if($t=jr,$t instanceof go&&$t.value===Nt){$t=dt;continue}if($t instanceof Ya||$t instanceof cu||$t instanceof go)break}}return $t}},g.withStatementHandler=function(_){var F=this,ae=this.createClosure(_.object),Ee=this.createClosure(_.body);return function(){var Qe=ae(),et=F.getCurrentScope(),Nt=new Ka(Qe,et,nr);F.setCurrentScope(Nt);var $t=F.setValue(Ee());return F.setCurrentScope(et),$t}},g.throwStatementHandler=function(_){var F=this,ae=this.createClosure(_.argument);return function(){throw F.setValue(void 0),ae()}},g.tryStatementHandler=function(_){var F=this,ae=this.createClosure(_.block),Ee=_.handler?this.catchClauseHandler(_.handler):null,Qe=_.finalizer?this.createClosure(_.finalizer):null;return function(){var et=F.getCurrentScope(),Nt=F.getCurrentContext(),$t=et.labelStack.concat([]),Hr=F.callStack.concat([]),cn=dt,jr,Dn,yn=function(){F.setCurrentScope(et),F.setCurrentContext(Nt),et.labelStack=$t,F.callStack=Hr};try{cn=F.setValue(ae()),cn instanceof Ya&&(jr=cn)}catch(jn){if(yn(),F.isInterruptThrow(jn))throw jn;if(Ee)try{cn=F.setValue(Ee(jn)),cn instanceof Ya&&(jr=cn)}catch(Na){if(yn(),F.isInterruptThrow(Na))throw Na;Dn=Na}}if(Qe)try{cn=Qe(),cn instanceof Ya&&(jr=cn)}catch(jn){if(yn(),F.isInterruptThrow(jn))throw jn;Dn=jn}if(Dn)throw Dn;return jr||cn}},g.catchClauseHandler=function(_){var F=this,ae=this.createParamNameGetter(_.param),Ee=this.createClosure(_.body);return function(Qe){var et,Nt=F.getCurrentScope(),$t=Nt.data,Hr=ae(),cn=R.call($t,Hr),jr=$t[Hr];return $t[Hr]=Qe,et=Ee(),cn?$t[Hr]=jr:delete $t[Hr],et}},g.continueStatementHandler=function(_){return function(){return _.label?new go(_.label.name):ee}},g.breakStatementHandler=function(_){return function(){return _.label?new cu(_.label.name):z}},g.switchStatementHandler=function(_){var F=this,ae=this.createClosure(_.discriminant),Ee=_.cases.map(function(Qe){return F.switchCaseHandler(Qe)});return function(){for(var Qe=ae(),et=!1,Nt,$t,Hr,cn=0;cn<Ee.length;cn++){var jr=Ee[cn](),Dn=jr.testClosure();if(Dn===Pe){Hr=jr;continue}if(et||Dn===Qe){if(et=!0,$t=F.setValue(jr.bodyClosure()),$t===dt)continue;if($t===z||(Nt=$t,Nt instanceof Ya||Nt instanceof cu||Nt instanceof go||Nt===ee))break}}if(!et&&Hr){$t=F.setValue(Hr.bodyClosure());var yn=$t===dt||$t===z||$t===ee;yn||(Nt=$t)}return Nt}},g.switchCaseHandler=function(_){var F=_.test?this.createClosure(_.test):function(){return Pe},ae=this.createClosure({type:"BlockStatement",body:_.consequent});return function(){return{testClosure:F,bodyClosure:ae}}},g.labeledStatementHandler=function(_){var F=this,ae=_.label.name,Ee=this.createClosure(_.body);return function(){var Qe,et=F.getCurrentScope();return et.labelStack.push(ae),Qe=Ee(_),Qe instanceof cu&&Qe.value===ae&&(Qe=dt),et.labelStack.pop(),Qe}},g.debuggerStatementHandler=function(_){return function(){debugger;return dt}},g.createParamNameGetter=function(_){if(_.type==="Identifier")return function(){return _.name};throw this.createInternalThrowError(ri.ParamTypeSyntaxError,_.type,_)},g.createObjectKeyGetter=function(_){var F;return _.type==="Identifier"?F=function(){return _.name}:F=this.createClosure(_),function(){return F()}},g.createMemberKeyGetter=function(_){return _.computed?this.createClosure(_.property):this.createObjectKeyGetter(_.property)},g.createObjectGetter=function(_){var F=this;switch(_.type){case"Identifier":return function(){return F.getScopeDataFromName(_.name,F.getCurrentScope())};case"MemberExpression":return this.createClosure(_.object);default:throw this.createInternalThrowError(ri.AssignmentTypeSyntaxError,_.type,_)}},g.createNameGetter=function(_){switch(_.type){case"Identifier":return function(){return _.name};case"MemberExpression":return this.createMemberKeyGetter(_);default:throw this.createInternalThrowError(ri.AssignmentTypeSyntaxError,_.type,_)}},g.varDeclaration=function(_){var F=this.collectDeclVars;F[_]=void 0},g.funcDeclaration=function(_,F){var ae=this.collectDeclFuncs;ae[_]=F},g.addDeclarationsToScope=function(_,F,ae){var Ee=ae.data;for(var Qe in F){var et=F[Qe];Ee[Qe]=et&&et()}for(var Nt in _)Nt in Ee||(Ee[Nt]=void 0)},g.getScopeValue=function(_,F){var ae=this.getScopeFromName(_,F);return ae.data[_]},g.getScopeDataFromName=function(_,F){return this.getScopeFromName(_,F).data},g.getScopeFromName=function(_,F){var ae=F;do if(_ in ae.data)return ae;while(ae=ae.parent);return this.globalScope},g.setValue=function(_){var F=this.callStack.length;return this.isVarDeclMode||F||_===dt||_===z||_===ee||_ instanceof cu||_ instanceof go||(this.value=_ instanceof Ya?_.value:_),_},g.getValue=function(){return this.value},p}();Cn.version=ot,Cn.eval=zt,Cn.Function=be,Cn.ecmaVersion=5,Cn.globalContextInFunction=void 0,Cn.global=Object.create(null);function Jn(p){return p===void 0&&(p=Object.create(null)),p}function ss(p,g,w){g===void 0&&(g=[]),w===void 0&&(w={});var _=w.parsingContext,F=w.timeout===void 0?0:w.timeout,ae=`
    (function anonymous(`+g.join(",")+`){
         `+p+`
    });
    `,Ee=new Cn(_,{ecmaVersion:w.ecmaVersion,timeout:F,rootContext:w.rootContext,globalContextInFunction:w.globalContextInFunction});return Ee.evaluate(ae)}function Nu(p,g,w){var _=new Cn(g,w);return _.evaluate(p)}var ka=Nu,Pl=function(){function p(w){this._code=w}var g=p.prototype;return g.runInContext=function(_){return Nu(this._code,_)},g.runInNewContext=function(_){return Nu(this._code,_)},p}(),js=function(p,g,w){return Nu(p,g,w)};function Fa(){for(var p=arguments.length,g=new Array(p),w=0;w<p;w++)g[w]=arguments[w];var _=g.pop();return ss(_||"",g)}var pe=js},20396:function(rr,G,D){var oe;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(E,ce,J,U){"use strict";var re=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Y=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),se=re||Y,le=["","webkit","Moz","MS","ms","o"],ye=se?"":ce.createElement("div"),Ce="function",Oe=Math.round,Ue=Math.abs,pt=Date.now;function Ge(z,ee,Pe){return setTimeout(Fe(z,Pe),ee)}function lt(z,ee,Pe){return Array.isArray(z)?(Je(z,Pe[ee],Pe),!0):!1}function Je(z,ee,Pe){var dt;if(!!z)if(z.forEach)z.forEach(ee,Pe);else if(z.length!==U)for(dt=0;dt<z.length;)ee.call(Pe,z[dt],dt,z),dt++;else for(dt in z)z.hasOwnProperty(dt)&&ee.call(Pe,z[dt],dt,z)}function Ye(z,ee,Pe){var dt="DEPRECATED METHOD: "+ee+`
`+Pe+` AT 
`;return function(){var nr=new Error("get-stack-trace"),kr=nr&&nr.stack?nr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Tn=E.console&&(E.console.warn||E.console.log);return Tn&&Tn.call(E.console,dt,kr),z.apply(this,arguments)}}var Ke;typeof Object.assign!="function"?Ke=function(ee){if(ee===U||ee===null)throw new TypeError("Cannot convert undefined or null to object");for(var Pe=Object(ee),dt=1;dt<arguments.length;dt++){var nr=arguments[dt];if(nr!==U&&nr!==null)for(var kr in nr)nr.hasOwnProperty(kr)&&(Pe[kr]=nr[kr])}return Pe}:Ke=Object.assign;var xt=Ye(function(ee,Pe,dt){for(var nr=Object.keys(Pe),kr=0;kr<nr.length;)(!dt||dt&&ee[nr[kr]]===U)&&(ee[nr[kr]]=Pe[nr[kr]]),kr++;return ee},"extend","Use `assign`."),I=Ye(function(ee,Pe){return xt(ee,Pe,!0)},"merge","Use `assign`.");function ht(z,ee,Pe){var dt=ee.prototype,nr;nr=z.prototype=Object.create(dt),nr.constructor=z,nr._super=dt,Pe&&Ke(nr,Pe)}function Fe(z,ee){return function(){return z.apply(ee,arguments)}}function ge(z,ee){return typeof z==Ce?z.apply(ee&&ee[0]||U,ee):z}function je(z,ee){return z===U?ee:z}function Be(z,ee,Pe){Je(ne(ee),function(dt){z.addEventListener(dt,Pe,!1)})}function tt(z,ee,Pe){Je(ne(ee),function(dt){z.removeEventListener(dt,Pe,!1)})}function _t(z,ee){for(;z;){if(z==ee)return!0;z=z.parentNode}return!1}function k(z,ee){return z.indexOf(ee)>-1}function ne(z){return z.trim().split(/\s+/g)}function P(z,ee,Pe){if(z.indexOf&&!Pe)return z.indexOf(ee);for(var dt=0;dt<z.length;){if(Pe&&z[dt][Pe]==ee||!Pe&&z[dt]===ee)return dt;dt++}return-1}function L(z){return Array.prototype.slice.call(z,0)}function b(z,ee,Pe){for(var dt=[],nr=[],kr=0;kr<z.length;){var Tn=ee?z[kr][ee]:z[kr];P(nr,Tn)<0&&dt.push(z[kr]),nr[kr]=Tn,kr++}return Pe&&(ee?dt=dt.sort(function(yi,Ot){return yi[ee]>Ot[ee]}):dt=dt.sort()),dt}function de(z,ee){for(var Pe,dt,nr=ee[0].toUpperCase()+ee.slice(1),kr=0;kr<le.length;){if(Pe=le[kr],dt=Pe?Pe+nr:ee,dt in z)return dt;kr++}return U}var Te=1;function we(){return Te++}function We(z){var ee=z.ownerDocument||z;return ee.defaultView||ee.parentWindow||E}var St=/mobile|tablet|ip(ad|hone|od)|android/i,ar="ontouchstart"in E,jt=de(E,"PointerEvent")!==U,Or=ar&&St.test(navigator.userAgent),Wr="touch",Zr="pen",pn="mouse",an="kinect",Fn=25,ln=1,gn=2,nn=4,Tr=8,Vr=1,fi=2,ti=4,Zn=8,Ne=16,V=fi|ti,Z=Zn|Ne,$=V|Z,T=["x","y"],xe=["clientX","clientY"];function vt(z,ee){var Pe=this;this.manager=z,this.callback=ee,this.element=z.element,this.target=z.options.inputTarget,this.domHandler=function(dt){ge(z.options.enable,[z])&&Pe.handler(dt)},this.init()}vt.prototype={handler:function(){},init:function(){this.evEl&&Be(this.element,this.evEl,this.domHandler),this.evTarget&&Be(this.target,this.evTarget,this.domHandler),this.evWin&&Be(We(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&tt(this.element,this.evEl,this.domHandler),this.evTarget&&tt(this.target,this.evTarget,this.domHandler),this.evWin&&tt(We(this.element),this.evWin,this.domHandler)}};function Gt(z){var ee,Pe=z.options.inputClass;return Pe?ee=Pe:jt?ee=ia:Or?ee=aa:ar?ee=oi:ee=Vi,new ee(z,_e)}function _e(z,ee,Pe){var dt=Pe.pointers.length,nr=Pe.changedPointers.length,kr=ee&ln&&dt-nr==0,Tn=ee&(nn|Tr)&&dt-nr==0;Pe.isFirst=!!kr,Pe.isFinal=!!Tn,kr&&(z.session={}),Pe.eventType=ee,$e(z,Pe),z.emit("hammer.input",Pe),z.recognize(Pe),z.session.prevInput=Pe}function $e(z,ee){var Pe=z.session,dt=ee.pointers,nr=dt.length;Pe.firstInput||(Pe.firstInput=er(ee)),nr>1&&!Pe.firstMultiple?Pe.firstMultiple=er(ee):nr===1&&(Pe.firstMultiple=!1);var kr=Pe.firstInput,Tn=Pe.firstMultiple,Ai=Tn?Tn.center:kr.center,yi=ee.center=lr(dt);ee.timeStamp=pt(),ee.deltaTime=ee.timeStamp-kr.timeStamp,ee.angle=Yr(Ai,yi),ee.distance=cr(Ai,yi),At(Pe,ee),ee.offsetDirection=Ir(ee.deltaX,ee.deltaY);var Ot=Nr(ee.deltaTime,ee.deltaX,ee.deltaY);ee.overallVelocityX=Ot.x,ee.overallVelocityY=Ot.y,ee.overallVelocity=Ue(Ot.x)>Ue(Ot.y)?Ot.x:Ot.y,ee.scale=Tn?Un(Tn.pointers,dt):1,ee.rotation=Tn?en(Tn.pointers,dt):0,ee.maxPointers=Pe.prevInput?ee.pointers.length>Pe.prevInput.maxPointers?ee.pointers.length:Pe.prevInput.maxPointers:ee.pointers.length,Zt(Pe,ee);var zt=z.element;_t(ee.srcEvent.target,zt)&&(zt=ee.srcEvent.target),ee.target=zt}function At(z,ee){var Pe=ee.center,dt=z.offsetDelta||{},nr=z.prevDelta||{},kr=z.prevInput||{};(ee.eventType===ln||kr.eventType===nn)&&(nr=z.prevDelta={x:kr.deltaX||0,y:kr.deltaY||0},dt=z.offsetDelta={x:Pe.x,y:Pe.y}),ee.deltaX=nr.x+(Pe.x-dt.x),ee.deltaY=nr.y+(Pe.y-dt.y)}function Zt(z,ee){var Pe=z.lastInterval||ee,dt=ee.timeStamp-Pe.timeStamp,nr,kr,Tn,Ai;if(ee.eventType!=Tr&&(dt>Fn||Pe.velocity===U)){var yi=ee.deltaX-Pe.deltaX,Ot=ee.deltaY-Pe.deltaY,zt=Nr(dt,yi,Ot);kr=zt.x,Tn=zt.y,nr=Ue(zt.x)>Ue(zt.y)?zt.x:zt.y,Ai=Ir(yi,Ot),z.lastInterval=ee}else nr=Pe.velocity,kr=Pe.velocityX,Tn=Pe.velocityY,Ai=Pe.direction;ee.velocity=nr,ee.velocityX=kr,ee.velocityY=Tn,ee.direction=Ai}function er(z){for(var ee=[],Pe=0;Pe<z.pointers.length;)ee[Pe]={clientX:Oe(z.pointers[Pe].clientX),clientY:Oe(z.pointers[Pe].clientY)},Pe++;return{timeStamp:pt(),pointers:ee,center:lr(ee),deltaX:z.deltaX,deltaY:z.deltaY}}function lr(z){var ee=z.length;if(ee===1)return{x:Oe(z[0].clientX),y:Oe(z[0].clientY)};for(var Pe=0,dt=0,nr=0;nr<ee;)Pe+=z[nr].clientX,dt+=z[nr].clientY,nr++;return{x:Oe(Pe/ee),y:Oe(dt/ee)}}function Nr(z,ee,Pe){return{x:ee/z||0,y:Pe/z||0}}function Ir(z,ee){return z===ee?Vr:Ue(z)>=Ue(ee)?z<0?fi:ti:ee<0?Zn:Ne}function cr(z,ee,Pe){Pe||(Pe=T);var dt=ee[Pe[0]]-z[Pe[0]],nr=ee[Pe[1]]-z[Pe[1]];return Math.sqrt(dt*dt+nr*nr)}function Yr(z,ee,Pe){Pe||(Pe=T);var dt=ee[Pe[0]]-z[Pe[0]],nr=ee[Pe[1]]-z[Pe[1]];return Math.atan2(nr,dt)*180/Math.PI}function en(z,ee){return Yr(ee[1],ee[0],xe)+Yr(z[1],z[0],xe)}function Un(z,ee){return cr(ee[0],ee[1],xe)/cr(z[0],z[1],xe)}var mi={mousedown:ln,mousemove:gn,mouseup:nn},di="mousedown",Yn="mousemove mouseup";function Vi(){this.evEl=di,this.evWin=Yn,this.pressed=!1,vt.apply(this,arguments)}ht(Vi,vt,{handler:function(ee){var Pe=mi[ee.type];Pe&ln&&ee.button===0&&(this.pressed=!0),Pe&gn&&ee.which!==1&&(Pe=nn),!!this.pressed&&(Pe&nn&&(this.pressed=!1),this.callback(this.manager,Pe,{pointers:[ee],changedPointers:[ee],pointerType:pn,srcEvent:ee}))}});var ja={pointerdown:ln,pointermove:gn,pointerup:nn,pointercancel:Tr,pointerout:Tr},ea={2:Wr,3:Zr,4:pn,5:an},Ra="pointerdown",Wa="pointermove pointerup pointercancel";!se&&E.MSPointerEvent&&!E.PointerEvent&&(Ra="MSPointerDown",Wa="MSPointerMove MSPointerUp MSPointerCancel");function ia(){this.evEl=Ra,this.evWin=Wa,vt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ht(ia,vt,{handler:function(ee){var Pe=this.store,dt=!1,nr=ee.type.toLowerCase().replace("ms",""),kr=ja[nr],Tn=ea[ee.pointerType]||ee.pointerType,Ai=Tn==Wr,yi=P(Pe,ee.pointerId,"pointerId");kr&ln&&(ee.button===0||Ai)?yi<0&&(Pe.push(ee),yi=Pe.length-1):kr&(nn|Tr)&&(dt=!0),!(yi<0)&&(Pe[yi]=ee,this.callback(this.manager,kr,{pointers:Pe,changedPointers:[ee],pointerType:Tn,srcEvent:ee}),dt&&Pe.splice(yi,1))}});var Ei={touchstart:ln,touchmove:gn,touchend:nn,touchcancel:Tr},ho="touchstart",Mu="touchstart touchmove touchend touchcancel";function Ru(){this.evTarget=ho,this.evWin=Mu,this.started=!1,vt.apply(this,arguments)}ht(Ru,vt,{handler:function(ee){var Pe=Ei[ee.type];if(Pe===ln&&(this.started=!0),!!this.started){var dt=Rl.call(this,ee,Pe);Pe&(nn|Tr)&&dt[0].length-dt[1].length==0&&(this.started=!1),this.callback(this.manager,Pe,{pointers:dt[0],changedPointers:dt[1],pointerType:Wr,srcEvent:ee})}}});function Rl(z,ee){var Pe=L(z.touches),dt=L(z.changedTouches);return ee&(nn|Tr)&&(Pe=b(Pe.concat(dt),"identifier",!0)),[Pe,dt]}var Lu={touchstart:ln,touchmove:gn,touchend:nn,touchcancel:Tr},rn="touchstart touchmove touchend touchcancel";function aa(){this.evTarget=rn,this.targetIds={},vt.apply(this,arguments)}ht(aa,vt,{handler:function(ee){var Pe=Lu[ee.type],dt=Pu.call(this,ee,Pe);!dt||this.callback(this.manager,Pe,{pointers:dt[0],changedPointers:dt[1],pointerType:Wr,srcEvent:ee})}});function Pu(z,ee){var Pe=L(z.touches),dt=this.targetIds;if(ee&(ln|gn)&&Pe.length===1)return dt[Pe[0].identifier]=!0,[Pe,Pe];var nr,kr,Tn=L(z.changedTouches),Ai=[],yi=this.target;if(kr=Pe.filter(function(Ot){return _t(Ot.target,yi)}),ee===ln)for(nr=0;nr<kr.length;)dt[kr[nr].identifier]=!0,nr++;for(nr=0;nr<Tn.length;)dt[Tn[nr].identifier]&&Ai.push(Tn[nr]),ee&(nn|Tr)&&delete dt[Tn[nr].identifier],nr++;if(!!Ai.length)return[b(kr.concat(Ai),"identifier",!0),Ai]}var Oo=2500,as=25;function oi(){vt.apply(this,arguments);var z=Fe(this.handler,this);this.touch=new aa(this.manager,z),this.mouse=new Vi(this.manager,z),this.primaryTouch=null,this.lastTouches=[]}ht(oi,vt,{handler:function(ee,Pe,dt){var nr=dt.pointerType==Wr,kr=dt.pointerType==pn;if(!(kr&&dt.sourceCapabilities&&dt.sourceCapabilities.firesTouchEvents)){if(nr)Vs.call(this,Pe,dt);else if(kr&&Hs.call(this,dt))return;this.callback(ee,Pe,dt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Vs(z,ee){z&ln?(this.primaryTouch=ee.changedPointers[0].identifier,st.call(this,ee)):z&(nn|Tr)&&st.call(this,ee)}function st(z){var ee=z.changedPointers[0];if(ee.identifier===this.primaryTouch){var Pe={x:ee.clientX,y:ee.clientY};this.lastTouches.push(Pe);var dt=this.lastTouches,nr=function(){var kr=dt.indexOf(Pe);kr>-1&&dt.splice(kr,1)};setTimeout(nr,Oo)}}function Hs(z){for(var ee=z.srcEvent.clientX,Pe=z.srcEvent.clientY,dt=0;dt<this.lastTouches.length;dt++){var nr=this.lastTouches[dt],kr=Math.abs(ee-nr.x),Tn=Math.abs(Pe-nr.y);if(kr<=as&&Tn<=as)return!0}return!1}var q=se?U:de(ye.style,"touchAction"),Iu=q!==U,uu="compute",ko="auto",Ou="manipulation",La="none",Pa="pan-x",dn="pan-y",po=os();function jo(z,ee){this.manager=z,this.set(ee)}jo.prototype={set:function(z){z==uu&&(z=this.compute()),Iu&&this.manager.element.style&&po[z]&&(this.manager.element.style[q]=z),this.actions=z.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var z=[];return Je(this.manager.recognizers,function(ee){ge(ee.options.enable,[ee])&&(z=z.concat(ee.getTouchAction()))}),su(z.join(" "))},preventDefaults:function(z){var ee=z.srcEvent,Pe=z.offsetDirection;if(this.manager.session.prevented){ee.preventDefault();return}var dt=this.actions,nr=k(dt,La)&&!po[La],kr=k(dt,dn)&&!po[dn],Tn=k(dt,Pa)&&!po[Pa];if(nr){var Ai=z.pointers.length===1,yi=z.distance<2,Ot=z.deltaTime<250;if(Ai&&yi&&Ot)return}if(!(Tn&&kr)&&(nr||kr&&Pe&V||Tn&&Pe&Z))return this.preventSrc(ee)},preventSrc:function(z){this.manager.session.prevented=!0,z.preventDefault()}};function su(z){if(k(z,La))return La;var ee=k(z,Pa),Pe=k(z,dn);return ee&&Pe?La:ee||Pe?ee?Pa:dn:k(z,Ou)?Ou:ko}function os(){if(!Iu)return!1;var z={};if(se)return z;var ee=E.CSS&&E.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Pe){z[Pe]=ee?E.CSS.supports("touch-action",Pe):!0}),z}var Wo=1,gi=2,$o=4,vo=8,Hi=vo,fa=16,ha=32;function oa(z){this.options=Ke({},this.defaults,z||{}),this.id=we(),this.manager=null,this.options.enable=je(this.options.enable,!0),this.state=Wo,this.simultaneous={},this.requireFail=[]}oa.prototype={defaults:{},set:function(z){return Ke(this.options,z),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(z){if(lt(z,"recognizeWith",this))return this;var ee=this.simultaneous;return z=$a(z,this),ee[z.id]||(ee[z.id]=z,z.recognizeWith(this)),this},dropRecognizeWith:function(z){return lt(z,"dropRecognizeWith",this)?this:(z=$a(z,this),delete this.simultaneous[z.id],this)},requireFailure:function(z){if(lt(z,"requireFailure",this))return this;var ee=this.requireFail;return z=$a(z,this),P(ee,z)===-1&&(ee.push(z),z.requireFailure(this)),this},dropRequireFailure:function(z){if(lt(z,"dropRequireFailure",this))return this;z=$a(z,this);var ee=P(this.requireFail,z);return ee>-1&&this.requireFail.splice(ee,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(z){return!!this.simultaneous[z.id]},emit:function(z){var ee=this,Pe=this.state;function dt(nr){ee.manager.emit(nr,z)}Pe<vo&&dt(ee.options.event+us(Pe)),dt(ee.options.event),z.additionalEvent&&dt(z.additionalEvent),Pe>=vo&&dt(ee.options.event+us(Pe))},tryEmit:function(z){if(this.canEmit())return this.emit(z);this.state=ha},canEmit:function(){for(var z=0;z<this.requireFail.length;){if(!(this.requireFail[z].state&(ha|Wo)))return!1;z++}return!0},recognize:function(z){var ee=Ke({},z);if(!ge(this.options.enable,[this,ee])){this.reset(),this.state=ha;return}this.state&(Hi|fa|ha)&&(this.state=Wo),this.state=this.process(ee),this.state&(gi|$o|vo|fa)&&this.tryEmit(ee)},process:function(z){},getTouchAction:function(){},reset:function(){}};function us(z){return z&fa?"cancel":z&vo?"end":z&$o?"move":z&gi?"start":""}function Xo(z){return z==Ne?"down":z==Zn?"up":z==fi?"left":z==ti?"right":""}function $a(z,ee){var Pe=ee.manager;return Pe?Pe.get(z):z}function ua(){oa.apply(this,arguments)}ht(ua,oa,{defaults:{pointers:1},attrTest:function(z){var ee=this.options.pointers;return ee===0||z.pointers.length===ee},process:function(z){var ee=this.state,Pe=z.eventType,dt=ee&(gi|$o),nr=this.attrTest(z);return dt&&(Pe&Tr||!nr)?ee|fa:dt||nr?Pe&nn?ee|vo:ee&gi?ee|$o:gi:ha}});function Xa(){ua.apply(this,arguments),this.pX=null,this.pY=null}ht(Xa,ua,{defaults:{event:"pan",threshold:10,pointers:1,direction:$},getTouchAction:function(){var z=this.options.direction,ee=[];return z&V&&ee.push(dn),z&Z&&ee.push(Pa),ee},directionTest:function(z){var ee=this.options,Pe=!0,dt=z.distance,nr=z.direction,kr=z.deltaX,Tn=z.deltaY;return nr&ee.direction||(ee.direction&V?(nr=kr===0?Vr:kr<0?fi:ti,Pe=kr!=this.pX,dt=Math.abs(z.deltaX)):(nr=Tn===0?Vr:Tn<0?Zn:Ne,Pe=Tn!=this.pY,dt=Math.abs(z.deltaY))),z.direction=nr,Pe&&dt>ee.threshold&&nr&ee.direction},attrTest:function(z){return ua.prototype.attrTest.call(this,z)&&(this.state&gi||!(this.state&gi)&&this.directionTest(z))},emit:function(z){this.pX=z.deltaX,this.pY=z.deltaY;var ee=Xo(z.direction);ee&&(z.additionalEvent=this.options.event+ee),this._super.emit.call(this,z)}});function Ia(){ua.apply(this,arguments)}ht(Ia,ua,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[La]},attrTest:function(z){return this._super.attrTest.call(this,z)&&(Math.abs(z.scale-1)>this.options.threshold||this.state&gi)},emit:function(z){if(z.scale!==1){var ee=z.scale<1?"in":"out";z.additionalEvent=this.options.event+ee}this._super.emit.call(this,z)}});function ku(){oa.apply(this,arguments),this._timer=null,this._input=null}ht(ku,oa,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ko]},process:function(z){var ee=this.options,Pe=z.pointers.length===ee.pointers,dt=z.distance<ee.threshold,nr=z.deltaTime>ee.time;if(this._input=z,!dt||!Pe||z.eventType&(nn|Tr)&&!nr)this.reset();else if(z.eventType&ln)this.reset(),this._timer=Ge(function(){this.state=Hi,this.tryEmit()},ee.time,this);else if(z.eventType&nn)return Hi;return ha},reset:function(){clearTimeout(this._timer)},emit:function(z){this.state===Hi&&(z&&z.eventType&nn?this.manager.emit(this.options.event+"up",z):(this._input.timeStamp=pt(),this.manager.emit(this.options.event,this._input)))}});function lu(){ua.apply(this,arguments)}ht(lu,ua,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[La]},attrTest:function(z){return this._super.attrTest.call(this,z)&&(Math.abs(z.rotation)>this.options.threshold||this.state&gi)}});function Oa(){ua.apply(this,arguments)}ht(Oa,ua,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:V|Z,pointers:1},getTouchAction:function(){return Xa.prototype.getTouchAction.call(this)},attrTest:function(z){var ee=this.options.direction,Pe;return ee&(V|Z)?Pe=z.overallVelocity:ee&V?Pe=z.overallVelocityX:ee&Z&&(Pe=z.overallVelocityY),this._super.attrTest.call(this,z)&&ee&z.offsetDirection&&z.distance>this.options.threshold&&z.maxPointers==this.options.pointers&&Ue(Pe)>this.options.velocity&&z.eventType&nn},emit:function(z){var ee=Xo(z.offsetDirection);ee&&this.manager.emit(this.options.event+ee,z),this.manager.emit(this.options.event,z)}});function Fi(){oa.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ht(Fi,oa,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ou]},process:function(z){var ee=this.options,Pe=z.pointers.length===ee.pointers,dt=z.distance<ee.threshold,nr=z.deltaTime<ee.time;if(this.reset(),z.eventType&ln&&this.count===0)return this.failTimeout();if(dt&&nr&&Pe){if(z.eventType!=nn)return this.failTimeout();var kr=this.pTime?z.timeStamp-this.pTime<ee.interval:!0,Tn=!this.pCenter||cr(this.pCenter,z.center)<ee.posThreshold;this.pTime=z.timeStamp,this.pCenter=z.center,!Tn||!kr?this.count=1:this.count+=1,this._input=z;var Ai=this.count%ee.taps;if(Ai===0)return this.hasRequireFailures()?(this._timer=Ge(function(){this.state=Hi,this.tryEmit()},ee.interval,this),gi):Hi}return ha},failTimeout:function(){return this._timer=Ge(function(){this.state=ha},this.options.interval,this),ha},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Hi&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ri(z,ee){return ee=ee||{},ee.recognizers=je(ee.recognizers,ri.defaults.preset),new Fo(z,ee)}ri.VERSION="2.0.7",ri.defaults={domEvents:!1,touchAction:uu,enable:!0,inputTarget:null,inputClass:null,preset:[[lu,{enable:!1}],[Ia,{enable:!1},["rotate"]],[Oa,{direction:V}],[Xa,{direction:V},["swipe"]],[Fi],[Fi,{event:"doubletap",taps:2},["tap"]],[ku]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Yo=1,mo=2;function Fo(z,ee){this.options=Ke({},ri.defaults,ee||{}),this.options.inputTarget=this.options.inputTarget||z,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=z,this.input=Gt(this),this.touchAction=new jo(this,this.options.touchAction),ot(this,!0),Je(this.options.recognizers,function(Pe){var dt=this.add(new Pe[0](Pe[1]));Pe[2]&&dt.recognizeWith(Pe[2]),Pe[3]&&dt.requireFailure(Pe[3])},this)}Fo.prototype={set:function(z){return Ke(this.options,z),z.touchAction&&this.touchAction.update(),z.inputTarget&&(this.input.destroy(),this.input.target=z.inputTarget,this.input.init()),this},stop:function(z){this.session.stopped=z?mo:Yo},recognize:function(z){var ee=this.session;if(!ee.stopped){this.touchAction.preventDefaults(z);var Pe,dt=this.recognizers,nr=ee.curRecognizer;(!nr||nr&&nr.state&Hi)&&(nr=ee.curRecognizer=null);for(var kr=0;kr<dt.length;)Pe=dt[kr],ee.stopped!==mo&&(!nr||Pe==nr||Pe.canRecognizeWith(nr))?Pe.recognize(z):Pe.reset(),!nr&&Pe.state&(gi|$o|vo)&&(nr=ee.curRecognizer=Pe),kr++}},get:function(z){if(z instanceof oa)return z;for(var ee=this.recognizers,Pe=0;Pe<ee.length;Pe++)if(ee[Pe].options.event==z)return ee[Pe];return null},add:function(z){if(lt(z,"add",this))return this;var ee=this.get(z.options.event);return ee&&this.remove(ee),this.recognizers.push(z),z.manager=this,this.touchAction.update(),z},remove:function(z){if(lt(z,"remove",this))return this;if(z=this.get(z),z){var ee=this.recognizers,Pe=P(ee,z);Pe!==-1&&(ee.splice(Pe,1),this.touchAction.update())}return this},on:function(z,ee){if(z!==U&&ee!==U){var Pe=this.handlers;return Je(ne(z),function(dt){Pe[dt]=Pe[dt]||[],Pe[dt].push(ee)}),this}},off:function(z,ee){if(z!==U){var Pe=this.handlers;return Je(ne(z),function(dt){ee?Pe[dt]&&Pe[dt].splice(P(Pe[dt],ee),1):delete Pe[dt]}),this}},emit:function(z,ee){this.options.domEvents&&at(z,ee);var Pe=this.handlers[z]&&this.handlers[z].slice();if(!(!Pe||!Pe.length)){ee.type=z,ee.preventDefault=function(){ee.srcEvent.preventDefault()};for(var dt=0;dt<Pe.length;)Pe[dt](ee),dt++}},destroy:function(){this.element&&ot(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ot(z,ee){var Pe=z.element;if(!!Pe.style){var dt;Je(z.options.cssProps,function(nr,kr){dt=de(Pe.style,kr),ee?(z.oldCssProps[dt]=Pe.style[dt],Pe.style[dt]=nr):Pe.style[dt]=z.oldCssProps[dt]||""}),ee||(z.oldCssProps={})}}function at(z,ee){if(!se){var Pe=ce.createEvent("Event");Pe.initEvent(z,!0,!0),Pe.gesture=ee,ee.target.dispatchEvent(Pe)}}if(!se){Ke(ri,{INPUT_START:ln,INPUT_MOVE:gn,INPUT_END:nn,INPUT_CANCEL:Tr,STATE_POSSIBLE:Wo,STATE_BEGAN:gi,STATE_CHANGED:$o,STATE_ENDED:vo,STATE_RECOGNIZED:Hi,STATE_CANCELLED:fa,STATE_FAILED:ha,DIRECTION_NONE:Vr,DIRECTION_LEFT:fi,DIRECTION_RIGHT:ti,DIRECTION_UP:Zn,DIRECTION_DOWN:Ne,DIRECTION_HORIZONTAL:V,DIRECTION_VERTICAL:Z,DIRECTION_ALL:$,Manager:Fo,Input:vt,TouchAction:jo,TouchInput:aa,MouseInput:Vi,PointerEventInput:ia,TouchMouseInput:oi,SingleTouchInput:Ru,Recognizer:oa,AttrRecognizer:ua,Tap:Fi,Pan:Xa,Swipe:Oa,Pinch:Ia,Rotate:lu,Press:ku,on:Be,off:tt,each:Je,merge:I,extend:xt,assign:Ke,inherit:ht,bindFn:Fe,prefixed:de});var R=typeof window!="undefined"?window:typeof self!="undefined"?self:{};R.Hammer=ri,oe=function(){return ri}.call(G,D,G,rr),oe!==U&&(rr.exports=oe)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},88307:function(rr,G,D){(function(oe,E){rr.exports=E(D(18857))})(this,function(oe){"use strict";var E=function(C){return C instanceof Uint8Array||C instanceof Uint16Array||C instanceof Uint32Array||C instanceof Int8Array||C instanceof Int16Array||C instanceof Int32Array||C instanceof Float32Array||C instanceof Float64Array||C instanceof Uint8ClampedArray},ce=function(C,X){for(var me=Object.keys(X),nt=0;nt<me.length;++nt)C[me[nt]]=X[me[nt]];return C},J=`
`;function U(C){return typeof atob!="undefined"?atob(C):"base64:"+C}function re(C){var X=new Error("(regl) "+C);throw console.error(X),X}function Y(C,X){C||re(X)}function se(C){return C?": "+C:""}function le(C,X,me){C in X||re("unknown parameter ("+C+")"+se(me)+". possible values: "+Object.keys(X).join())}function ye(C,X){E(C)||re("invalid parameter type"+se(X)+". must be a typed array")}function Ce(C,X){switch(X){case"number":return typeof C=="number";case"object":return typeof C=="object";case"string":return typeof C=="string";case"boolean":return typeof C=="boolean";case"function":return typeof C=="function";case"undefined":return typeof C=="undefined";case"symbol":return typeof C=="symbol"}}function Oe(C,X,me){Ce(C,X)||re("invalid parameter type"+se(me)+". expected "+X+", got "+typeof C)}function Ue(C,X){C>=0&&(C|0)===C||re("invalid parameter type, ("+C+")"+se(X)+". must be a nonnegative integer")}function pt(C,X,me){X.indexOf(C)<0&&re("invalid value"+se(me)+". must be one of: "+X)}var Ge=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function lt(C){Object.keys(C).forEach(function(X){Ge.indexOf(X)<0&&re('invalid regl constructor argument "'+X+'". must be one of '+Ge)})}function Je(C,X){for(C=C+"";C.length<X;)C=" "+C;return C}function Ye(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Ke(C,X){this.number=C,this.line=X,this.errors=[]}function xt(C,X,me){this.file=C,this.line=X,this.message=me}function I(){var C=new Error,X=(C.stack||C).toString(),me=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(X);if(me)return me[1];var nt=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(X);return nt?nt[1]:"unknown"}function ht(){var C=new Error,X=(C.stack||C).toString(),me=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(X);if(me)return me[1];var nt=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(X);return nt?nt[1]:"unknown"}function Fe(C,X){var me=C.split(`
`),nt=1,Rt=0,ut={unknown:new Ye,0:new Ye};ut.unknown.name=ut[0].name=X||I(),ut.unknown.lines.push(new Ke(0,""));for(var Tt=0;Tt<me.length;++Tt){var It=me[Tt],Bt=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(It);if(Bt)switch(Bt[1]){case"line":var Kt=/(\d+)(\s+\d+)?/.exec(Bt[2]);Kt&&(nt=Kt[1]|0,Kt[2]&&(Rt=Kt[2]|0,Rt in ut||(ut[Rt]=new Ye)));break;case"define":var Qt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Bt[2]);Qt&&(ut[Rt].name=Qt[1]?U(Qt[2]):Qt[2]);break}ut[Rt].lines.push(new Ke(nt++,It))}return Object.keys(ut).forEach(function(Jt){var tr=ut[Jt];tr.lines.forEach(function(kt){tr.index[kt.number]=kt})}),ut}function ge(C){var X=[];return C.split(`
`).forEach(function(me){if(!(me.length<5)){var nt=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(me);nt?X.push(new xt(nt[1]|0,nt[2]|0,nt[3].trim())):me.length>0&&X.push(new xt("unknown",0,me))}}),X}function je(C,X){X.forEach(function(me){var nt=C[me.file];if(nt){var Rt=nt.index[me.line];if(Rt){Rt.errors.push(me),nt.hasErrors=!0;return}}C.unknown.hasErrors=!0,C.unknown.lines[0].errors.push(me)})}function Be(C,X,me,nt,Rt){if(!C.getShaderParameter(X,C.COMPILE_STATUS)){var ut=C.getShaderInfoLog(X),Tt=nt===C.FRAGMENT_SHADER?"fragment":"vertex";b(me,"string",Tt+" shader source must be a string",Rt);var It=Fe(me,Rt),Bt=ge(ut);je(It,Bt),Object.keys(It).forEach(function(Kt){var Qt=It[Kt];if(!Qt.hasErrors)return;var Jt=[""],tr=[""];function kt(Xt,Ve){Jt.push(Xt),tr.push(Ve||"")}kt("file number "+Kt+": "+Qt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Qt.lines.forEach(function(Xt){if(Xt.errors.length>0){kt(Je(Xt.number,4)+"|  ","background-color:yellow; font-weight:bold"),kt(Xt.line+J,"color:red; background-color:yellow; font-weight:bold");var Ve=0;Xt.errors.forEach(function(bt){var Wt=bt.message,Sr=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Wt);if(Sr){var Ft=Sr[1];switch(Wt=Sr[2],Ft){case"assign":Ft="=";break}Ve=Math.max(Xt.line.indexOf(Ft,Ve),0)}else Ve=0;kt(Je("| ",6)),kt(Je("^^^",Ve+3)+J,"font-weight:bold"),kt(Je("| ",6)),kt(Wt+J,"font-weight:bold")}),kt(Je("| ",6)+J)}else kt(Je(Xt.number,4)+"|  "),kt(Xt.line+J,"color:red")}),typeof document!="undefined"&&!window.chrome?(tr[0]=Jt.join("%c"),console.log.apply(console,tr)):console.log(Jt.join(""))}),Y.raise("Error compiling "+Tt+" shader, "+It[0].name)}}function tt(C,X,me,nt,Rt){if(!C.getProgramParameter(X,C.LINK_STATUS)){var ut=C.getProgramInfoLog(X),Tt=Fe(me,Rt),It=Fe(nt,Rt),Bt='Error linking program with vertex shader, "'+It[0].name+'", and fragment shader "'+Tt[0].name+'"';typeof document!="undefined"?console.log("%c"+Bt+J+"%c"+ut,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Bt+J+ut),Y.raise(Bt)}}function _t(C){C._commandRef=I()}function k(C,X,me,nt){_t(C);function Rt(Bt){return Bt?nt.id(Bt):0}C._fragId=Rt(C.static.frag),C._vertId=Rt(C.static.vert);function ut(Bt,Kt){Object.keys(Kt).forEach(function(Qt){Bt[nt.id(Qt)]=!0})}var Tt=C._uniformSet={};ut(Tt,X.static),ut(Tt,X.dynamic);var It=C._attributeSet={};ut(It,me.static),ut(It,me.dynamic),C._hasCount="count"in C.static||"count"in C.dynamic||"elements"in C.static||"elements"in C.dynamic}function ne(C,X){var me=ht();re(C+" in command "+(X||I())+(me==="unknown"?"":" called from "+me))}function P(C,X,me){C||ne(X,me||I())}function L(C,X,me,nt){C in X||ne("unknown parameter ("+C+")"+se(me)+". possible values: "+Object.keys(X).join(),nt||I())}function b(C,X,me,nt){Ce(C,X)||ne("invalid parameter type"+se(me)+". expected "+X+", got "+typeof C,nt||I())}function de(C){C()}function Te(C,X,me){C.texture?pt(C.texture._texture.internalformat,X,"unsupported texture format for attachment"):pt(C.renderbuffer._renderbuffer.format,me,"unsupported renderbuffer format for attachment")}var we=33071,We=9728,St=9984,ar=9985,jt=9986,Or=9987,Wr=5120,Zr=5121,pn=5122,an=5123,Fn=5124,ln=5125,gn=5126,nn=32819,Tr=32820,Vr=33635,fi=34042,ti=36193,Zn={};Zn[Wr]=Zn[Zr]=1,Zn[pn]=Zn[an]=Zn[ti]=Zn[Vr]=Zn[nn]=Zn[Tr]=2,Zn[Fn]=Zn[ln]=Zn[gn]=Zn[fi]=4;function Ne(C,X){return C===Tr||C===nn||C===Vr?2:C===fi?4:Zn[C]*X}function V(C){return!(C&C-1)&&!!C}function Z(C,X,me){var nt,Rt=X.width,ut=X.height,Tt=X.channels;Y(Rt>0&&Rt<=me.maxTextureSize&&ut>0&&ut<=me.maxTextureSize,"invalid texture shape"),(C.wrapS!==we||C.wrapT!==we)&&Y(V(Rt)&&V(ut),"incompatible wrap mode for texture, both width and height must be power of 2"),X.mipmask===1?Rt!==1&&ut!==1&&Y(C.minFilter!==St&&C.minFilter!==jt&&C.minFilter!==ar&&C.minFilter!==Or,"min filter requires mipmap"):(Y(V(Rt)&&V(ut),"texture must be a square power of 2 to support mipmapping"),Y(X.mipmask===(Rt<<1)-1,"missing or incomplete mipmap data")),X.type===gn&&(me.extensions.indexOf("oes_texture_float_linear")<0&&Y(C.minFilter===We&&C.magFilter===We,"filter not supported, must enable oes_texture_float_linear"),Y(!C.genMipmaps,"mipmap generation not supported with float textures"));var It=X.images;for(nt=0;nt<16;++nt)if(It[nt]){var Bt=Rt>>nt,Kt=ut>>nt;Y(X.mipmask&1<<nt,"missing mipmap data");var Qt=It[nt];if(Y(Qt.width===Bt&&Qt.height===Kt,"invalid shape for mip images"),Y(Qt.format===X.format&&Qt.internalformat===X.internalformat&&Qt.type===X.type,"incompatible type for mip image"),!Qt.compressed)if(Qt.data){var Jt=Math.ceil(Ne(Qt.type,Tt)*Bt/Qt.unpackAlignment)*Qt.unpackAlignment;Y(Qt.data.byteLength===Jt*Kt,"invalid data for image, buffer size is inconsistent with image format")}else Qt.element||Qt.copy}else C.genMipmaps||Y((X.mipmask&1<<nt)==0,"extra mipmap data");X.compressed&&Y(!C.genMipmaps,"mipmap generation for compressed images not supported")}function $(C,X,me,nt){var Rt=C.width,ut=C.height,Tt=C.channels;Y(Rt>0&&Rt<=nt.maxTextureSize&&ut>0&&ut<=nt.maxTextureSize,"invalid texture shape"),Y(Rt===ut,"cube map must be square"),Y(X.wrapS===we&&X.wrapT===we,"wrap mode not supported by cube map");for(var It=0;It<me.length;++It){var Bt=me[It];Y(Bt.width===Rt&&Bt.height===ut,"inconsistent cube map face shape"),X.genMipmaps&&(Y(!Bt.compressed,"can not generate mipmap for compressed textures"),Y(Bt.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Kt=Bt.images,Qt=0;Qt<16;++Qt){var Jt=Kt[Qt];if(Jt){var tr=Rt>>Qt,kt=ut>>Qt;Y(Bt.mipmask&1<<Qt,"missing mipmap data"),Y(Jt.width===tr&&Jt.height===kt,"invalid shape for mip images"),Y(Jt.format===C.format&&Jt.internalformat===C.internalformat&&Jt.type===C.type,"incompatible type for mip image"),Jt.compressed||(Jt.data?Y(Jt.data.byteLength===tr*kt*Math.max(Ne(Jt.type,Tt),Jt.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Jt.element||Jt.copy)}}}}var T=ce(Y,{optional:de,raise:re,commandRaise:ne,command:P,parameter:le,commandParameter:L,constructor:lt,type:Oe,commandType:b,isTypedArray:ye,nni:Ue,oneOf:pt,shaderError:Be,linkError:tt,callSite:ht,saveCommandRef:_t,saveDrawInfo:k,framebufferFormat:Te,guessCommand:I,texture2D:Z,textureCube:$}),xe=0,vt=0,Gt=5,_e=6;function $e(C,X){this.id=xe++,this.type=C,this.data=X}function At(C){return C.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Zt(C){if(C.length===0)return[];var X=C.charAt(0),me=C.charAt(C.length-1);if(C.length>1&&X===me&&(X==='"'||X==="'"))return['"'+At(C.substr(1,C.length-2))+'"'];var nt=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(C);if(nt)return Zt(C.substr(0,nt.index)).concat(Zt(nt[1])).concat(Zt(C.substr(nt.index+nt[0].length)));var Rt=C.split(".");if(Rt.length===1)return['"'+At(C)+'"'];for(var ut=[],Tt=0;Tt<Rt.length;++Tt)ut=ut.concat(Zt(Rt[Tt]));return ut}function er(C){return"["+Zt(C).join("][")+"]"}function lr(C,X){return new $e(C,er(X+""))}function Nr(C){return typeof C=="function"&&!C._reglType||C instanceof $e}function Ir(C,X){if(typeof C=="function")return new $e(vt,C);if(typeof C=="number"||typeof C=="boolean")return new $e(Gt,C);if(Array.isArray(C))return new $e(_e,C.map(function(me,nt){return Ir(me,X+"["+nt+"]")}));if(C instanceof $e)return C;T(!1,"invalid option type in uniform "+X)}var cr={DynamicVariable:$e,define:lr,isDynamic:Nr,unbox:Ir,accessor:er},Yr={next:typeof requestAnimationFrame=="function"?function(C){return requestAnimationFrame(C)}:function(C){return setTimeout(C,16)},cancel:typeof cancelAnimationFrame=="function"?function(C){return cancelAnimationFrame(C)}:clearTimeout},en=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Un=en?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function mi(){var C={"":0},X=[""];return{id:function(me){var nt=C[me];return nt||(nt=C[me]=X.length,X.push(me),nt)},str:function(me){return X[me]}}}function di(C,X,me){var nt=document.createElement("canvas");ce(nt.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),C.appendChild(nt),C===document.body&&(nt.style.position="absolute",ce(C.style,{margin:0,padding:0}));function Rt(){var It=window.innerWidth,Bt=window.innerHeight;if(C!==document.body){var Kt=nt.getBoundingClientRect();It=Kt.right-Kt.left,Bt=Kt.bottom-Kt.top}nt.width=me*It,nt.height=me*Bt}var ut;C!==document.body&&typeof ResizeObserver=="function"?(ut=new ResizeObserver(function(){setTimeout(Rt)}),ut.observe(C)):window.addEventListener("resize",Rt,!1);function Tt(){ut?ut.disconnect():window.removeEventListener("resize",Rt),C.removeChild(nt)}return Rt(),{canvas:nt,onDestroy:Tt}}function Yn(C,X){function me(nt){try{return C.getContext(nt,X)}catch(Rt){return null}}return me("webgl")||me("experimental-webgl")||me("webgl-experimental")}function Vi(C){return typeof C.nodeName=="string"&&typeof C.appendChild=="function"&&typeof C.getBoundingClientRect=="function"}function ja(C){return typeof C.drawArrays=="function"||typeof C.drawElements=="function"}function ea(C){return typeof C=="string"?C.split():(T(Array.isArray(C),"invalid extension array"),C)}function Ra(C){return typeof C=="string"?(T(typeof document!="undefined","not supported outside of DOM"),document.querySelector(C)):C}function Wa(C){var X=C||{},me,nt,Rt,ut,Tt={},It=[],Bt=[],Kt=typeof window=="undefined"?1:window.devicePixelRatio,Qt=!1,Jt=function(Xt){Xt&&T.raise(Xt)},tr=function(){};if(typeof X=="string"?(T(typeof document!="undefined","selector queries only supported in DOM environments"),me=document.querySelector(X),T(me,"invalid query string for element")):typeof X=="object"?Vi(X)?me=X:ja(X)?(ut=X,Rt=ut.canvas):(T.constructor(X),"gl"in X?ut=X.gl:"canvas"in X?Rt=Ra(X.canvas):"container"in X&&(nt=Ra(X.container)),"attributes"in X&&(Tt=X.attributes,T.type(Tt,"object","invalid context attributes")),"extensions"in X&&(It=ea(X.extensions)),"optionalExtensions"in X&&(Bt=ea(X.optionalExtensions)),"onDone"in X&&(T.type(X.onDone,"function","invalid or missing onDone callback"),Jt=X.onDone),"profile"in X&&(Qt=!!X.profile),"pixelRatio"in X&&(Kt=+X.pixelRatio,T(Kt>0,"invalid pixel ratio"))):T.raise("invalid arguments to regl"),me&&(me.nodeName.toLowerCase()==="canvas"?Rt=me:nt=me),!ut){if(!Rt){T(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var kt=di(nt||document.body,Jt,Kt);if(!kt)return null;Rt=kt.canvas,tr=kt.onDestroy}Tt.premultipliedAlpha===void 0&&(Tt.premultipliedAlpha=!0),ut=Yn(Rt,Tt)}return ut?{gl:ut,canvas:Rt,container:nt,extensions:It,optionalExtensions:Bt,pixelRatio:Kt,profile:Qt,onDone:Jt,onDestroy:tr}:(tr(),Jt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ia(C,X){var me={};function nt(It){T.type(It,"string","extension name must be string");var Bt=It.toLowerCase(),Kt;try{Kt=me[Bt]=Rt(It)}catch(Qt){}return!!Kt}function Rt(It){return C.getExtension(It)?C.getExtension(It):C.getExtension(It.toLowerCase())?C.getExtension(It.toLowerCase()):null}for(var ut=0;ut<X.extensions.length;++ut){var Tt=X.extensions[ut];if(!nt(Tt))return X.onDestroy(),X.onDone('"'+Tt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return X.optionalExtensions.forEach(nt),{extensions:me,restore:function(){Object.keys(me).forEach(function(It){if(me[It]&&!nt(It))throw new Error("(regl): error restoring extension "+It)})}}}function Ei(C,X){for(var me=Array(C),nt=0;nt<C;++nt)me[nt]=X(nt);return me}var ho=5120,Mu=5121,Ru=5122,Rl=5123,Lu=5124,rn=5125,aa=5126;function Pu(C){for(var X=16;X<=1<<28;X*=16)if(C<=X)return X;return 0}function Oo(C){var X,me;return X=(C>65535)<<4,C>>>=X,me=(C>255)<<3,C>>>=me,X|=me,me=(C>15)<<2,C>>>=me,X|=me,me=(C>3)<<1,C>>>=me,X|=me,X|C>>1}function as(){var C=Ei(8,function(){return[]});function X(ut){var Tt=Pu(ut),It=C[Oo(Tt)>>2];return It.length>0?It.pop():new ArrayBuffer(Tt)}function me(ut){C[Oo(ut.byteLength)>>2].push(ut)}function nt(ut,Tt){var It=null;switch(ut){case ho:It=new Int8Array(X(Tt),0,Tt);break;case Mu:It=new Uint8Array(X(Tt),0,Tt);break;case Ru:It=new Int16Array(X(2*Tt),0,Tt);break;case Rl:It=new Uint16Array(X(2*Tt),0,Tt);break;case Lu:It=new Int32Array(X(4*Tt),0,Tt);break;case rn:It=new Uint32Array(X(4*Tt),0,Tt);break;case aa:It=new Float32Array(X(4*Tt),0,Tt);break;default:return null}return It.length!==Tt?It.subarray(0,Tt):It}function Rt(ut){me(ut.buffer)}return{alloc:X,free:me,allocType:nt,freeType:Rt}}var oi=as();oi.zero=as();var Vs=3408,st=3410,Hs=3411,q=3412,Iu=3413,uu=3414,ko=3415,Ou=33901,La=33902,Pa=3379,dn=3386,po=34921,jo=36347,su=36348,os=35661,Wo=35660,gi=34930,$o=36349,vo=34076,Hi=34024,fa=7936,ha=7937,oa=7938,us=35724,Xo=34047,$a=36063,ua=34852,Xa=3553,Ia=34067,ku=34069,lu=33984,Oa=6408,Fi=5126,ri=5121,Yo=36160,mo=36053,Fo=36064,ot=16384,at=function(C,X){var me=1;X.ext_texture_filter_anisotropic&&(me=C.getParameter(Xo));var nt=1,Rt=1;X.webgl_draw_buffers&&(nt=C.getParameter(ua),Rt=C.getParameter($a));var ut=!!X.oes_texture_float;if(ut){var Tt=C.createTexture();C.bindTexture(Xa,Tt),C.texImage2D(Xa,0,Oa,1,1,0,Oa,Fi,null);var It=C.createFramebuffer();if(C.bindFramebuffer(Yo,It),C.framebufferTexture2D(Yo,Fo,Xa,Tt,0),C.bindTexture(Xa,null),C.checkFramebufferStatus(Yo)!==mo)ut=!1;else{C.viewport(0,0,1,1),C.clearColor(1,0,0,1),C.clear(ot);var Bt=oi.allocType(Fi,4);C.readPixels(0,0,1,1,Oa,Fi,Bt),C.getError()?ut=!1:(C.deleteFramebuffer(It),C.deleteTexture(Tt),ut=Bt[0]===1),oi.freeType(Bt)}}var Kt=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Qt=!0;if(!Kt){var Jt=C.createTexture(),tr=oi.allocType(ri,36);C.activeTexture(lu),C.bindTexture(Ia,Jt),C.texImage2D(ku,0,Oa,3,3,0,Oa,ri,tr),oi.freeType(tr),C.bindTexture(Ia,null),C.deleteTexture(Jt),Qt=!C.getError()}return{colorBits:[C.getParameter(st),C.getParameter(Hs),C.getParameter(q),C.getParameter(Iu)],depthBits:C.getParameter(uu),stencilBits:C.getParameter(ko),subpixelBits:C.getParameter(Vs),extensions:Object.keys(X).filter(function(kt){return!!X[kt]}),maxAnisotropic:me,maxDrawbuffers:nt,maxColorAttachments:Rt,pointSizeDims:C.getParameter(Ou),lineWidthDims:C.getParameter(La),maxViewportDims:C.getParameter(dn),maxCombinedTextureUnits:C.getParameter(os),maxCubeMapSize:C.getParameter(vo),maxRenderbufferSize:C.getParameter(Hi),maxTextureUnits:C.getParameter(gi),maxTextureSize:C.getParameter(Pa),maxAttributes:C.getParameter(po),maxVertexUniforms:C.getParameter(jo),maxVertexTextureUnits:C.getParameter(Wo),maxVaryingVectors:C.getParameter(su),maxFragmentUniforms:C.getParameter($o),glsl:C.getParameter(us),renderer:C.getParameter(ha),vendor:C.getParameter(fa),version:C.getParameter(oa),readFloat:ut,npotTextureCube:Qt}};function R(C){return!!C&&typeof C=="object"&&Array.isArray(C.shape)&&Array.isArray(C.stride)&&typeof C.offset=="number"&&C.shape.length===C.stride.length&&(Array.isArray(C.data)||E(C.data))}var z=function(C){return Object.keys(C).map(function(X){return C[X]})},ee={shape:Ai,flatten:Tn};function Pe(C,X,me){for(var nt=0;nt<X;++nt)me[nt]=C[nt]}function dt(C,X,me,nt){for(var Rt=0,ut=0;ut<X;++ut)for(var Tt=C[ut],It=0;It<me;++It)nt[Rt++]=Tt[It]}function nr(C,X,me,nt,Rt,ut){for(var Tt=ut,It=0;It<X;++It)for(var Bt=C[It],Kt=0;Kt<me;++Kt)for(var Qt=Bt[Kt],Jt=0;Jt<nt;++Jt)Rt[Tt++]=Qt[Jt]}function kr(C,X,me,nt,Rt){for(var ut=1,Tt=me+1;Tt<X.length;++Tt)ut*=X[Tt];var It=X[me];if(X.length-me==4){var Bt=X[me+1],Kt=X[me+2],Qt=X[me+3];for(Tt=0;Tt<It;++Tt)nr(C[Tt],Bt,Kt,Qt,nt,Rt),Rt+=ut}else for(Tt=0;Tt<It;++Tt)kr(C[Tt],X,me+1,nt,Rt),Rt+=ut}function Tn(C,X,me,nt){var Rt=1;if(X.length)for(var ut=0;ut<X.length;++ut)Rt*=X[ut];else Rt=0;var Tt=nt||oi.allocType(me,Rt);switch(X.length){case 0:break;case 1:Pe(C,X[0],Tt);break;case 2:dt(C,X[0],X[1],Tt);break;case 3:nr(C,X[0],X[1],X[2],Tt,0);break;default:kr(C,X,0,Tt,0)}return Tt}function Ai(C){for(var X=[],me=C;me.length;me=me[0])X.push(me.length);return X}var yi={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ot=5120,zt=5122,be=5124,Ya=5121,cu=5123,go=5125,Ka=5126,Fu=5126,qa={int8:Ot,int16:zt,int32:be,uint8:Ya,uint16:cu,uint32:go,float:Ka,float32:Fu},Ll=35048,yo=35040,Cn={dynamic:Ll,stream:yo,static:35044},Jn=ee.flatten,ss=ee.shape,Nu=35044,ka=35040,Pl=5121,js=5126,Fa=[];Fa[5120]=1,Fa[5122]=2,Fa[5124]=4,Fa[5121]=1,Fa[5123]=2,Fa[5125]=4,Fa[5126]=4;function pe(C){return yi[Object.prototype.toString.call(C)]|0}function p(C,X){for(var me=0;me<X.length;++me)C[me]=X[me]}function g(C,X,me,nt,Rt,ut,Tt){for(var It=0,Bt=0;Bt<me;++Bt)for(var Kt=0;Kt<nt;++Kt)C[It++]=X[Rt*Bt+ut*Kt+Tt]}function w(C,X,me,nt){var Rt=0,ut={};function Tt(Ve){this.id=Rt++,this.buffer=C.createBuffer(),this.type=Ve,this.usage=Nu,this.byteLength=0,this.dimension=1,this.dtype=Pl,this.persistentData=null,me.profile&&(this.stats={size:0})}Tt.prototype.bind=function(){C.bindBuffer(this.type,this.buffer)},Tt.prototype.destroy=function(){tr(this)};var It=[];function Bt(Ve,bt){var Wt=It.pop();return Wt||(Wt=new Tt(Ve)),Wt.bind(),Jt(Wt,bt,ka,0,1,!1),Wt}function Kt(Ve){It.push(Ve)}function Qt(Ve,bt,Wt){Ve.byteLength=bt.byteLength,C.bufferData(Ve.type,bt,Wt)}function Jt(Ve,bt,Wt,Sr,Ft,gr){var mr;if(Ve.usage=Wt,Array.isArray(bt)){if(Ve.dtype=Sr||js,bt.length>0){var Gr;if(Array.isArray(bt[0])){mr=ss(bt);for(var Lt=1,wt=1;wt<mr.length;++wt)Lt*=mr[wt];Ve.dimension=Lt,Gr=Jn(bt,mr,Ve.dtype),Qt(Ve,Gr,Wt),gr?Ve.persistentData=Gr:oi.freeType(Gr)}else if(typeof bt[0]=="number"){Ve.dimension=Ft;var Mr=oi.allocType(Ve.dtype,bt.length);p(Mr,bt),Qt(Ve,Mr,Wt),gr?Ve.persistentData=Mr:oi.freeType(Mr)}else E(bt[0])?(Ve.dimension=bt[0].length,Ve.dtype=Sr||pe(bt[0])||js,Gr=Jn(bt,[bt.length,bt[0].length],Ve.dtype),Qt(Ve,Gr,Wt),gr?Ve.persistentData=Gr:oi.freeType(Gr)):T.raise("invalid buffer data")}}else if(E(bt))Ve.dtype=Sr||pe(bt),Ve.dimension=Ft,Qt(Ve,bt,Wt),gr&&(Ve.persistentData=new Uint8Array(new Uint8Array(bt.buffer)));else if(R(bt)){mr=bt.shape;var fr=bt.stride,Vt=bt.offset,vr=0,dr=0,on=0,$r=0;mr.length===1?(vr=mr[0],dr=1,on=fr[0],$r=0):mr.length===2?(vr=mr[0],dr=mr[1],on=fr[0],$r=fr[1]):T.raise("invalid shape"),Ve.dtype=Sr||pe(bt.data)||js,Ve.dimension=dr;var hr=oi.allocType(Ve.dtype,vr*dr);g(hr,bt.data,vr,dr,on,$r,Vt),Qt(Ve,hr,Wt),gr?Ve.persistentData=hr:oi.freeType(hr)}else bt instanceof ArrayBuffer?(Ve.dtype=Pl,Ve.dimension=Ft,Qt(Ve,bt,Wt),gr&&(Ve.persistentData=new Uint8Array(new Uint8Array(bt)))):T.raise("invalid buffer data")}function tr(Ve){X.bufferCount--,nt(Ve);var bt=Ve.buffer;T(bt,"buffer must not be deleted already"),C.deleteBuffer(bt),Ve.buffer=null,delete ut[Ve.id]}function kt(Ve,bt,Wt,Sr){X.bufferCount++;var Ft=new Tt(bt);ut[Ft.id]=Ft;function gr(Lt){var wt=Nu,Mr=null,fr=0,Vt=0,vr=1;return Array.isArray(Lt)||E(Lt)||R(Lt)||Lt instanceof ArrayBuffer?Mr=Lt:typeof Lt=="number"?fr=Lt|0:Lt&&(T.type(Lt,"object","buffer arguments must be an object, a number or an array"),"data"in Lt&&(T(Mr===null||Array.isArray(Mr)||E(Mr)||R(Mr),"invalid data for buffer"),Mr=Lt.data),"usage"in Lt&&(T.parameter(Lt.usage,Cn,"invalid buffer usage"),wt=Cn[Lt.usage]),"type"in Lt&&(T.parameter(Lt.type,qa,"invalid buffer type"),Vt=qa[Lt.type]),"dimension"in Lt&&(T.type(Lt.dimension,"number","invalid dimension"),vr=Lt.dimension|0),"length"in Lt&&(T.nni(fr,"buffer length must be a nonnegative integer"),fr=Lt.length|0)),Ft.bind(),Mr?Jt(Ft,Mr,wt,Vt,vr,Sr):(fr&&C.bufferData(Ft.type,fr,wt),Ft.dtype=Vt||Pl,Ft.usage=wt,Ft.dimension=vr,Ft.byteLength=fr),me.profile&&(Ft.stats.size=Ft.byteLength*Fa[Ft.dtype]),gr}function mr(Lt,wt){T(wt+Lt.byteLength<=Ft.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Lt.byteLength+" starting from offset "+wt+" to a buffer of size "+Ft.byteLength),C.bufferSubData(Ft.type,wt,Lt)}function Gr(Lt,wt){var Mr=(wt||0)|0,fr;if(Ft.bind(),E(Lt)||Lt instanceof ArrayBuffer)mr(Lt,Mr);else if(Array.isArray(Lt)){if(Lt.length>0)if(typeof Lt[0]=="number"){var Vt=oi.allocType(Ft.dtype,Lt.length);p(Vt,Lt),mr(Vt,Mr),oi.freeType(Vt)}else if(Array.isArray(Lt[0])||E(Lt[0])){fr=ss(Lt);var vr=Jn(Lt,fr,Ft.dtype);mr(vr,Mr),oi.freeType(vr)}else T.raise("invalid buffer data")}else if(R(Lt)){fr=Lt.shape;var dr=Lt.stride,on=0,$r=0,hr=0,yr=0;fr.length===1?(on=fr[0],$r=1,hr=dr[0],yr=0):fr.length===2?(on=fr[0],$r=fr[1],hr=dr[0],yr=dr[1]):T.raise("invalid shape");var Xr=Array.isArray(Lt.data)?Ft.dtype:pe(Lt.data),tn=oi.allocType(Xr,on*$r);g(tn,Lt.data,on,$r,hr,yr,Lt.offset),mr(tn,Mr),oi.freeType(tn)}else T.raise("invalid data for buffer subdata");return gr}return Wt||gr(Ve),gr._reglType="buffer",gr._buffer=Ft,gr.subdata=Gr,me.profile&&(gr.stats=Ft.stats),gr.destroy=function(){tr(Ft)},gr}function Xt(){z(ut).forEach(function(Ve){Ve.buffer=C.createBuffer(),C.bindBuffer(Ve.type,Ve.buffer),C.bufferData(Ve.type,Ve.persistentData||Ve.byteLength,Ve.usage)})}return me.profile&&(X.getTotalBufferSize=function(){var Ve=0;return Object.keys(ut).forEach(function(bt){Ve+=ut[bt].stats.size}),Ve}),{create:kt,createStream:Bt,destroyStream:Kt,clear:function(){z(ut).forEach(tr),It.forEach(tr)},getBuffer:function(Ve){return Ve&&Ve._buffer instanceof Tt?Ve._buffer:null},restore:Xt,_initBuffer:Jt}}var _=0,F=0,ae=1,Ee=1,Qe=4,et=4,Nt={points:_,point:F,lines:ae,line:Ee,triangles:Qe,triangle:et,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},$t=0,Hr=1,cn=4,jr=5120,Dn=5121,yn=5122,jn=5123,Na=5124,Si=5125,xa=34963,_o=35040,ni=35044;function Sa(C,X,me,nt){var Rt={},ut=0,Tt={uint8:Dn,uint16:jn};X.oes_element_index_uint&&(Tt.uint32=Si);function It(Xt){this.id=ut++,Rt[this.id]=this,this.buffer=Xt,this.primType=cn,this.vertCount=0,this.type=0}It.prototype.bind=function(){this.buffer.bind()};var Bt=[];function Kt(Xt){var Ve=Bt.pop();return Ve||(Ve=new It(me.create(null,xa,!0,!1)._buffer)),Jt(Ve,Xt,_o,-1,-1,0,0),Ve}function Qt(Xt){Bt.push(Xt)}function Jt(Xt,Ve,bt,Wt,Sr,Ft,gr){Xt.buffer.bind();var mr;if(Ve){var Gr=gr;!gr&&(!E(Ve)||R(Ve)&&!E(Ve.data))&&(Gr=X.oes_element_index_uint?Si:jn),me._initBuffer(Xt.buffer,Ve,bt,Gr,3)}else C.bufferData(xa,Ft,bt),Xt.buffer.dtype=mr||Dn,Xt.buffer.usage=bt,Xt.buffer.dimension=3,Xt.buffer.byteLength=Ft;if(mr=gr,!gr){switch(Xt.buffer.dtype){case Dn:case jr:mr=Dn;break;case jn:case yn:mr=jn;break;case Si:case Na:mr=Si;break;default:T.raise("unsupported type for element array")}Xt.buffer.dtype=mr}Xt.type=mr,T(mr!==Si||!!X.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Lt=Sr;Lt<0&&(Lt=Xt.buffer.byteLength,mr===jn?Lt>>=1:mr===Si&&(Lt>>=2)),Xt.vertCount=Lt;var wt=Wt;if(Wt<0){wt=cn;var Mr=Xt.buffer.dimension;Mr===1&&(wt=$t),Mr===2&&(wt=Hr),Mr===3&&(wt=cn)}Xt.primType=wt}function tr(Xt){nt.elementsCount--,T(Xt.buffer!==null,"must not double destroy elements"),delete Rt[Xt.id],Xt.buffer.destroy(),Xt.buffer=null}function kt(Xt,Ve){var bt=me.create(null,xa,!0),Wt=new It(bt._buffer);nt.elementsCount++;function Sr(Ft){if(!Ft)bt(),Wt.primType=cn,Wt.vertCount=0,Wt.type=Dn;else if(typeof Ft=="number")bt(Ft),Wt.primType=cn,Wt.vertCount=Ft|0,Wt.type=Dn;else{var gr=null,mr=ni,Gr=-1,Lt=-1,wt=0,Mr=0;Array.isArray(Ft)||E(Ft)||R(Ft)?gr=Ft:(T.type(Ft,"object","invalid arguments for elements"),"data"in Ft&&(gr=Ft.data,T(Array.isArray(gr)||E(gr)||R(gr),"invalid data for element buffer")),"usage"in Ft&&(T.parameter(Ft.usage,Cn,"invalid element buffer usage"),mr=Cn[Ft.usage]),"primitive"in Ft&&(T.parameter(Ft.primitive,Nt,"invalid element buffer primitive"),Gr=Nt[Ft.primitive]),"count"in Ft&&(T(typeof Ft.count=="number"&&Ft.count>=0,"invalid vertex count for elements"),Lt=Ft.count|0),"type"in Ft&&(T.parameter(Ft.type,Tt,"invalid buffer type"),Mr=Tt[Ft.type]),"length"in Ft?wt=Ft.length|0:(wt=Lt,Mr===jn||Mr===yn?wt*=2:(Mr===Si||Mr===Na)&&(wt*=4))),Jt(Wt,gr,mr,Gr,Lt,wt,Mr)}return Sr}return Sr(Xt),Sr._reglType="elements",Sr._elements=Wt,Sr.subdata=function(Ft,gr){return bt.subdata(Ft,gr),Sr},Sr.destroy=function(){tr(Wt)},Sr}return{create:kt,createStream:Kt,destroyStream:Qt,getElements:function(Xt){return typeof Xt=="function"&&Xt._elements instanceof It?Xt._elements:null},clear:function(){z(Rt).forEach(tr)}}}var ls=new Float32Array(1),yc=new Uint32Array(ls.buffer),Il=5123;function _c(C){for(var X=oi.allocType(Il,C.length),me=0;me<C.length;++me)if(isNaN(C[me]))X[me]=65535;else if(C[me]===Infinity)X[me]=31744;else if(C[me]===-Infinity)X[me]=64512;else{ls[0]=C[me];var nt=yc[0],Rt=nt>>>31<<15,ut=(nt<<1>>>24)-127,Tt=nt>>13&(1<<10)-1;if(ut<-24)X[me]=Rt;else if(ut<-14){var It=-14-ut;X[me]=Rt+(Tt+(1<<10)>>It)}else ut>15?X[me]=Rt+31744:X[me]=Rt+(ut+15<<10)+Tt}return X}function Ti(C){return Array.isArray(C)||E(C)}var df=function(C){return!(C&C-1)&&!!C},lh=34467,Qa=3553,Ja=34067,fu=34069,Du=6408,xc=6406,cs=6407,fs=6409,Ol=6410,vf=32854,sa=32855,ba=36194,jd=32819,dp=32820,Ni=33635,ch=34042,Bu=6402,Ws=34041,kl=35904,mf=35906,$s=36193,gf=33776,hs=33777,eo=33778,Zu=33779,fh=35986,hh=35987,Xs=34798,pa=35840,xo=35841,ps=35842,Da=35843,ph=36196,ds=5121,Uu=5123,to=5125,Ys=5126,dh=10242,vh=10243,vp=10497,yf=33071,mp=33648,Sc=10240,rt=10241,Dt=9728,Ct=9729,zr=9984,xn=9985,Gn=9986,hi=9987,Kn=33170,Fl=4352,gp=4353,No=4354,Ko=34046,yp=3317,Ks=37440,_f=37441,qs=37443,ii=37444,bc=33984,_p=[zr,Gn,xn,hi],vs=[0,fs,Ol,cs,Du],So={};So[fs]=So[xc]=So[Bu]=1,So[Ws]=So[Ol]=2,So[cs]=So[kl]=3,So[Du]=So[mf]=4;function Qs(C){return"[object "+C+"]"}var xf=Qs("HTMLCanvasElement"),Nl=Qs("OffscreenCanvas"),hu=Qs("CanvasRenderingContext2D"),Dl=Qs("ImageBitmap"),Sf=Qs("HTMLImageElement"),pu=Qs("HTMLVideoElement"),mh=Object.keys(yi).concat([xf,Nl,hu,Dl,Sf,pu]),ms=[];ms[ds]=1,ms[Ys]=4,ms[$s]=2,ms[Uu]=2,ms[to]=4;var Di=[];Di[vf]=2,Di[sa]=2,Di[ba]=2,Di[Ws]=4,Di[gf]=.5,Di[hs]=.5,Di[eo]=1,Di[Zu]=1,Di[fh]=.5,Di[hh]=1,Di[Xs]=1,Di[pa]=.5,Di[xo]=.25,Di[ps]=.5,Di[Da]=.25,Di[ph]=.5;function Bl(C){return Array.isArray(C)&&(C.length===0||typeof C[0]=="number")}function Zl(C){if(!Array.isArray(C))return!1;var X=C.length;return!(X===0||!Ti(C[0]))}function bo(C){return Object.prototype.toString.call(C)}function Ec(C){return bo(C)===xf}function gh(C){return bo(C)===Nl}function xp(C){return bo(C)===hu}function Sp(C){return bo(C)===Dl}function Js(C){return bo(C)===Sf}function el(C){return bo(C)===pu}function Ul(C){var X=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(X&&C&&C.getContext)}function bp(C){var X=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(X&&C&&"src"in C&&"crossOrigin"in C)}function bf(C){if(!C)return!1;if(Ul(C)||bp(C))return!0;var X=bo(C);return mh.indexOf(X)>=0?!0:Bl(C)||Zl(C)||R(C)}function Ep(C){return yi[Object.prototype.toString.call(C)]|0}function Wd(C,X){var me=X.length;switch(C.type){case ds:case Uu:case to:case Ys:var nt=oi.allocType(C.type,me);nt.set(X),C.data=nt;break;case $s:C.data=_c(X);break;default:T.raise("unsupported texture type, must specify a typed array")}}function Bi(C,X){return oi.allocType(C.type===$s?Ys:C.type,X)}function la(C,X){C.type===$s?(C.data=_c(X),oi.freeType(X)):C.data=X}function Ap(C,X,me,nt,Rt,ut){for(var Tt=C.width,It=C.height,Bt=C.channels,Kt=Tt*It*Bt,Qt=Bi(C,Kt),Jt=0,tr=0;tr<It;++tr)for(var kt=0;kt<Tt;++kt)for(var Xt=0;Xt<Bt;++Xt)Qt[Jt++]=X[me*kt+nt*tr+Rt*Xt+ut];la(C,Qt)}function Ac(C,X,me,nt,Rt,ut){var Tt;if(typeof Di[C]!="undefined"?Tt=Di[C]:Tt=So[C]*ms[X],ut&&(Tt*=6),Rt){for(var It=0,Bt=me;Bt>=1;)It+=Tt*Bt*Bt,Bt/=2;return It}else return Tt*me*nt}function Ba(C,X,me,nt,Rt,ut,Tt){var It={"don't care":Fl,"dont care":Fl,nice:No,fast:gp},Bt={repeat:vp,clamp:yf,mirror:mp},Kt={nearest:Dt,linear:Ct},Qt=ce({mipmap:hi,"nearest mipmap nearest":zr,"linear mipmap nearest":xn,"nearest mipmap linear":Gn,"linear mipmap linear":hi},Kt),Jt={none:0,browser:ii},tr={uint8:ds,rgba4:jd,rgb565:Ni,"rgb5 a1":dp},kt={alpha:xc,luminance:fs,"luminance alpha":Ol,rgb:cs,rgba:Du,rgba4:vf,"rgb5 a1":sa,rgb565:ba},Xt={};X.ext_srgb&&(kt.srgb=kl,kt.srgba=mf),X.oes_texture_float&&(tr.float32=tr.float=Ys),X.oes_texture_half_float&&(tr.float16=tr["half float"]=$s),X.webgl_depth_texture&&(ce(kt,{depth:Bu,"depth stencil":Ws}),ce(tr,{uint16:Uu,uint32:to,"depth stencil":ch})),X.webgl_compressed_texture_s3tc&&ce(Xt,{"rgb s3tc dxt1":gf,"rgba s3tc dxt1":hs,"rgba s3tc dxt3":eo,"rgba s3tc dxt5":Zu}),X.webgl_compressed_texture_atc&&ce(Xt,{"rgb atc":fh,"rgba atc explicit alpha":hh,"rgba atc interpolated alpha":Xs}),X.webgl_compressed_texture_pvrtc&&ce(Xt,{"rgb pvrtc 4bppv1":pa,"rgb pvrtc 2bppv1":xo,"rgba pvrtc 4bppv1":ps,"rgba pvrtc 2bppv1":Da}),X.webgl_compressed_texture_etc1&&(Xt["rgb etc1"]=ph);var Ve=Array.prototype.slice.call(C.getParameter(lh)||new Uint32Array(0));Object.keys(Xt).forEach(function(fe){var yt=Xt[fe];Ve.indexOf(yt)>=0&&(kt[fe]=yt)});var bt=Object.keys(kt);me.textureFormats=bt;var Wt=[];Object.keys(kt).forEach(function(fe){var yt=kt[fe];Wt[yt]=fe});var Sr=[];Object.keys(tr).forEach(function(fe){var yt=tr[fe];Sr[yt]=fe});var Ft=[];Object.keys(Kt).forEach(function(fe){var yt=Kt[fe];Ft[yt]=fe});var gr=[];Object.keys(Qt).forEach(function(fe){var yt=Qt[fe];gr[yt]=fe});var mr=[];Object.keys(Bt).forEach(function(fe){var yt=Bt[fe];mr[yt]=fe});var Gr=bt.reduce(function(fe,yt){var it=kt[yt];return it===fs||it===xc||it===fs||it===Ol||it===Bu||it===Ws||X.ext_srgb&&(it===kl||it===mf)?fe[it]=it:it===sa||yt.indexOf("rgba")>=0?fe[it]=Du:fe[it]=cs,fe},{});function Lt(){this.internalformat=Du,this.format=Du,this.type=ds,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=ii,this.width=0,this.height=0,this.channels=0}function wt(fe,yt){fe.internalformat=yt.internalformat,fe.format=yt.format,fe.type=yt.type,fe.compressed=yt.compressed,fe.premultiplyAlpha=yt.premultiplyAlpha,fe.flipY=yt.flipY,fe.unpackAlignment=yt.unpackAlignment,fe.colorSpace=yt.colorSpace,fe.width=yt.width,fe.height=yt.height,fe.channels=yt.channels}function Mr(fe,yt){if(!(typeof yt!="object"||!yt)){if("premultiplyAlpha"in yt&&(T.type(yt.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),fe.premultiplyAlpha=yt.premultiplyAlpha),"flipY"in yt&&(T.type(yt.flipY,"boolean","invalid texture flip"),fe.flipY=yt.flipY),"alignment"in yt&&(T.oneOf(yt.alignment,[1,2,4,8],"invalid texture unpack alignment"),fe.unpackAlignment=yt.alignment),"colorSpace"in yt&&(T.parameter(yt.colorSpace,Jt,"invalid colorSpace"),fe.colorSpace=Jt[yt.colorSpace]),"type"in yt){var it=yt.type;T(X.oes_texture_float||!(it==="float"||it==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),T(X.oes_texture_half_float||!(it==="half float"||it==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),T(X.webgl_depth_texture||!(it==="uint16"||it==="uint32"||it==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),T.parameter(it,tr,"invalid texture type"),fe.type=tr[it]}var br=fe.width,_n=fe.height,ie=fe.channels,j=!1;"shape"in yt?(T(Array.isArray(yt.shape)&&yt.shape.length>=2,"shape must be an array"),br=yt.shape[0],_n=yt.shape[1],yt.shape.length===3&&(ie=yt.shape[2],T(ie>0&&ie<=4,"invalid number of channels"),j=!0),T(br>=0&&br<=me.maxTextureSize,"invalid width"),T(_n>=0&&_n<=me.maxTextureSize,"invalid height")):("radius"in yt&&(br=_n=yt.radius,T(br>=0&&br<=me.maxTextureSize,"invalid radius")),"width"in yt&&(br=yt.width,T(br>=0&&br<=me.maxTextureSize,"invalid width")),"height"in yt&&(_n=yt.height,T(_n>=0&&_n<=me.maxTextureSize,"invalid height")),"channels"in yt&&(ie=yt.channels,T(ie>0&&ie<=4,"invalid number of channels"),j=!0)),fe.width=br|0,fe.height=_n|0,fe.channels=ie|0;var Ae=!1;if("format"in yt){var De=yt.format;T(X.webgl_depth_texture||!(De==="depth"||De==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),T.parameter(De,kt,"invalid texture format");var mt=fe.internalformat=kt[De];fe.format=Gr[mt],De in tr&&("type"in yt||(fe.type=tr[De])),De in Xt&&(fe.compressed=!0),Ae=!0}!j&&Ae?fe.channels=So[fe.format]:j&&!Ae?fe.channels!==vs[fe.format]&&(fe.format=fe.internalformat=vs[fe.channels]):Ae&&j&&T(fe.channels===So[fe.format],"number of channels inconsistent with specified format")}}function fr(fe){C.pixelStorei(Ks,fe.flipY),C.pixelStorei(_f,fe.premultiplyAlpha),C.pixelStorei(qs,fe.colorSpace),C.pixelStorei(yp,fe.unpackAlignment)}function Vt(){Lt.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function vr(fe,yt){var it=null;if(bf(yt)?it=yt:yt&&(T.type(yt,"object","invalid pixel data type"),Mr(fe,yt),"x"in yt&&(fe.xOffset=yt.x|0),"y"in yt&&(fe.yOffset=yt.y|0),bf(yt.data)&&(it=yt.data)),T(!fe.compressed||it instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),yt.copy){T(!it,"can not specify copy and data field for the same texture");var br=Rt.viewportWidth,_n=Rt.viewportHeight;fe.width=fe.width||br-fe.xOffset,fe.height=fe.height||_n-fe.yOffset,fe.needsCopy=!0,T(fe.xOffset>=0&&fe.xOffset<br&&fe.yOffset>=0&&fe.yOffset<_n&&fe.width>0&&fe.width<=br&&fe.height>0&&fe.height<=_n,"copy texture read out of bounds")}else if(!it)fe.width=fe.width||1,fe.height=fe.height||1,fe.channels=fe.channels||4;else if(E(it))fe.channels=fe.channels||4,fe.data=it,!("type"in yt)&&fe.type===ds&&(fe.type=Ep(it));else if(Bl(it))fe.channels=fe.channels||4,Wd(fe,it),fe.alignment=1,fe.needsFree=!0;else if(R(it)){var ie=it.data;!Array.isArray(ie)&&fe.type===ds&&(fe.type=Ep(ie));var j=it.shape,Ae=it.stride,De,mt,Ie,Le,ke,Q;j.length===3?(Ie=j[2],Q=Ae[2]):(T(j.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Ie=1,Q=1),De=j[0],mt=j[1],Le=Ae[0],ke=Ae[1],fe.alignment=1,fe.width=De,fe.height=mt,fe.channels=Ie,fe.format=fe.internalformat=vs[Ie],fe.needsFree=!0,Ap(fe,ie,Le,ke,Q,it.offset)}else if(Ul(it)||Ec(it)||gh(it)||xp(it))Ul(it)||Ec(it)||gh(it)?fe.element=it:fe.element=it.canvas,fe.width=fe.element.width,fe.height=fe.element.height,fe.channels=4;else if(Sp(it))fe.element=it,fe.width=it.width,fe.height=it.height,fe.channels=4;else if(Js(it))fe.element=it,fe.width=it.naturalWidth,fe.height=it.naturalHeight,fe.channels=4;else if(bp(it))fe.element=it,fe.width=it.width,fe.height=it.height,fe.channels=4;else if(el(it))fe.element=it,fe.width=it.videoWidth,fe.height=it.videoHeight,fe.channels=4;else if(Zl(it)){var Se=fe.width||it[0].length,ue=fe.height||it.length,He=fe.channels;Ti(it[0][0])?He=He||it[0][0].length:He=He||1;for(var Xe=ee.shape(it),Et=1,Ht=0;Ht<Xe.length;++Ht)Et*=Xe[Ht];var or=Bi(fe,Et);ee.flatten(it,Xe,"",or),la(fe,or),fe.alignment=1,fe.width=Se,fe.height=ue,fe.channels=He,fe.format=fe.internalformat=vs[He],fe.needsFree=!0}fe.type===Ys?T(me.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):fe.type===$s&&T(me.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function dr(fe,yt,it){var br=fe.element,_n=fe.data,ie=fe.internalformat,j=fe.format,Ae=fe.type,De=fe.width,mt=fe.height;fr(fe),br?C.texImage2D(yt,it,j,j,Ae,br):fe.compressed?C.compressedTexImage2D(yt,it,ie,De,mt,0,_n):fe.needsCopy?(nt(),C.copyTexImage2D(yt,it,j,fe.xOffset,fe.yOffset,De,mt,0)):C.texImage2D(yt,it,j,De,mt,0,j,Ae,_n||null)}function on(fe,yt,it,br,_n){var ie=fe.element,j=fe.data,Ae=fe.internalformat,De=fe.format,mt=fe.type,Ie=fe.width,Le=fe.height;fr(fe),ie?C.texSubImage2D(yt,_n,it,br,De,mt,ie):fe.compressed?C.compressedTexSubImage2D(yt,_n,it,br,Ae,Ie,Le,j):fe.needsCopy?(nt(),C.copyTexSubImage2D(yt,_n,it,br,fe.xOffset,fe.yOffset,Ie,Le)):C.texSubImage2D(yt,_n,it,br,Ie,Le,De,mt,j)}var $r=[];function hr(){return $r.pop()||new Vt}function yr(fe){fe.needsFree&&oi.freeType(fe.data),Vt.call(fe),$r.push(fe)}function Xr(){Lt.call(this),this.genMipmaps=!1,this.mipmapHint=Fl,this.mipmask=0,this.images=Array(16)}function tn(fe,yt,it){var br=fe.images[0]=hr();fe.mipmask=1,br.width=fe.width=yt,br.height=fe.height=it,br.channels=fe.channels=4}function Sn(fe,yt){var it=null;if(bf(yt))it=fe.images[0]=hr(),wt(it,fe),vr(it,yt),fe.mipmask=1;else if(Mr(fe,yt),Array.isArray(yt.mipmap))for(var br=yt.mipmap,_n=0;_n<br.length;++_n)it=fe.images[_n]=hr(),wt(it,fe),it.width>>=_n,it.height>>=_n,vr(it,br[_n]),fe.mipmask|=1<<_n;else it=fe.images[0]=hr(),wt(it,fe),vr(it,yt),fe.mipmask=1;wt(fe,fe.images[0]),fe.compressed&&(fe.internalformat===gf||fe.internalformat===hs||fe.internalformat===eo||fe.internalformat===Zu)&&T(fe.width%4==0&&fe.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Nn(fe,yt){for(var it=fe.images,br=0;br<it.length;++br){if(!it[br])return;dr(it[br],yt,br)}}var qn=[];function sn(){var fe=qn.pop()||new Xr;Lt.call(fe),fe.mipmask=0;for(var yt=0;yt<16;++yt)fe.images[yt]=null;return fe}function Zi(fe){for(var yt=fe.images,it=0;it<yt.length;++it)yt[it]&&yr(yt[it]),yt[it]=null;qn.push(fe)}function ui(){this.minFilter=Dt,this.magFilter=Dt,this.wrapS=yf,this.wrapT=yf,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Fl}function Ui(fe,yt){if("min"in yt){var it=yt.min;T.parameter(it,Qt),fe.minFilter=Qt[it],_p.indexOf(fe.minFilter)>=0&&!("faces"in yt)&&(fe.genMipmaps=!0)}if("mag"in yt){var br=yt.mag;T.parameter(br,Kt),fe.magFilter=Kt[br]}var _n=fe.wrapS,ie=fe.wrapT;if("wrap"in yt){var j=yt.wrap;typeof j=="string"?(T.parameter(j,Bt),_n=ie=Bt[j]):Array.isArray(j)&&(T.parameter(j[0],Bt),T.parameter(j[1],Bt),_n=Bt[j[0]],ie=Bt[j[1]])}else{if("wrapS"in yt){var Ae=yt.wrapS;T.parameter(Ae,Bt),_n=Bt[Ae]}if("wrapT"in yt){var De=yt.wrapT;T.parameter(De,Bt),ie=Bt[De]}}if(fe.wrapS=_n,fe.wrapT=ie,"anisotropic"in yt){var mt=yt.anisotropic;T(typeof mt=="number"&&mt>=1&&mt<=me.maxAnisotropic,"aniso samples must be between 1 and "),fe.anisotropic=yt.anisotropic}if("mipmap"in yt){var Ie=!1;switch(typeof yt.mipmap){case"string":T.parameter(yt.mipmap,It,"invalid mipmap hint"),fe.mipmapHint=It[yt.mipmap],fe.genMipmaps=!0,Ie=!0;break;case"boolean":Ie=fe.genMipmaps=yt.mipmap;break;case"object":T(Array.isArray(yt.mipmap),"invalid mipmap type"),fe.genMipmaps=!1,Ie=!0;break;default:T.raise("invalid mipmap type")}Ie&&!("min"in yt)&&(fe.minFilter=zr)}}function Li(fe,yt){C.texParameteri(yt,rt,fe.minFilter),C.texParameteri(yt,Sc,fe.magFilter),C.texParameteri(yt,dh,fe.wrapS),C.texParameteri(yt,vh,fe.wrapT),X.ext_texture_filter_anisotropic&&C.texParameteri(yt,Ko,fe.anisotropic),fe.genMipmaps&&(C.hint(Kn,fe.mipmapHint),C.generateMipmap(yt))}var Ki=0,$i={},qi=me.maxTextureUnits,Pi=Array(qi).map(function(){return null});function fn(fe){Lt.call(this),this.mipmask=0,this.internalformat=Du,this.id=Ki++,this.refCount=1,this.target=fe,this.texture=C.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new ui,Tt.profile&&(this.stats={size:0})}function Qi(fe){C.activeTexture(bc),C.bindTexture(fe.target,fe.texture)}function zn(){var fe=Pi[0];fe?C.bindTexture(fe.target,fe.texture):C.bindTexture(Qa,null)}function Xi(fe){var yt=fe.texture;T(yt,"must not double destroy texture");var it=fe.unit,br=fe.target;it>=0&&(C.activeTexture(bc+it),C.bindTexture(br,null),Pi[it]=null),C.deleteTexture(yt),fe.texture=null,fe.params=null,fe.pixels=null,fe.refCount=0,delete $i[fe.id],ut.textureCount--}ce(fn.prototype,{bind:function(){var fe=this;fe.bindCount+=1;var yt=fe.unit;if(yt<0){for(var it=0;it<qi;++it){var br=Pi[it];if(br){if(br.bindCount>0)continue;br.unit=-1}Pi[it]=fe,yt=it;break}yt>=qi&&T.raise("insufficient number of texture units"),Tt.profile&&ut.maxTextureUnits<yt+1&&(ut.maxTextureUnits=yt+1),fe.unit=yt,C.activeTexture(bc+yt),C.bindTexture(fe.target,fe.texture)}return yt},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Xi(this)}});function Kr(fe,yt){var it=new fn(Qa);$i[it.id]=it,ut.textureCount++;function br(j,Ae){var De=it.texInfo;ui.call(De);var mt=sn();return typeof j=="number"?typeof Ae=="number"?tn(mt,j|0,Ae|0):tn(mt,j|0,j|0):j?(T.type(j,"object","invalid arguments to regl.texture"),Ui(De,j),Sn(mt,j)):tn(mt,1,1),De.genMipmaps&&(mt.mipmask=(mt.width<<1)-1),it.mipmask=mt.mipmask,wt(it,mt),T.texture2D(De,mt,me),it.internalformat=mt.internalformat,br.width=mt.width,br.height=mt.height,Qi(it),Nn(mt,Qa),Li(De,Qa),zn(),Zi(mt),Tt.profile&&(it.stats.size=Ac(it.internalformat,it.type,mt.width,mt.height,De.genMipmaps,!1)),br.format=Wt[it.internalformat],br.type=Sr[it.type],br.mag=Ft[De.magFilter],br.min=gr[De.minFilter],br.wrapS=mr[De.wrapS],br.wrapT=mr[De.wrapT],br}function _n(j,Ae,De,mt){T(!!j,"must specify image data");var Ie=Ae|0,Le=De|0,ke=mt|0,Q=hr();return wt(Q,it),Q.width=0,Q.height=0,vr(Q,j),Q.width=Q.width||(it.width>>ke)-Ie,Q.height=Q.height||(it.height>>ke)-Le,T(it.type===Q.type&&it.format===Q.format&&it.internalformat===Q.internalformat,"incompatible format for texture.subimage"),T(Ie>=0&&Le>=0&&Ie+Q.width<=it.width&&Le+Q.height<=it.height,"texture.subimage write out of bounds"),T(it.mipmask&1<<ke,"missing mipmap data"),T(Q.data||Q.element||Q.needsCopy,"missing image data"),Qi(it),on(Q,Qa,Ie,Le,ke),zn(),yr(Q),br}function ie(j,Ae){var De=j|0,mt=Ae|0||De;if(De===it.width&&mt===it.height)return br;br.width=it.width=De,br.height=it.height=mt,Qi(it);for(var Ie=0;it.mipmask>>Ie;++Ie){var Le=De>>Ie,ke=mt>>Ie;if(!Le||!ke)break;C.texImage2D(Qa,Ie,it.format,Le,ke,0,it.format,it.type,null)}return zn(),Tt.profile&&(it.stats.size=Ac(it.internalformat,it.type,De,mt,!1,!1)),br}return br(fe,yt),br.subimage=_n,br.resize=ie,br._reglType="texture2d",br._texture=it,Tt.profile&&(br.stats=it.stats),br.destroy=function(){it.decRef()},br}function vn(fe,yt,it,br,_n,ie){var j=new fn(Ja);$i[j.id]=j,ut.cubeCount++;var Ae=new Array(6);function De(Le,ke,Q,Se,ue,He){var Xe,Et=j.texInfo;for(ui.call(Et),Xe=0;Xe<6;++Xe)Ae[Xe]=sn();if(typeof Le=="number"||!Le){var Ht=Le|0||1;for(Xe=0;Xe<6;++Xe)tn(Ae[Xe],Ht,Ht)}else if(typeof Le=="object")if(ke)Sn(Ae[0],Le),Sn(Ae[1],ke),Sn(Ae[2],Q),Sn(Ae[3],Se),Sn(Ae[4],ue),Sn(Ae[5],He);else if(Ui(Et,Le),Mr(j,Le),"faces"in Le){var or=Le.faces;for(T(Array.isArray(or)&&or.length===6,"cube faces must be a length 6 array"),Xe=0;Xe<6;++Xe)T(typeof or[Xe]=="object"&&!!or[Xe],"invalid input for cube map face"),wt(Ae[Xe],j),Sn(Ae[Xe],or[Xe])}else for(Xe=0;Xe<6;++Xe)Sn(Ae[Xe],Le);else T.raise("invalid arguments to cube map");for(wt(j,Ae[0]),T.optional(function(){me.npotTextureCube||T(df(j.width)&&df(j.height),"your browser does not support non power or two texture dimensions")}),Et.genMipmaps?j.mipmask=(Ae[0].width<<1)-1:j.mipmask=Ae[0].mipmask,T.textureCube(j,Et,Ae,me),j.internalformat=Ae[0].internalformat,De.width=Ae[0].width,De.height=Ae[0].height,Qi(j),Xe=0;Xe<6;++Xe)Nn(Ae[Xe],fu+Xe);for(Li(Et,Ja),zn(),Tt.profile&&(j.stats.size=Ac(j.internalformat,j.type,De.width,De.height,Et.genMipmaps,!0)),De.format=Wt[j.internalformat],De.type=Sr[j.type],De.mag=Ft[Et.magFilter],De.min=gr[Et.minFilter],De.wrapS=mr[Et.wrapS],De.wrapT=mr[Et.wrapT],Xe=0;Xe<6;++Xe)Zi(Ae[Xe]);return De}function mt(Le,ke,Q,Se,ue){T(!!ke,"must specify image data"),T(typeof Le=="number"&&Le===(Le|0)&&Le>=0&&Le<6,"invalid face");var He=Q|0,Xe=Se|0,Et=ue|0,Ht=hr();return wt(Ht,j),Ht.width=0,Ht.height=0,vr(Ht,ke),Ht.width=Ht.width||(j.width>>Et)-He,Ht.height=Ht.height||(j.height>>Et)-Xe,T(j.type===Ht.type&&j.format===Ht.format&&j.internalformat===Ht.internalformat,"incompatible format for texture.subimage"),T(He>=0&&Xe>=0&&He+Ht.width<=j.width&&Xe+Ht.height<=j.height,"texture.subimage write out of bounds"),T(j.mipmask&1<<Et,"missing mipmap data"),T(Ht.data||Ht.element||Ht.needsCopy,"missing image data"),Qi(j),on(Ht,fu+Le,He,Xe,Et),zn(),yr(Ht),De}function Ie(Le){var ke=Le|0;if(ke!==j.width){De.width=j.width=ke,De.height=j.height=ke,Qi(j);for(var Q=0;Q<6;++Q)for(var Se=0;j.mipmask>>Se;++Se)C.texImage2D(fu+Q,Se,j.format,ke>>Se,ke>>Se,0,j.format,j.type,null);return zn(),Tt.profile&&(j.stats.size=Ac(j.internalformat,j.type,De.width,De.height,!1,!0)),De}}return De(fe,yt,it,br,_n,ie),De.subimage=mt,De.resize=Ie,De._reglType="textureCube",De._texture=j,Tt.profile&&(De.stats=j.stats),De.destroy=function(){j.decRef()},De}function Wn(){for(var fe=0;fe<qi;++fe)C.activeTexture(bc+fe),C.bindTexture(Qa,null),Pi[fe]=null;z($i).forEach(Xi),ut.cubeCount=0,ut.textureCount=0}Tt.profile&&(ut.getTotalTextureSize=function(){var fe=0;return Object.keys($i).forEach(function(yt){fe+=$i[yt].stats.size}),fe});function Ii(){for(var fe=0;fe<qi;++fe){var yt=Pi[fe];yt&&(yt.bindCount=0,yt.unit=-1,Pi[fe]=null)}z($i).forEach(function(it){it.texture=C.createTexture(),C.bindTexture(it.target,it.texture);for(var br=0;br<32;++br)if((it.mipmask&1<<br)!=0)if(it.target===Qa)C.texImage2D(Qa,br,it.internalformat,it.width>>br,it.height>>br,0,it.internalformat,it.type,null);else for(var _n=0;_n<6;++_n)C.texImage2D(fu+_n,br,it.internalformat,it.width>>br,it.height>>br,0,it.internalformat,it.type,null);Li(it.texInfo,it.target)})}function wo(){for(var fe=0;fe<qi;++fe){var yt=Pi[fe];yt&&(yt.bindCount=0,yt.unit=-1,Pi[fe]=null),C.activeTexture(bc+fe),C.bindTexture(Qa,null),C.bindTexture(Ja,null)}}return{create2D:Kr,createCube:vn,clear:Wn,getTexture:function(fe){return null},restore:Ii,refresh:wo}}var zu=36161,In=32854,tl=32855,Ef=36194,gs=33189,rl=36168,nl=34041,il=35907,ys=34836,Tc=34842,yh=34843,ro=[];ro[In]=2,ro[tl]=2,ro[Ef]=2,ro[gs]=2,ro[rl]=1,ro[nl]=4,ro[il]=4,ro[ys]=16,ro[Tc]=8,ro[yh]=6;function Tp(C,X,me){return ro[C]*X*me}var $d=function(C,X,me,nt,Rt){var ut={rgba4:In,rgb565:Ef,"rgb5 a1":tl,depth:gs,stencil:rl,"depth stencil":nl};X.ext_srgb&&(ut.srgba=il),X.ext_color_buffer_half_float&&(ut.rgba16f=Tc,ut.rgb16f=yh),X.webgl_color_buffer_float&&(ut.rgba32f=ys);var Tt=[];Object.keys(ut).forEach(function(kt){var Xt=ut[kt];Tt[Xt]=kt});var It=0,Bt={};function Kt(kt){this.id=It++,this.refCount=1,this.renderbuffer=kt,this.format=In,this.width=0,this.height=0,Rt.profile&&(this.stats={size:0})}Kt.prototype.decRef=function(){--this.refCount<=0&&Qt(this)};function Qt(kt){var Xt=kt.renderbuffer;T(Xt,"must not double destroy renderbuffer"),C.bindRenderbuffer(zu,null),C.deleteRenderbuffer(Xt),kt.renderbuffer=null,kt.refCount=0,delete Bt[kt.id],nt.renderbufferCount--}function Jt(kt,Xt){var Ve=new Kt(C.createRenderbuffer());Bt[Ve.id]=Ve,nt.renderbufferCount++;function bt(Sr,Ft){var gr=0,mr=0,Gr=In;if(typeof Sr=="object"&&Sr){var Lt=Sr;if("shape"in Lt){var wt=Lt.shape;T(Array.isArray(wt)&&wt.length>=2,"invalid renderbuffer shape"),gr=wt[0]|0,mr=wt[1]|0}else"radius"in Lt&&(gr=mr=Lt.radius|0),"width"in Lt&&(gr=Lt.width|0),"height"in Lt&&(mr=Lt.height|0);"format"in Lt&&(T.parameter(Lt.format,ut,"invalid renderbuffer format"),Gr=ut[Lt.format])}else typeof Sr=="number"?(gr=Sr|0,typeof Ft=="number"?mr=Ft|0:mr=gr):Sr?T.raise("invalid arguments to renderbuffer constructor"):gr=mr=1;if(T(gr>0&&mr>0&&gr<=me.maxRenderbufferSize&&mr<=me.maxRenderbufferSize,"invalid renderbuffer size"),!(gr===Ve.width&&mr===Ve.height&&Gr===Ve.format))return bt.width=Ve.width=gr,bt.height=Ve.height=mr,Ve.format=Gr,C.bindRenderbuffer(zu,Ve.renderbuffer),C.renderbufferStorage(zu,Gr,gr,mr),T(C.getError()===0,"invalid render buffer format"),Rt.profile&&(Ve.stats.size=Tp(Ve.format,Ve.width,Ve.height)),bt.format=Tt[Ve.format],bt}function Wt(Sr,Ft){var gr=Sr|0,mr=Ft|0||gr;return gr===Ve.width&&mr===Ve.height||(T(gr>0&&mr>0&&gr<=me.maxRenderbufferSize&&mr<=me.maxRenderbufferSize,"invalid renderbuffer size"),bt.width=Ve.width=gr,bt.height=Ve.height=mr,C.bindRenderbuffer(zu,Ve.renderbuffer),C.renderbufferStorage(zu,Ve.format,gr,mr),T(C.getError()===0,"invalid render buffer format"),Rt.profile&&(Ve.stats.size=Tp(Ve.format,Ve.width,Ve.height))),bt}return bt(kt,Xt),bt.resize=Wt,bt._reglType="renderbuffer",bt._renderbuffer=Ve,Rt.profile&&(bt.stats=Ve.stats),bt.destroy=function(){Ve.decRef()},bt}Rt.profile&&(nt.getTotalRenderbufferSize=function(){var kt=0;return Object.keys(Bt).forEach(function(Xt){kt+=Bt[Xt].stats.size}),kt});function tr(){z(Bt).forEach(function(kt){kt.renderbuffer=C.createRenderbuffer(),C.bindRenderbuffer(zu,kt.renderbuffer),C.renderbufferStorage(zu,kt.format,kt.width,kt.height)}),C.bindRenderbuffer(zu,null)}return{create:Jt,clear:function(){z(Bt).forEach(Qt)},restore:tr}},no=36160,Gu=36161,du=3553,K=34069,_s=36064,Vu=36096,da=36128,On=33306,Cc=36053,_h=36054,zl=36055,Do=36057,wc=36061,al=36193,Gl=5121,qo=5126,xh=6407,Qo=6408,Cp=6402,wp=[xh,Qo],Af=[];Af[Qo]=4,Af[xh]=3;var Mc=[];Mc[Gl]=1,Mc[qo]=4,Mc[al]=2;var Mp=32854,Jo=32855,Sh=36194,Rp=33189,bh=36168,xs=34041,Eh=35907,eu=34836,Lp=34842,Rc=34843,Ci=[Mp,Jo,Sh,Eh,Lp,Rc,eu],Ss={};Ss[Cc]="complete",Ss[_h]="incomplete attachment",Ss[Do]="incomplete dimensions",Ss[zl]="incomplete, missing attachment",Ss[wc]="unsupported";function Ah(C,X,me,nt,Rt,ut){var Tt={cur:null,next:null,dirty:!1,setFBO:null},It=["rgba"],Bt=["rgba4","rgb565","rgb5 a1"];X.ext_srgb&&Bt.push("srgba"),X.ext_color_buffer_half_float&&Bt.push("rgba16f","rgb16f"),X.webgl_color_buffer_float&&Bt.push("rgba32f");var Kt=["uint8"];X.oes_texture_half_float&&Kt.push("half float","float16"),X.oes_texture_float&&Kt.push("float","float32");function Qt(Vt,vr,dr){this.target=Vt,this.texture=vr,this.renderbuffer=dr;var on=0,$r=0;vr?(on=vr.width,$r=vr.height):dr&&(on=dr.width,$r=dr.height),this.width=on,this.height=$r}function Jt(Vt){Vt&&(Vt.texture&&Vt.texture._texture.decRef(),Vt.renderbuffer&&Vt.renderbuffer._renderbuffer.decRef())}function tr(Vt,vr,dr){if(!!Vt)if(Vt.texture){var on=Vt.texture._texture,$r=Math.max(1,on.width),hr=Math.max(1,on.height);T($r===vr&&hr===dr,"inconsistent width/height for supplied texture"),on.refCount+=1}else{var yr=Vt.renderbuffer._renderbuffer;T(yr.width===vr&&yr.height===dr,"inconsistent width/height for renderbuffer"),yr.refCount+=1}}function kt(Vt,vr){vr&&(vr.texture?C.framebufferTexture2D(no,Vt,vr.target,vr.texture._texture.texture,0):C.framebufferRenderbuffer(no,Vt,Gu,vr.renderbuffer._renderbuffer.renderbuffer))}function Xt(Vt){var vr=du,dr=null,on=null,$r=Vt;typeof Vt=="object"&&($r=Vt.data,"target"in Vt&&(vr=Vt.target|0)),T.type($r,"function","invalid attachment data");var hr=$r._reglType;return hr==="texture2d"?(dr=$r,T(vr===du)):hr==="textureCube"?(dr=$r,T(vr>=K&&vr<K+6,"invalid cube map target")):hr==="renderbuffer"?(on=$r,vr=Gu):T.raise("invalid regl object for attachment"),new Qt(vr,dr,on)}function Ve(Vt,vr,dr,on,$r){if(dr){var hr=nt.create2D({width:Vt,height:vr,format:on,type:$r});return hr._texture.refCount=0,new Qt(du,hr,null)}else{var yr=Rt.create({width:Vt,height:vr,format:on});return yr._renderbuffer.refCount=0,new Qt(Gu,null,yr)}}function bt(Vt){return Vt&&(Vt.texture||Vt.renderbuffer)}function Wt(Vt,vr,dr){Vt&&(Vt.texture?Vt.texture.resize(vr,dr):Vt.renderbuffer&&Vt.renderbuffer.resize(vr,dr),Vt.width=vr,Vt.height=dr)}var Sr=0,Ft={};function gr(){this.id=Sr++,Ft[this.id]=this,this.framebuffer=C.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function mr(Vt){Vt.colorAttachments.forEach(Jt),Jt(Vt.depthAttachment),Jt(Vt.stencilAttachment),Jt(Vt.depthStencilAttachment)}function Gr(Vt){var vr=Vt.framebuffer;T(vr,"must not double destroy framebuffer"),C.deleteFramebuffer(vr),Vt.framebuffer=null,ut.framebufferCount--,delete Ft[Vt.id]}function Lt(Vt){var vr;C.bindFramebuffer(no,Vt.framebuffer);var dr=Vt.colorAttachments;for(vr=0;vr<dr.length;++vr)kt(_s+vr,dr[vr]);for(vr=dr.length;vr<me.maxColorAttachments;++vr)C.framebufferTexture2D(no,_s+vr,du,null,0);C.framebufferTexture2D(no,On,du,null,0),C.framebufferTexture2D(no,Vu,du,null,0),C.framebufferTexture2D(no,da,du,null,0),kt(Vu,Vt.depthAttachment),kt(da,Vt.stencilAttachment),kt(On,Vt.depthStencilAttachment);var on=C.checkFramebufferStatus(no);!C.isContextLost()&&on!==Cc&&T.raise("framebuffer configuration not supported, status = "+Ss[on]),C.bindFramebuffer(no,Tt.next?Tt.next.framebuffer:null),Tt.cur=Tt.next,C.getError()}function wt(Vt,vr){var dr=new gr;ut.framebufferCount++;function on(hr,yr){var Xr;T(Tt.next!==dr,"can not update framebuffer which is currently in use");var tn=0,Sn=0,Nn=!0,qn=!0,sn=null,Zi=!0,ui="rgba",Ui="uint8",Li=1,Ki=null,$i=null,qi=null,Pi=!1;if(typeof hr=="number")tn=hr|0,Sn=yr|0||tn;else if(!hr)tn=Sn=1;else{T.type(hr,"object","invalid arguments for framebuffer");var fn=hr;if("shape"in fn){var Qi=fn.shape;T(Array.isArray(Qi)&&Qi.length>=2,"invalid shape for framebuffer"),tn=Qi[0],Sn=Qi[1]}else"radius"in fn&&(tn=Sn=fn.radius),"width"in fn&&(tn=fn.width),"height"in fn&&(Sn=fn.height);("color"in fn||"colors"in fn)&&(sn=fn.color||fn.colors,Array.isArray(sn)&&T(sn.length===1||X.webgl_draw_buffers,"multiple render targets not supported")),sn||("colorCount"in fn&&(Li=fn.colorCount|0,T(Li>0,"invalid color buffer count")),"colorTexture"in fn&&(Zi=!!fn.colorTexture,ui="rgba4"),"colorType"in fn&&(Ui=fn.colorType,Zi?(T(X.oes_texture_float||!(Ui==="float"||Ui==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),T(X.oes_texture_half_float||!(Ui==="half float"||Ui==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ui==="half float"||Ui==="float16"?(T(X.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),ui="rgba16f"):(Ui==="float"||Ui==="float32")&&(T(X.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),ui="rgba32f"),T.oneOf(Ui,Kt,"invalid color type")),"colorFormat"in fn&&(ui=fn.colorFormat,It.indexOf(ui)>=0?Zi=!0:Bt.indexOf(ui)>=0?Zi=!1:T.optional(function(){Zi?T.oneOf(fn.colorFormat,It,"invalid color format for texture"):T.oneOf(fn.colorFormat,Bt,"invalid color format for renderbuffer")}))),("depthTexture"in fn||"depthStencilTexture"in fn)&&(Pi=!!(fn.depthTexture||fn.depthStencilTexture),T(!Pi||X.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in fn&&(typeof fn.depth=="boolean"?Nn=fn.depth:(Ki=fn.depth,qn=!1)),"stencil"in fn&&(typeof fn.stencil=="boolean"?qn=fn.stencil:($i=fn.stencil,Nn=!1)),"depthStencil"in fn&&(typeof fn.depthStencil=="boolean"?Nn=qn=fn.depthStencil:(qi=fn.depthStencil,Nn=!1,qn=!1))}var zn=null,Xi=null,Kr=null,vn=null;if(Array.isArray(sn))zn=sn.map(Xt);else if(sn)zn=[Xt(sn)];else for(zn=new Array(Li),Xr=0;Xr<Li;++Xr)zn[Xr]=Ve(tn,Sn,Zi,ui,Ui);T(X.webgl_draw_buffers||zn.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),T(zn.length<=me.maxColorAttachments,"too many color attachments, not supported"),tn=tn||zn[0].width,Sn=Sn||zn[0].height,Ki?Xi=Xt(Ki):Nn&&!qn&&(Xi=Ve(tn,Sn,Pi,"depth","uint32")),$i?Kr=Xt($i):qn&&!Nn&&(Kr=Ve(tn,Sn,!1,"stencil","uint8")),qi?vn=Xt(qi):!Ki&&!$i&&qn&&Nn&&(vn=Ve(tn,Sn,Pi,"depth stencil","depth stencil")),T(!!Ki+!!$i+!!qi<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Wn=null;for(Xr=0;Xr<zn.length;++Xr)if(tr(zn[Xr],tn,Sn),T(!zn[Xr]||zn[Xr].texture&&wp.indexOf(zn[Xr].texture._texture.format)>=0||zn[Xr].renderbuffer&&Ci.indexOf(zn[Xr].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Xr+" is invalid"),zn[Xr]&&zn[Xr].texture){var Ii=Af[zn[Xr].texture._texture.format]*Mc[zn[Xr].texture._texture.type];Wn===null?Wn=Ii:T(Wn===Ii,"all color attachments much have the same number of bits per pixel.")}return tr(Xi,tn,Sn),T(!Xi||Xi.texture&&Xi.texture._texture.format===Cp||Xi.renderbuffer&&Xi.renderbuffer._renderbuffer.format===Rp,"invalid depth attachment for framebuffer object"),tr(Kr,tn,Sn),T(!Kr||Kr.renderbuffer&&Kr.renderbuffer._renderbuffer.format===bh,"invalid stencil attachment for framebuffer object"),tr(vn,tn,Sn),T(!vn||vn.texture&&vn.texture._texture.format===xs||vn.renderbuffer&&vn.renderbuffer._renderbuffer.format===xs,"invalid depth-stencil attachment for framebuffer object"),mr(dr),dr.width=tn,dr.height=Sn,dr.colorAttachments=zn,dr.depthAttachment=Xi,dr.stencilAttachment=Kr,dr.depthStencilAttachment=vn,on.color=zn.map(bt),on.depth=bt(Xi),on.stencil=bt(Kr),on.depthStencil=bt(vn),on.width=dr.width,on.height=dr.height,Lt(dr),on}function $r(hr,yr){T(Tt.next!==dr,"can not resize a framebuffer which is currently in use");var Xr=Math.max(hr|0,1),tn=Math.max(yr|0||Xr,1);if(Xr===dr.width&&tn===dr.height)return on;for(var Sn=dr.colorAttachments,Nn=0;Nn<Sn.length;++Nn)Wt(Sn[Nn],Xr,tn);return Wt(dr.depthAttachment,Xr,tn),Wt(dr.stencilAttachment,Xr,tn),Wt(dr.depthStencilAttachment,Xr,tn),dr.width=on.width=Xr,dr.height=on.height=tn,Lt(dr),on}return on(Vt,vr),ce(on,{resize:$r,_reglType:"framebuffer",_framebuffer:dr,destroy:function(){Gr(dr),mr(dr)},use:function(hr){Tt.setFBO({framebuffer:on},hr)}})}function Mr(Vt){var vr=Array(6);function dr($r){var hr;T(vr.indexOf(Tt.next)<0,"can not update framebuffer which is currently in use");var yr={color:null},Xr=0,tn=null,Sn="rgba",Nn="uint8",qn=1;if(typeof $r=="number")Xr=$r|0;else if(!$r)Xr=1;else{T.type($r,"object","invalid arguments for framebuffer");var sn=$r;if("shape"in sn){var Zi=sn.shape;T(Array.isArray(Zi)&&Zi.length>=2,"invalid shape for framebuffer"),T(Zi[0]===Zi[1],"cube framebuffer must be square"),Xr=Zi[0]}else"radius"in sn&&(Xr=sn.radius|0),"width"in sn?(Xr=sn.width|0,"height"in sn&&T(sn.height===Xr,"must be square")):"height"in sn&&(Xr=sn.height|0);("color"in sn||"colors"in sn)&&(tn=sn.color||sn.colors,Array.isArray(tn)&&T(tn.length===1||X.webgl_draw_buffers,"multiple render targets not supported")),tn||("colorCount"in sn&&(qn=sn.colorCount|0,T(qn>0,"invalid color buffer count")),"colorType"in sn&&(T.oneOf(sn.colorType,Kt,"invalid color type"),Nn=sn.colorType),"colorFormat"in sn&&(Sn=sn.colorFormat,T.oneOf(sn.colorFormat,It,"invalid color format for texture"))),"depth"in sn&&(yr.depth=sn.depth),"stencil"in sn&&(yr.stencil=sn.stencil),"depthStencil"in sn&&(yr.depthStencil=sn.depthStencil)}var ui;if(tn)if(Array.isArray(tn))for(ui=[],hr=0;hr<tn.length;++hr)ui[hr]=tn[hr];else ui=[tn];else{ui=Array(qn);var Ui={radius:Xr,format:Sn,type:Nn};for(hr=0;hr<qn;++hr)ui[hr]=nt.createCube(Ui)}for(yr.color=Array(ui.length),hr=0;hr<ui.length;++hr){var Li=ui[hr];T(typeof Li=="function"&&Li._reglType==="textureCube","invalid cube map"),Xr=Xr||Li.width,T(Li.width===Xr&&Li.height===Xr,"invalid cube map shape"),yr.color[hr]={target:K,data:ui[hr]}}for(hr=0;hr<6;++hr){for(var Ki=0;Ki<ui.length;++Ki)yr.color[Ki].target=K+hr;hr>0&&(yr.depth=vr[0].depth,yr.stencil=vr[0].stencil,yr.depthStencil=vr[0].depthStencil),vr[hr]?vr[hr](yr):vr[hr]=wt(yr)}return ce(dr,{width:Xr,height:Xr,color:ui})}function on($r){var hr,yr=$r|0;if(T(yr>0&&yr<=me.maxCubeMapSize,"invalid radius for cube fbo"),yr===dr.width)return dr;var Xr=dr.color;for(hr=0;hr<Xr.length;++hr)Xr[hr].resize(yr);for(hr=0;hr<6;++hr)vr[hr].resize(yr);return dr.width=dr.height=yr,dr}return dr(Vt),ce(dr,{faces:vr,resize:on,_reglType:"framebufferCube",destroy:function(){vr.forEach(function($r){$r.destroy()})}})}function fr(){Tt.cur=null,Tt.next=null,Tt.dirty=!0,z(Ft).forEach(function(Vt){Vt.framebuffer=C.createFramebuffer(),Lt(Vt)})}return ce(Tt,{getFramebuffer:function(Vt){if(typeof Vt=="function"&&Vt._reglType==="framebuffer"){var vr=Vt._framebuffer;if(vr instanceof gr)return vr}return null},create:wt,createCube:Mr,clear:function(){z(Ft).forEach(Gr)},restore:fr})}var Tf=5126,Cf=34962,Vl=34963,wf=["attributes","elements","offset","count","primitive","instances"];function io(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Tf,this.offset=0,this.stride=0,this.divisor=0}function Mf(C,X,me,nt,Rt,ut,Tt){for(var It=me.maxAttributes,Bt=new Array(It),Kt=0;Kt<It;++Kt)Bt[Kt]=new io;var Qt=0,Jt={},tr={Record:io,scope:{},state:Bt,currentVAO:null,targetVAO:null,restore:Xt()?mr:function(){},createVAO:Gr,getVAO:bt,destroyBuffer:kt,setVAO:Xt()?Wt:Sr,clear:Xt()?Ft:function(){}};function kt(Lt){for(var wt=0;wt<Bt.length;++wt){var Mr=Bt[wt];Mr.buffer===Lt&&(C.disableVertexAttribArray(wt),Mr.buffer=null)}}function Xt(){return X.oes_vertex_array_object}function Ve(){return X.angle_instanced_arrays}function bt(Lt){return typeof Lt=="function"&&Lt._vao?Lt._vao:null}function Wt(Lt){if(Lt!==tr.currentVAO){var wt=Xt();Lt?wt.bindVertexArrayOES(Lt.vao):wt.bindVertexArrayOES(null),tr.currentVAO=Lt}}function Sr(Lt){if(Lt!==tr.currentVAO){if(Lt)Lt.bindAttrs();else{for(var wt=Ve(),Mr=0;Mr<Bt.length;++Mr){var fr=Bt[Mr];fr.buffer?(C.enableVertexAttribArray(Mr),fr.buffer.bind(),C.vertexAttribPointer(Mr,fr.size,fr.type,fr.normalized,fr.stride,fr.offfset),wt&&fr.divisor&&wt.vertexAttribDivisorANGLE(Mr,fr.divisor)):(C.disableVertexAttribArray(Mr),C.vertexAttrib4f(Mr,fr.x,fr.y,fr.z,fr.w))}Tt.elements?C.bindBuffer(Vl,Tt.elements.buffer.buffer):C.bindBuffer(Vl,null)}tr.currentVAO=Lt}}function Ft(){z(Jt).forEach(function(Lt){Lt.destroy()})}function gr(){this.id=++Qt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Lt=Xt();Lt?this.vao=Lt.createVertexArrayOES():this.vao=null,Jt[this.id]=this,this.buffers=[]}gr.prototype.bindAttrs=function(){for(var Lt=Ve(),wt=this.attributes,Mr=0;Mr<wt.length;++Mr){var fr=wt[Mr];fr.buffer?(C.enableVertexAttribArray(Mr),C.bindBuffer(Cf,fr.buffer.buffer),C.vertexAttribPointer(Mr,fr.size,fr.type,fr.normalized,fr.stride,fr.offset),Lt&&fr.divisor&&Lt.vertexAttribDivisorANGLE(Mr,fr.divisor)):(C.disableVertexAttribArray(Mr),C.vertexAttrib4f(Mr,fr.x,fr.y,fr.z,fr.w))}for(var Vt=wt.length;Vt<It;++Vt)C.disableVertexAttribArray(Vt);var vr=ut.getElements(this.elements);vr?C.bindBuffer(Vl,vr.buffer.buffer):C.bindBuffer(Vl,null)},gr.prototype.refresh=function(){var Lt=Xt();Lt&&(Lt.bindVertexArrayOES(this.vao),this.bindAttrs(),tr.currentVAO=null,Lt.bindVertexArrayOES(null))},gr.prototype.destroy=function(){if(this.vao){var Lt=Xt();this===tr.currentVAO&&(tr.currentVAO=null,Lt.bindVertexArrayOES(null)),Lt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Jt[this.id]&&(delete Jt[this.id],nt.vaoCount-=1)};function mr(){var Lt=Xt();Lt&&z(Jt).forEach(function(wt){wt.refresh()})}function Gr(Lt){var wt=new gr;nt.vaoCount+=1;function Mr(fr){var Vt;if(Array.isArray(fr))Vt=fr,wt.elements&&wt.ownsElements&&wt.elements.destroy(),wt.elements=null,wt.ownsElements=!1,wt.offset=0,wt.count=0,wt.instances=-1,wt.primitive=4;else{if(T(typeof fr=="object","invalid arguments for create vao"),T("attributes"in fr,"must specify attributes for vao"),fr.elements){var vr=fr.elements;wt.ownsElements?typeof vr=="function"&&vr._reglType==="elements"?(wt.elements.destroy(),wt.ownsElements=!1):(wt.elements(vr),wt.ownsElements=!1):ut.getElements(fr.elements)?(wt.elements=fr.elements,wt.ownsElements=!1):(wt.elements=ut.create(fr.elements),wt.ownsElements=!0)}else wt.elements=null,wt.ownsElements=!1;Vt=fr.attributes,wt.offset=0,wt.count=-1,wt.instances=-1,wt.primitive=4,wt.elements&&(wt.count=wt.elements._elements.vertCount,wt.primitive=wt.elements._elements.primType),"offset"in fr&&(wt.offset=fr.offset|0),"count"in fr&&(wt.count=fr.count|0),"instances"in fr&&(wt.instances=fr.instances|0),"primitive"in fr&&(T(fr.primitive in Nt,"bad primitive type: "+fr.primitive),wt.primitive=Nt[fr.primitive]),T.optional(function(){for(var Nn=Object.keys(fr),qn=0;qn<Nn.length;++qn)T(wf.indexOf(Nn[qn])>=0,'invalid option for vao: "'+Nn[qn]+'" valid options are '+wf)}),T(Array.isArray(Vt),"attributes must be an array")}T(Vt.length<It,"too many attributes"),T(Vt.length>0,"must specify at least one attribute");var dr={},on=wt.attributes;on.length=Vt.length;for(var $r=0;$r<Vt.length;++$r){var hr=Vt[$r],yr=on[$r]=new io,Xr=hr.data||hr;if(Array.isArray(Xr)||E(Xr)||R(Xr)){var tn;wt.buffers[$r]&&(tn=wt.buffers[$r],E(Xr)&&tn._buffer.byteLength>=Xr.byteLength?tn.subdata(Xr):(tn.destroy(),wt.buffers[$r]=null)),wt.buffers[$r]||(tn=wt.buffers[$r]=Rt.create(hr,Cf,!1,!0)),yr.buffer=Rt.getBuffer(tn),yr.size=yr.buffer.dimension|0,yr.normalized=!1,yr.type=yr.buffer.dtype,yr.offset=0,yr.stride=0,yr.divisor=0,yr.state=1,dr[$r]=1}else Rt.getBuffer(hr)?(yr.buffer=Rt.getBuffer(hr),yr.size=yr.buffer.dimension|0,yr.normalized=!1,yr.type=yr.buffer.dtype,yr.offset=0,yr.stride=0,yr.divisor=0,yr.state=1):Rt.getBuffer(hr.buffer)?(yr.buffer=Rt.getBuffer(hr.buffer),yr.size=(+hr.size||yr.buffer.dimension)|0,yr.normalized=!!hr.normalized||!1,"type"in hr?(T.parameter(hr.type,qa,"invalid buffer type"),yr.type=qa[hr.type]):yr.type=yr.buffer.dtype,yr.offset=(hr.offset||0)|0,yr.stride=(hr.stride||0)|0,yr.divisor=(hr.divisor||0)|0,yr.state=1,T(yr.size>=1&&yr.size<=4,"size must be between 1 and 4"),T(yr.offset>=0,"invalid offset"),T(yr.stride>=0&&yr.stride<=255,"stride must be between 0 and 255"),T(yr.divisor>=0,"divisor must be positive"),T(!yr.divisor||!!X.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in hr?(T($r>0,"first attribute must not be a constant"),yr.x=+hr.x||0,yr.y=+hr.y||0,yr.z=+hr.z||0,yr.w=+hr.w||0,yr.state=2):T(!1,"invalid attribute spec for location "+$r)}for(var Sn=0;Sn<wt.buffers.length;++Sn)!dr[Sn]&&wt.buffers[Sn]&&(wt.buffers[Sn].destroy(),wt.buffers[Sn]=null);return wt.refresh(),Mr}return Mr.destroy=function(){for(var fr=0;fr<wt.buffers.length;++fr)wt.buffers[fr]&&wt.buffers[fr].destroy();wt.buffers.length=0,wt.ownsElements&&(wt.elements.destroy(),wt.elements=null,wt.ownsElements=!1),wt.destroy()},Mr._vao=wt,Mr._reglType="vao",Mr(Lt)}return tr}var Pp=35632,wn=35633,Bo=35718,Eo=35721;function Rf(C,X,me,nt){var Rt={},ut={};function Tt(Ve,bt,Wt,Sr){this.name=Ve,this.id=bt,this.location=Wt,this.info=Sr}function It(Ve,bt){for(var Wt=0;Wt<Ve.length;++Wt)if(Ve[Wt].id===bt.id){Ve[Wt].location=bt.location;return}Ve.push(bt)}function Bt(Ve,bt,Wt){var Sr=Ve===Pp?Rt:ut,Ft=Sr[bt];if(!Ft){var gr=X.str(bt);Ft=C.createShader(Ve),C.shaderSource(Ft,gr),C.compileShader(Ft),T.shaderError(C,Ft,gr,Ve,Wt),Sr[bt]=Ft}return Ft}var Kt={},Qt=[],Jt=0;function tr(Ve,bt){this.id=Jt++,this.fragId=Ve,this.vertId=bt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,nt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function kt(Ve,bt,Wt){var Sr,Ft,gr=Bt(Pp,Ve.fragId),mr=Bt(wn,Ve.vertId),Gr=Ve.program=C.createProgram();if(C.attachShader(Gr,gr),C.attachShader(Gr,mr),Wt)for(Sr=0;Sr<Wt.length;++Sr){var Lt=Wt[Sr];C.bindAttribLocation(Gr,Lt[0],Lt[1])}C.linkProgram(Gr),T.linkError(C,Gr,X.str(Ve.fragId),X.str(Ve.vertId),bt);var wt=C.getProgramParameter(Gr,Bo);nt.profile&&(Ve.stats.uniformsCount=wt);var Mr=Ve.uniforms;for(Sr=0;Sr<wt;++Sr)if(Ft=C.getActiveUniform(Gr,Sr),Ft)if(Ft.size>1)for(var fr=0;fr<Ft.size;++fr){var Vt=Ft.name.replace("[0]","["+fr+"]");It(Mr,new Tt(Vt,X.id(Vt),C.getUniformLocation(Gr,Vt),Ft))}else It(Mr,new Tt(Ft.name,X.id(Ft.name),C.getUniformLocation(Gr,Ft.name),Ft));var vr=C.getProgramParameter(Gr,Eo);nt.profile&&(Ve.stats.attributesCount=vr);var dr=Ve.attributes;for(Sr=0;Sr<vr;++Sr)Ft=C.getActiveAttrib(Gr,Sr),Ft&&It(dr,new Tt(Ft.name,X.id(Ft.name),C.getAttribLocation(Gr,Ft.name),Ft))}nt.profile&&(me.getMaxUniformsCount=function(){var Ve=0;return Qt.forEach(function(bt){bt.stats.uniformsCount>Ve&&(Ve=bt.stats.uniformsCount)}),Ve},me.getMaxAttributesCount=function(){var Ve=0;return Qt.forEach(function(bt){bt.stats.attributesCount>Ve&&(Ve=bt.stats.attributesCount)}),Ve});function Xt(){Rt={},ut={};for(var Ve=0;Ve<Qt.length;++Ve)kt(Qt[Ve],null,Qt[Ve].attributes.map(function(bt){return[bt.location,bt.name]}))}return{clear:function(){var Ve=C.deleteShader.bind(C);z(Rt).forEach(Ve),Rt={},z(ut).forEach(Ve),ut={},Qt.forEach(function(bt){C.deleteProgram(bt.program)}),Qt.length=0,Kt={},me.shaderCount=0},program:function(Ve,bt,Wt,Sr){T.command(Ve>=0,"missing vertex shader",Wt),T.command(bt>=0,"missing fragment shader",Wt);var Ft=Kt[bt];Ft||(Ft=Kt[bt]={});var gr=Ft[Ve];if(gr&&(gr.refCount++,!Sr))return gr;var mr=new tr(bt,Ve);return me.shaderCount++,kt(mr,Wt,Sr),gr||(Ft[Ve]=mr),Qt.push(mr),ce(mr,{destroy:function(){if(mr.refCount--,mr.refCount<=0){C.deleteProgram(mr.program);var Gr=Qt.indexOf(mr);Qt.splice(Gr,1),me.shaderCount--}Ft[mr.vertId].refCount<=0&&(C.deleteShader(ut[mr.vertId]),delete ut[mr.vertId],delete Kt[mr.fragId][mr.vertId]),Object.keys(Kt[mr.fragId]).length||(C.deleteShader(Rt[mr.fragId]),delete Rt[mr.fragId],delete Kt[mr.fragId])}})},restore:Xt,shader:Bt,frag:-1,vert:-1}}var Th=6408,Hl=5121,vu=3333,ol=5126;function mu(C,X,me,nt,Rt,ut,Tt){function It(Qt){var Jt;X.next===null?(T(Rt.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Jt=Hl):(T(X.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Jt=X.next.colorAttachments[0].texture._texture.type,T.optional(function(){ut.oes_texture_float?(T(Jt===Hl||Jt===ol,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Jt===ol&&T(Tt.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):T(Jt===Hl,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var tr=0,kt=0,Xt=nt.framebufferWidth,Ve=nt.framebufferHeight,bt=null;E(Qt)?bt=Qt:Qt&&(T.type(Qt,"object","invalid arguments to regl.read()"),tr=Qt.x|0,kt=Qt.y|0,T(tr>=0&&tr<nt.framebufferWidth,"invalid x offset for regl.read"),T(kt>=0&&kt<nt.framebufferHeight,"invalid y offset for regl.read"),Xt=(Qt.width||nt.framebufferWidth-tr)|0,Ve=(Qt.height||nt.framebufferHeight-kt)|0,bt=Qt.data||null),bt&&(Jt===Hl?T(bt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Jt===ol&&T(bt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),T(Xt>0&&Xt+tr<=nt.framebufferWidth,"invalid width for read pixels"),T(Ve>0&&Ve+kt<=nt.framebufferHeight,"invalid height for read pixels"),me();var Wt=Xt*Ve*4;return bt||(Jt===Hl?bt=new Uint8Array(Wt):Jt===ol&&(bt=bt||new Float32Array(Wt))),T.isTypedArray(bt,"data buffer for regl.read() must be a typedarray"),T(bt.byteLength>=Wt,"data buffer for regl.read() too small"),C.pixelStorei(vu,4),C.readPixels(tr,kt,Xt,Ve,Th,Jt,bt),bt}function Bt(Qt){var Jt;return X.setFBO({framebuffer:Qt.framebuffer},function(){Jt=It(Qt)}),Jt}function Kt(Qt){return!Qt||!("framebuffer"in Qt)?It(Qt):Bt(Qt)}return Kt}function Yi(C){return Array.prototype.slice.call(C)}function Ao(C){return Yi(C).join("")}function jl(){var C=0,X=[],me=[];function nt(Jt){for(var tr=0;tr<me.length;++tr)if(me[tr]===Jt)return X[tr];var kt="g"+C++;return X.push(kt),me.push(Jt),kt}function Rt(){var Jt=[];function tr(){Jt.push.apply(Jt,Yi(arguments))}var kt=[];function Xt(){var Ve="v"+C++;return kt.push(Ve),arguments.length>0&&(Jt.push(Ve,"="),Jt.push.apply(Jt,Yi(arguments)),Jt.push(";")),Ve}return ce(tr,{def:Xt,toString:function(){return Ao([kt.length>0?"var "+kt.join(",")+";":"",Ao(Jt)])}})}function ut(){var Jt=Rt(),tr=Rt(),kt=Jt.toString,Xt=tr.toString;function Ve(bt,Wt){tr(bt,Wt,"=",Jt.def(bt,Wt),";")}return ce(function(){Jt.apply(Jt,Yi(arguments))},{def:Jt.def,entry:Jt,exit:tr,save:Ve,set:function(bt,Wt,Sr){Ve(bt,Wt),Jt(bt,Wt,"=",Sr,";")},toString:function(){return kt()+Xt()}})}function Tt(){var Jt=Ao(arguments),tr=ut(),kt=ut(),Xt=tr.toString,Ve=kt.toString;return ce(tr,{then:function(){return tr.apply(tr,Yi(arguments)),this},else:function(){return kt.apply(kt,Yi(arguments)),this},toString:function(){var bt=Ve();return bt&&(bt="else{"+bt+"}"),Ao(["if(",Jt,"){",Xt(),"}",bt])}})}var It=Rt(),Bt={};function Kt(Jt,tr){var kt=[];function Xt(){var Ft="a"+kt.length;return kt.push(Ft),Ft}tr=tr||0;for(var Ve=0;Ve<tr;++Ve)Xt();var bt=ut(),Wt=bt.toString,Sr=Bt[Jt]=ce(bt,{arg:Xt,toString:function(){return Ao(["function(",kt.join(),"){",Wt(),"}"])}});return Sr}function Qt(){var Jt=['"use strict";',It,"return {"];Object.keys(Bt).forEach(function(Ve){Jt.push('"',Ve,'":',Bt[Ve].toString(),",")}),Jt.push("}");var tr=Ao(Jt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),kt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Xt=kt?oe.Function.apply(null,X.concat(tr)):Function.apply(null,X.concat(tr));return Xt.apply(null,me)}return{global:It,link:nt,block:Rt,proc:Kt,scope:ut,cond:Tt,compile:Qt}}var Dr="xyzw".split(""),Rr=5121,Za=1,Wl=2,Lc=0,ul=1,bn=2,va=3,ei=4,tu=5,Lf=6,To="dither",sl="blend.enable",Pc="blend.color",gu="blend.equation",$l="blend.func",ma="depth.enable",Pf="depth.func",Ch="depth.range",bi="depth.mask",Ic="colorMask",Xl="cull.enable",Ip="cull.face",bs="frontFace",Oc="lineWidth",kc="polygonOffset.enable",Es="polygonOffset.offset",As="sample.alpha",Hu="sample.enable",Yl="sample.coverage",Fc="stencil.enable",If="stencil.mask",wh="stencil.func",ll="stencil.opFront",Nc="stencil.opBack",Mh="scissor.enable",cl="scissor.box",ru="viewport",fl="profile",nu="framebuffer",hl="vert",ju="frag",ao="elements",Ts="primitive",Wu="count",pl="offset",Of="instances",Cs="vao",Kl="Width",Dc="Height",ws=nu+Kl,$u=nu+Dc,Op=ru+Kl,ji=ru+Dc,Ln="drawingBuffer",ql=Ln+Kl,kp=Ln+Dc,Ql=[$l,gu,wh,ll,Nc,Yl,ru,cl,Es],dl=34962,Ms=34963,kf=35632,Ea=35633,Ff=3553,Jl=34067,Nf=2884,Df=3042,Fp=3024,oo=2960,Rs=2929,Zo=3089,Rh=32823,Bc=32926,Np=32928,Zc=5126,ec=35664,Ls=35665,tc=35666,uo=5124,Uc=35667,Co=35668,vl=35669,Bf=35670,ml=35671,rc=35672,zc=35673,nc=35674,ic=35675,gl=35676,ac=35678,Ps=35680,Zf=4,ta=1028,ga=1029,Lh=2304,Uf=2305,oc=32775,yl=32776,Ph=519,Uo=7680,Gc=0,zf=1,Is=32774,Wi=513,Vc=36160,Os=36064,wi={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},_l=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Xu={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ua={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Hc={frag:kf,vert:Ea},xl={cw:Lh,ccw:Uf};function jc(C){return Array.isArray(C)||E(C)||R(C)}function Wc(C){return C.sort(function(X,me){return X===ru?-1:me===ru?1:X<me?-1:1})}function _i(C,X,me,nt){this.thisDep=C,this.contextDep=X,this.propDep=me,this.append=nt}function so(C){return C&&!(C.thisDep||C.contextDep||C.propDep)}function Mi(C){return new _i(!1,!1,!1,C)}function Aa(C,X){var me=C.type;if(me===Lc){var nt=C.data.length;return new _i(!0,nt>=1,nt>=2,X)}else if(me===ei){var Rt=C.data;return new _i(Rt.thisDep,Rt.contextDep,Rt.propDep,X)}else{if(me===tu)return new _i(!1,!1,!1,X);if(me===Lf){for(var ut=!1,Tt=!1,It=!1,Bt=0;Bt<C.data.length;++Bt){var Kt=C.data[Bt];if(Kt.type===ul)It=!0;else if(Kt.type===bn)Tt=!0;else if(Kt.type===va)ut=!0;else if(Kt.type===Lc){ut=!0;var Qt=Kt.data;Qt>=1&&(Tt=!0),Qt>=2&&(It=!0)}else Kt.type===ei&&(ut=ut||Kt.data.thisDep,Tt=Tt||Kt.data.contextDep,It=It||Kt.data.propDep)}return new _i(ut,Tt,It,X)}else return new _i(me===va,me===bn,me===ul,X)}}var Gf=new _i(!1,!1,!1,function(){});function yu(C,X,me,nt,Rt,ut,Tt,It,Bt,Kt,Qt,Jt,tr,kt,Xt){var Ve=Kt.Record,bt={add:32774,subtract:32778,"reverse subtract":32779};me.ext_blend_minmax&&(bt.min=oc,bt.max=yl);var Wt=me.angle_instanced_arrays,Sr=me.webgl_draw_buffers,Ft=me.oes_vertex_array_object,gr={dirty:!0,profile:Xt.profile},mr={},Gr=[],Lt={},wt={};function Mr(ie){return ie.replace(".","_")}function fr(ie,j,Ae){var De=Mr(ie);Gr.push(ie),mr[De]=gr[De]=!!Ae,Lt[De]=j}function Vt(ie,j,Ae){var De=Mr(ie);Gr.push(ie),Array.isArray(Ae)?(gr[De]=Ae.slice(),mr[De]=Ae.slice()):gr[De]=mr[De]=Ae,wt[De]=j}fr(To,Fp),fr(sl,Df),Vt(Pc,"blendColor",[0,0,0,0]),Vt(gu,"blendEquationSeparate",[Is,Is]),Vt($l,"blendFuncSeparate",[zf,Gc,zf,Gc]),fr(ma,Rs,!0),Vt(Pf,"depthFunc",Wi),Vt(Ch,"depthRange",[0,1]),Vt(bi,"depthMask",!0),Vt(Ic,Ic,[!0,!0,!0,!0]),fr(Xl,Nf),Vt(Ip,"cullFace",ga),Vt(bs,bs,Uf),Vt(Oc,Oc,1),fr(kc,Rh),Vt(Es,"polygonOffset",[0,0]),fr(As,Bc),fr(Hu,Np),Vt(Yl,"sampleCoverage",[1,!1]),fr(Fc,oo),Vt(If,"stencilMask",-1),Vt(wh,"stencilFunc",[Ph,0,-1]),Vt(ll,"stencilOpSeparate",[ta,Uo,Uo,Uo]),Vt(Nc,"stencilOpSeparate",[ga,Uo,Uo,Uo]),fr(Mh,Zo),Vt(cl,"scissor",[0,0,C.drawingBufferWidth,C.drawingBufferHeight]),Vt(ru,ru,[0,0,C.drawingBufferWidth,C.drawingBufferHeight]);var vr={gl:C,context:tr,strings:X,next:mr,current:gr,draw:Jt,elements:ut,buffer:Rt,shader:Qt,attributes:Kt.state,vao:Kt,uniforms:Bt,framebuffer:It,extensions:me,timer:kt,isBufferArgs:jc},dr={primTypes:Nt,compareFuncs:Xu,blendFuncs:wi,blendEquations:bt,stencilOps:Ua,glTypes:qa,orientationType:xl};T.optional(function(){vr.isArrayLike=Ti}),Sr&&(dr.backBuffer=[ga],dr.drawBuffer=Ei(nt.maxDrawbuffers,function(ie){return ie===0?[0]:Ei(ie,function(j){return Os+j})}));var on=0;function $r(){var ie=jl(),j=ie.link,Ae=ie.global;ie.id=on++,ie.batchId="0";var De=j(vr),mt=ie.shared={props:"a0"};Object.keys(vr).forEach(function(Se){mt[Se]=Ae.def(De,".",Se)}),T.optional(function(){ie.CHECK=j(T),ie.commandStr=T.guessCommand(),ie.command=j(ie.commandStr),ie.assert=function(Se,ue,He){Se("if(!(",ue,"))",this.CHECK,".commandRaise(",j(He),",",this.command,");")},dr.invalidBlendCombinations=_l});var Ie=ie.next={},Le=ie.current={};Object.keys(wt).forEach(function(Se){Array.isArray(gr[Se])&&(Ie[Se]=Ae.def(mt.next,".",Se),Le[Se]=Ae.def(mt.current,".",Se))});var ke=ie.constants={};Object.keys(dr).forEach(function(Se){ke[Se]=Ae.def(JSON.stringify(dr[Se]))}),ie.invoke=function(Se,ue){switch(ue.type){case Lc:var He=["this",mt.context,mt.props,ie.batchId];return Se.def(j(ue.data),".call(",He.slice(0,Math.max(ue.data.length+1,4)),")");case ul:return Se.def(mt.props,ue.data);case bn:return Se.def(mt.context,ue.data);case va:return Se.def("this",ue.data);case ei:return ue.data.append(ie,Se),ue.data.ref;case tu:return ue.data.toString();case Lf:return ue.data.map(function(Xe){return ie.invoke(Se,Xe)})}},ie.attribCache={};var Q={};return ie.scopeAttrib=function(Se){var ue=X.id(Se);if(ue in Q)return Q[ue];var He=Kt.scope[ue];He||(He=Kt.scope[ue]=new Ve);var Xe=Q[ue]=j(He);return Xe},ie}function hr(ie){var j=ie.static,Ae=ie.dynamic,De;if(fl in j){var mt=!!j[fl];De=Mi(function(Le,ke){return mt}),De.enable=mt}else if(fl in Ae){var Ie=Ae[fl];De=Aa(Ie,function(Le,ke){return Le.invoke(ke,Ie)})}return De}function yr(ie,j){var Ae=ie.static,De=ie.dynamic;if(nu in Ae){var mt=Ae[nu];return mt?(mt=It.getFramebuffer(mt),T.command(mt,"invalid framebuffer object"),Mi(function(Le,ke){var Q=Le.link(mt),Se=Le.shared;ke.set(Se.framebuffer,".next",Q);var ue=Se.context;return ke.set(ue,"."+ws,Q+".width"),ke.set(ue,"."+$u,Q+".height"),Q})):Mi(function(Le,ke){var Q=Le.shared;ke.set(Q.framebuffer,".next","null");var Se=Q.context;return ke.set(Se,"."+ws,Se+"."+ql),ke.set(Se,"."+$u,Se+"."+kp),"null"})}else if(nu in De){var Ie=De[nu];return Aa(Ie,function(Le,ke){var Q=Le.invoke(ke,Ie),Se=Le.shared,ue=Se.framebuffer,He=ke.def(ue,".getFramebuffer(",Q,")");T.optional(function(){Le.assert(ke,"!"+Q+"||"+He,"invalid framebuffer object")}),ke.set(ue,".next",He);var Xe=Se.context;return ke.set(Xe,"."+ws,He+"?"+He+".width:"+Xe+"."+ql),ke.set(Xe,"."+$u,He+"?"+He+".height:"+Xe+"."+kp),He})}else return null}function Xr(ie,j,Ae){var De=ie.static,mt=ie.dynamic;function Ie(Q){if(Q in De){var Se=De[Q];T.commandType(Se,"object","invalid "+Q,Ae.commandStr);var ue=!0,He=Se.x|0,Xe=Se.y|0,Et,Ht;return"width"in Se?(Et=Se.width|0,T.command(Et>=0,"invalid "+Q,Ae.commandStr)):ue=!1,"height"in Se?(Ht=Se.height|0,T.command(Ht>=0,"invalid "+Q,Ae.commandStr)):ue=!1,new _i(!ue&&j&&j.thisDep,!ue&&j&&j.contextDep,!ue&&j&&j.propDep,function(ir,Pr){var Er=ir.shared.context,Ut=Et;"width"in Se||(Ut=Pr.def(Er,".",ws,"-",He));var Lr=Ht;return"height"in Se||(Lr=Pr.def(Er,".",$u,"-",Xe)),[He,Xe,Ut,Lr]})}else if(Q in mt){var or=mt[Q],_r=Aa(or,function(ir,Pr){var Er=ir.invoke(Pr,or);T.optional(function(){ir.assert(Pr,Er+"&&typeof "+Er+'==="object"',"invalid "+Q)});var Ut=ir.shared.context,Lr=Pr.def(Er,".x|0"),Cr=Pr.def(Er,".y|0"),Ur=Pr.def('"width" in ',Er,"?",Er,".width|0:","(",Ut,".",ws,"-",Lr,")"),Qn=Pr.def('"height" in ',Er,"?",Er,".height|0:","(",Ut,".",$u,"-",Cr,")");return T.optional(function(){ir.assert(Pr,Ur+">=0&&"+Qn+">=0","invalid "+Q)}),[Lr,Cr,Ur,Qn]});return j&&(_r.thisDep=_r.thisDep||j.thisDep,_r.contextDep=_r.contextDep||j.contextDep,_r.propDep=_r.propDep||j.propDep),_r}else return j?new _i(j.thisDep,j.contextDep,j.propDep,function(ir,Pr){var Er=ir.shared.context;return[0,0,Pr.def(Er,".",ws),Pr.def(Er,".",$u)]}):null}var Le=Ie(ru);if(Le){var ke=Le;Le=new _i(Le.thisDep,Le.contextDep,Le.propDep,function(Q,Se){var ue=ke.append(Q,Se),He=Q.shared.context;return Se.set(He,"."+Op,ue[2]),Se.set(He,"."+ji,ue[3]),ue})}return{viewport:Le,scissor_box:Ie(cl)}}function tn(ie,j){var Ae=ie.static,De=typeof Ae[ju]=="string"&&typeof Ae[hl]=="string";if(De){if(Object.keys(j.dynamic).length>0)return null;var mt=j.static,Ie=Object.keys(mt);if(Ie.length>0&&typeof mt[Ie[0]]=="number"){for(var Le=[],ke=0;ke<Ie.length;++ke)T(typeof mt[Ie[ke]]=="number","must specify all vertex attribute locations when using vaos"),Le.push([mt[Ie[ke]]|0,Ie[ke]]);return Le}}return null}function Sn(ie,j,Ae){var De=ie.static,mt=ie.dynamic;function Ie(ue){if(ue in De){var He=X.id(De[ue]);T.optional(function(){Qt.shader(Hc[ue],He,T.guessCommand())});var Xe=Mi(function(){return He});return Xe.id=He,Xe}else if(ue in mt){var Et=mt[ue];return Aa(Et,function(Ht,or){var _r=Ht.invoke(or,Et),ir=or.def(Ht.shared.strings,".id(",_r,")");return T.optional(function(){or(Ht.shared.shader,".shader(",Hc[ue],",",ir,",",Ht.command,");")}),ir})}return null}var Le=Ie(ju),ke=Ie(hl),Q=null,Se;return so(Le)&&so(ke)?(Q=Qt.program(ke.id,Le.id,null,Ae),Se=Mi(function(ue,He){return ue.link(Q)})):Se=new _i(Le&&Le.thisDep||ke&&ke.thisDep,Le&&Le.contextDep||ke&&ke.contextDep,Le&&Le.propDep||ke&&ke.propDep,function(ue,He){var Xe=ue.shared.shader,Et;Le?Et=Le.append(ue,He):Et=He.def(Xe,".",ju);var Ht;ke?Ht=ke.append(ue,He):Ht=He.def(Xe,".",hl);var or=Xe+".program("+Ht+","+Et;return T.optional(function(){or+=","+ue.command}),He.def(or+")")}),{frag:Le,vert:ke,progVar:Se,program:Q}}function Nn(ie,j){var Ae=ie.static,De=ie.dynamic,mt={},Ie=!1;function Le(){if(Cs in Ae){var Pr=Ae[Cs];return Pr!==null&&Kt.getVAO(Pr)===null&&(Pr=Kt.createVAO(Pr)),Ie=!0,mt.vao=Pr,Mi(function(Ut){var Lr=Kt.getVAO(Pr);return Lr?Ut.link(Lr):"null"})}else if(Cs in De){Ie=!0;var Er=De[Cs];return Aa(Er,function(Ut,Lr){var Cr=Ut.invoke(Lr,Er);return Lr.def(Ut.shared.vao+".getVAO("+Cr+")")})}return null}var ke=Le(),Q=!1;function Se(){if(ao in Ae){var Pr=Ae[ao];if(mt.elements=Pr,jc(Pr)){var Er=mt.elements=ut.create(Pr,!0);Pr=ut.getElements(Er),Q=!0}else Pr&&(Pr=ut.getElements(Pr),Q=!0,T.command(Pr,"invalid elements",j.commandStr));var Ut=Mi(function(Cr,Ur){if(Pr){var Qn=Cr.link(Pr);return Cr.ELEMENTS=Qn,Qn}return Cr.ELEMENTS=null,null});return Ut.value=Pr,Ut}else if(ao in De){Q=!0;var Lr=De[ao];return Aa(Lr,function(Cr,Ur){var Qn=Cr.shared,Rn=Qn.isBufferArgs,Ta=Qn.elements,Yu=Cr.invoke(Ur,Lr),Ku=Ur.def("null"),Ca=Ur.def(Rn,"(",Yu,")"),xu=Cr.cond(Ca).then(Ku,"=",Ta,".createStream(",Yu,");").else(Ku,"=",Ta,".getElements(",Yu,");");return T.optional(function(){Cr.assert(xu.else,"!"+Yu+"||"+Ku,"invalid elements")}),Ur.entry(xu),Ur.exit(Cr.cond(Ca).then(Ta,".destroyStream(",Ku,");")),Cr.ELEMENTS=Ku,Ku})}else if(Ie)return new _i(ke.thisDep,ke.contextDep,ke.propDep,function(Cr,Ur){return Ur.def(Cr.shared.vao+".currentVAO?"+Cr.shared.elements+".getElements("+Cr.shared.vao+".currentVAO.elements):null")});return null}var ue=Se();function He(){if(Ts in Ae){var Pr=Ae[Ts];return mt.primitive=Pr,T.commandParameter(Pr,Nt,"invalid primitve",j.commandStr),Mi(function(Ut,Lr){return Nt[Pr]})}else if(Ts in De){var Er=De[Ts];return Aa(Er,function(Ut,Lr){var Cr=Ut.constants.primTypes,Ur=Ut.invoke(Lr,Er);return T.optional(function(){Ut.assert(Lr,Ur+" in "+Cr,"invalid primitive, must be one of "+Object.keys(Nt))}),Lr.def(Cr,"[",Ur,"]")})}else{if(Q)return so(ue)?ue.value?Mi(function(Ut,Lr){return Lr.def(Ut.ELEMENTS,".primType")}):Mi(function(){return Zf}):new _i(ue.thisDep,ue.contextDep,ue.propDep,function(Ut,Lr){var Cr=Ut.ELEMENTS;return Lr.def(Cr,"?",Cr,".primType:",Zf)});if(Ie)return new _i(ke.thisDep,ke.contextDep,ke.propDep,function(Ut,Lr){return Lr.def(Ut.shared.vao+".currentVAO?"+Ut.shared.vao+".currentVAO.primitive:"+Zf)})}return null}function Xe(Pr,Er){if(Pr in Ae){var Ut=Ae[Pr]|0;return Er?mt.offset=Ut:mt.instances=Ut,T.command(!Er||Ut>=0,"invalid "+Pr,j.commandStr),Mi(function(Cr,Ur){return Er&&(Cr.OFFSET=Ut),Ut})}else if(Pr in De){var Lr=De[Pr];return Aa(Lr,function(Cr,Ur){var Qn=Cr.invoke(Ur,Lr);return Er&&(Cr.OFFSET=Qn,T.optional(function(){Cr.assert(Ur,Qn+">=0","invalid "+Pr)})),Qn})}else if(Er){if(Q)return Mi(function(Cr,Ur){return Cr.OFFSET=0,0});if(Ie)return new _i(ke.thisDep,ke.contextDep,ke.propDep,function(Cr,Ur){return Ur.def(Cr.shared.vao+".currentVAO?"+Cr.shared.vao+".currentVAO.offset:0")})}else if(Ie)return new _i(ke.thisDep,ke.contextDep,ke.propDep,function(Cr,Ur){return Ur.def(Cr.shared.vao+".currentVAO?"+Cr.shared.vao+".currentVAO.instances:-1")});return null}var Et=Xe(pl,!0);function Ht(){if(Wu in Ae){var Pr=Ae[Wu]|0;return mt.count=Pr,T.command(typeof Pr=="number"&&Pr>=0,"invalid vertex count",j.commandStr),Mi(function(){return Pr})}else if(Wu in De){var Er=De[Wu];return Aa(Er,function(Ur,Qn){var Rn=Ur.invoke(Qn,Er);return T.optional(function(){Ur.assert(Qn,"typeof "+Rn+'==="number"&&'+Rn+">=0&&"+Rn+"===("+Rn+"|0)","invalid vertex count")}),Rn})}else if(Q)if(so(ue)){if(ue)return Et?new _i(Et.thisDep,Et.contextDep,Et.propDep,function(Ur,Qn){var Rn=Qn.def(Ur.ELEMENTS,".vertCount-",Ur.OFFSET);return T.optional(function(){Ur.assert(Qn,Rn+">=0","invalid vertex offset/element buffer too small")}),Rn}):Mi(function(Ur,Qn){return Qn.def(Ur.ELEMENTS,".vertCount")});var Ut=Mi(function(){return-1});return T.optional(function(){Ut.MISSING=!0}),Ut}else{var Lr=new _i(ue.thisDep||Et.thisDep,ue.contextDep||Et.contextDep,ue.propDep||Et.propDep,function(Ur,Qn){var Rn=Ur.ELEMENTS;return Ur.OFFSET?Qn.def(Rn,"?",Rn,".vertCount-",Ur.OFFSET,":-1"):Qn.def(Rn,"?",Rn,".vertCount:-1")});return T.optional(function(){Lr.DYNAMIC=!0}),Lr}else if(Ie){var Cr=new _i(ke.thisDep,ke.contextDep,ke.propDep,function(Ur,Qn){return Qn.def(Ur.shared.vao,".currentVAO?",Ur.shared.vao,".currentVAO.count:-1")});return Cr}return null}var or=He(),_r=Ht(),ir=Xe(Of,!1);return{elements:ue,primitive:or,count:_r,instances:ir,offset:Et,vao:ke,vaoActive:Ie,elementsActive:Q,static:mt}}function qn(ie,j){var Ae=ie.static,De=ie.dynamic,mt={};return Gr.forEach(function(Ie){var Le=Mr(Ie);function ke(Q,Se){if(Ie in Ae){var ue=Q(Ae[Ie]);mt[Le]=Mi(function(){return ue})}else if(Ie in De){var He=De[Ie];mt[Le]=Aa(He,function(Xe,Et){return Se(Xe,Et,Xe.invoke(Et,He))})}}switch(Ie){case Xl:case sl:case To:case Fc:case ma:case Mh:case kc:case As:case Hu:case bi:return ke(function(Q){return T.commandType(Q,"boolean",Ie,j.commandStr),Q},function(Q,Se,ue){return T.optional(function(){Q.assert(Se,"typeof "+ue+'==="boolean"',"invalid flag "+Ie,Q.commandStr)}),ue});case Pf:return ke(function(Q){return T.commandParameter(Q,Xu,"invalid "+Ie,j.commandStr),Xu[Q]},function(Q,Se,ue){var He=Q.constants.compareFuncs;return T.optional(function(){Q.assert(Se,ue+" in "+He,"invalid "+Ie+", must be one of "+Object.keys(Xu))}),Se.def(He,"[",ue,"]")});case Ch:return ke(function(Q){return T.command(Ti(Q)&&Q.length===2&&typeof Q[0]=="number"&&typeof Q[1]=="number"&&Q[0]<=Q[1],"depth range is 2d array",j.commandStr),Q},function(Q,Se,ue){T.optional(function(){Q.assert(Se,Q.shared.isArrayLike+"("+ue+")&&"+ue+".length===2&&typeof "+ue+'[0]==="number"&&typeof '+ue+'[1]==="number"&&'+ue+"[0]<="+ue+"[1]","depth range must be a 2d array")});var He=Se.def("+",ue,"[0]"),Xe=Se.def("+",ue,"[1]");return[He,Xe]});case $l:return ke(function(Q){T.commandType(Q,"object","blend.func",j.commandStr);var Se="srcRGB"in Q?Q.srcRGB:Q.src,ue="srcAlpha"in Q?Q.srcAlpha:Q.src,He="dstRGB"in Q?Q.dstRGB:Q.dst,Xe="dstAlpha"in Q?Q.dstAlpha:Q.dst;return T.commandParameter(Se,wi,Le+".srcRGB",j.commandStr),T.commandParameter(ue,wi,Le+".srcAlpha",j.commandStr),T.commandParameter(He,wi,Le+".dstRGB",j.commandStr),T.commandParameter(Xe,wi,Le+".dstAlpha",j.commandStr),T.command(_l.indexOf(Se+", "+He)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Se+", "+He+")",j.commandStr),[wi[Se],wi[He],wi[ue],wi[Xe]]},function(Q,Se,ue){var He=Q.constants.blendFuncs;T.optional(function(){Q.assert(Se,ue+"&&typeof "+ue+'==="object"',"invalid blend func, must be an object")});function Xe(Er,Ut){var Lr=Se.def('"',Er,Ut,'" in ',ue,"?",ue,".",Er,Ut,":",ue,".",Er);return T.optional(function(){Q.assert(Se,Lr+" in "+He,"invalid "+Ie+"."+Er+Ut+", must be one of "+Object.keys(wi))}),Lr}var Et=Xe("src","RGB"),Ht=Xe("dst","RGB");T.optional(function(){var Er=Q.constants.invalidBlendCombinations;Q.assert(Se,Er+".indexOf("+Et+'+", "+'+Ht+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var or=Se.def(He,"[",Et,"]"),_r=Se.def(He,"[",Xe("src","Alpha"),"]"),ir=Se.def(He,"[",Ht,"]"),Pr=Se.def(He,"[",Xe("dst","Alpha"),"]");return[or,ir,_r,Pr]});case gu:return ke(function(Q){if(typeof Q=="string")return T.commandParameter(Q,bt,"invalid "+Ie,j.commandStr),[bt[Q],bt[Q]];if(typeof Q=="object")return T.commandParameter(Q.rgb,bt,Ie+".rgb",j.commandStr),T.commandParameter(Q.alpha,bt,Ie+".alpha",j.commandStr),[bt[Q.rgb],bt[Q.alpha]];T.commandRaise("invalid blend.equation",j.commandStr)},function(Q,Se,ue){var He=Q.constants.blendEquations,Xe=Se.def(),Et=Se.def(),Ht=Q.cond("typeof ",ue,'==="string"');return T.optional(function(){function or(_r,ir,Pr){Q.assert(_r,Pr+" in "+He,"invalid "+ir+", must be one of "+Object.keys(bt))}or(Ht.then,Ie,ue),Q.assert(Ht.else,ue+"&&typeof "+ue+'==="object"',"invalid "+Ie),or(Ht.else,Ie+".rgb",ue+".rgb"),or(Ht.else,Ie+".alpha",ue+".alpha")}),Ht.then(Xe,"=",Et,"=",He,"[",ue,"];"),Ht.else(Xe,"=",He,"[",ue,".rgb];",Et,"=",He,"[",ue,".alpha];"),Se(Ht),[Xe,Et]});case Pc:return ke(function(Q){return T.command(Ti(Q)&&Q.length===4,"blend.color must be a 4d array",j.commandStr),Ei(4,function(Se){return+Q[Se]})},function(Q,Se,ue){return T.optional(function(){Q.assert(Se,Q.shared.isArrayLike+"("+ue+")&&"+ue+".length===4","blend.color must be a 4d array")}),Ei(4,function(He){return Se.def("+",ue,"[",He,"]")})});case If:return ke(function(Q){return T.commandType(Q,"number",Le,j.commandStr),Q|0},function(Q,Se,ue){return T.optional(function(){Q.assert(Se,"typeof "+ue+'==="number"',"invalid stencil.mask")}),Se.def(ue,"|0")});case wh:return ke(function(Q){T.commandType(Q,"object",Le,j.commandStr);var Se=Q.cmp||"keep",ue=Q.ref||0,He="mask"in Q?Q.mask:-1;return T.commandParameter(Se,Xu,Ie+".cmp",j.commandStr),T.commandType(ue,"number",Ie+".ref",j.commandStr),T.commandType(He,"number",Ie+".mask",j.commandStr),[Xu[Se],ue,He]},function(Q,Se,ue){var He=Q.constants.compareFuncs;T.optional(function(){function or(){Q.assert(Se,Array.prototype.join.call(arguments,""),"invalid stencil.func")}or(ue+"&&typeof ",ue,'==="object"'),or('!("cmp" in ',ue,")||(",ue,".cmp in ",He,")")});var Xe=Se.def('"cmp" in ',ue,"?",He,"[",ue,".cmp]",":",Uo),Et=Se.def(ue,".ref|0"),Ht=Se.def('"mask" in ',ue,"?",ue,".mask|0:-1");return[Xe,Et,Ht]});case ll:case Nc:return ke(function(Q){T.commandType(Q,"object",Le,j.commandStr);var Se=Q.fail||"keep",ue=Q.zfail||"keep",He=Q.zpass||"keep";return T.commandParameter(Se,Ua,Ie+".fail",j.commandStr),T.commandParameter(ue,Ua,Ie+".zfail",j.commandStr),T.commandParameter(He,Ua,Ie+".zpass",j.commandStr),[Ie===Nc?ga:ta,Ua[Se],Ua[ue],Ua[He]]},function(Q,Se,ue){var He=Q.constants.stencilOps;T.optional(function(){Q.assert(Se,ue+"&&typeof "+ue+'==="object"',"invalid "+Ie)});function Xe(Et){return T.optional(function(){Q.assert(Se,'!("'+Et+'" in '+ue+")||("+ue+"."+Et+" in "+He+")","invalid "+Ie+"."+Et+", must be one of "+Object.keys(Ua))}),Se.def('"',Et,'" in ',ue,"?",He,"[",ue,".",Et,"]:",Uo)}return[Ie===Nc?ga:ta,Xe("fail"),Xe("zfail"),Xe("zpass")]});case Es:return ke(function(Q){T.commandType(Q,"object",Le,j.commandStr);var Se=Q.factor|0,ue=Q.units|0;return T.commandType(Se,"number",Le+".factor",j.commandStr),T.commandType(ue,"number",Le+".units",j.commandStr),[Se,ue]},function(Q,Se,ue){T.optional(function(){Q.assert(Se,ue+"&&typeof "+ue+'==="object"',"invalid "+Ie)});var He=Se.def(ue,".factor|0"),Xe=Se.def(ue,".units|0");return[He,Xe]});case Ip:return ke(function(Q){var Se=0;return Q==="front"?Se=ta:Q==="back"&&(Se=ga),T.command(!!Se,Le,j.commandStr),Se},function(Q,Se,ue){return T.optional(function(){Q.assert(Se,ue+'==="front"||'+ue+'==="back"',"invalid cull.face")}),Se.def(ue,'==="front"?',ta,":",ga)});case Oc:return ke(function(Q){return T.command(typeof Q=="number"&&Q>=nt.lineWidthDims[0]&&Q<=nt.lineWidthDims[1],"invalid line width, must be a positive number between "+nt.lineWidthDims[0]+" and "+nt.lineWidthDims[1],j.commandStr),Q},function(Q,Se,ue){return T.optional(function(){Q.assert(Se,"typeof "+ue+'==="number"&&'+ue+">="+nt.lineWidthDims[0]+"&&"+ue+"<="+nt.lineWidthDims[1],"invalid line width")}),ue});case bs:return ke(function(Q){return T.commandParameter(Q,xl,Le,j.commandStr),xl[Q]},function(Q,Se,ue){return T.optional(function(){Q.assert(Se,ue+'==="cw"||'+ue+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Se.def(ue+'==="cw"?'+Lh+":"+Uf)});case Ic:return ke(function(Q){return T.command(Ti(Q)&&Q.length===4,"color.mask must be length 4 array",j.commandStr),Q.map(function(Se){return!!Se})},function(Q,Se,ue){return T.optional(function(){Q.assert(Se,Q.shared.isArrayLike+"("+ue+")&&"+ue+".length===4","invalid color.mask")}),Ei(4,function(He){return"!!"+ue+"["+He+"]"})});case Yl:return ke(function(Q){T.command(typeof Q=="object"&&Q,Le,j.commandStr);var Se="value"in Q?Q.value:1,ue=!!Q.invert;return T.command(typeof Se=="number"&&Se>=0&&Se<=1,"sample.coverage.value must be a number between 0 and 1",j.commandStr),[Se,ue]},function(Q,Se,ue){T.optional(function(){Q.assert(Se,ue+"&&typeof "+ue+'==="object"',"invalid sample.coverage")});var He=Se.def('"value" in ',ue,"?+",ue,".value:1"),Xe=Se.def("!!",ue,".invert");return[He,Xe]})}}),mt}function sn(ie,j){var Ae=ie.static,De=ie.dynamic,mt={};return Object.keys(Ae).forEach(function(Ie){var Le=Ae[Ie],ke;if(typeof Le=="number"||typeof Le=="boolean")ke=Mi(function(){return Le});else if(typeof Le=="function"){var Q=Le._reglType;Q==="texture2d"||Q==="textureCube"?ke=Mi(function(Se){return Se.link(Le)}):Q==="framebuffer"||Q==="framebufferCube"?(T.command(Le.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ie+'"',j.commandStr),ke=Mi(function(Se){return Se.link(Le.color[0])})):T.commandRaise('invalid data for uniform "'+Ie+'"',j.commandStr)}else Ti(Le)?ke=Mi(function(Se){var ue=Se.global.def("[",Ei(Le.length,function(He){return T.command(typeof Le[He]=="number"||typeof Le[He]=="boolean","invalid uniform "+Ie,Se.commandStr),Le[He]}),"]");return ue}):T.commandRaise('invalid or missing data for uniform "'+Ie+'"',j.commandStr);ke.value=Le,mt[Ie]=ke}),Object.keys(De).forEach(function(Ie){var Le=De[Ie];mt[Ie]=Aa(Le,function(ke,Q){return ke.invoke(Q,Le)})}),mt}function Zi(ie,j){var Ae=ie.static,De=ie.dynamic,mt={};return Object.keys(Ae).forEach(function(Ie){var Le=Ae[Ie],ke=X.id(Ie),Q=new Ve;if(jc(Le))Q.state=Za,Q.buffer=Rt.getBuffer(Rt.create(Le,dl,!1,!0)),Q.type=0;else{var Se=Rt.getBuffer(Le);if(Se)Q.state=Za,Q.buffer=Se,Q.type=0;else if(T.command(typeof Le=="object"&&Le,"invalid data for attribute "+Ie,j.commandStr),"constant"in Le){var ue=Le.constant;Q.buffer="null",Q.state=Wl,typeof ue=="number"?Q.x=ue:(T.command(Ti(ue)&&ue.length>0&&ue.length<=4,"invalid constant for attribute "+Ie,j.commandStr),Dr.forEach(function(ir,Pr){Pr<ue.length&&(Q[ir]=ue[Pr])}))}else{jc(Le.buffer)?Se=Rt.getBuffer(Rt.create(Le.buffer,dl,!1,!0)):Se=Rt.getBuffer(Le.buffer),T.command(!!Se,'missing buffer for attribute "'+Ie+'"',j.commandStr);var He=Le.offset|0;T.command(He>=0,'invalid offset for attribute "'+Ie+'"',j.commandStr);var Xe=Le.stride|0;T.command(Xe>=0&&Xe<256,'invalid stride for attribute "'+Ie+'", must be integer betweeen [0, 255]',j.commandStr);var Et=Le.size|0;T.command(!("size"in Le)||Et>0&&Et<=4,'invalid size for attribute "'+Ie+'", must be 1,2,3,4',j.commandStr);var Ht=!!Le.normalized,or=0;"type"in Le&&(T.commandParameter(Le.type,qa,"invalid type for attribute "+Ie,j.commandStr),or=qa[Le.type]);var _r=Le.divisor|0;T.optional(function(){"divisor"in Le&&(T.command(_r===0||Wt,'cannot specify divisor for attribute "'+Ie+'", instancing not supported',j.commandStr),T.command(_r>=0,'invalid divisor for attribute "'+Ie+'"',j.commandStr));var ir=j.commandStr,Pr=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Le).forEach(function(Er){T.command(Pr.indexOf(Er)>=0,'unknown parameter "'+Er+'" for attribute pointer "'+Ie+'" (valid parameters are '+Pr+")",ir)})}),Q.buffer=Se,Q.state=Za,Q.size=Et,Q.normalized=Ht,Q.type=or||Se.dtype,Q.offset=He,Q.stride=Xe,Q.divisor=_r}}mt[Ie]=Mi(function(ir,Pr){var Er=ir.attribCache;if(ke in Er)return Er[ke];var Ut={isStream:!1};return Object.keys(Q).forEach(function(Lr){Ut[Lr]=Q[Lr]}),Q.buffer&&(Ut.buffer=ir.link(Q.buffer),Ut.type=Ut.type||Ut.buffer+".dtype"),Er[ke]=Ut,Ut})}),Object.keys(De).forEach(function(Ie){var Le=De[Ie];function ke(Q,Se){var ue=Q.invoke(Se,Le),He=Q.shared,Xe=Q.constants,Et=He.isBufferArgs,Ht=He.buffer;T.optional(function(){Q.assert(Se,ue+"&&(typeof "+ue+'==="object"||typeof '+ue+'==="function")&&('+Et+"("+ue+")||"+Ht+".getBuffer("+ue+")||"+Ht+".getBuffer("+ue+".buffer)||"+Et+"("+ue+'.buffer)||("constant" in '+ue+"&&(typeof "+ue+'.constant==="number"||'+He.isArrayLike+"("+ue+".constant))))",'invalid dynamic attribute "'+Ie+'"')});var or={isStream:Se.def(!1)},_r=new Ve;_r.state=Za,Object.keys(_r).forEach(function(Ut){or[Ut]=Se.def(""+_r[Ut])});var ir=or.buffer,Pr=or.type;Se("if(",Et,"(",ue,")){",or.isStream,"=true;",ir,"=",Ht,".createStream(",dl,",",ue,");",Pr,"=",ir,".dtype;","}else{",ir,"=",Ht,".getBuffer(",ue,");","if(",ir,"){",Pr,"=",ir,".dtype;",'}else if("constant" in ',ue,"){",or.state,"=",Wl,";","if(typeof "+ue+'.constant === "number"){',or[Dr[0]],"=",ue,".constant;",Dr.slice(1).map(function(Ut){return or[Ut]}).join("="),"=0;","}else{",Dr.map(function(Ut,Lr){return or[Ut]+"="+ue+".constant.length>"+Lr+"?"+ue+".constant["+Lr+"]:0;"}).join(""),"}}else{","if(",Et,"(",ue,".buffer)){",ir,"=",Ht,".createStream(",dl,",",ue,".buffer);","}else{",ir,"=",Ht,".getBuffer(",ue,".buffer);","}",Pr,'="type" in ',ue,"?",Xe.glTypes,"[",ue,".type]:",ir,".dtype;",or.normalized,"=!!",ue,".normalized;");function Er(Ut){Se(or[Ut],"=",ue,".",Ut,"|0;")}return Er("size"),Er("offset"),Er("stride"),Er("divisor"),Se("}}"),Se.exit("if(",or.isStream,"){",Ht,".destroyStream(",ir,");","}"),or}mt[Ie]=Aa(Le,ke)}),mt}function ui(ie){var j=ie.static,Ae=ie.dynamic,De={};return Object.keys(j).forEach(function(mt){var Ie=j[mt];De[mt]=Mi(function(Le,ke){return typeof Ie=="number"||typeof Ie=="boolean"?""+Ie:Le.link(Ie)})}),Object.keys(Ae).forEach(function(mt){var Ie=Ae[mt];De[mt]=Aa(Ie,function(Le,ke){return Le.invoke(ke,Ie)})}),De}function Ui(ie,j,Ae,De,mt){var Ie=ie.static,Le=ie.dynamic;T.optional(function(){var Er=[nu,hl,ju,ao,Ts,pl,Wu,Of,fl,Cs].concat(Gr);function Ut(Lr){Object.keys(Lr).forEach(function(Cr){T.command(Er.indexOf(Cr)>=0,'unknown parameter "'+Cr+'"',mt.commandStr)})}Ut(Ie),Ut(Le)});var ke=tn(ie,j),Q=yr(ie,mt),Se=Xr(ie,Q,mt),ue=Nn(ie,mt),He=qn(ie,mt),Xe=Sn(ie,mt,ke);function Et(Er){var Ut=Se[Er];Ut&&(He[Er]=Ut)}Et(ru),Et(Mr(cl));var Ht=Object.keys(He).length>0,or={framebuffer:Q,draw:ue,shader:Xe,state:He,dirty:Ht,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(or.profile=hr(ie,mt),or.uniforms=sn(Ae,mt),or.drawVAO=or.scopeVAO=ue.vao,!or.drawVAO&&Xe.program&&!ke&&me.angle_instanced_arrays&&ue.static.elements){var _r=!0,ir=Xe.program.attributes.map(function(Er){var Ut=j.static[Er];return _r=_r&&!!Ut,Ut});if(_r&&ir.length>0){var Pr=Kt.getVAO(Kt.createVAO({attributes:ir,elements:ue.static.elements}));or.drawVAO=new _i(null,null,null,function(Er,Ut){return Er.link(Pr)}),or.useVAO=!0}}return ke?or.useVAO=!0:or.attributes=Zi(j,mt),or.context=ui(De,mt),or}function Li(ie,j,Ae){var De=ie.shared,mt=De.context,Ie=ie.scope();Object.keys(Ae).forEach(function(Le){j.save(mt,"."+Le);var ke=Ae[Le],Q=ke.append(ie,j);Array.isArray(Q)?Ie(mt,".",Le,"=[",Q.join(),"];"):Ie(mt,".",Le,"=",Q,";")}),j(Ie)}function Ki(ie,j,Ae,De){var mt=ie.shared,Ie=mt.gl,Le=mt.framebuffer,ke;Sr&&(ke=j.def(mt.extensions,".webgl_draw_buffers"));var Q=ie.constants,Se=Q.drawBuffer,ue=Q.backBuffer,He;Ae?He=Ae.append(ie,j):He=j.def(Le,".next"),De||j("if(",He,"!==",Le,".cur){"),j("if(",He,"){",Ie,".bindFramebuffer(",Vc,",",He,".framebuffer);"),Sr&&j(ke,".drawBuffersWEBGL(",Se,"[",He,".colorAttachments.length]);"),j("}else{",Ie,".bindFramebuffer(",Vc,",null);"),Sr&&j(ke,".drawBuffersWEBGL(",ue,");"),j("}",Le,".cur=",He,";"),De||j("}")}function $i(ie,j,Ae){var De=ie.shared,mt=De.gl,Ie=ie.current,Le=ie.next,ke=De.current,Q=De.next,Se=ie.cond(ke,".dirty");Gr.forEach(function(ue){var He=Mr(ue);if(!(He in Ae.state)){var Xe,Et;if(He in Le){Xe=Le[He],Et=Ie[He];var Ht=Ei(gr[He].length,function(_r){return Se.def(Xe,"[",_r,"]")});Se(ie.cond(Ht.map(function(_r,ir){return _r+"!=="+Et+"["+ir+"]"}).join("||")).then(mt,".",wt[He],"(",Ht,");",Ht.map(function(_r,ir){return Et+"["+ir+"]="+_r}).join(";"),";"))}else{Xe=Se.def(Q,".",He);var or=ie.cond(Xe,"!==",ke,".",He);Se(or),He in Lt?or(ie.cond(Xe).then(mt,".enable(",Lt[He],");").else(mt,".disable(",Lt[He],");"),ke,".",He,"=",Xe,";"):or(mt,".",wt[He],"(",Xe,");",ke,".",He,"=",Xe,";")}}}),Object.keys(Ae.state).length===0&&Se(ke,".dirty=false;"),j(Se)}function qi(ie,j,Ae,De){var mt=ie.shared,Ie=ie.current,Le=mt.current,ke=mt.gl;Wc(Object.keys(Ae)).forEach(function(Q){var Se=Ae[Q];if(!(De&&!De(Se))){var ue=Se.append(ie,j);if(Lt[Q]){var He=Lt[Q];so(Se)?ue?j(ke,".enable(",He,");"):j(ke,".disable(",He,");"):j(ie.cond(ue).then(ke,".enable(",He,");").else(ke,".disable(",He,");")),j(Le,".",Q,"=",ue,";")}else if(Ti(ue)){var Xe=Ie[Q];j(ke,".",wt[Q],"(",ue,");",ue.map(function(Et,Ht){return Xe+"["+Ht+"]="+Et}).join(";"),";")}else j(ke,".",wt[Q],"(",ue,");",Le,".",Q,"=",ue,";")}})}function Pi(ie,j){Wt&&(ie.instancing=j.def(ie.shared.extensions,".angle_instanced_arrays"))}function fn(ie,j,Ae,De,mt){var Ie=ie.shared,Le=ie.stats,ke=Ie.current,Q=Ie.timer,Se=Ae.profile;function ue(){var Er=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Er||typeof performance=="undefined"?"Date.now()":"performance.now()"}var He,Xe;function Et(Er){He=j.def(),Er(He,"=",ue(),";"),typeof mt=="string"?Er(Le,".count+=",mt,";"):Er(Le,".count++;"),kt&&(De?(Xe=j.def(),Er(Xe,"=",Q,".getNumPendingQueries();")):Er(Q,".beginQuery(",Le,");"))}function Ht(Er){Er(Le,".cpuTime+=",ue(),"-",He,";"),kt&&(De?Er(Q,".pushScopeStats(",Xe,",",Q,".getNumPendingQueries(),",Le,");"):Er(Q,".endQuery();"))}function or(Er){var Ut=j.def(ke,".profile");j(ke,".profile=",Er,";"),j.exit(ke,".profile=",Ut,";")}var _r;if(Se){if(so(Se)){Se.enable?(Et(j),Ht(j.exit),or("true")):or("false");return}_r=Se.append(ie,j),or(_r)}else _r=j.def(ke,".profile");var ir=ie.block();Et(ir),j("if(",_r,"){",ir,"}");var Pr=ie.block();Ht(Pr),j.exit("if(",_r,"){",Pr,"}")}function Qi(ie,j,Ae,De,mt){var Ie=ie.shared;function Le(Q){switch(Q){case ec:case Uc:case ml:return 2;case Ls:case Co:case rc:return 3;case tc:case vl:case zc:return 4;default:return 1}}function ke(Q,Se,ue){var He=Ie.gl,Xe=j.def(Q,".location"),Et=j.def(Ie.attributes,"[",Xe,"]"),Ht=ue.state,or=ue.buffer,_r=[ue.x,ue.y,ue.z,ue.w],ir=["buffer","normalized","offset","stride"];function Pr(){j("if(!",Et,".buffer){",He,".enableVertexAttribArray(",Xe,");}");var Ut=ue.type,Lr;if(ue.size?Lr=j.def(ue.size,"||",Se):Lr=Se,j("if(",Et,".type!==",Ut,"||",Et,".size!==",Lr,"||",ir.map(function(Ur){return Et+"."+Ur+"!=="+ue[Ur]}).join("||"),"){",He,".bindBuffer(",dl,",",or,".buffer);",He,".vertexAttribPointer(",[Xe,Lr,Ut,ue.normalized,ue.stride,ue.offset],");",Et,".type=",Ut,";",Et,".size=",Lr,";",ir.map(function(Ur){return Et+"."+Ur+"="+ue[Ur]+";"}).join(""),"}"),Wt){var Cr=ue.divisor;j("if(",Et,".divisor!==",Cr,"){",ie.instancing,".vertexAttribDivisorANGLE(",[Xe,Cr],");",Et,".divisor=",Cr,";}")}}function Er(){j("if(",Et,".buffer){",He,".disableVertexAttribArray(",Xe,");",Et,".buffer=null;","}if(",Dr.map(function(Ut,Lr){return Et+"."+Ut+"!=="+_r[Lr]}).join("||"),"){",He,".vertexAttrib4f(",Xe,",",_r,");",Dr.map(function(Ut,Lr){return Et+"."+Ut+"="+_r[Lr]+";"}).join(""),"}")}Ht===Za?Pr():Ht===Wl?Er():(j("if(",Ht,"===",Za,"){"),Pr(),j("}else{"),Er(),j("}"))}De.forEach(function(Q){var Se=Q.name,ue=Ae.attributes[Se],He;if(ue){if(!mt(ue))return;He=ue.append(ie,j)}else{if(!mt(Gf))return;var Xe=ie.scopeAttrib(Se);T.optional(function(){ie.assert(j,Xe+".state","missing attribute "+Se)}),He={},Object.keys(new Ve).forEach(function(Et){He[Et]=j.def(Xe,".",Et)})}ke(ie.link(Q),Le(Q.info.type),He)})}function zn(ie,j,Ae,De,mt,Ie){for(var Le=ie.shared,ke=Le.gl,Q,Se=0;Se<De.length;++Se){var ue=De[Se],He=ue.name,Xe=ue.info.type,Et=Ae.uniforms[He],Ht=ie.link(ue),or=Ht+".location",_r;if(Et){if(!mt(Et))continue;if(so(Et)){var ir=Et.value;if(T.command(ir!==null&&typeof ir!="undefined",'missing uniform "'+He+'"',ie.commandStr),Xe===ac||Xe===Ps){T.command(typeof ir=="function"&&(Xe===ac&&(ir._reglType==="texture2d"||ir._reglType==="framebuffer")||Xe===Ps&&(ir._reglType==="textureCube"||ir._reglType==="framebufferCube")),"invalid texture for uniform "+He,ie.commandStr);var Pr=ie.link(ir._texture||ir.color[0]._texture);j(ke,".uniform1i(",or,",",Pr+".bind());"),j.exit(Pr,".unbind();")}else if(Xe===nc||Xe===ic||Xe===gl){T.optional(function(){T.command(Ti(ir),"invalid matrix for uniform "+He,ie.commandStr),T.command(Xe===nc&&ir.length===4||Xe===ic&&ir.length===9||Xe===gl&&ir.length===16,"invalid length for matrix uniform "+He,ie.commandStr)});var Er=ie.global.def("new Float32Array(["+Array.prototype.slice.call(ir)+"])"),Ut=2;Xe===ic?Ut=3:Xe===gl&&(Ut=4),j(ke,".uniformMatrix",Ut,"fv(",or,",false,",Er,");")}else{switch(Xe){case Zc:T.commandType(ir,"number","uniform "+He,ie.commandStr),Q="1f";break;case ec:T.command(Ti(ir)&&ir.length===2,"uniform "+He,ie.commandStr),Q="2f";break;case Ls:T.command(Ti(ir)&&ir.length===3,"uniform "+He,ie.commandStr),Q="3f";break;case tc:T.command(Ti(ir)&&ir.length===4,"uniform "+He,ie.commandStr),Q="4f";break;case Bf:T.commandType(ir,"boolean","uniform "+He,ie.commandStr),Q="1i";break;case uo:T.commandType(ir,"number","uniform "+He,ie.commandStr),Q="1i";break;case ml:T.command(Ti(ir)&&ir.length===2,"uniform "+He,ie.commandStr),Q="2i";break;case Uc:T.command(Ti(ir)&&ir.length===2,"uniform "+He,ie.commandStr),Q="2i";break;case rc:T.command(Ti(ir)&&ir.length===3,"uniform "+He,ie.commandStr),Q="3i";break;case Co:T.command(Ti(ir)&&ir.length===3,"uniform "+He,ie.commandStr),Q="3i";break;case zc:T.command(Ti(ir)&&ir.length===4,"uniform "+He,ie.commandStr),Q="4i";break;case vl:T.command(Ti(ir)&&ir.length===4,"uniform "+He,ie.commandStr),Q="4i";break}j(ke,".uniform",Q,"(",or,",",Ti(ir)?Array.prototype.slice.call(ir):ir,");")}continue}else _r=Et.append(ie,j)}else{if(!mt(Gf))continue;_r=j.def(Le.uniforms,"[",X.id(He),"]")}Xe===ac?(T(!Array.isArray(_r),"must specify a scalar prop for textures"),j("if(",_r,"&&",_r,'._reglType==="framebuffer"){',_r,"=",_r,".color[0];","}")):Xe===Ps&&(T(!Array.isArray(_r),"must specify a scalar prop for cube maps"),j("if(",_r,"&&",_r,'._reglType==="framebufferCube"){',_r,"=",_r,".color[0];","}")),T.optional(function(){function Ca(Mo,Fh){ie.assert(j,Mo,'bad data or missing for uniform "'+He+'".  '+Fh)}function xu(Mo){T(!Array.isArray(_r),"must not specify an array type for uniform"),Ca("typeof "+_r+'==="'+Mo+'"',"invalid type, expected "+Mo)}function zo(Mo,Fh){Array.isArray(_r)?T(_r.length===Mo,"must have length "+Mo):Ca(Le.isArrayLike+"("+_r+")&&"+_r+".length==="+Mo,"invalid vector, should have length "+Mo,ie.commandStr)}function Bp(Mo){T(!Array.isArray(_r),"must not specify a value type"),Ca("typeof "+_r+'==="function"&&'+_r+'._reglType==="texture'+(Mo===Ff?"2d":"Cube")+'"',"invalid texture type",ie.commandStr)}switch(Xe){case uo:xu("number");break;case Uc:zo(2,"number");break;case Co:zo(3,"number");break;case vl:zo(4,"number");break;case Zc:xu("number");break;case ec:zo(2,"number");break;case Ls:zo(3,"number");break;case tc:zo(4,"number");break;case Bf:xu("boolean");break;case ml:zo(2,"boolean");break;case rc:zo(3,"boolean");break;case zc:zo(4,"boolean");break;case nc:zo(4,"number");break;case ic:zo(9,"number");break;case gl:zo(16,"number");break;case ac:Bp(Ff);break;case Ps:Bp(Jl);break}});var Lr=1;switch(Xe){case ac:case Ps:var Cr=j.def(_r,"._texture");j(ke,".uniform1i(",or,",",Cr,".bind());"),j.exit(Cr,".unbind();");continue;case uo:case Bf:Q="1i";break;case Uc:case ml:Q="2i",Lr=2;break;case Co:case rc:Q="3i",Lr=3;break;case vl:case zc:Q="4i",Lr=4;break;case Zc:Q="1f";break;case ec:Q="2f",Lr=2;break;case Ls:Q="3f",Lr=3;break;case tc:Q="4f",Lr=4;break;case nc:Q="Matrix2fv";break;case ic:Q="Matrix3fv";break;case gl:Q="Matrix4fv";break}if(Q.charAt(0)==="M"){j(ke,".uniform",Q,"(",or,",");var Ur=Math.pow(Xe-nc+2,2),Qn=ie.global.def("new Float32Array(",Ur,")");Array.isArray(_r)?j("false,(",Ei(Ur,function(Ca){return Qn+"["+Ca+"]="+_r[Ca]}),",",Qn,")"):j("false,(Array.isArray(",_r,")||",_r," instanceof Float32Array)?",_r,":(",Ei(Ur,function(Ca){return Qn+"["+Ca+"]="+_r+"["+Ca+"]"}),",",Qn,")"),j(");")}else if(Lr>1){for(var Rn=[],Ta=[],Yu=0;Yu<Lr;++Yu)Array.isArray(_r)?Ta.push(_r[Yu]):Ta.push(j.def(_r+"["+Yu+"]")),Ie&&Rn.push(j.def());Ie&&j("if(!",ie.batchId,"||",Rn.map(function(Ca,xu){return Ca+"!=="+Ta[xu]}).join("||"),"){",Rn.map(function(Ca,xu){return Ca+"="+Ta[xu]+";"}).join("")),j(ke,".uniform",Q,"(",or,",",Ta.join(","),");"),Ie&&j("}")}else{if(T(!Array.isArray(_r),"uniform value must not be an array"),Ie){var Ku=j.def();j("if(!",ie.batchId,"||",Ku,"!==",_r,"){",Ku,"=",_r,";")}j(ke,".uniform",Q,"(",or,",",_r,");"),Ie&&j("}")}}}function Xi(ie,j,Ae,De){var mt=ie.shared,Ie=mt.gl,Le=mt.draw,ke=De.draw;function Q(){var Lr=ke.elements,Cr,Ur=j;return Lr?((Lr.contextDep&&De.contextDynamic||Lr.propDep)&&(Ur=Ae),Cr=Lr.append(ie,Ur),ke.elementsActive&&Ur("if("+Cr+")"+Ie+".bindBuffer("+Ms+","+Cr+".buffer.buffer);")):(Cr=Ur.def(),Ur(Cr,"=",Le,".",ao,";","if(",Cr,"){",Ie,".bindBuffer(",Ms,",",Cr,".buffer.buffer);}","else if(",mt.vao,".currentVAO){",Cr,"=",ie.shared.elements+".getElements("+mt.vao,".currentVAO.elements);",Ft?"":"if("+Cr+")"+Ie+".bindBuffer("+Ms+","+Cr+".buffer.buffer);","}")),Cr}function Se(){var Lr=ke.count,Cr,Ur=j;return Lr?((Lr.contextDep&&De.contextDynamic||Lr.propDep)&&(Ur=Ae),Cr=Lr.append(ie,Ur),T.optional(function(){Lr.MISSING&&ie.assert(j,"false","missing vertex count"),Lr.DYNAMIC&&ie.assert(Ur,Cr+">=0","missing vertex count")})):(Cr=Ur.def(Le,".",Wu),T.optional(function(){ie.assert(Ur,Cr+">=0","missing vertex count")})),Cr}var ue=Q();function He(Lr){var Cr=ke[Lr];return Cr?Cr.contextDep&&De.contextDynamic||Cr.propDep?Cr.append(ie,Ae):Cr.append(ie,j):j.def(Le,".",Lr)}var Xe=He(Ts),Et=He(pl),Ht=Se();if(typeof Ht=="number"){if(Ht===0)return}else Ae("if(",Ht,"){"),Ae.exit("}");var or,_r;Wt&&(or=He(Of),_r=ie.instancing);var ir=ue+".type",Pr=ke.elements&&so(ke.elements)&&!ke.vaoActive;function Er(){function Lr(){Ae(_r,".drawElementsInstancedANGLE(",[Xe,Ht,ir,Et+"<<(("+ir+"-"+Rr+")>>1)",or],");")}function Cr(){Ae(_r,".drawArraysInstancedANGLE(",[Xe,Et,Ht,or],");")}ue&&ue!=="null"?Pr?Lr():(Ae("if(",ue,"){"),Lr(),Ae("}else{"),Cr(),Ae("}")):Cr()}function Ut(){function Lr(){Ae(Ie+".drawElements("+[Xe,Ht,ir,Et+"<<(("+ir+"-"+Rr+")>>1)"]+");")}function Cr(){Ae(Ie+".drawArrays("+[Xe,Et,Ht]+");")}ue&&ue!=="null"?Pr?Lr():(Ae("if(",ue,"){"),Lr(),Ae("}else{"),Cr(),Ae("}")):Cr()}Wt&&(typeof or!="number"||or>=0)?typeof or=="string"?(Ae("if(",or,">0){"),Er(),Ae("}else if(",or,"<0){"),Ut(),Ae("}")):Er():Ut()}function Kr(ie,j,Ae,De,mt){var Ie=$r(),Le=Ie.proc("body",mt);return T.optional(function(){Ie.commandStr=j.commandStr,Ie.command=Ie.link(j.commandStr)}),Wt&&(Ie.instancing=Le.def(Ie.shared.extensions,".angle_instanced_arrays")),ie(Ie,Le,Ae,De),Ie.compile().body}function vn(ie,j,Ae,De){Pi(ie,j),Ae.useVAO?Ae.drawVAO?j(ie.shared.vao,".setVAO(",Ae.drawVAO.append(ie,j),");"):j(ie.shared.vao,".setVAO(",ie.shared.vao,".targetVAO);"):(j(ie.shared.vao,".setVAO(null);"),Qi(ie,j,Ae,De.attributes,function(){return!0})),zn(ie,j,Ae,De.uniforms,function(){return!0},!1),Xi(ie,j,j,Ae)}function Wn(ie,j){var Ae=ie.proc("draw",1);Pi(ie,Ae),Li(ie,Ae,j.context),Ki(ie,Ae,j.framebuffer),$i(ie,Ae,j),qi(ie,Ae,j.state),fn(ie,Ae,j,!1,!0);var De=j.shader.progVar.append(ie,Ae);if(Ae(ie.shared.gl,".useProgram(",De,".program);"),j.shader.program)vn(ie,Ae,j,j.shader.program);else{Ae(ie.shared.vao,".setVAO(null);");var mt=ie.global.def("{}"),Ie=Ae.def(De,".id"),Le=Ae.def(mt,"[",Ie,"]");Ae(ie.cond(Le).then(Le,".call(this,a0);").else(Le,"=",mt,"[",Ie,"]=",ie.link(function(ke){return Kr(vn,ie,j,ke,1)}),"(",De,");",Le,".call(this,a0);"))}Object.keys(j.state).length>0&&Ae(ie.shared.current,".dirty=true;"),ie.shared.vao&&Ae(ie.shared.vao,".setVAO(null);")}function Ii(ie,j,Ae,De){ie.batchId="a1",Pi(ie,j);function mt(){return!0}Qi(ie,j,Ae,De.attributes,mt),zn(ie,j,Ae,De.uniforms,mt,!1),Xi(ie,j,j,Ae)}function wo(ie,j,Ae,De){Pi(ie,j);var mt=Ae.contextDep,Ie=j.def(),Le="a0",ke="a1",Q=j.def();ie.shared.props=Q,ie.batchId=Ie;var Se=ie.scope(),ue=ie.scope();j(Se.entry,"for(",Ie,"=0;",Ie,"<",ke,";++",Ie,"){",Q,"=",Le,"[",Ie,"];",ue,"}",Se.exit);function He(ir){return ir.contextDep&&mt||ir.propDep}function Xe(ir){return!He(ir)}if(Ae.needsContext&&Li(ie,ue,Ae.context),Ae.needsFramebuffer&&Ki(ie,ue,Ae.framebuffer),qi(ie,ue,Ae.state,He),Ae.profile&&He(Ae.profile)&&fn(ie,ue,Ae,!1,!0),De)Ae.useVAO?Ae.drawVAO?He(Ae.drawVAO)?ue(ie.shared.vao,".setVAO(",Ae.drawVAO.append(ie,ue),");"):Se(ie.shared.vao,".setVAO(",Ae.drawVAO.append(ie,Se),");"):Se(ie.shared.vao,".setVAO(",ie.shared.vao,".targetVAO);"):(Se(ie.shared.vao,".setVAO(null);"),Qi(ie,Se,Ae,De.attributes,Xe),Qi(ie,ue,Ae,De.attributes,He)),zn(ie,Se,Ae,De.uniforms,Xe,!1),zn(ie,ue,Ae,De.uniforms,He,!0),Xi(ie,Se,ue,Ae);else{var Et=ie.global.def("{}"),Ht=Ae.shader.progVar.append(ie,ue),or=ue.def(Ht,".id"),_r=ue.def(Et,"[",or,"]");ue(ie.shared.gl,".useProgram(",Ht,".program);","if(!",_r,"){",_r,"=",Et,"[",or,"]=",ie.link(function(ir){return Kr(Ii,ie,Ae,ir,2)}),"(",Ht,");}",_r,".call(this,a0[",Ie,"],",Ie,");")}}function fe(ie,j){var Ae=ie.proc("batch",2);ie.batchId="0",Pi(ie,Ae);var De=!1,mt=!0;Object.keys(j.context).forEach(function(Et){De=De||j.context[Et].propDep}),De||(Li(ie,Ae,j.context),mt=!1);var Ie=j.framebuffer,Le=!1;Ie?(Ie.propDep?De=Le=!0:Ie.contextDep&&De&&(Le=!0),Le||Ki(ie,Ae,Ie)):Ki(ie,Ae,null),j.state.viewport&&j.state.viewport.propDep&&(De=!0);function ke(Et){return Et.contextDep&&De||Et.propDep}$i(ie,Ae,j),qi(ie,Ae,j.state,function(Et){return!ke(Et)}),(!j.profile||!ke(j.profile))&&fn(ie,Ae,j,!1,"a1"),j.contextDep=De,j.needsContext=mt,j.needsFramebuffer=Le;var Q=j.shader.progVar;if(Q.contextDep&&De||Q.propDep)wo(ie,Ae,j,null);else{var Se=Q.append(ie,Ae);if(Ae(ie.shared.gl,".useProgram(",Se,".program);"),j.shader.program)wo(ie,Ae,j,j.shader.program);else{Ae(ie.shared.vao,".setVAO(null);");var ue=ie.global.def("{}"),He=Ae.def(Se,".id"),Xe=Ae.def(ue,"[",He,"]");Ae(ie.cond(Xe).then(Xe,".call(this,a0,a1);").else(Xe,"=",ue,"[",He,"]=",ie.link(function(Et){return Kr(wo,ie,j,Et,2)}),"(",Se,");",Xe,".call(this,a0,a1);"))}}Object.keys(j.state).length>0&&Ae(ie.shared.current,".dirty=true;"),ie.shared.vao&&Ae(ie.shared.vao,".setVAO(null);")}function yt(ie,j){var Ae=ie.proc("scope",3);ie.batchId="a2";var De=ie.shared,mt=De.current;Li(ie,Ae,j.context),j.framebuffer&&j.framebuffer.append(ie,Ae),Wc(Object.keys(j.state)).forEach(function(Le){var ke=j.state[Le],Q=ke.append(ie,Ae);Ti(Q)?Q.forEach(function(Se,ue){Ae.set(ie.next[Le],"["+ue+"]",Se)}):Ae.set(De.next,"."+Le,Q)}),fn(ie,Ae,j,!0,!0),[ao,pl,Wu,Of,Ts].forEach(function(Le){var ke=j.draw[Le];!ke||Ae.set(De.draw,"."+Le,""+ke.append(ie,Ae))}),Object.keys(j.uniforms).forEach(function(Le){var ke=j.uniforms[Le].append(ie,Ae);Array.isArray(ke)&&(ke="["+ke.join()+"]"),Ae.set(De.uniforms,"["+X.id(Le)+"]",ke)}),Object.keys(j.attributes).forEach(function(Le){var ke=j.attributes[Le].append(ie,Ae),Q=ie.scopeAttrib(Le);Object.keys(new Ve).forEach(function(Se){Ae.set(Q,"."+Se,ke[Se])})}),j.scopeVAO&&Ae.set(De.vao,".targetVAO",j.scopeVAO.append(ie,Ae));function Ie(Le){var ke=j.shader[Le];ke&&Ae.set(De.shader,"."+Le,ke.append(ie,Ae))}Ie(hl),Ie(ju),Object.keys(j.state).length>0&&(Ae(mt,".dirty=true;"),Ae.exit(mt,".dirty=true;")),Ae("a1(",ie.shared.context,",a0,",ie.batchId,");")}function it(ie){if(!(typeof ie!="object"||Ti(ie))){for(var j=Object.keys(ie),Ae=0;Ae<j.length;++Ae)if(cr.isDynamic(ie[j[Ae]]))return!0;return!1}}function br(ie,j,Ae){var De=j.static[Ae];if(!De||!it(De))return;var mt=ie.global,Ie=Object.keys(De),Le=!1,ke=!1,Q=!1,Se=ie.global.def("{}");Ie.forEach(function(He){var Xe=De[He];if(cr.isDynamic(Xe)){typeof Xe=="function"&&(Xe=De[He]=cr.unbox(Xe));var Et=Aa(Xe,null);Le=Le||Et.thisDep,Q=Q||Et.propDep,ke=ke||Et.contextDep}else{switch(mt(Se,".",He,"="),typeof Xe){case"number":mt(Xe);break;case"string":mt('"',Xe,'"');break;case"object":Array.isArray(Xe)&&mt("[",Xe.join(),"]");break;default:mt(ie.link(Xe));break}mt(";")}});function ue(He,Xe){Ie.forEach(function(Et){var Ht=De[Et];if(!!cr.isDynamic(Ht)){var or=He.invoke(Xe,Ht);Xe(Se,".",Et,"=",or,";")}})}j.dynamic[Ae]=new cr.DynamicVariable(ei,{thisDep:Le,contextDep:ke,propDep:Q,ref:Se,append:ue}),delete j.static[Ae]}function _n(ie,j,Ae,De,mt){var Ie=$r();Ie.stats=Ie.link(mt),Object.keys(j.static).forEach(function(ke){br(Ie,j,ke)}),Ql.forEach(function(ke){br(Ie,ie,ke)});var Le=Ui(ie,j,Ae,De,Ie);return Wn(Ie,Le),yt(Ie,Le),fe(Ie,Le),ce(Ie.compile(),{destroy:function(){Le.shader.program.destroy()}})}return{next:mr,current:gr,procs:function(){var ie=$r(),j=ie.proc("poll"),Ae=ie.proc("refresh"),De=ie.block();j(De),Ae(De);var mt=ie.shared,Ie=mt.gl,Le=mt.next,ke=mt.current;De(ke,".dirty=false;"),Ki(ie,j),Ki(ie,Ae,null,!0);var Q;Wt&&(Q=ie.link(Wt)),me.oes_vertex_array_object&&Ae(ie.link(me.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Se=0;Se<nt.maxAttributes;++Se){var ue=Ae.def(mt.attributes,"[",Se,"]"),He=ie.cond(ue,".buffer");He.then(Ie,".enableVertexAttribArray(",Se,");",Ie,".bindBuffer(",dl,",",ue,".buffer.buffer);",Ie,".vertexAttribPointer(",Se,",",ue,".size,",ue,".type,",ue,".normalized,",ue,".stride,",ue,".offset);").else(Ie,".disableVertexAttribArray(",Se,");",Ie,".vertexAttrib4f(",Se,",",ue,".x,",ue,".y,",ue,".z,",ue,".w);",ue,".buffer=null;"),Ae(He),Wt&&Ae(Q,".vertexAttribDivisorANGLE(",Se,",",ue,".divisor);")}return Ae(ie.shared.vao,".currentVAO=null;",ie.shared.vao,".setVAO(",ie.shared.vao,".targetVAO);"),Object.keys(Lt).forEach(function(Xe){var Et=Lt[Xe],Ht=De.def(Le,".",Xe),or=ie.block();or("if(",Ht,"){",Ie,".enable(",Et,")}else{",Ie,".disable(",Et,")}",ke,".",Xe,"=",Ht,";"),Ae(or),j("if(",Ht,"!==",ke,".",Xe,"){",or,"}")}),Object.keys(wt).forEach(function(Xe){var Et=wt[Xe],Ht=gr[Xe],or,_r,ir=ie.block();if(ir(Ie,".",Et,"("),Ti(Ht)){var Pr=Ht.length;or=ie.global.def(Le,".",Xe),_r=ie.global.def(ke,".",Xe),ir(Ei(Pr,function(Er){return or+"["+Er+"]"}),");",Ei(Pr,function(Er){return _r+"["+Er+"]="+or+"["+Er+"];"}).join("")),j("if(",Ei(Pr,function(Er){return or+"["+Er+"]!=="+_r+"["+Er+"]"}).join("||"),"){",ir,"}")}else or=De.def(Le,".",Xe),_r=De.def(ke,".",Xe),ir(or,");",ke,".",Xe,"=",or,";"),j("if(",or,"!==",_r,"){",ir,"}");Ae(ir)}),ie.compile()}(),compile:_n}}function Ih(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Oh=34918,Vf=34919,$c=35007,kh=function(C,X){if(!X.ext_disjoint_timer_query)return null;var me=[];function nt(){return me.pop()||X.ext_disjoint_timer_query.createQueryEXT()}function Rt(Wt){me.push(Wt)}var ut=[];function Tt(Wt){var Sr=nt();X.ext_disjoint_timer_query.beginQueryEXT($c,Sr),ut.push(Sr),kt(ut.length-1,ut.length,Wt)}function It(){X.ext_disjoint_timer_query.endQueryEXT($c)}function Bt(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Kt=[];function Qt(){return Kt.pop()||new Bt}function Jt(Wt){Kt.push(Wt)}var tr=[];function kt(Wt,Sr,Ft){var gr=Qt();gr.startQueryIndex=Wt,gr.endQueryIndex=Sr,gr.sum=0,gr.stats=Ft,tr.push(gr)}var Xt=[],Ve=[];function bt(){var Wt,Sr,Ft=ut.length;if(Ft!==0){Ve.length=Math.max(Ve.length,Ft+1),Xt.length=Math.max(Xt.length,Ft+1),Xt[0]=0,Ve[0]=0;var gr=0;for(Wt=0,Sr=0;Sr<ut.length;++Sr){var mr=ut[Sr];X.ext_disjoint_timer_query.getQueryObjectEXT(mr,Vf)?(gr+=X.ext_disjoint_timer_query.getQueryObjectEXT(mr,Oh),Rt(mr)):ut[Wt++]=mr,Xt[Sr+1]=gr,Ve[Sr+1]=Wt}for(ut.length=Wt,Wt=0,Sr=0;Sr<tr.length;++Sr){var Gr=tr[Sr],Lt=Gr.startQueryIndex,wt=Gr.endQueryIndex;Gr.sum+=Xt[wt]-Xt[Lt];var Mr=Ve[Lt],fr=Ve[wt];fr===Mr?(Gr.stats.gpuTime+=Gr.sum/1e6,Jt(Gr)):(Gr.startQueryIndex=Mr,Gr.endQueryIndex=fr,tr[Wt++]=Gr)}tr.length=Wt}}return{beginQuery:Tt,endQuery:It,pushScopeStats:kt,update:bt,getNumPendingQueries:function(){return ut.length},clear:function(){me.push.apply(me,ut);for(var Wt=0;Wt<me.length;Wt++)X.ext_disjoint_timer_query.deleteQueryEXT(me[Wt]);ut.length=0,me.length=0},restore:function(){ut.length=0,me.length=0}}},Dp=16384,_u=256,Hf=1024,jf=34962,Xc="webglcontextlost",uc="webglcontextrestored",ks=1,Qr=2,Yc=3;function sc(C,X){for(var me=0;me<C.length;++me)if(C[me]===X)return me;return-1}function Fs(C){var X=Wa(C);if(!X)return null;var me=X.gl,nt=me.getContextAttributes(),Rt=me.isContextLost(),ut=ia(me,X);if(!ut)return null;var Tt=mi(),It=Ih(),Bt=ut.extensions,Kt=kh(me,Bt),Qt=Un(),Jt=me.drawingBufferWidth,tr=me.drawingBufferHeight,kt={tick:0,time:0,viewportWidth:Jt,viewportHeight:tr,framebufferWidth:Jt,framebufferHeight:tr,drawingBufferWidth:Jt,drawingBufferHeight:tr,pixelRatio:X.pixelRatio},Xt={},Ve={elements:null,primitive:4,count:-1,offset:0,instances:-1},bt=at(me,Bt),Wt=w(me,It,X,gr),Sr=Sa(me,Bt,Wt,It),Ft=Mf(me,Bt,bt,It,Wt,Sr,Ve);function gr(Kr){return Ft.destroyBuffer(Kr)}var mr=Rf(me,Tt,It,X),Gr=Ba(me,Bt,bt,function(){Mr.procs.poll()},kt,It,X),Lt=$d(me,Bt,bt,It,X),wt=Ah(me,Bt,bt,Gr,Lt,It),Mr=yu(me,Tt,Bt,bt,Wt,Sr,Gr,wt,Xt,Ft,mr,Ve,kt,Kt,X),fr=mu(me,wt,Mr.procs.poll,kt,nt,Bt,bt),Vt=Mr.next,vr=me.canvas,dr=[],on=[],$r=[],hr=[X.onDestroy],yr=null;function Xr(){if(dr.length===0){Kt&&Kt.update(),yr=null;return}yr=Yr.next(Xr),Pi();for(var Kr=dr.length-1;Kr>=0;--Kr){var vn=dr[Kr];vn&&vn(kt,null,0)}me.flush(),Kt&&Kt.update()}function tn(){!yr&&dr.length>0&&(yr=Yr.next(Xr))}function Sn(){yr&&(Yr.cancel(Xr),yr=null)}function Nn(Kr){Kr.preventDefault(),Rt=!0,Sn(),on.forEach(function(vn){vn()})}function qn(Kr){me.getError(),Rt=!1,ut.restore(),mr.restore(),Wt.restore(),Gr.restore(),Lt.restore(),wt.restore(),Ft.restore(),Kt&&Kt.restore(),Mr.procs.refresh(),tn(),$r.forEach(function(vn){vn()})}var sn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!sn&&vr&&(vr.addEventListener(Xc,Nn,!1),vr.addEventListener(uc,qn,!1));function Zi(){dr.length=0,Sn(),!sn&&vr&&(vr.removeEventListener(Xc,Nn),vr.removeEventListener(uc,qn)),mr.clear(),wt.clear(),Lt.clear(),Ft.clear(),Gr.clear(),Sr.clear(),Wt.clear(),Kt&&Kt.clear(),hr.forEach(function(Kr){Kr()})}function ui(Kr){T(!!Kr,"invalid args to regl({...})"),T.type(Kr,"object","invalid args to regl({...})");function vn(Ie){var Le=ce({},Ie);delete Le.uniforms,delete Le.attributes,delete Le.context,delete Le.vao,"stencil"in Le&&Le.stencil.op&&(Le.stencil.opBack=Le.stencil.opFront=Le.stencil.op,delete Le.stencil.op);function ke(Q){if(Q in Le){var Se=Le[Q];delete Le[Q],Object.keys(Se).forEach(function(ue){Le[Q+"."+ue]=Se[ue]})}}return ke("blend"),ke("depth"),ke("cull"),ke("stencil"),ke("polygonOffset"),ke("scissor"),ke("sample"),"vao"in Ie&&(Le.vao=Ie.vao),Le}function Wn(Ie,Le){var ke={},Q={};return Object.keys(Ie).forEach(function(Se){var ue=Ie[Se];if(cr.isDynamic(ue)){Q[Se]=cr.unbox(ue,Se);return}else if(Le&&Array.isArray(ue)){for(var He=0;He<ue.length;++He)if(cr.isDynamic(ue[He])){Q[Se]=cr.unbox(ue,Se);return}}ke[Se]=ue}),{dynamic:Q,static:ke}}var Ii=Wn(Kr.context||{},!0),wo=Wn(Kr.uniforms||{},!0),fe=Wn(Kr.attributes||{},!1),yt=Wn(vn(Kr),!1),it={gpuTime:0,cpuTime:0,count:0},br=Mr.compile(yt,fe,wo,Ii,it),_n=br.draw,ie=br.batch,j=br.scope,Ae=[];function De(Ie){for(;Ae.length<Ie;)Ae.push(null);return Ae}function mt(Ie,Le){var ke;if(Rt&&T.raise("context lost"),typeof Ie=="function")return j.call(this,null,Ie,0);if(typeof Le=="function")if(typeof Ie=="number")for(ke=0;ke<Ie;++ke)j.call(this,null,Le,ke);else if(Array.isArray(Ie))for(ke=0;ke<Ie.length;++ke)j.call(this,Ie[ke],Le,ke);else return j.call(this,Ie,Le,0);else if(typeof Ie=="number"){if(Ie>0)return ie.call(this,De(Ie|0),Ie|0)}else if(Array.isArray(Ie)){if(Ie.length)return ie.call(this,Ie,Ie.length)}else return _n.call(this,Ie)}return ce(mt,{stats:it,destroy:function(){br.destroy()}})}var Ui=wt.setFBO=ui({framebuffer:cr.define.call(null,ks,"framebuffer")});function Li(Kr,vn){var Wn=0;Mr.procs.poll();var Ii=vn.color;Ii&&(me.clearColor(+Ii[0]||0,+Ii[1]||0,+Ii[2]||0,+Ii[3]||0),Wn|=Dp),"depth"in vn&&(me.clearDepth(+vn.depth),Wn|=_u),"stencil"in vn&&(me.clearStencil(vn.stencil|0),Wn|=Hf),T(!!Wn,"called regl.clear with no buffer specified"),me.clear(Wn)}function Ki(Kr){if(T(typeof Kr=="object"&&Kr,"regl.clear() takes an object as input"),"framebuffer"in Kr)if(Kr.framebuffer&&Kr.framebuffer_reglType==="framebufferCube")for(var vn=0;vn<6;++vn)Ui(ce({framebuffer:Kr.framebuffer.faces[vn]},Kr),Li);else Ui(Kr,Li);else Li(null,Kr)}function $i(Kr){T.type(Kr,"function","regl.frame() callback must be a function"),dr.push(Kr);function vn(){var Wn=sc(dr,Kr);T(Wn>=0,"cannot cancel a frame twice");function Ii(){var wo=sc(dr,Ii);dr[wo]=dr[dr.length-1],dr.length-=1,dr.length<=0&&Sn()}dr[Wn]=Ii}return tn(),{cancel:vn}}function qi(){var Kr=Vt.viewport,vn=Vt.scissor_box;Kr[0]=Kr[1]=vn[0]=vn[1]=0,kt.viewportWidth=kt.framebufferWidth=kt.drawingBufferWidth=Kr[2]=vn[2]=me.drawingBufferWidth,kt.viewportHeight=kt.framebufferHeight=kt.drawingBufferHeight=Kr[3]=vn[3]=me.drawingBufferHeight}function Pi(){kt.tick+=1,kt.time=Qi(),qi(),Mr.procs.poll()}function fn(){Gr.refresh(),qi(),Mr.procs.refresh(),Kt&&Kt.update()}function Qi(){return(Un()-Qt)/1e3}fn();function zn(Kr,vn){T.type(vn,"function","listener callback must be a function");var Wn;switch(Kr){case"frame":return $i(vn);case"lost":Wn=on;break;case"restore":Wn=$r;break;case"destroy":Wn=hr;break;default:T.raise("invalid event, must be one of frame,lost,restore,destroy")}return Wn.push(vn),{cancel:function(){for(var Ii=0;Ii<Wn.length;++Ii)if(Wn[Ii]===vn){Wn[Ii]=Wn[Wn.length-1],Wn.pop();return}}}}var Xi=ce(ui,{clear:Ki,prop:cr.define.bind(null,ks),context:cr.define.bind(null,Qr),this:cr.define.bind(null,Yc),draw:ui({}),buffer:function(Kr){return Wt.create(Kr,jf,!1,!1)},elements:function(Kr){return Sr.create(Kr,!1)},texture:Gr.create2D,cube:Gr.createCube,renderbuffer:Lt.create,framebuffer:wt.create,framebufferCube:wt.createCube,vao:Ft.createVAO,attributes:nt,frame:$i,on:zn,limits:bt,hasExtension:function(Kr){return bt.extensions.indexOf(Kr.toLowerCase())>=0},read:fr,destroy:Zi,_gl:me,_refresh:fn,poll:function(){Pi(),Kt&&Kt.update()},now:Qi,stats:It});return X.onDone(null,Xi),Xi}return Fs})},96486:function(rr,G,D){rr=D.nmd(rr);var oe;/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(){var E,ce="4.17.21",J=200,U="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",re="Expected a function",Y="Invalid `variable` option passed into `_.template`",se="__lodash_hash_undefined__",le=500,ye="__lodash_placeholder__",Ce=1,Oe=2,Ue=4,pt=1,Ge=2,lt=1,Je=2,Ye=4,Ke=8,xt=16,I=32,ht=64,Fe=128,ge=256,je=512,Be=30,tt="...",_t=800,k=16,ne=1,P=2,L=3,b=1/0,de=9007199254740991,Te=17976931348623157e292,we=0/0,We=4294967295,St=We-1,ar=We>>>1,jt=[["ary",Fe],["bind",lt],["bindKey",Je],["curry",Ke],["curryRight",xt],["flip",je],["partial",I],["partialRight",ht],["rearg",ge]],Or="[object Arguments]",Wr="[object Array]",Zr="[object AsyncFunction]",pn="[object Boolean]",an="[object Date]",Fn="[object DOMException]",ln="[object Error]",gn="[object Function]",nn="[object GeneratorFunction]",Tr="[object Map]",Vr="[object Number]",fi="[object Null]",ti="[object Object]",Zn="[object Promise]",Ne="[object Proxy]",V="[object RegExp]",Z="[object Set]",$="[object String]",T="[object Symbol]",xe="[object Undefined]",vt="[object WeakMap]",Gt="[object WeakSet]",_e="[object ArrayBuffer]",$e="[object DataView]",At="[object Float32Array]",Zt="[object Float64Array]",er="[object Int8Array]",lr="[object Int16Array]",Nr="[object Int32Array]",Ir="[object Uint8Array]",cr="[object Uint8ClampedArray]",Yr="[object Uint16Array]",en="[object Uint32Array]",Un=/\b__p \+= '';/g,mi=/\b(__p \+=) '' \+/g,di=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Yn=/&(?:amp|lt|gt|quot|#39);/g,Vi=/[&<>"']/g,ja=RegExp(Yn.source),ea=RegExp(Vi.source),Ra=/<%-([\s\S]+?)%>/g,Wa=/<%([\s\S]+?)%>/g,ia=/<%=([\s\S]+?)%>/g,Ei=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ho=/^\w*$/,Mu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ru=/[\\^$.*+?()[\]{}|]/g,Rl=RegExp(Ru.source),Lu=/^\s+/,rn=/\s/,aa=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pu=/\{\n\/\* \[wrapped with (.+)\] \*/,Oo=/,? & /,as=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,oi=/[()=,{}\[\]\/\s]/,Vs=/\\(\\)?/g,st=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Hs=/\w*$/,q=/^[-+]0x[0-9a-f]+$/i,Iu=/^0b[01]+$/i,uu=/^\[object .+?Constructor\]$/,ko=/^0o[0-7]+$/i,Ou=/^(?:0|[1-9]\d*)$/,La=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Pa=/($^)/,dn=/['\n\r\u2028\u2029\\]/g,po="\\ud800-\\udfff",jo="\\u0300-\\u036f",su="\\ufe20-\\ufe2f",os="\\u20d0-\\u20ff",Wo=jo+su+os,gi="\\u2700-\\u27bf",$o="a-z\\xdf-\\xf6\\xf8-\\xff",vo="\\xac\\xb1\\xd7\\xf7",Hi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fa="\\u2000-\\u206f",ha=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",oa="A-Z\\xc0-\\xd6\\xd8-\\xde",us="\\ufe0e\\ufe0f",Xo=vo+Hi+fa+ha,$a="['\u2019]",ua="["+po+"]",Xa="["+Xo+"]",Ia="["+Wo+"]",ku="\\d+",lu="["+gi+"]",Oa="["+$o+"]",Fi="[^"+po+Xo+ku+gi+$o+oa+"]",ri="\\ud83c[\\udffb-\\udfff]",Yo="(?:"+Ia+"|"+ri+")",mo="[^"+po+"]",Fo="(?:\\ud83c[\\udde6-\\uddff]){2}",ot="[\\ud800-\\udbff][\\udc00-\\udfff]",at="["+oa+"]",R="\\u200d",z="(?:"+Oa+"|"+Fi+")",ee="(?:"+at+"|"+Fi+")",Pe="(?:"+$a+"(?:d|ll|m|re|s|t|ve))?",dt="(?:"+$a+"(?:D|LL|M|RE|S|T|VE))?",nr=Yo+"?",kr="["+us+"]?",Tn="(?:"+R+"(?:"+[mo,Fo,ot].join("|")+")"+kr+nr+")*",Ai="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",yi="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ot=kr+nr+Tn,zt="(?:"+[lu,Fo,ot].join("|")+")"+Ot,be="(?:"+[mo+Ia+"?",Ia,Fo,ot,ua].join("|")+")",Ya=RegExp($a,"g"),cu=RegExp(Ia,"g"),go=RegExp(ri+"(?="+ri+")|"+be+Ot,"g"),Ka=RegExp([at+"?"+Oa+"+"+Pe+"(?="+[Xa,at,"$"].join("|")+")",ee+"+"+dt+"(?="+[Xa,at+z,"$"].join("|")+")",at+"?"+z+"+"+Pe,at+"+"+dt,yi,Ai,ku,zt].join("|"),"g"),Fu=RegExp("["+R+po+Wo+us+"]"),qa=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ll=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yo=-1,Cn={};Cn[At]=Cn[Zt]=Cn[er]=Cn[lr]=Cn[Nr]=Cn[Ir]=Cn[cr]=Cn[Yr]=Cn[en]=!0,Cn[Or]=Cn[Wr]=Cn[_e]=Cn[pn]=Cn[$e]=Cn[an]=Cn[ln]=Cn[gn]=Cn[Tr]=Cn[Vr]=Cn[ti]=Cn[V]=Cn[Z]=Cn[$]=Cn[vt]=!1;var Jn={};Jn[Or]=Jn[Wr]=Jn[_e]=Jn[$e]=Jn[pn]=Jn[an]=Jn[At]=Jn[Zt]=Jn[er]=Jn[lr]=Jn[Nr]=Jn[Tr]=Jn[Vr]=Jn[ti]=Jn[V]=Jn[Z]=Jn[$]=Jn[T]=Jn[Ir]=Jn[cr]=Jn[Yr]=Jn[en]=!0,Jn[ln]=Jn[gn]=Jn[vt]=!1;var ss={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Nu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ka={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Pl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},js=parseFloat,Fa=parseInt,pe=typeof D.g=="object"&&D.g&&D.g.Object===Object&&D.g,p=typeof self=="object"&&self&&self.Object===Object&&self,g=pe||p||Function("return this")(),w=G&&!G.nodeType&&G,_=w&&!0&&rr&&!rr.nodeType&&rr,F=_&&_.exports===w,ae=F&&pe.process,Ee=function(){try{var rt=_&&_.require&&_.require("util").types;return rt||ae&&ae.binding&&ae.binding("util")}catch(Dt){}}(),Qe=Ee&&Ee.isArrayBuffer,et=Ee&&Ee.isDate,Nt=Ee&&Ee.isMap,$t=Ee&&Ee.isRegExp,Hr=Ee&&Ee.isSet,cn=Ee&&Ee.isTypedArray;function jr(rt,Dt,Ct){switch(Ct.length){case 0:return rt.call(Dt);case 1:return rt.call(Dt,Ct[0]);case 2:return rt.call(Dt,Ct[0],Ct[1]);case 3:return rt.call(Dt,Ct[0],Ct[1],Ct[2])}return rt.apply(Dt,Ct)}function Dn(rt,Dt,Ct,zr){for(var xn=-1,Gn=rt==null?0:rt.length;++xn<Gn;){var hi=rt[xn];Dt(zr,hi,Ct(hi),rt)}return zr}function yn(rt,Dt){for(var Ct=-1,zr=rt==null?0:rt.length;++Ct<zr&&Dt(rt[Ct],Ct,rt)!==!1;);return rt}function jn(rt,Dt){for(var Ct=rt==null?0:rt.length;Ct--&&Dt(rt[Ct],Ct,rt)!==!1;);return rt}function Na(rt,Dt){for(var Ct=-1,zr=rt==null?0:rt.length;++Ct<zr;)if(!Dt(rt[Ct],Ct,rt))return!1;return!0}function Si(rt,Dt){for(var Ct=-1,zr=rt==null?0:rt.length,xn=0,Gn=[];++Ct<zr;){var hi=rt[Ct];Dt(hi,Ct,rt)&&(Gn[xn++]=hi)}return Gn}function xa(rt,Dt){var Ct=rt==null?0:rt.length;return!!Ct&&Ja(rt,Dt,0)>-1}function _o(rt,Dt,Ct){for(var zr=-1,xn=rt==null?0:rt.length;++zr<xn;)if(Ct(Dt,rt[zr]))return!0;return!1}function ni(rt,Dt){for(var Ct=-1,zr=rt==null?0:rt.length,xn=Array(zr);++Ct<zr;)xn[Ct]=Dt(rt[Ct],Ct,rt);return xn}function Sa(rt,Dt){for(var Ct=-1,zr=Dt.length,xn=rt.length;++Ct<zr;)rt[xn+Ct]=Dt[Ct];return rt}function ls(rt,Dt,Ct,zr){var xn=-1,Gn=rt==null?0:rt.length;for(zr&&Gn&&(Ct=rt[++xn]);++xn<Gn;)Ct=Dt(Ct,rt[xn],xn,rt);return Ct}function yc(rt,Dt,Ct,zr){var xn=rt==null?0:rt.length;for(zr&&xn&&(Ct=rt[--xn]);xn--;)Ct=Dt(Ct,rt[xn],xn,rt);return Ct}function Il(rt,Dt){for(var Ct=-1,zr=rt==null?0:rt.length;++Ct<zr;)if(Dt(rt[Ct],Ct,rt))return!0;return!1}var _c=cs("length");function Ti(rt){return rt.split("")}function df(rt){return rt.match(as)||[]}function lh(rt,Dt,Ct){var zr;return Ct(rt,function(xn,Gn,hi){if(Dt(xn,Gn,hi))return zr=Gn,!1}),zr}function Qa(rt,Dt,Ct,zr){for(var xn=rt.length,Gn=Ct+(zr?1:-1);zr?Gn--:++Gn<xn;)if(Dt(rt[Gn],Gn,rt))return Gn;return-1}function Ja(rt,Dt,Ct){return Dt===Dt?ph(rt,Dt,Ct):Qa(rt,Du,Ct)}function fu(rt,Dt,Ct,zr){for(var xn=Ct-1,Gn=rt.length;++xn<Gn;)if(zr(rt[xn],Dt))return xn;return-1}function Du(rt){return rt!==rt}function xc(rt,Dt){var Ct=rt==null?0:rt.length;return Ct?sa(rt,Dt)/Ct:we}function cs(rt){return function(Dt){return Dt==null?E:Dt[rt]}}function fs(rt){return function(Dt){return rt==null?E:rt[Dt]}}function Ol(rt,Dt,Ct,zr,xn){return xn(rt,function(Gn,hi,Kn){Ct=zr?(zr=!1,Gn):Dt(Ct,Gn,hi,Kn)}),Ct}function vf(rt,Dt){var Ct=rt.length;for(rt.sort(Dt);Ct--;)rt[Ct]=rt[Ct].value;return rt}function sa(rt,Dt){for(var Ct,zr=-1,xn=rt.length;++zr<xn;){var Gn=Dt(rt[zr]);Gn!==E&&(Ct=Ct===E?Gn:Ct+Gn)}return Ct}function ba(rt,Dt){for(var Ct=-1,zr=Array(rt);++Ct<rt;)zr[Ct]=Dt(Ct);return zr}function jd(rt,Dt){return ni(Dt,function(Ct){return[Ct,rt[Ct]]})}function dp(rt){return rt&&rt.slice(0,Ys(rt)+1).replace(Lu,"")}function Ni(rt){return function(Dt){return rt(Dt)}}function ch(rt,Dt){return ni(Dt,function(Ct){return rt[Ct]})}function Bu(rt,Dt){return rt.has(Dt)}function Ws(rt,Dt){for(var Ct=-1,zr=rt.length;++Ct<zr&&Ja(Dt,rt[Ct],0)>-1;);return Ct}function kl(rt,Dt){for(var Ct=rt.length;Ct--&&Ja(Dt,rt[Ct],0)>-1;);return Ct}function mf(rt,Dt){for(var Ct=rt.length,zr=0;Ct--;)rt[Ct]===Dt&&++zr;return zr}var $s=fs(ss),gf=fs(Nu);function hs(rt){return"\\"+Pl[rt]}function eo(rt,Dt){return rt==null?E:rt[Dt]}function Zu(rt){return Fu.test(rt)}function fh(rt){return qa.test(rt)}function hh(rt){for(var Dt,Ct=[];!(Dt=rt.next()).done;)Ct.push(Dt.value);return Ct}function Xs(rt){var Dt=-1,Ct=Array(rt.size);return rt.forEach(function(zr,xn){Ct[++Dt]=[xn,zr]}),Ct}function pa(rt,Dt){return function(Ct){return rt(Dt(Ct))}}function xo(rt,Dt){for(var Ct=-1,zr=rt.length,xn=0,Gn=[];++Ct<zr;){var hi=rt[Ct];(hi===Dt||hi===ye)&&(rt[Ct]=ye,Gn[xn++]=Ct)}return Gn}function ps(rt){var Dt=-1,Ct=Array(rt.size);return rt.forEach(function(zr){Ct[++Dt]=zr}),Ct}function Da(rt){var Dt=-1,Ct=Array(rt.size);return rt.forEach(function(zr){Ct[++Dt]=[zr,zr]}),Ct}function ph(rt,Dt,Ct){for(var zr=Ct-1,xn=rt.length;++zr<xn;)if(rt[zr]===Dt)return zr;return-1}function ds(rt,Dt,Ct){for(var zr=Ct+1;zr--;)if(rt[zr]===Dt)return zr;return zr}function Uu(rt){return Zu(rt)?vh(rt):_c(rt)}function to(rt){return Zu(rt)?vp(rt):Ti(rt)}function Ys(rt){for(var Dt=rt.length;Dt--&&rn.test(rt.charAt(Dt)););return Dt}var dh=fs(ka);function vh(rt){for(var Dt=go.lastIndex=0;go.test(rt);)++Dt;return Dt}function vp(rt){return rt.match(go)||[]}function yf(rt){return rt.match(Ka)||[]}var mp=function rt(Dt){Dt=Dt==null?g:Sc.defaults(g.Object(),Dt,Sc.pick(g,Ll));var Ct=Dt.Array,zr=Dt.Date,xn=Dt.Error,Gn=Dt.Function,hi=Dt.Math,Kn=Dt.Object,Fl=Dt.RegExp,gp=Dt.String,No=Dt.TypeError,Ko=Ct.prototype,yp=Gn.prototype,Ks=Kn.prototype,_f=Dt["__core-js_shared__"],qs=yp.toString,ii=Ks.hasOwnProperty,bc=0,_p=function(){var c=/[^.]+$/.exec(_f&&_f.keys&&_f.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),vs=Ks.toString,So=qs.call(Kn),Qs=g._,xf=Fl("^"+qs.call(ii).replace(Ru,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Nl=F?Dt.Buffer:E,hu=Dt.Symbol,Dl=Dt.Uint8Array,Sf=Nl?Nl.allocUnsafe:E,pu=pa(Kn.getPrototypeOf,Kn),mh=Kn.create,ms=Ks.propertyIsEnumerable,Di=Ko.splice,Bl=hu?hu.isConcatSpreadable:E,Zl=hu?hu.iterator:E,bo=hu?hu.toStringTag:E,Ec=function(){try{var c=Fs(Kn,"defineProperty");return c({},"",{}),c}catch(f){}}(),gh=Dt.clearTimeout!==g.clearTimeout&&Dt.clearTimeout,xp=zr&&zr.now!==g.Date.now&&zr.now,Sp=Dt.setTimeout!==g.setTimeout&&Dt.setTimeout,Js=hi.ceil,el=hi.floor,Ul=Kn.getOwnPropertySymbols,bp=Nl?Nl.isBuffer:E,bf=Dt.isFinite,Ep=Ko.join,Wd=pa(Kn.keys,Kn),Bi=hi.max,la=hi.min,Ap=zr.now,Ac=Dt.parseInt,Ba=hi.random,zu=Ko.reverse,In=Fs(Dt,"DataView"),tl=Fs(Dt,"Map"),Ef=Fs(Dt,"Promise"),gs=Fs(Dt,"Set"),rl=Fs(Dt,"WeakMap"),nl=Fs(Kn,"create"),il=rl&&new rl,ys={},Tc=qn(In),yh=qn(tl),ro=qn(Ef),Tp=qn(gs),$d=qn(rl),no=hu?hu.prototype:E,Gu=no?no.valueOf:E,du=no?no.toString:E;function K(c){if(qe(c)&&!Mn(c)&&!(c instanceof On)){if(c instanceof da)return c;if(ii.call(c,"__wrapped__"))return Zi(c)}return new da(c)}var _s=function(){function c(){}return function(f){if(!Gi(f))return{};if(mh)return mh(f);c.prototype=f;var m=new c;return c.prototype=E,m}}();function Vu(){}function da(c,f){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=E}K.templateSettings={escape:Ra,evaluate:Wa,interpolate:ia,variable:"",imports:{_:K}},K.prototype=Vu.prototype,K.prototype.constructor=K,da.prototype=_s(Vu.prototype),da.prototype.constructor=da;function On(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=We,this.__views__=[]}function Cc(){var c=new On(this.__wrapped__);return c.__actions__=ta(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=ta(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=ta(this.__views__),c}function _h(){if(this.__filtered__){var c=new On(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function zl(){var c=this.__wrapped__.value(),f=this.__dir__,m=Mn(c),A=f<0,B=m?c.length:0,te=Rt(0,B,this.__views__),Me=te.start,Ze=te.end,ct=Ze-Me,Yt=A?Ze:Me-1,qt=this.__iteratees__,ur=qt.length,Fr=0,qr=la(ct,this.__takeCount__);if(!m||!A&&B==ct&&qr==ct)return Np(c,this.__actions__);var hn=[];e:for(;ct--&&Fr<qr;){Yt+=f;for(var mn=-1,un=c[Yt];++mn<ur;){var Bn=qt[mn],Vn=Bn.iteratee,Lo=Bn.type,wa=Vn(un);if(Lo==P)un=wa;else if(!wa){if(Lo==ne)continue e;break e}}hn[Fr++]=un}return hn}On.prototype=_s(Vu.prototype),On.prototype.constructor=On;function Do(c){var f=-1,m=c==null?0:c.length;for(this.clear();++f<m;){var A=c[f];this.set(A[0],A[1])}}function wc(){this.__data__=nl?nl(null):{},this.size=0}function al(c){var f=this.has(c)&&delete this.__data__[c];return this.size-=f?1:0,f}function Gl(c){var f=this.__data__;if(nl){var m=f[c];return m===se?E:m}return ii.call(f,c)?f[c]:E}function qo(c){var f=this.__data__;return nl?f[c]!==E:ii.call(f,c)}function xh(c,f){var m=this.__data__;return this.size+=this.has(c)?0:1,m[c]=nl&&f===E?se:f,this}Do.prototype.clear=wc,Do.prototype.delete=al,Do.prototype.get=Gl,Do.prototype.has=qo,Do.prototype.set=xh;function Qo(c){var f=-1,m=c==null?0:c.length;for(this.clear();++f<m;){var A=c[f];this.set(A[0],A[1])}}function Cp(){this.__data__=[],this.size=0}function wp(c){var f=this.__data__,m=Eo(f,c);if(m<0)return!1;var A=f.length-1;return m==A?f.pop():Di.call(f,m,1),--this.size,!0}function Af(c){var f=this.__data__,m=Eo(f,c);return m<0?E:f[m][1]}function Mc(c){return Eo(this.__data__,c)>-1}function Mp(c,f){var m=this.__data__,A=Eo(m,c);return A<0?(++this.size,m.push([c,f])):m[A][1]=f,this}Qo.prototype.clear=Cp,Qo.prototype.delete=wp,Qo.prototype.get=Af,Qo.prototype.has=Mc,Qo.prototype.set=Mp;function Jo(c){var f=-1,m=c==null?0:c.length;for(this.clear();++f<m;){var A=c[f];this.set(A[0],A[1])}}function Sh(){this.size=0,this.__data__={hash:new Do,map:new(tl||Qo),string:new Do}}function Rp(c){var f=Yc(this,c).delete(c);return this.size-=f?1:0,f}function bh(c){return Yc(this,c).get(c)}function xs(c){return Yc(this,c).has(c)}function Eh(c,f){var m=Yc(this,c),A=m.size;return m.set(c,f),this.size+=m.size==A?0:1,this}Jo.prototype.clear=Sh,Jo.prototype.delete=Rp,Jo.prototype.get=bh,Jo.prototype.has=xs,Jo.prototype.set=Eh;function eu(c){var f=-1,m=c==null?0:c.length;for(this.__data__=new Jo;++f<m;)this.add(c[f])}function Lp(c){return this.__data__.set(c,se),this}function Rc(c){return this.__data__.has(c)}eu.prototype.add=eu.prototype.push=Lp,eu.prototype.has=Rc;function Ci(c){var f=this.__data__=new Qo(c);this.size=f.size}function Ss(){this.__data__=new Qo,this.size=0}function Ah(c){var f=this.__data__,m=f.delete(c);return this.size=f.size,m}function Tf(c){return this.__data__.get(c)}function Cf(c){return this.__data__.has(c)}function Vl(c,f){var m=this.__data__;if(m instanceof Qo){var A=m.__data__;if(!tl||A.length<J-1)return A.push([c,f]),this.size=++m.size,this;m=this.__data__=new Jo(A)}return m.set(c,f),this.size=m.size,this}Ci.prototype.clear=Ss,Ci.prototype.delete=Ah,Ci.prototype.get=Tf,Ci.prototype.has=Cf,Ci.prototype.set=Vl;function wf(c,f){var m=Mn(c),A=!m&&Ds(c),B=!m&&!A&&El(c),te=!m&&!A&&!B&&lc(c),Me=m||A||B||te,Ze=Me?ba(c.length,gp):[],ct=Ze.length;for(var Yt in c)(f||ii.call(c,Yt))&&!(Me&&(Yt=="length"||B&&(Yt=="offset"||Yt=="parent")||te&&(Yt=="buffer"||Yt=="byteLength"||Yt=="byteOffset")||tr(Yt,ct)))&&Ze.push(Yt);return Ze}function io(c){var f=c.length;return f?c[$u(0,f-1)]:E}function Mf(c,f){return tn(ta(c),mu(f,0,c.length))}function Pp(c){return tn(ta(c))}function wn(c,f,m){(m!==E&&!lo(c[f],m)||m===E&&!(f in c))&&vu(c,f,m)}function Bo(c,f,m){var A=c[f];(!(ii.call(c,f)&&lo(A,m))||m===E&&!(f in c))&&vu(c,f,m)}function Eo(c,f){for(var m=c.length;m--;)if(lo(c[m][0],f))return m;return-1}function Rf(c,f,m,A){return Za(c,function(B,te,Me){f(A,B,m(B),Me)}),A}function Th(c,f){return c&&ga(f,ya(f),c)}function Hl(c,f){return c&&ga(f,Ri(f),c)}function vu(c,f,m){f=="__proto__"&&Ec?Ec(c,f,{configurable:!0,enumerable:!0,value:m,writable:!0}):c[f]=m}function ol(c,f){for(var m=-1,A=f.length,B=Ct(A),te=c==null;++m<A;)B[m]=te?E:Vh(c,f[m]);return B}function mu(c,f,m){return c===c&&(m!==E&&(c=c<=m?c:m),f!==E&&(c=c>=f?c:f)),c}function Yi(c,f,m,A,B,te){var Me,Ze=f&Ce,ct=f&Oe,Yt=f&Ue;if(m&&(Me=B?m(c,A,B,te):m(c)),Me!==E)return Me;if(!Gi(c))return c;var qt=Mn(c);if(qt){if(Me=It(c),!Ze)return ta(c,Me)}else{var ur=nt(c),Fr=ur==gn||ur==nn;if(El(c))return Bf(c,Ze);if(ur==ti||ur==Or||Fr&&!B){if(Me=ct||Fr?{}:Bt(c),!Ze)return ct?Uf(c,Hl(Me,c)):Lh(c,Th(Me,c))}else{if(!Jn[ur])return B?c:{};Me=Kt(c,ur,Ze)}}te||(te=new Ci);var qr=te.get(c);if(qr)return qr;te.set(c,Me),Kp(c)?c.forEach(function(un){Me.add(Yi(un,f,m,un,c,te))}):ov(c)&&c.forEach(function(un,Bn){Me.set(Bn,Yi(un,f,m,Bn,c,te))});var hn=Yt?ct?jf:Hf:ct?Ri:ya,mn=qt?E:hn(c);return yn(mn||c,function(un,Bn){mn&&(Bn=un,un=c[Bn]),Bo(Me,Bn,Yi(un,f,m,Bn,c,te))}),Me}function Ao(c){var f=ya(c);return function(m){return jl(m,c,f)}}function jl(c,f,m){var A=m.length;if(c==null)return!A;for(c=Kn(c);A--;){var B=m[A],te=f[B],Me=c[B];if(Me===E&&!(B in c)||!te(Me))return!1}return!0}function Dr(c,f,m){if(typeof c!="function")throw new No(re);return $r(function(){c.apply(E,m)},f)}function Rr(c,f,m,A){var B=-1,te=xa,Me=!0,Ze=c.length,ct=[],Yt=f.length;if(!Ze)return ct;m&&(f=ni(f,Ni(m))),A?(te=_o,Me=!1):f.length>=J&&(te=Bu,Me=!1,f=new eu(f));e:for(;++B<Ze;){var qt=c[B],ur=m==null?qt:m(qt);if(qt=A||qt!==0?qt:0,Me&&ur===ur){for(var Fr=Yt;Fr--;)if(f[Fr]===ur)continue e;ct.push(qt)}else te(f,ur,A)||ct.push(qt)}return ct}var Za=Ph(To),Wl=Ph(sl,!0);function Lc(c,f){var m=!0;return Za(c,function(A,B,te){return m=!!f(A,B,te),m}),m}function ul(c,f,m){for(var A=-1,B=c.length;++A<B;){var te=c[A],Me=f(te);if(Me!=null&&(Ze===E?Me===Me&&!Go(Me):m(Me,Ze)))var Ze=Me,ct=te}return ct}function bn(c,f,m,A){var B=c.length;for(m=Pn(m),m<0&&(m=-m>B?0:B+m),A=A===E||A>B?B:Pn(A),A<0&&(A+=B),A=m>A?0:hv(A);m<A;)c[m++]=f;return c}function va(c,f){var m=[];return Za(c,function(A,B,te){f(A,B,te)&&m.push(A)}),m}function ei(c,f,m,A,B){var te=-1,Me=c.length;for(m||(m=Jt),B||(B=[]);++te<Me;){var Ze=c[te];f>0&&m(Ze)?f>1?ei(Ze,f-1,m,A,B):Sa(B,Ze):A||(B[B.length]=Ze)}return B}var tu=Uo(),Lf=Uo(!0);function To(c,f){return c&&tu(c,f,ya)}function sl(c,f){return c&&Lf(c,f,ya)}function Pc(c,f){return Si(f,function(m){return Bs(c[m])})}function gu(c,f){f=uo(f,c);for(var m=0,A=f.length;c!=null&&m<A;)c=c[Nn(f[m++])];return m&&m==A?c:E}function $l(c,f,m){var A=f(c);return Mn(c)?A:Sa(A,m(c))}function ma(c){return c==null?c===E?xe:fi:bo&&bo in Kn(c)?C(c):Mr(c)}function Pf(c,f){return c>f}function Ch(c,f){return c!=null&&ii.call(c,f)}function bi(c,f){return c!=null&&f in Kn(c)}function Ic(c,f,m){return c>=la(f,m)&&c<Bi(f,m)}function Xl(c,f,m){for(var A=m?_o:xa,B=c[0].length,te=c.length,Me=te,Ze=Ct(te),ct=Infinity,Yt=[];Me--;){var qt=c[Me];Me&&f&&(qt=ni(qt,Ni(f))),ct=la(qt.length,ct),Ze[Me]=!m&&(f||B>=120&&qt.length>=120)?new eu(Me&&qt):E}qt=c[0];var ur=-1,Fr=Ze[0];e:for(;++ur<B&&Yt.length<ct;){var qr=qt[ur],hn=f?f(qr):qr;if(qr=m||qr!==0?qr:0,!(Fr?Bu(Fr,hn):A(Yt,hn,m))){for(Me=te;--Me;){var mn=Ze[Me];if(!(mn?Bu(mn,hn):A(c[Me],hn,m)))continue e}Fr&&Fr.push(hn),Yt.push(qr)}}return Yt}function Ip(c,f,m,A){return To(c,function(B,te,Me){f(A,m(B),te,Me)}),A}function bs(c,f,m){f=uo(f,c),c=Vt(c,f);var A=c==null?c:c[Nn(De(f))];return A==null?E:jr(A,c,m)}function Oc(c){return qe(c)&&ma(c)==Or}function kc(c){return qe(c)&&ma(c)==_e}function Es(c){return qe(c)&&ma(c)==an}function As(c,f,m,A,B){return c===f?!0:c==null||f==null||!qe(c)&&!qe(f)?c!==c&&f!==f:Hu(c,f,m,A,As,B)}function Hu(c,f,m,A,B,te){var Me=Mn(c),Ze=Mn(f),ct=Me?Wr:nt(c),Yt=Ze?Wr:nt(f);ct=ct==Or?ti:ct,Yt=Yt==Or?ti:Yt;var qt=ct==ti,ur=Yt==ti,Fr=ct==Yt;if(Fr&&El(c)){if(!El(f))return!1;Me=!0,qt=!1}if(Fr&&!qt)return te||(te=new Ci),Me||lc(c)?$c(c,f,m,A,B,te):kh(c,f,ct,m,A,B,te);if(!(m&pt)){var qr=qt&&ii.call(c,"__wrapped__"),hn=ur&&ii.call(f,"__wrapped__");if(qr||hn){var mn=qr?c.value():c,un=hn?f.value():f;return te||(te=new Ci),B(mn,un,m,A,te)}}return Fr?(te||(te=new Ci),Dp(c,f,m,A,B,te)):!1}function Yl(c){return qe(c)&&nt(c)==Tr}function Fc(c,f,m,A){var B=m.length,te=B,Me=!A;if(c==null)return!te;for(c=Kn(c);B--;){var Ze=m[B];if(Me&&Ze[2]?Ze[1]!==c[Ze[0]]:!(Ze[0]in c))return!1}for(;++B<te;){Ze=m[B];var ct=Ze[0],Yt=c[ct],qt=Ze[1];if(Me&&Ze[2]){if(Yt===E&&!(ct in c))return!1}else{var ur=new Ci;if(A)var Fr=A(Yt,qt,ct,c,f,ur);if(!(Fr===E?As(qt,Yt,pt|Ge,A,ur):Fr))return!1}}return!0}function If(c){if(!Gi(c)||Wt(c))return!1;var f=Bs(c)?xf:uu;return f.test(qn(c))}function wh(c){return qe(c)&&ma(c)==V}function ll(c){return qe(c)&&nt(c)==Z}function Nc(c){return qe(c)&&pr(c.length)&&!!Cn[ma(c)]}function Mh(c){return typeof c=="function"?c:c==null?$n:typeof c=="object"?Mn(c)?ju(c[0],c[1]):hl(c):Km(c)}function cl(c){if(!Ft(c))return Wd(c);var f=[];for(var m in Kn(c))ii.call(c,m)&&m!="constructor"&&f.push(m);return f}function ru(c){if(!Gi(c))return wt(c);var f=Ft(c),m=[];for(var A in c)A=="constructor"&&(f||!ii.call(c,A))||m.push(A);return m}function fl(c,f){return c<f}function nu(c,f){var m=-1,A=za(c)?Ct(c.length):[];return Za(c,function(B,te,Me){A[++m]=f(B,te,Me)}),A}function hl(c){var f=sc(c);return f.length==1&&f[0][2]?mr(f[0][0],f[0][1]):function(m){return m===c||Fc(m,c,f)}}function ju(c,f){return Xt(c)&&gr(f)?mr(Nn(c),f):function(m){var A=Vh(m,c);return A===E&&A===f?Hh(m,c):As(f,A,pt|Ge)}}function ao(c,f,m,A,B){c!==f&&tu(f,function(te,Me){if(B||(B=new Ci),Gi(te))Ts(c,f,Me,m,ao,A,B);else{var Ze=A?A(dr(c,Me),te,Me+"",c,f,B):E;Ze===E&&(Ze=te),wn(c,Me,Ze)}},Ri)}function Ts(c,f,m,A,B,te,Me){var Ze=dr(c,m),ct=dr(f,m),Yt=Me.get(ct);if(Yt){wn(c,m,Yt);return}var qt=te?te(Ze,ct,m+"",c,f,Me):E,ur=qt===E;if(ur){var Fr=Mn(ct),qr=!Fr&&El(ct),hn=!Fr&&!qr&&lc(ct);qt=ct,Fr||qr||hn?Mn(Ze)?qt=Ze:zi(Ze)?qt=ta(Ze):qr?(ur=!1,qt=Bf(ct,!0)):hn?(ur=!1,qt=ic(ct,!0)):qt=[]:Jc(ct)||Ds(ct)?(qt=Ze,Ds(Ze)?qt=pv(Ze):(!Gi(Ze)||Bs(Ze))&&(qt=Bt(ct))):ur=!1}ur&&(Me.set(ct,qt),B(qt,ct,A,te,Me),Me.delete(ct)),wn(c,m,qt)}function Wu(c,f){var m=c.length;if(!!m)return f+=f<0?m:0,tr(f,m)?c[f]:E}function pl(c,f,m){f.length?f=ni(f,function(te){return Mn(te)?function(Me){return gu(Me,te.length===1?te[0]:te)}:te}):f=[$n];var A=-1;f=ni(f,Ni(Qr()));var B=nu(c,function(te,Me,Ze){var ct=ni(f,function(Yt){return Yt(te)});return{criteria:ct,index:++A,value:te}});return vf(B,function(te,Me){return ac(te,Me,m)})}function Of(c,f){return Cs(c,f,function(m,A){return Hh(c,A)})}function Cs(c,f,m){for(var A=-1,B=f.length,te={};++A<B;){var Me=f[A],Ze=gu(c,Me);m(Ze,Me)&&Ql(te,uo(Me,c),Ze)}return te}function Kl(c){return function(f){return gu(f,c)}}function Dc(c,f,m,A){var B=A?fu:Ja,te=-1,Me=f.length,Ze=c;for(c===f&&(f=ta(f)),m&&(Ze=ni(c,Ni(m)));++te<Me;)for(var ct=0,Yt=f[te],qt=m?m(Yt):Yt;(ct=B(Ze,qt,ct,A))>-1;)Ze!==c&&Di.call(Ze,ct,1),Di.call(c,ct,1);return c}function ws(c,f){for(var m=c?f.length:0,A=m-1;m--;){var B=f[m];if(m==A||B!==te){var te=B;tr(B)?Di.call(c,B,1):Zo(c,B)}}return c}function $u(c,f){return c+el(Ba()*(f-c+1))}function Op(c,f,m,A){for(var B=-1,te=Bi(Js((f-c)/(m||1)),0),Me=Ct(te);te--;)Me[A?te:++B]=c,c+=m;return Me}function ji(c,f){var m="";if(!c||f<1||f>de)return m;do f%2&&(m+=c),f=el(f/2),f&&(c+=c);while(f);return m}function Ln(c,f){return hr(fr(c,f,$n),c+"")}function ql(c){return io(rf(c))}function kp(c,f){var m=rf(c);return tn(m,mu(f,0,m.length))}function Ql(c,f,m,A){if(!Gi(c))return c;f=uo(f,c);for(var B=-1,te=f.length,Me=te-1,Ze=c;Ze!=null&&++B<te;){var ct=Nn(f[B]),Yt=m;if(ct==="__proto__"||ct==="constructor"||ct==="prototype")return c;if(B!=Me){var qt=Ze[ct];Yt=A?A(qt,ct,Ze):E,Yt===E&&(Yt=Gi(qt)?qt:tr(f[B+1])?[]:{})}Bo(Ze,ct,Yt),Ze=Ze[ct]}return c}var dl=il?function(c,f){return il.set(c,f),c}:$n,Ms=Ec?function(c,f){return Ec(c,"toString",{configurable:!0,enumerable:!1,value:nd(f),writable:!0})}:$n;function kf(c){return tn(rf(c))}function Ea(c,f,m){var A=-1,B=c.length;f<0&&(f=-f>B?0:B+f),m=m>B?B:m,m<0&&(m+=B),B=f>m?0:m-f>>>0,f>>>=0;for(var te=Ct(B);++A<B;)te[A]=c[A+f];return te}function Ff(c,f){var m;return Za(c,function(A,B,te){return m=f(A,B,te),!m}),!!m}function Jl(c,f,m){var A=0,B=c==null?A:c.length;if(typeof f=="number"&&f===f&&B<=ar){for(;A<B;){var te=A+B>>>1,Me=c[te];Me!==null&&!Go(Me)&&(m?Me<=f:Me<f)?A=te+1:B=te}return B}return Nf(c,f,$n,m)}function Nf(c,f,m,A){var B=0,te=c==null?0:c.length;if(te===0)return 0;f=m(f);for(var Me=f!==f,Ze=f===null,ct=Go(f),Yt=f===E;B<te;){var qt=el((B+te)/2),ur=m(c[qt]),Fr=ur!==E,qr=ur===null,hn=ur===ur,mn=Go(ur);if(Me)var un=A||hn;else Yt?un=hn&&(A||Fr):Ze?un=hn&&Fr&&(A||!qr):ct?un=hn&&Fr&&!qr&&(A||!mn):qr||mn?un=!1:un=A?ur<=f:ur<f;un?B=qt+1:te=qt}return la(te,St)}function Df(c,f){for(var m=-1,A=c.length,B=0,te=[];++m<A;){var Me=c[m],Ze=f?f(Me):Me;if(!m||!lo(Ze,ct)){var ct=Ze;te[B++]=Me===0?0:Me}}return te}function Fp(c){return typeof c=="number"?c:Go(c)?we:+c}function oo(c){if(typeof c=="string")return c;if(Mn(c))return ni(c,oo)+"";if(Go(c))return du?du.call(c):"";var f=c+"";return f=="0"&&1/c==-b?"-0":f}function Rs(c,f,m){var A=-1,B=xa,te=c.length,Me=!0,Ze=[],ct=Ze;if(m)Me=!1,B=_o;else if(te>=J){var Yt=f?null:Aa(c);if(Yt)return ps(Yt);Me=!1,B=Bu,ct=new eu}else ct=f?[]:Ze;e:for(;++A<te;){var qt=c[A],ur=f?f(qt):qt;if(qt=m||qt!==0?qt:0,Me&&ur===ur){for(var Fr=ct.length;Fr--;)if(ct[Fr]===ur)continue e;f&&ct.push(ur),Ze.push(qt)}else B(ct,ur,m)||(ct!==Ze&&ct.push(ur),Ze.push(qt))}return Ze}function Zo(c,f){return f=uo(f,c),c=Vt(c,f),c==null||delete c[Nn(De(f))]}function Rh(c,f,m,A){return Ql(c,f,m(gu(c,f)),A)}function Bc(c,f,m,A){for(var B=c.length,te=A?B:-1;(A?te--:++te<B)&&f(c[te],te,c););return m?Ea(c,A?0:te,A?te+1:B):Ea(c,A?te+1:0,A?B:te)}function Np(c,f){var m=c;return m instanceof On&&(m=m.value()),ls(f,function(A,B){return B.func.apply(B.thisArg,Sa([A],B.args))},m)}function Zc(c,f,m){var A=c.length;if(A<2)return A?Rs(c[0]):[];for(var B=-1,te=Ct(A);++B<A;)for(var Me=c[B],Ze=-1;++Ze<A;)Ze!=B&&(te[B]=Rr(te[B]||Me,c[Ze],f,m));return Rs(ei(te,1),f,m)}function ec(c,f,m){for(var A=-1,B=c.length,te=f.length,Me={};++A<B;){var Ze=A<te?f[A]:E;m(Me,c[A],Ze)}return Me}function Ls(c){return zi(c)?c:[]}function tc(c){return typeof c=="function"?c:$n}function uo(c,f){return Mn(c)?c:Xt(c,f)?[c]:Sn(si(c))}var Uc=Ln;function Co(c,f,m){var A=c.length;return m=m===E?A:m,!f&&m>=A?c:Ea(c,f,m)}var vl=gh||function(c){return g.clearTimeout(c)};function Bf(c,f){if(f)return c.slice();var m=c.length,A=Sf?Sf(m):new c.constructor(m);return c.copy(A),A}function ml(c){var f=new c.constructor(c.byteLength);return new Dl(f).set(new Dl(c)),f}function rc(c,f){var m=f?ml(c.buffer):c.buffer;return new c.constructor(m,c.byteOffset,c.byteLength)}function zc(c){var f=new c.constructor(c.source,Hs.exec(c));return f.lastIndex=c.lastIndex,f}function nc(c){return Gu?Kn(Gu.call(c)):{}}function ic(c,f){var m=f?ml(c.buffer):c.buffer;return new c.constructor(m,c.byteOffset,c.length)}function gl(c,f){if(c!==f){var m=c!==E,A=c===null,B=c===c,te=Go(c),Me=f!==E,Ze=f===null,ct=f===f,Yt=Go(f);if(!Ze&&!Yt&&!te&&c>f||te&&Me&&ct&&!Ze&&!Yt||A&&Me&&ct||!m&&ct||!B)return 1;if(!A&&!te&&!Yt&&c<f||Yt&&m&&B&&!A&&!te||Ze&&m&&B||!Me&&B||!ct)return-1}return 0}function ac(c,f,m){for(var A=-1,B=c.criteria,te=f.criteria,Me=B.length,Ze=m.length;++A<Me;){var ct=gl(B[A],te[A]);if(ct){if(A>=Ze)return ct;var Yt=m[A];return ct*(Yt=="desc"?-1:1)}}return c.index-f.index}function Ps(c,f,m,A){for(var B=-1,te=c.length,Me=m.length,Ze=-1,ct=f.length,Yt=Bi(te-Me,0),qt=Ct(ct+Yt),ur=!A;++Ze<ct;)qt[Ze]=f[Ze];for(;++B<Me;)(ur||B<te)&&(qt[m[B]]=c[B]);for(;Yt--;)qt[Ze++]=c[B++];return qt}function Zf(c,f,m,A){for(var B=-1,te=c.length,Me=-1,Ze=m.length,ct=-1,Yt=f.length,qt=Bi(te-Ze,0),ur=Ct(qt+Yt),Fr=!A;++B<qt;)ur[B]=c[B];for(var qr=B;++ct<Yt;)ur[qr+ct]=f[ct];for(;++Me<Ze;)(Fr||B<te)&&(ur[qr+m[Me]]=c[B++]);return ur}function ta(c,f){var m=-1,A=c.length;for(f||(f=Ct(A));++m<A;)f[m]=c[m];return f}function ga(c,f,m,A){var B=!m;m||(m={});for(var te=-1,Me=f.length;++te<Me;){var Ze=f[te],ct=A?A(m[Ze],c[Ze],Ze,m,c):E;ct===E&&(ct=c[Ze]),B?vu(m,Ze,ct):Bo(m,Ze,ct)}return m}function Lh(c,f){return ga(c,X(c),f)}function Uf(c,f){return ga(c,me(c),f)}function oc(c,f){return function(m,A){var B=Mn(m)?Dn:Rf,te=f?f():{};return B(m,c,Qr(A,2),te)}}function yl(c){return Ln(function(f,m){var A=-1,B=m.length,te=B>1?m[B-1]:E,Me=B>2?m[2]:E;for(te=c.length>3&&typeof te=="function"?(B--,te):E,Me&&kt(m[0],m[1],Me)&&(te=B<3?E:te,B=1),f=Kn(f);++A<B;){var Ze=m[A];Ze&&c(f,Ze,A,te)}return f})}function Ph(c,f){return function(m,A){if(m==null)return m;if(!za(m))return c(m,A);for(var B=m.length,te=f?B:-1,Me=Kn(m);(f?te--:++te<B)&&A(Me[te],te,Me)!==!1;);return m}}function Uo(c){return function(f,m,A){for(var B=-1,te=Kn(f),Me=A(f),Ze=Me.length;Ze--;){var ct=Me[c?Ze:++B];if(m(te[ct],ct,te)===!1)break}return f}}function Gc(c,f,m){var A=f&lt,B=Wi(c);function te(){var Me=this&&this!==g&&this instanceof te?B:c;return Me.apply(A?m:this,arguments)}return te}function zf(c){return function(f){f=si(f);var m=Zu(f)?to(f):E,A=m?m[0]:f.charAt(0),B=m?Co(m,1).join(""):f.slice(1);return A[c]()+B}}function Is(c){return function(f){return ls(td(wv(f).replace(Ya,"")),c,"")}}function Wi(c){return function(){var f=arguments;switch(f.length){case 0:return new c;case 1:return new c(f[0]);case 2:return new c(f[0],f[1]);case 3:return new c(f[0],f[1],f[2]);case 4:return new c(f[0],f[1],f[2],f[3]);case 5:return new c(f[0],f[1],f[2],f[3],f[4]);case 6:return new c(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new c(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var m=_s(c.prototype),A=c.apply(m,f);return Gi(A)?A:m}}function Vc(c,f,m){var A=Wi(c);function B(){for(var te=arguments.length,Me=Ct(te),Ze=te,ct=ks(B);Ze--;)Me[Ze]=arguments[Ze];var Yt=te<3&&Me[0]!==ct&&Me[te-1]!==ct?[]:xo(Me,ct);if(te-=Yt.length,te<m)return so(c,f,_l,B.placeholder,E,Me,Yt,E,E,m-te);var qt=this&&this!==g&&this instanceof B?A:c;return jr(qt,this,Me)}return B}function Os(c){return function(f,m,A){var B=Kn(f);if(!za(f)){var te=Qr(m,3);f=ya(f),m=function(Ze){return te(B[Ze],Ze,B)}}var Me=c(f,m,A);return Me>-1?B[te?f[Me]:Me]:E}}function wi(c){return _u(function(f){var m=f.length,A=m,B=da.prototype.thru;for(c&&f.reverse();A--;){var te=f[A];if(typeof te!="function")throw new No(re);if(B&&!Me&&uc(te)=="wrapper")var Me=new da([],!0)}for(A=Me?A:m;++A<m;){te=f[A];var Ze=uc(te),ct=Ze=="wrapper"?Xc(te):E;ct&&bt(ct[0])&&ct[1]==(Fe|Ke|I|ge)&&!ct[4].length&&ct[9]==1?Me=Me[uc(ct[0])].apply(Me,ct[3]):Me=te.length==1&&bt(te)?Me[Ze]():Me.thru(te)}return function(){var Yt=arguments,qt=Yt[0];if(Me&&Yt.length==1&&Mn(qt))return Me.plant(qt).value();for(var ur=0,Fr=m?f[ur].apply(this,Yt):qt;++ur<m;)Fr=f[ur].call(this,Fr);return Fr}})}function _l(c,f,m,A,B,te,Me,Ze,ct,Yt){var qt=f&Fe,ur=f&lt,Fr=f&Je,qr=f&(Ke|xt),hn=f&je,mn=Fr?E:Wi(c);function un(){for(var Bn=arguments.length,Vn=Ct(Bn),Lo=Bn;Lo--;)Vn[Lo]=arguments[Lo];if(qr)var wa=ks(un),Po=mf(Vn,wa);if(A&&(Vn=Ps(Vn,A,B,qr)),te&&(Vn=Zf(Vn,te,Me,qr)),Bn-=Po,qr&&Bn<Yt){var Ji=xo(Vn,wa);return so(c,f,_l,un.placeholder,m,Vn,Ji,Ze,ct,Yt-Bn)}var bu=ur?m:this,Ju=Fr?bu[c]:c;return Bn=Vn.length,Ze?Vn=vr(Vn,Ze):hn&&Bn>1&&Vn.reverse(),qt&&ct<Bn&&(Vn.length=ct),this&&this!==g&&this instanceof un&&(Ju=mn||Wi(Ju)),Ju.apply(bu,Vn)}return un}function Xu(c,f){return function(m,A){return Ip(m,c,f(A),{})}}function Ua(c,f){return function(m,A){var B;if(m===E&&A===E)return f;if(m!==E&&(B=m),A!==E){if(B===E)return A;typeof m=="string"||typeof A=="string"?(m=oo(m),A=oo(A)):(m=Fp(m),A=Fp(A)),B=c(m,A)}return B}}function Hc(c){return _u(function(f){return f=ni(f,Ni(Qr())),Ln(function(m){var A=this;return c(f,function(B){return jr(B,A,m)})})})}function xl(c,f){f=f===E?" ":oo(f);var m=f.length;if(m<2)return m?ji(f,c):f;var A=ji(f,Js(c/Uu(f)));return Zu(f)?Co(to(A),0,c).join(""):A.slice(0,c)}function jc(c,f,m,A){var B=f&lt,te=Wi(c);function Me(){for(var Ze=-1,ct=arguments.length,Yt=-1,qt=A.length,ur=Ct(qt+ct),Fr=this&&this!==g&&this instanceof Me?te:c;++Yt<qt;)ur[Yt]=A[Yt];for(;ct--;)ur[Yt++]=arguments[++Ze];return jr(Fr,B?m:this,ur)}return Me}function Wc(c){return function(f,m,A){return A&&typeof A!="number"&&kt(f,m,A)&&(m=A=E),f=Zs(f),m===E?(m=f,f=0):m=Zs(m),A=A===E?f<m?1:-1:Zs(A),Op(f,m,A,c)}}function _i(c){return function(f,m){return typeof f=="string"&&typeof m=="string"||(f=Vo(f),m=Vo(m)),c(f,m)}}function so(c,f,m,A,B,te,Me,Ze,ct,Yt){var qt=f&Ke,ur=qt?Me:E,Fr=qt?E:Me,qr=qt?te:E,hn=qt?E:te;f|=qt?I:ht,f&=~(qt?ht:I),f&Ye||(f&=~(lt|Je));var mn=[c,f,B,qr,ur,hn,Fr,Ze,ct,Yt],un=m.apply(E,mn);return bt(c)&&on(un,mn),un.placeholder=A,yr(un,c,f)}function Mi(c){var f=hi[c];return function(m,A){if(m=Vo(m),A=A==null?0:la(Pn(A),292),A&&bf(m)){var B=(si(m)+"e").split("e"),te=f(B[0]+"e"+(+B[1]+A));return B=(si(te)+"e").split("e"),+(B[0]+"e"+(+B[1]-A))}return f(m)}}var Aa=gs&&1/ps(new gs([,-0]))[1]==b?function(c){return new gs(c)}:En;function Gf(c){return function(f){var m=nt(f);return m==Tr?Xs(f):m==Z?Da(f):jd(f,c(f))}}function yu(c,f,m,A,B,te,Me,Ze){var ct=f&Je;if(!ct&&typeof c!="function")throw new No(re);var Yt=A?A.length:0;if(Yt||(f&=~(I|ht),A=B=E),Me=Me===E?Me:Bi(Pn(Me),0),Ze=Ze===E?Ze:Pn(Ze),Yt-=B?B.length:0,f&ht){var qt=A,ur=B;A=B=E}var Fr=ct?E:Xc(c),qr=[c,f,m,A,B,qt,ur,te,Me,Ze];if(Fr&&Lt(qr,Fr),c=qr[0],f=qr[1],m=qr[2],A=qr[3],B=qr[4],Ze=qr[9]=qr[9]===E?ct?0:c.length:Bi(qr[9]-Yt,0),!Ze&&f&(Ke|xt)&&(f&=~(Ke|xt)),!f||f==lt)var hn=Gc(c,f,m);else f==Ke||f==xt?hn=Vc(c,f,Ze):(f==I||f==(lt|I))&&!B.length?hn=jc(c,f,m,A):hn=_l.apply(E,qr);var mn=Fr?dl:on;return yr(mn(hn,qr),c,f)}function Ih(c,f,m,A){return c===E||lo(c,Ks[m])&&!ii.call(A,m)?f:c}function Oh(c,f,m,A,B,te){return Gi(c)&&Gi(f)&&(te.set(f,c),ao(c,f,E,Oh,te),te.delete(f)),c}function Vf(c){return Jc(c)?E:c}function $c(c,f,m,A,B,te){var Me=m&pt,Ze=c.length,ct=f.length;if(Ze!=ct&&!(Me&&ct>Ze))return!1;var Yt=te.get(c),qt=te.get(f);if(Yt&&qt)return Yt==f&&qt==c;var ur=-1,Fr=!0,qr=m&Ge?new eu:E;for(te.set(c,f),te.set(f,c);++ur<Ze;){var hn=c[ur],mn=f[ur];if(A)var un=Me?A(mn,hn,ur,f,c,te):A(hn,mn,ur,c,f,te);if(un!==E){if(un)continue;Fr=!1;break}if(qr){if(!Il(f,function(Bn,Vn){if(!Bu(qr,Vn)&&(hn===Bn||B(hn,Bn,m,A,te)))return qr.push(Vn)})){Fr=!1;break}}else if(!(hn===mn||B(hn,mn,m,A,te))){Fr=!1;break}}return te.delete(c),te.delete(f),Fr}function kh(c,f,m,A,B,te,Me){switch(m){case $e:if(c.byteLength!=f.byteLength||c.byteOffset!=f.byteOffset)return!1;c=c.buffer,f=f.buffer;case _e:return!(c.byteLength!=f.byteLength||!te(new Dl(c),new Dl(f)));case pn:case an:case Vr:return lo(+c,+f);case ln:return c.name==f.name&&c.message==f.message;case V:case $:return c==f+"";case Tr:var Ze=Xs;case Z:var ct=A&pt;if(Ze||(Ze=ps),c.size!=f.size&&!ct)return!1;var Yt=Me.get(c);if(Yt)return Yt==f;A|=Ge,Me.set(c,f);var qt=$c(Ze(c),Ze(f),A,B,te,Me);return Me.delete(c),qt;case T:if(Gu)return Gu.call(c)==Gu.call(f)}return!1}function Dp(c,f,m,A,B,te){var Me=m&pt,Ze=Hf(c),ct=Ze.length,Yt=Hf(f),qt=Yt.length;if(ct!=qt&&!Me)return!1;for(var ur=ct;ur--;){var Fr=Ze[ur];if(!(Me?Fr in f:ii.call(f,Fr)))return!1}var qr=te.get(c),hn=te.get(f);if(qr&&hn)return qr==f&&hn==c;var mn=!0;te.set(c,f),te.set(f,c);for(var un=Me;++ur<ct;){Fr=Ze[ur];var Bn=c[Fr],Vn=f[Fr];if(A)var Lo=Me?A(Vn,Bn,Fr,f,c,te):A(Bn,Vn,Fr,c,f,te);if(!(Lo===E?Bn===Vn||B(Bn,Vn,m,A,te):Lo)){mn=!1;break}un||(un=Fr=="constructor")}if(mn&&!un){var wa=c.constructor,Po=f.constructor;wa!=Po&&"constructor"in c&&"constructor"in f&&!(typeof wa=="function"&&wa instanceof wa&&typeof Po=="function"&&Po instanceof Po)&&(mn=!1)}return te.delete(c),te.delete(f),mn}function _u(c){return hr(fr(c,E,Wn),c+"")}function Hf(c){return $l(c,ya,X)}function jf(c){return $l(c,Ri,me)}var Xc=il?function(c){return il.get(c)}:En;function uc(c){for(var f=c.name+"",m=ys[f],A=ii.call(ys,f)?m.length:0;A--;){var B=m[A],te=B.func;if(te==null||te==c)return B.name}return f}function ks(c){var f=ii.call(K,"placeholder")?K:c;return f.placeholder}function Qr(){var c=K.iteratee||id;return c=c===id?Mh:c,arguments.length?c(arguments[0],arguments[1]):c}function Yc(c,f){var m=c.__data__;return Ve(f)?m[typeof f=="string"?"string":"hash"]:m.map}function sc(c){for(var f=ya(c),m=f.length;m--;){var A=f[m],B=c[A];f[m]=[A,B,gr(B)]}return f}function Fs(c,f){var m=eo(c,f);return If(m)?m:E}function C(c){var f=ii.call(c,bo),m=c[bo];try{c[bo]=E;var A=!0}catch(te){}var B=vs.call(c);return A&&(f?c[bo]=m:delete c[bo]),B}var X=Ul?function(c){return c==null?[]:(c=Kn(c),Si(Ul(c),function(f){return ms.call(c,f)}))}:zv,me=Ul?function(c){for(var f=[];c;)Sa(f,X(c)),c=pu(c);return f}:zv,nt=ma;(In&&nt(new In(new ArrayBuffer(1)))!=$e||tl&&nt(new tl)!=Tr||Ef&&nt(Ef.resolve())!=Zn||gs&&nt(new gs)!=Z||rl&&nt(new rl)!=vt)&&(nt=function(c){var f=ma(c),m=f==ti?c.constructor:E,A=m?qn(m):"";if(A)switch(A){case Tc:return $e;case yh:return Tr;case ro:return Zn;case Tp:return Z;case $d:return vt}return f});function Rt(c,f,m){for(var A=-1,B=m.length;++A<B;){var te=m[A],Me=te.size;switch(te.type){case"drop":c+=Me;break;case"dropRight":f-=Me;break;case"take":f=la(f,c+Me);break;case"takeRight":c=Bi(c,f-Me);break}}return{start:c,end:f}}function ut(c){var f=c.match(Pu);return f?f[1].split(Oo):[]}function Tt(c,f,m){f=uo(f,c);for(var A=-1,B=f.length,te=!1;++A<B;){var Me=Nn(f[A]);if(!(te=c!=null&&m(c,Me)))break;c=c[Me]}return te||++A!=B?te:(B=c==null?0:c.length,!!B&&pr(B)&&tr(Me,B)&&(Mn(c)||Ds(c)))}function It(c){var f=c.length,m=new c.constructor(f);return f&&typeof c[0]=="string"&&ii.call(c,"index")&&(m.index=c.index,m.input=c.input),m}function Bt(c){return typeof c.constructor=="function"&&!Ft(c)?_s(pu(c)):{}}function Kt(c,f,m){var A=c.constructor;switch(f){case _e:return ml(c);case pn:case an:return new A(+c);case $e:return rc(c,m);case At:case Zt:case er:case lr:case Nr:case Ir:case cr:case Yr:case en:return ic(c,m);case Tr:return new A;case Vr:case $:return new A(c);case V:return zc(c);case Z:return new A;case T:return nc(c)}}function Qt(c,f){var m=f.length;if(!m)return c;var A=m-1;return f[A]=(m>1?"& ":"")+f[A],f=f.join(m>2?", ":" "),c.replace(aa,`{
/* [wrapped with `+f+`] */
`)}function Jt(c){return Mn(c)||Ds(c)||!!(Bl&&c&&c[Bl])}function tr(c,f){var m=typeof c;return f=f==null?de:f,!!f&&(m=="number"||m!="symbol"&&Ou.test(c))&&c>-1&&c%1==0&&c<f}function kt(c,f,m){if(!Gi(m))return!1;var A=typeof f;return(A=="number"?za(m)&&tr(f,m.length):A=="string"&&f in m)?lo(m[f],c):!1}function Xt(c,f){if(Mn(c))return!1;var m=typeof c;return m=="number"||m=="symbol"||m=="boolean"||c==null||Go(c)?!0:ho.test(c)||!Ei.test(c)||f!=null&&c in Kn(f)}function Ve(c){var f=typeof c;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?c!=="__proto__":c===null}function bt(c){var f=uc(c),m=K[f];if(typeof m!="function"||!(f in On.prototype))return!1;if(c===m)return!0;var A=Xc(m);return!!A&&c===A[0]}function Wt(c){return!!_p&&_p in c}var Sr=_f?Bs:Gv;function Ft(c){var f=c&&c.constructor,m=typeof f=="function"&&f.prototype||Ks;return c===m}function gr(c){return c===c&&!Gi(c)}function mr(c,f){return function(m){return m==null?!1:m[c]===f&&(f!==E||c in Kn(m))}}function Gr(c){var f=zh(c,function(A){return m.size===le&&m.clear(),A}),m=f.cache;return f}function Lt(c,f){var m=c[1],A=f[1],B=m|A,te=B<(lt|Je|Fe),Me=A==Fe&&m==Ke||A==Fe&&m==ge&&c[7].length<=f[8]||A==(Fe|ge)&&f[7].length<=f[8]&&m==Ke;if(!(te||Me))return c;A&lt&&(c[2]=f[2],B|=m&lt?0:Ye);var Ze=f[3];if(Ze){var ct=c[3];c[3]=ct?Ps(ct,Ze,f[4]):Ze,c[4]=ct?xo(c[3],ye):f[4]}return Ze=f[5],Ze&&(ct=c[5],c[5]=ct?Zf(ct,Ze,f[6]):Ze,c[6]=ct?xo(c[5],ye):f[6]),Ze=f[7],Ze&&(c[7]=Ze),A&Fe&&(c[8]=c[8]==null?f[8]:la(c[8],f[8])),c[9]==null&&(c[9]=f[9]),c[0]=f[0],c[1]=B,c}function wt(c){var f=[];if(c!=null)for(var m in Kn(c))f.push(m);return f}function Mr(c){return vs.call(c)}function fr(c,f,m){return f=Bi(f===E?c.length-1:f,0),function(){for(var A=arguments,B=-1,te=Bi(A.length-f,0),Me=Ct(te);++B<te;)Me[B]=A[f+B];B=-1;for(var Ze=Ct(f+1);++B<f;)Ze[B]=A[B];return Ze[f]=m(Me),jr(c,this,Ze)}}function Vt(c,f){return f.length<2?c:gu(c,Ea(f,0,-1))}function vr(c,f){for(var m=c.length,A=la(f.length,m),B=ta(c);A--;){var te=f[A];c[A]=tr(te,m)?B[te]:E}return c}function dr(c,f){if(!(f==="constructor"&&typeof c[f]=="function")&&f!="__proto__")return c[f]}var on=Xr(dl),$r=Sp||function(c,f){return g.setTimeout(c,f)},hr=Xr(Ms);function yr(c,f,m){var A=f+"";return hr(c,Qt(A,sn(ut(A),m)))}function Xr(c){var f=0,m=0;return function(){var A=Ap(),B=k-(A-m);if(m=A,B>0){if(++f>=_t)return arguments[0]}else f=0;return c.apply(E,arguments)}}function tn(c,f){var m=-1,A=c.length,B=A-1;for(f=f===E?A:f;++m<f;){var te=$u(m,B),Me=c[te];c[te]=c[m],c[m]=Me}return c.length=f,c}var Sn=Gr(function(c){var f=[];return c.charCodeAt(0)===46&&f.push(""),c.replace(Mu,function(m,A,B,te){f.push(B?te.replace(Vs,"$1"):A||m)}),f});function Nn(c){if(typeof c=="string"||Go(c))return c;var f=c+"";return f=="0"&&1/c==-b?"-0":f}function qn(c){if(c!=null){try{return qs.call(c)}catch(f){}try{return c+""}catch(f){}}return""}function sn(c,f){return yn(jt,function(m){var A="_."+m[0];f&m[1]&&!xa(c,A)&&c.push(A)}),c.sort()}function Zi(c){if(c instanceof On)return c.clone();var f=new da(c.__wrapped__,c.__chain__);return f.__actions__=ta(c.__actions__),f.__index__=c.__index__,f.__values__=c.__values__,f}function ui(c,f,m){(m?kt(c,f,m):f===E)?f=1:f=Bi(Pn(f),0);var A=c==null?0:c.length;if(!A||f<1)return[];for(var B=0,te=0,Me=Ct(Js(A/f));B<A;)Me[te++]=Ea(c,B,B+=f);return Me}function Ui(c){for(var f=-1,m=c==null?0:c.length,A=0,B=[];++f<m;){var te=c[f];te&&(B[A++]=te)}return B}function Li(){var c=arguments.length;if(!c)return[];for(var f=Ct(c-1),m=arguments[0],A=c;A--;)f[A-1]=arguments[A];return Sa(Mn(m)?ta(m):[m],ei(f,1))}var Ki=Ln(function(c,f){return zi(c)?Rr(c,ei(f,1,zi,!0)):[]}),$i=Ln(function(c,f){var m=De(f);return zi(m)&&(m=E),zi(c)?Rr(c,ei(f,1,zi,!0),Qr(m,2)):[]}),qi=Ln(function(c,f){var m=De(f);return zi(m)&&(m=E),zi(c)?Rr(c,ei(f,1,zi,!0),E,m):[]});function Pi(c,f,m){var A=c==null?0:c.length;return A?(f=m||f===E?1:Pn(f),Ea(c,f<0?0:f,A)):[]}function fn(c,f,m){var A=c==null?0:c.length;return A?(f=m||f===E?1:Pn(f),f=A-f,Ea(c,0,f<0?0:f)):[]}function Qi(c,f){return c&&c.length?Bc(c,Qr(f,3),!0,!0):[]}function zn(c,f){return c&&c.length?Bc(c,Qr(f,3),!0):[]}function Xi(c,f,m,A){var B=c==null?0:c.length;return B?(m&&typeof m!="number"&&kt(c,f,m)&&(m=0,A=B),bn(c,f,m,A)):[]}function Kr(c,f,m){var A=c==null?0:c.length;if(!A)return-1;var B=m==null?0:Pn(m);return B<0&&(B=Bi(A+B,0)),Qa(c,Qr(f,3),B)}function vn(c,f,m){var A=c==null?0:c.length;if(!A)return-1;var B=A-1;return m!==E&&(B=Pn(m),B=m<0?Bi(A+B,0):la(B,A-1)),Qa(c,Qr(f,3),B,!0)}function Wn(c){var f=c==null?0:c.length;return f?ei(c,1):[]}function Ii(c){var f=c==null?0:c.length;return f?ei(c,b):[]}function wo(c,f){var m=c==null?0:c.length;return m?(f=f===E?1:Pn(f),ei(c,f)):[]}function fe(c){for(var f=-1,m=c==null?0:c.length,A={};++f<m;){var B=c[f];A[B[0]]=B[1]}return A}function yt(c){return c&&c.length?c[0]:E}function it(c,f,m){var A=c==null?0:c.length;if(!A)return-1;var B=m==null?0:Pn(m);return B<0&&(B=Bi(A+B,0)),Ja(c,f,B)}function br(c){var f=c==null?0:c.length;return f?Ea(c,0,-1):[]}var _n=Ln(function(c){var f=ni(c,Ls);return f.length&&f[0]===c[0]?Xl(f):[]}),ie=Ln(function(c){var f=De(c),m=ni(c,Ls);return f===De(m)?f=E:m.pop(),m.length&&m[0]===c[0]?Xl(m,Qr(f,2)):[]}),j=Ln(function(c){var f=De(c),m=ni(c,Ls);return f=typeof f=="function"?f:E,f&&m.pop(),m.length&&m[0]===c[0]?Xl(m,E,f):[]});function Ae(c,f){return c==null?"":Ep.call(c,f)}function De(c){var f=c==null?0:c.length;return f?c[f-1]:E}function mt(c,f,m){var A=c==null?0:c.length;if(!A)return-1;var B=A;return m!==E&&(B=Pn(m),B=B<0?Bi(A+B,0):la(B,A-1)),f===f?ds(c,f,B):Qa(c,Du,B,!0)}function Ie(c,f){return c&&c.length?Wu(c,Pn(f)):E}var Le=Ln(ke);function ke(c,f){return c&&c.length&&f&&f.length?Dc(c,f):c}function Q(c,f,m){return c&&c.length&&f&&f.length?Dc(c,f,Qr(m,2)):c}function Se(c,f,m){return c&&c.length&&f&&f.length?Dc(c,f,E,m):c}var ue=_u(function(c,f){var m=c==null?0:c.length,A=ol(c,f);return ws(c,ni(f,function(B){return tr(B,m)?+B:B}).sort(gl)),A});function He(c,f){var m=[];if(!(c&&c.length))return m;var A=-1,B=[],te=c.length;for(f=Qr(f,3);++A<te;){var Me=c[A];f(Me,A,c)&&(m.push(Me),B.push(A))}return ws(c,B),m}function Xe(c){return c==null?c:zu.call(c)}function Et(c,f,m){var A=c==null?0:c.length;return A?(m&&typeof m!="number"&&kt(c,f,m)?(f=0,m=A):(f=f==null?0:Pn(f),m=m===E?A:Pn(m)),Ea(c,f,m)):[]}function Ht(c,f){return Jl(c,f)}function or(c,f,m){return Nf(c,f,Qr(m,2))}function _r(c,f){var m=c==null?0:c.length;if(m){var A=Jl(c,f);if(A<m&&lo(c[A],f))return A}return-1}function ir(c,f){return Jl(c,f,!0)}function Pr(c,f,m){return Nf(c,f,Qr(m,2),!0)}function Er(c,f){var m=c==null?0:c.length;if(m){var A=Jl(c,f,!0)-1;if(lo(c[A],f))return A}return-1}function Ut(c){return c&&c.length?Df(c):[]}function Lr(c,f){return c&&c.length?Df(c,Qr(f,2)):[]}function Cr(c){var f=c==null?0:c.length;return f?Ea(c,1,f):[]}function Ur(c,f,m){return c&&c.length?(f=m||f===E?1:Pn(f),Ea(c,0,f<0?0:f)):[]}function Qn(c,f,m){var A=c==null?0:c.length;return A?(f=m||f===E?1:Pn(f),f=A-f,Ea(c,f<0?0:f,A)):[]}function Rn(c,f){return c&&c.length?Bc(c,Qr(f,3),!1,!0):[]}function Ta(c,f){return c&&c.length?Bc(c,Qr(f,3)):[]}var Yu=Ln(function(c){return Rs(ei(c,1,zi,!0))}),Ku=Ln(function(c){var f=De(c);return zi(f)&&(f=E),Rs(ei(c,1,zi,!0),Qr(f,2))}),Ca=Ln(function(c){var f=De(c);return f=typeof f=="function"?f:E,Rs(ei(c,1,zi,!0),E,f)});function xu(c){return c&&c.length?Rs(c):[]}function zo(c,f){return c&&c.length?Rs(c,Qr(f,2)):[]}function Bp(c,f){return f=typeof f=="function"?f:E,c&&c.length?Rs(c,E,f):[]}function Mo(c){if(!(c&&c.length))return[];var f=0;return c=Si(c,function(m){if(zi(m))return f=Bi(m.length,f),!0}),ba(f,function(m){return ni(c,cs(m))})}function Fh(c,f){if(!(c&&c.length))return[];var m=Mo(c);return f==null?m:ni(m,function(A){return jr(f,E,A)})}var _y=Ln(function(c,f){return zi(c)?Rr(c,f):[]}),xy=Ln(function(c){return Zc(Si(c,zi))}),Sy=Ln(function(c){var f=De(c);return zi(f)&&(f=E),Zc(Si(c,zi),Qr(f,2))}),by=Ln(function(c){var f=De(c);return f=typeof f=="function"?f:E,Zc(Si(c,zi),E,f)}),Ey=Ln(Mo);function N0(c,f){return ec(c||[],f||[],Bo)}function Ay(c,f){return ec(c||[],f||[],Ql)}var qu=Ln(function(c){var f=c.length,m=f>1?c[f-1]:E;return m=typeof m=="function"?(c.pop(),m):E,Fh(c,m)});function Ns(c){var f=K(c);return f.__chain__=!0,f}function Ty(c,f){return f(c),c}function Nh(c,f){return f(c)}var Cy=_u(function(c){var f=c.length,m=f?c[0]:0,A=this.__wrapped__,B=function(te){return ol(te,c)};return f>1||this.__actions__.length||!(A instanceof On)||!tr(m)?this.thru(B):(A=A.slice(m,+m+(f?1:0)),A.__actions__.push({func:Nh,args:[B],thisArg:E}),new da(A,this.__chain__).thru(function(te){return f&&!te.length&&te.push(E),te}))});function wy(){return Ns(this)}function My(){return new da(this.value(),this.__chain__)}function Ry(){this.__values__===E&&(this.__values__=fv(this.value()));var c=this.__index__>=this.__values__.length,f=c?E:this.__values__[this.__index__++];return{done:c,value:f}}function Ly(){return this}function Py(c){for(var f,m=this;m instanceof Vu;){var A=Zi(m);A.__index__=0,A.__values__=E,f?B.__wrapped__=A:f=A;var B=A;m=m.__wrapped__}return B.__wrapped__=c,f}function Iy(){var c=this.__wrapped__;if(c instanceof On){var f=c;return this.__actions__.length&&(f=new On(this)),f=f.reverse(),f.__actions__.push({func:Nh,args:[Xe],thisArg:E}),new da(f,this.__chain__)}return this.thru(Xe)}function Oy(){return Np(this.__wrapped__,this.__actions__)}var ky=oc(function(c,f,m){ii.call(c,m)?++c[m]:vu(c,m,1)});function Fy(c,f,m){var A=Mn(c)?Na:Lc;return m&&kt(c,f,m)&&(f=E),A(c,Qr(f,3))}function Ny(c,f){var m=Mn(c)?Si:va;return m(c,Qr(f,3))}var Dy=Os(Kr),Kc=Os(vn);function By(c,f){return ei(Su(c,f),1)}function Zy(c,f){return ei(Su(c,f),b)}function Uy(c,f,m){return m=m===E?1:Pn(m),ei(Su(c,f),m)}function D0(c,f){var m=Mn(c)?yn:Za;return m(c,Qr(f,3))}function B0(c,f){var m=Mn(c)?jn:Wl;return m(c,Qr(f,3))}var zy=oc(function(c,f,m){ii.call(c,m)?c[m].push(f):vu(c,m,[f])});function Dh(c,f,m,A){c=za(c)?c:rf(c),m=m&&!A?Pn(m):0;var B=c.length;return m<0&&(m=Bi(B+m,0)),$f(c)?m<=B&&c.indexOf(f,m)>-1:!!B&&Ja(c,f,m)>-1}var Gy=Ln(function(c,f,m){var A=-1,B=typeof f=="function",te=za(c)?Ct(c.length):[];return Za(c,function(Me){te[++A]=B?jr(f,Me,m):bs(Me,f,m)}),te}),ra=oc(function(c,f,m){vu(c,m,f)});function Su(c,f){var m=Mn(c)?ni:nu;return m(c,Qr(f,3))}function qc(c,f,m,A){return c==null?[]:(Mn(f)||(f=f==null?[]:[f]),m=A?E:m,Mn(m)||(m=m==null?[]:[m]),pl(c,f,m))}var Zp=oc(function(c,f,m){c[m?0:1].push(f)},function(){return[[],[]]});function Sl(c,f,m){var A=Mn(c)?ls:Ol,B=arguments.length<3;return A(c,Qr(f,4),m,B,Za)}function Qc(c,f,m){var A=Mn(c)?yc:Ol,B=arguments.length<3;return A(c,Qr(f,4),m,B,Wl)}function Up(c,f){var m=Mn(c)?Si:va;return m(c,bl(Qr(f,3)))}function Vy(c){var f=Mn(c)?io:ql;return f(c)}function Z0(c,f,m){(m?kt(c,f,m):f===E)?f=1:f=Pn(f);var A=Mn(c)?Mf:kp;return A(c,f)}function Bh(c){var f=Mn(c)?Pp:kf;return f(c)}function zp(c){if(c==null)return 0;if(za(c))return $f(c)?Uu(c):c.length;var f=nt(c);return f==Tr||f==Z?c.size:cl(c).length}function Zh(c,f,m){var A=Mn(c)?Il:Ff;return m&&kt(c,f,m)&&(f=E),A(c,Qr(f,3))}var Xd=Ln(function(c,f){if(c==null)return[];var m=f.length;return m>1&&kt(c,f[0],f[1])?f=[]:m>2&&kt(f[0],f[1],f[2])&&(f=[f[0]]),pl(c,ei(f,1),[])}),Gp=xp||function(){return g.Date.now()};function Hy(c,f){if(typeof f!="function")throw new No(re);return c=Pn(c),function(){if(--c<1)return f.apply(this,arguments)}}function Yd(c,f,m){return f=m?E:f,f=c&&f==null?c.length:f,yu(c,Fe,E,E,E,E,f)}function Kd(c,f){var m;if(typeof f!="function")throw new No(re);return c=Pn(c),function(){return--c>0&&(m=f.apply(this,arguments)),c<=1&&(f=E),m}}var Vp=Ln(function(c,f,m){var A=lt;if(m.length){var B=xo(m,ks(Vp));A|=I}return yu(c,A,f,m,B)}),qd=Ln(function(c,f,m){var A=lt|Je;if(m.length){var B=xo(m,ks(qd));A|=I}return yu(f,A,c,m,B)});function Hp(c,f,m){f=m?E:f;var A=yu(c,Ke,E,E,E,E,E,f);return A.placeholder=Hp.placeholder,A}function Qd(c,f,m){f=m?E:f;var A=yu(c,xt,E,E,E,E,E,f);return A.placeholder=Qd.placeholder,A}function Uh(c,f,m){var A,B,te,Me,Ze,ct,Yt=0,qt=!1,ur=!1,Fr=!0;if(typeof c!="function")throw new No(re);f=Vo(f)||0,Gi(m)&&(qt=!!m.leading,ur="maxWait"in m,te=ur?Bi(Vo(m.maxWait)||0,f):te,Fr="trailing"in m?!!m.trailing:Fr);function qr(Ji){var bu=A,Ju=B;return A=B=E,Yt=Ji,Me=c.apply(Ju,bu),Me}function hn(Ji){return Yt=Ji,Ze=$r(Bn,f),qt?qr(Ji):Me}function mn(Ji){var bu=Ji-ct,Ju=Ji-Yt,ud=f-bu;return ur?la(ud,te-Ju):ud}function un(Ji){var bu=Ji-ct,Ju=Ji-Yt;return ct===E||bu>=f||bu<0||ur&&Ju>=te}function Bn(){var Ji=Gp();if(un(Ji))return Vn(Ji);Ze=$r(Bn,mn(Ji))}function Vn(Ji){return Ze=E,Fr&&A?qr(Ji):(A=B=E,Me)}function Lo(){Ze!==E&&vl(Ze),Yt=0,A=ct=B=Ze=E}function wa(){return Ze===E?Me:Vn(Gp())}function Po(){var Ji=Gp(),bu=un(Ji);if(A=arguments,B=this,ct=Ji,bu){if(Ze===E)return hn(ct);if(ur)return vl(Ze),Ze=$r(Bn,f),qr(ct)}return Ze===E&&(Ze=$r(Bn,f)),Me}return Po.cancel=Lo,Po.flush=wa,Po}var Jd=Ln(function(c,f){return Dr(c,1,f)}),U0=Ln(function(c,f,m){return Dr(c,Vo(f)||0,m)});function jy(c){return yu(c,je)}function zh(c,f){if(typeof c!="function"||f!=null&&typeof f!="function")throw new No(re);var m=function(){var A=arguments,B=f?f.apply(this,A):A[0],te=m.cache;if(te.has(B))return te.get(B);var Me=c.apply(this,A);return m.cache=te.set(B,Me)||te,Me};return m.cache=new(zh.Cache||Jo),m}zh.Cache=Jo;function bl(c){if(typeof c!="function")throw new No(re);return function(){var f=arguments;switch(f.length){case 0:return!c.call(this);case 1:return!c.call(this,f[0]);case 2:return!c.call(this,f[0],f[1]);case 3:return!c.call(this,f[0],f[1],f[2])}return!c.apply(this,f)}}function z0(c){return Kd(2,c)}var G0=Uc(function(c,f){f=f.length==1&&Mn(f[0])?ni(f[0],Ni(Qr())):ni(ei(f,1),Ni(Qr()));var m=f.length;return Ln(function(A){for(var B=-1,te=la(A.length,m);++B<te;)A[B]=f[B].call(this,A[B]);return jr(c,this,A)})}),jp=Ln(function(c,f){var m=xo(f,ks(jp));return yu(c,I,E,f,m)}),ev=Ln(function(c,f){var m=xo(f,ks(ev));return yu(c,ht,E,f,m)}),Wy=_u(function(c,f){return yu(c,ge,E,E,E,f)});function Wp(c,f){if(typeof c!="function")throw new No(re);return f=f===E?f:Pn(f),Ln(c,f)}function tv(c,f){if(typeof c!="function")throw new No(re);return f=f==null?0:Bi(Pn(f),0),Ln(function(m){var A=m[f],B=Co(m,0,f);return A&&Sa(B,A),jr(c,this,B)})}function V0(c,f,m){var A=!0,B=!0;if(typeof c!="function")throw new No(re);return Gi(m)&&(A="leading"in m?!!m.leading:A,B="trailing"in m?!!m.trailing:B),Uh(c,f,{leading:A,maxWait:f,trailing:B})}function H0(c){return Yd(c,1)}function j0(c,f){return jp(tc(f),c)}function W0(){if(!arguments.length)return[];var c=arguments[0];return Mn(c)?c:[c]}function rv(c){return Yi(c,Ue)}function $0(c,f){return f=typeof f=="function"?f:E,Yi(c,Ue,f)}function X0(c){return Yi(c,Ce|Ue)}function Y0(c,f){return f=typeof f=="function"?f:E,Yi(c,Ce|Ue,f)}function K0(c,f){return f==null||jl(c,f,ya(f))}function lo(c,f){return c===f||c!==c&&f!==f}var nv=_i(Pf),q0=_i(function(c,f){return c>=f}),Ds=Oc(function(){return arguments}())?Oc:function(c){return qe(c)&&ii.call(c,"callee")&&!ms.call(c,"callee")},Mn=Ct.isArray,Q0=Qe?Ni(Qe):kc;function za(c){return c!=null&&pr(c.length)&&!Bs(c)}function zi(c){return qe(c)&&za(c)}function $p(c){return c===!0||c===!1||qe(c)&&ma(c)==pn}var El=bp||Gv,J0=et?Ni(et):Es;function Xp(c){return qe(c)&&c.nodeType===1&&!Jc(c)}function Yp(c){if(c==null)return!0;if(za(c)&&(Mn(c)||typeof c=="string"||typeof c.splice=="function"||El(c)||lc(c)||Ds(c)))return!c.length;var f=nt(c);if(f==Tr||f==Z)return!c.size;if(Ft(c))return!cl(c).length;for(var m in c)if(ii.call(c,m))return!1;return!0}function em(c,f){return As(c,f)}function tm(c,f,m){m=typeof m=="function"?m:E;var A=m?m(c,f):E;return A===E?As(c,f,E,m):!!A}function iv(c){if(!qe(c))return!1;var f=ma(c);return f==ln||f==Fn||typeof c.message=="string"&&typeof c.name=="string"&&!Jc(c)}function av(c){return typeof c=="number"&&bf(c)}function Bs(c){if(!Gi(c))return!1;var f=ma(c);return f==gn||f==nn||f==Zr||f==Ne}function rm(c){return typeof c=="number"&&c==Pn(c)}function pr(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=de}function Gi(c){var f=typeof c;return c!=null&&(f=="object"||f=="function")}function qe(c){return c!=null&&typeof c=="object"}var ov=Nt?Ni(Nt):Yl;function nm(c,f){return c===f||Fc(c,f,sc(f))}function uv(c,f,m){return m=typeof m=="function"?m:E,Fc(c,f,sc(f),m)}function im(c){return lv(c)&&c!=+c}function sv(c){if(Sr(c))throw new xn(U);return If(c)}function Wf(c){return c===null}function am(c){return c==null}function lv(c){return typeof c=="number"||qe(c)&&ma(c)==Vr}function Jc(c){if(!qe(c)||ma(c)!=ti)return!1;var f=pu(c);if(f===null)return!0;var m=ii.call(f,"constructor")&&f.constructor;return typeof m=="function"&&m instanceof m&&qs.call(m)==So}var Gh=$t?Ni($t):wh;function cv(c){return rm(c)&&c>=-de&&c<=de}var Kp=Hr?Ni(Hr):ll;function $f(c){return typeof c=="string"||!Mn(c)&&qe(c)&&ma(c)==$}function Go(c){return typeof c=="symbol"||qe(c)&&ma(c)==T}var lc=cn?Ni(cn):Nc;function om(c){return c===E}function um(c){return qe(c)&&nt(c)==vt}function sm(c){return qe(c)&&ma(c)==Gt}var lm=_i(fl),cm=_i(function(c,f){return c<=f});function fv(c){if(!c)return[];if(za(c))return $f(c)?to(c):ta(c);if(Zl&&c[Zl])return hh(c[Zl]());var f=nt(c),m=f==Tr?Xs:f==Z?ps:rf;return m(c)}function Zs(c){if(!c)return c===0?c:0;if(c=Vo(c),c===b||c===-b){var f=c<0?-1:1;return f*Te}return c===c?c:0}function Pn(c){var f=Zs(c),m=f%1;return f===f?m?f-m:f:0}function hv(c){return c?mu(Pn(c),0,We):0}function Vo(c){if(typeof c=="number")return c;if(Go(c))return we;if(Gi(c)){var f=typeof c.valueOf=="function"?c.valueOf():c;c=Gi(f)?f+"":f}if(typeof c!="string")return c===0?c:+c;c=dp(c);var m=Iu.test(c);return m||ko.test(c)?Fa(c.slice(2),m?2:8):q.test(c)?we:+c}function pv(c){return ga(c,Ri(c))}function dv(c){return c?mu(Pn(c),-de,de):c===0?c:0}function si(c){return c==null?"":oo(c)}var $y=yl(function(c,f){if(Ft(f)||za(f)){ga(f,ya(f),c);return}for(var m in f)ii.call(f,m)&&Bo(c,m,f[m])}),vv=yl(function(c,f){ga(f,Ri(f),c)}),Xf=yl(function(c,f,m,A){ga(f,Ri(f),c,A)}),mv=yl(function(c,f,m,A){ga(f,ya(f),c,A)}),fm=_u(ol);function gv(c,f){var m=_s(c);return f==null?m:Th(m,f)}var yv=Ln(function(c,f){c=Kn(c);var m=-1,A=f.length,B=A>2?f[2]:E;for(B&&kt(f[0],f[1],B)&&(A=1);++m<A;)for(var te=f[m],Me=Ri(te),Ze=-1,ct=Me.length;++Ze<ct;){var Yt=Me[Ze],qt=c[Yt];(qt===E||lo(qt,Ks[Yt])&&!ii.call(c,Yt))&&(c[Yt]=te[Yt])}return c}),hm=Ln(function(c){return c.push(E,Oh),jr(tf,E,c)});function pm(c,f){return lh(c,Qr(f,3),To)}function dm(c,f){return lh(c,Qr(f,3),sl)}function _v(c,f){return c==null?c:tu(c,Qr(f,3),Ri)}function Yf(c,f){return c==null?c:Lf(c,Qr(f,3),Ri)}function vm(c,f){return c&&To(c,Qr(f,3))}function Ro(c,f){return c&&sl(c,Qr(f,3))}function xv(c){return c==null?[]:Pc(c,ya(c))}function mm(c){return c==null?[]:Pc(c,Ri(c))}function Vh(c,f,m){var A=c==null?E:gu(c,f);return A===E?m:A}function gm(c,f){return c!=null&&Tt(c,f,Ch)}function Hh(c,f){return c!=null&&Tt(c,f,bi)}var ym=Xu(function(c,f,m){f!=null&&typeof f.toString!="function"&&(f=vs.call(f)),c[f]=m},nd($n)),jh=Xu(function(c,f,m){f!=null&&typeof f.toString!="function"&&(f=vs.call(f)),ii.call(c,f)?c[f].push(m):c[f]=[m]},Qr),_m=Ln(bs);function ya(c){return za(c)?wf(c):cl(c)}function Ri(c){return za(c)?wf(c,!0):ru(c)}function cc(c,f){var m={};return f=Qr(f,3),To(c,function(A,B,te){vu(m,f(A,B,te),A)}),m}function ef(c,f){var m={};return f=Qr(f,3),To(c,function(A,B,te){vu(m,B,f(A,B,te))}),m}var xm=yl(function(c,f,m){ao(c,f,m)}),tf=yl(function(c,f,m,A){ao(c,f,m,A)}),Wh=_u(function(c,f){var m={};if(c==null)return m;var A=!1;f=ni(f,function(te){return te=uo(te,c),A||(A=te.length>1),te}),ga(c,jf(c),m),A&&(m=Yi(m,Ce|Oe|Ue,Vf));for(var B=f.length;B--;)Zo(m,f[B]);return m});function $h(c,f){return bv(c,bl(Qr(f)))}var Sv=_u(function(c,f){return c==null?{}:Of(c,f)});function bv(c,f){if(c==null)return{};var m=ni(jf(c),function(A){return[A]});return f=Qr(f),Cs(c,m,function(A,B){return f(A,B[0])})}function Sm(c,f,m){f=uo(f,c);var A=-1,B=f.length;for(B||(B=1,c=E);++A<B;){var te=c==null?E:c[Nn(f[A])];te===E&&(A=B,te=m),c=Bs(te)?te.call(c):te}return c}function bm(c,f,m){return c==null?c:Ql(c,f,m)}function Em(c,f,m,A){return A=typeof A=="function"?A:E,c==null?c:Ql(c,f,m,A)}var Ev=Gf(ya),qp=Gf(Ri);function Am(c,f,m){var A=Mn(c),B=A||El(c)||lc(c);if(f=Qr(f,4),m==null){var te=c&&c.constructor;B?m=A?new te:[]:Gi(c)?m=Bs(te)?_s(pu(c)):{}:m={}}return(B?yn:To)(c,function(Me,Ze,ct){return f(m,Me,Ze,ct)}),m}function Tm(c,f){return c==null?!0:Zo(c,f)}function Av(c,f,m){return c==null?c:Rh(c,f,tc(m))}function Cm(c,f,m,A){return A=typeof A=="function"?A:E,c==null?c:Rh(c,f,tc(m),A)}function rf(c){return c==null?[]:ch(c,ya(c))}function wm(c){return c==null?[]:ch(c,Ri(c))}function Mm(c,f,m){return m===E&&(m=f,f=E),m!==E&&(m=Vo(m),m=m===m?m:0),f!==E&&(f=Vo(f),f=f===f?f:0),mu(Vo(c),f,m)}function Rm(c,f,m){return f=Zs(f),m===E?(m=f,f=0):m=Zs(m),c=Vo(c),Ic(c,f,m)}function Tv(c,f,m){if(m&&typeof m!="boolean"&&kt(c,f,m)&&(f=m=E),m===E&&(typeof f=="boolean"?(m=f,f=E):typeof c=="boolean"&&(m=c,c=E)),c===E&&f===E?(c=0,f=1):(c=Zs(c),f===E?(f=c,c=0):f=Zs(f)),c>f){var A=c;c=f,f=A}if(m||c%1||f%1){var B=Ba();return la(c+B*(f-c+js("1e-"+((B+"").length-1))),f)}return $u(c,f)}var Qp=Is(function(c,f,m){return f=f.toLowerCase(),c+(m?Cv(f):f)});function Cv(c){return ed(si(c).toLowerCase())}function wv(c){return c=si(c),c&&c.replace(La,$s).replace(cu,"")}function Mv(c,f,m){c=si(c),f=oo(f);var A=c.length;m=m===E?A:mu(Pn(m),0,A);var B=m;return m-=f.length,m>=0&&c.slice(m,B)==f}function Lm(c){return c=si(c),c&&ea.test(c)?c.replace(Vi,gf):c}function Pm(c){return c=si(c),c&&Rl.test(c)?c.replace(Ru,"\\$&"):c}var Rv=Is(function(c,f,m){return c+(m?"-":"")+f.toLowerCase()}),Im=Is(function(c,f,m){return c+(m?" ":"")+f.toLowerCase()}),Om=zf("toLowerCase");function km(c,f,m){c=si(c),f=Pn(f);var A=f?Uu(c):0;if(!f||A>=f)return c;var B=(f-A)/2;return xl(el(B),m)+c+xl(Js(B),m)}function Fm(c,f,m){c=si(c),f=Pn(f);var A=f?Uu(c):0;return f&&A<f?c+xl(f-A,m):c}function Lv(c,f,m){c=si(c),f=Pn(f);var A=f?Uu(c):0;return f&&A<f?xl(f-A,m)+c:c}function Nm(c,f,m){return m||f==null?f=0:f&&(f=+f),Ac(si(c).replace(Lu,""),f||0)}function Dm(c,f,m){return(m?kt(c,f,m):f===E)?f=1:f=Pn(f),ji(si(c),f)}function Bm(){var c=arguments,f=si(c[0]);return c.length<3?f:f.replace(c[1],c[2])}var Jp=Is(function(c,f,m){return c+(m?"_":"")+f.toLowerCase()});function Zm(c,f,m){return m&&typeof m!="number"&&kt(c,f,m)&&(f=m=E),m=m===E?We:m>>>0,m?(c=si(c),c&&(typeof f=="string"||f!=null&&!Gh(f))&&(f=oo(f),!f&&Zu(c))?Co(to(c),0,m):c.split(f,m)):[]}var Um=Is(function(c,f,m){return c+(m?" ":"")+ed(f)});function Pv(c,f,m){return c=si(c),m=m==null?0:mu(Pn(m),0,c.length),f=oo(f),c.slice(m,m+f.length)==f}function Iv(c,f,m){var A=K.templateSettings;m&&kt(c,f,m)&&(f=E),c=si(c),f=Xf({},f,A,Ih);var B=Xf({},f.imports,A.imports,Ih),te=ya(B),Me=ch(B,te),Ze,ct,Yt=0,qt=f.interpolate||Pa,ur="__p += '",Fr=Fl((f.escape||Pa).source+"|"+qt.source+"|"+(qt===ia?st:Pa).source+"|"+(f.evaluate||Pa).source+"|$","g"),qr="//# sourceURL="+(ii.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++yo+"]")+`
`;c.replace(Fr,function(un,Bn,Vn,Lo,wa,Po){return Vn||(Vn=Lo),ur+=c.slice(Yt,Po).replace(dn,hs),Bn&&(Ze=!0,ur+=`' +
__e(`+Bn+`) +
'`),wa&&(ct=!0,ur+=`';
`+wa+`;
__p += '`),Vn&&(ur+=`' +
((__t = (`+Vn+`)) == null ? '' : __t) +
'`),Yt=Po+un.length,un}),ur+=`';
`;var hn=ii.call(f,"variable")&&f.variable;if(!hn)ur=`with (obj) {
`+ur+`
}
`;else if(oi.test(hn))throw new xn(Y);ur=(ct?ur.replace(Un,""):ur).replace(mi,"$1").replace(di,"$1;"),ur="function("+(hn||"obj")+`) {
`+(hn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ze?", __e = _.escape":"")+(ct?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ur+`return __p
}`;var mn=rd(function(){return Gn(te,qr+"return "+ur).apply(E,Me)});if(mn.source=ur,iv(mn))throw mn;return mn}function zm(c){return si(c).toLowerCase()}function Us(c){return si(c).toUpperCase()}function Ov(c,f,m){if(c=si(c),c&&(m||f===E))return dp(c);if(!c||!(f=oo(f)))return c;var A=to(c),B=to(f),te=Ws(A,B),Me=kl(A,B)+1;return Co(A,te,Me).join("")}function kv(c,f,m){if(c=si(c),c&&(m||f===E))return c.slice(0,Ys(c)+1);if(!c||!(f=oo(f)))return c;var A=to(c),B=kl(A,to(f))+1;return Co(A,0,B).join("")}function Gm(c,f,m){if(c=si(c),c&&(m||f===E))return c.replace(Lu,"");if(!c||!(f=oo(f)))return c;var A=to(c),B=Ws(A,to(f));return Co(A,B).join("")}function Vm(c,f){var m=Be,A=tt;if(Gi(f)){var B="separator"in f?f.separator:B;m="length"in f?Pn(f.length):m,A="omission"in f?oo(f.omission):A}c=si(c);var te=c.length;if(Zu(c)){var Me=to(c);te=Me.length}if(m>=te)return c;var Ze=m-Uu(A);if(Ze<1)return A;var ct=Me?Co(Me,0,Ze).join(""):c.slice(0,Ze);if(B===E)return ct+A;if(Me&&(Ze+=ct.length-Ze),Gh(B)){if(c.slice(Ze).search(B)){var Yt,qt=ct;for(B.global||(B=Fl(B.source,si(Hs.exec(B))+"g")),B.lastIndex=0;Yt=B.exec(qt);)var ur=Yt.index;ct=ct.slice(0,ur===E?Ze:ur)}}else if(c.indexOf(oo(B),Ze)!=Ze){var Fr=ct.lastIndexOf(B);Fr>-1&&(ct=ct.slice(0,Fr))}return ct+A}function Fv(c){return c=si(c),c&&ja.test(c)?c.replace(Yn,dh):c}var Hm=Is(function(c,f,m){return c+(m?" ":"")+f.toUpperCase()}),ed=zf("toUpperCase");function td(c,f,m){return c=si(c),f=m?E:f,f===E?fh(c)?yf(c):df(c):c.match(f)||[]}var rd=Ln(function(c,f){try{return jr(c,E,f)}catch(m){return iv(m)?m:new xn(m)}}),jm=_u(function(c,f){return yn(f,function(m){m=Nn(m),vu(c,m,Vp(c[m],c))}),c});function Nv(c){var f=c==null?0:c.length,m=Qr();return c=f?ni(c,function(A){if(typeof A[1]!="function")throw new No(re);return[m(A[0]),A[1]]}):[],Ln(function(A){for(var B=-1;++B<f;){var te=c[B];if(jr(te[0],this,A))return jr(te[1],this,A)}})}function Dv(c){return Ao(Yi(c,Ce))}function nd(c){return function(){return c}}function Qu(c,f){return c==null||c!==c?f:c}var zs=wi(),nf=wi(!0);function $n(c){return c}function id(c){return Mh(typeof c=="function"?c:Yi(c,Ce))}function Wm(c){return hl(Yi(c,Ce))}function Bv(c,f){return ju(c,Yi(f,Ce))}var Zv=Ln(function(c,f){return function(m){return bs(m,c,f)}}),$m=Ln(function(c,f){return function(m){return bs(c,m,f)}});function ad(c,f,m){var A=ya(f),B=Pc(f,A);m==null&&!(Gi(f)&&(B.length||!A.length))&&(m=f,f=c,c=this,B=Pc(f,ya(f)));var te=!(Gi(m)&&"chain"in m)||!!m.chain,Me=Bs(c);return yn(B,function(Ze){var ct=f[Ze];c[Ze]=ct,Me&&(c.prototype[Ze]=function(){var Yt=this.__chain__;if(te||Yt){var qt=c(this.__wrapped__),ur=qt.__actions__=ta(this.__actions__);return ur.push({func:ct,args:arguments,thisArg:c}),qt.__chain__=Yt,qt}return ct.apply(c,Sa([this.value()],arguments))})}),c}function Xm(){return g._===this&&(g._=Qs),this}function En(){}function An(c){return c=Pn(c),Ln(function(f){return Wu(f,c)})}var Uv=Hc(ni),Xy=Hc(Na),Ym=Hc(Il);function Km(c){return Xt(c)?cs(Nn(c)):Kl(c)}function Yy(c){return function(f){return c==null?E:gu(c,f)}}var Ky=Wc(),qy=Wc(!0);function zv(){return[]}function Gv(){return!1}function Qy(){return{}}function Jy(){return""}function e_(){return!0}function t_(c,f){if(c=Pn(c),c<1||c>de)return[];var m=We,A=la(c,We);f=Qr(f),c-=We;for(var B=ba(A,f);++m<c;)f(m);return B}function r_(c){return Mn(c)?ni(c,Nn):Go(c)?[c]:ta(Sn(si(c)))}function qm(c){var f=++bc;return si(c)+f}var n_=Ua(function(c,f){return c+f},0),i_=Mi("ceil"),a_=Ua(function(c,f){return c/f},1),o_=Mi("floor");function u_(c){return c&&c.length?ul(c,$n,Pf):E}function s_(c,f){return c&&c.length?ul(c,Qr(f,2),Pf):E}function l_(c){return xc(c,$n)}function c_(c,f){return xc(c,Qr(f,2))}function f_(c){return c&&c.length?ul(c,$n,fl):E}function h_(c,f){return c&&c.length?ul(c,Qr(f,2),fl):E}var p_=Ua(function(c,f){return c*f},1),d_=Mi("round"),od=Ua(function(c,f){return c-f},0);function v_(c){return c&&c.length?sa(c,$n):0}function m_(c,f){return c&&c.length?sa(c,Qr(f,2)):0}return K.after=Hy,K.ary=Yd,K.assign=$y,K.assignIn=vv,K.assignInWith=Xf,K.assignWith=mv,K.at=fm,K.before=Kd,K.bind=Vp,K.bindAll=jm,K.bindKey=qd,K.castArray=W0,K.chain=Ns,K.chunk=ui,K.compact=Ui,K.concat=Li,K.cond=Nv,K.conforms=Dv,K.constant=nd,K.countBy=ky,K.create=gv,K.curry=Hp,K.curryRight=Qd,K.debounce=Uh,K.defaults=yv,K.defaultsDeep=hm,K.defer=Jd,K.delay=U0,K.difference=Ki,K.differenceBy=$i,K.differenceWith=qi,K.drop=Pi,K.dropRight=fn,K.dropRightWhile=Qi,K.dropWhile=zn,K.fill=Xi,K.filter=Ny,K.flatMap=By,K.flatMapDeep=Zy,K.flatMapDepth=Uy,K.flatten=Wn,K.flattenDeep=Ii,K.flattenDepth=wo,K.flip=jy,K.flow=zs,K.flowRight=nf,K.fromPairs=fe,K.functions=xv,K.functionsIn=mm,K.groupBy=zy,K.initial=br,K.intersection=_n,K.intersectionBy=ie,K.intersectionWith=j,K.invert=ym,K.invertBy=jh,K.invokeMap=Gy,K.iteratee=id,K.keyBy=ra,K.keys=ya,K.keysIn=Ri,K.map=Su,K.mapKeys=cc,K.mapValues=ef,K.matches=Wm,K.matchesProperty=Bv,K.memoize=zh,K.merge=xm,K.mergeWith=tf,K.method=Zv,K.methodOf=$m,K.mixin=ad,K.negate=bl,K.nthArg=An,K.omit=Wh,K.omitBy=$h,K.once=z0,K.orderBy=qc,K.over=Uv,K.overArgs=G0,K.overEvery=Xy,K.overSome=Ym,K.partial=jp,K.partialRight=ev,K.partition=Zp,K.pick=Sv,K.pickBy=bv,K.property=Km,K.propertyOf=Yy,K.pull=Le,K.pullAll=ke,K.pullAllBy=Q,K.pullAllWith=Se,K.pullAt=ue,K.range=Ky,K.rangeRight=qy,K.rearg=Wy,K.reject=Up,K.remove=He,K.rest=Wp,K.reverse=Xe,K.sampleSize=Z0,K.set=bm,K.setWith=Em,K.shuffle=Bh,K.slice=Et,K.sortBy=Xd,K.sortedUniq=Ut,K.sortedUniqBy=Lr,K.split=Zm,K.spread=tv,K.tail=Cr,K.take=Ur,K.takeRight=Qn,K.takeRightWhile=Rn,K.takeWhile=Ta,K.tap=Ty,K.throttle=V0,K.thru=Nh,K.toArray=fv,K.toPairs=Ev,K.toPairsIn=qp,K.toPath=r_,K.toPlainObject=pv,K.transform=Am,K.unary=H0,K.union=Yu,K.unionBy=Ku,K.unionWith=Ca,K.uniq=xu,K.uniqBy=zo,K.uniqWith=Bp,K.unset=Tm,K.unzip=Mo,K.unzipWith=Fh,K.update=Av,K.updateWith=Cm,K.values=rf,K.valuesIn=wm,K.without=_y,K.words=td,K.wrap=j0,K.xor=xy,K.xorBy=Sy,K.xorWith=by,K.zip=Ey,K.zipObject=N0,K.zipObjectDeep=Ay,K.zipWith=qu,K.entries=Ev,K.entriesIn=qp,K.extend=vv,K.extendWith=Xf,ad(K,K),K.add=n_,K.attempt=rd,K.camelCase=Qp,K.capitalize=Cv,K.ceil=i_,K.clamp=Mm,K.clone=rv,K.cloneDeep=X0,K.cloneDeepWith=Y0,K.cloneWith=$0,K.conformsTo=K0,K.deburr=wv,K.defaultTo=Qu,K.divide=a_,K.endsWith=Mv,K.eq=lo,K.escape=Lm,K.escapeRegExp=Pm,K.every=Fy,K.find=Dy,K.findIndex=Kr,K.findKey=pm,K.findLast=Kc,K.findLastIndex=vn,K.findLastKey=dm,K.floor=o_,K.forEach=D0,K.forEachRight=B0,K.forIn=_v,K.forInRight=Yf,K.forOwn=vm,K.forOwnRight=Ro,K.get=Vh,K.gt=nv,K.gte=q0,K.has=gm,K.hasIn=Hh,K.head=yt,K.identity=$n,K.includes=Dh,K.indexOf=it,K.inRange=Rm,K.invoke=_m,K.isArguments=Ds,K.isArray=Mn,K.isArrayBuffer=Q0,K.isArrayLike=za,K.isArrayLikeObject=zi,K.isBoolean=$p,K.isBuffer=El,K.isDate=J0,K.isElement=Xp,K.isEmpty=Yp,K.isEqual=em,K.isEqualWith=tm,K.isError=iv,K.isFinite=av,K.isFunction=Bs,K.isInteger=rm,K.isLength=pr,K.isMap=ov,K.isMatch=nm,K.isMatchWith=uv,K.isNaN=im,K.isNative=sv,K.isNil=am,K.isNull=Wf,K.isNumber=lv,K.isObject=Gi,K.isObjectLike=qe,K.isPlainObject=Jc,K.isRegExp=Gh,K.isSafeInteger=cv,K.isSet=Kp,K.isString=$f,K.isSymbol=Go,K.isTypedArray=lc,K.isUndefined=om,K.isWeakMap=um,K.isWeakSet=sm,K.join=Ae,K.kebabCase=Rv,K.last=De,K.lastIndexOf=mt,K.lowerCase=Im,K.lowerFirst=Om,K.lt=lm,K.lte=cm,K.max=u_,K.maxBy=s_,K.mean=l_,K.meanBy=c_,K.min=f_,K.minBy=h_,K.stubArray=zv,K.stubFalse=Gv,K.stubObject=Qy,K.stubString=Jy,K.stubTrue=e_,K.multiply=p_,K.nth=Ie,K.noConflict=Xm,K.noop=En,K.now=Gp,K.pad=km,K.padEnd=Fm,K.padStart=Lv,K.parseInt=Nm,K.random=Tv,K.reduce=Sl,K.reduceRight=Qc,K.repeat=Dm,K.replace=Bm,K.result=Sm,K.round=d_,K.runInContext=rt,K.sample=Vy,K.size=zp,K.snakeCase=Jp,K.some=Zh,K.sortedIndex=Ht,K.sortedIndexBy=or,K.sortedIndexOf=_r,K.sortedLastIndex=ir,K.sortedLastIndexBy=Pr,K.sortedLastIndexOf=Er,K.startCase=Um,K.startsWith=Pv,K.subtract=od,K.sum=v_,K.sumBy=m_,K.template=Iv,K.times=t_,K.toFinite=Zs,K.toInteger=Pn,K.toLength=hv,K.toLower=zm,K.toNumber=Vo,K.toSafeInteger=dv,K.toString=si,K.toUpper=Us,K.trim=Ov,K.trimEnd=kv,K.trimStart=Gm,K.truncate=Vm,K.unescape=Fv,K.uniqueId=qm,K.upperCase=Hm,K.upperFirst=ed,K.each=D0,K.eachRight=B0,K.first=yt,ad(K,function(){var c={};return To(K,function(f,m){ii.call(K.prototype,m)||(c[m]=f)}),c}(),{chain:!1}),K.VERSION=ce,yn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){K[c].placeholder=K}),yn(["drop","take"],function(c,f){On.prototype[c]=function(m){m=m===E?1:Bi(Pn(m),0);var A=this.__filtered__&&!f?new On(this):this.clone();return A.__filtered__?A.__takeCount__=la(m,A.__takeCount__):A.__views__.push({size:la(m,We),type:c+(A.__dir__<0?"Right":"")}),A},On.prototype[c+"Right"]=function(m){return this.reverse()[c](m).reverse()}}),yn(["filter","map","takeWhile"],function(c,f){var m=f+1,A=m==ne||m==L;On.prototype[c]=function(B){var te=this.clone();return te.__iteratees__.push({iteratee:Qr(B,3),type:m}),te.__filtered__=te.__filtered__||A,te}}),yn(["head","last"],function(c,f){var m="take"+(f?"Right":"");On.prototype[c]=function(){return this[m](1).value()[0]}}),yn(["initial","tail"],function(c,f){var m="drop"+(f?"":"Right");On.prototype[c]=function(){return this.__filtered__?new On(this):this[m](1)}}),On.prototype.compact=function(){return this.filter($n)},On.prototype.find=function(c){return this.filter(c).head()},On.prototype.findLast=function(c){return this.reverse().find(c)},On.prototype.invokeMap=Ln(function(c,f){return typeof c=="function"?new On(this):this.map(function(m){return bs(m,c,f)})}),On.prototype.reject=function(c){return this.filter(bl(Qr(c)))},On.prototype.slice=function(c,f){c=Pn(c);var m=this;return m.__filtered__&&(c>0||f<0)?new On(m):(c<0?m=m.takeRight(-c):c&&(m=m.drop(c)),f!==E&&(f=Pn(f),m=f<0?m.dropRight(-f):m.take(f-c)),m)},On.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},On.prototype.toArray=function(){return this.take(We)},To(On.prototype,function(c,f){var m=/^(?:filter|find|map|reject)|While$/.test(f),A=/^(?:head|last)$/.test(f),B=K[A?"take"+(f=="last"?"Right":""):f],te=A||/^find/.test(f);!B||(K.prototype[f]=function(){var Me=this.__wrapped__,Ze=A?[1]:arguments,ct=Me instanceof On,Yt=Ze[0],qt=ct||Mn(Me),ur=function(Bn){var Vn=B.apply(K,Sa([Bn],Ze));return A&&Fr?Vn[0]:Vn};qt&&m&&typeof Yt=="function"&&Yt.length!=1&&(ct=qt=!1);var Fr=this.__chain__,qr=!!this.__actions__.length,hn=te&&!Fr,mn=ct&&!qr;if(!te&&qt){Me=mn?Me:new On(this);var un=c.apply(Me,Ze);return un.__actions__.push({func:Nh,args:[ur],thisArg:E}),new da(un,Fr)}return hn&&mn?c.apply(this,Ze):(un=this.thru(ur),hn?A?un.value()[0]:un.value():un)})}),yn(["pop","push","shift","sort","splice","unshift"],function(c){var f=Ko[c],m=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",A=/^(?:pop|shift)$/.test(c);K.prototype[c]=function(){var B=arguments;if(A&&!this.__chain__){var te=this.value();return f.apply(Mn(te)?te:[],B)}return this[m](function(Me){return f.apply(Mn(Me)?Me:[],B)})}}),To(On.prototype,function(c,f){var m=K[f];if(m){var A=m.name+"";ii.call(ys,A)||(ys[A]=[]),ys[A].push({name:f,func:m})}}),ys[_l(E,Je).name]=[{name:"wrapper",func:E}],On.prototype.clone=Cc,On.prototype.reverse=_h,On.prototype.value=zl,K.prototype.at=Cy,K.prototype.chain=wy,K.prototype.commit=My,K.prototype.next=Ry,K.prototype.plant=Py,K.prototype.reverse=Iy,K.prototype.toJSON=K.prototype.valueOf=K.prototype.value=Oy,K.prototype.first=K.prototype.head,Zl&&(K.prototype[Zl]=Ly),K},Sc=mp();g._=Sc,oe=function(){return Sc}.call(G,D,G,rr),oe!==E&&(rr.exports=oe)}).call(this)},3614:function(rr,G,D){"use strict";rr.exports=E;var oe=D(80645);function E(k){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(k)?k:new Uint8Array(k||0),this.pos=0,this.type=0,this.length=this.buf.length}E.Varint=0,E.Fixed64=1,E.Bytes=2,E.Fixed32=5;var ce=(1<<16)*(1<<16),J=1/ce,U=12,re=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");E.prototype={destroy:function(){this.buf=null},readFields:function(k,ne,P){for(P=P||this.length;this.pos<P;){var L=this.readVarint(),b=L>>3,de=this.pos;this.type=L&7,k(b,ne,this),this.pos===de&&this.skip(L)}return ne},readMessage:function(k,ne){return this.readFields(k,ne,this.readVarint()+this.pos)},readFixed32:function(){var k=Fe(this.buf,this.pos);return this.pos+=4,k},readSFixed32:function(){var k=je(this.buf,this.pos);return this.pos+=4,k},readFixed64:function(){var k=Fe(this.buf,this.pos)+Fe(this.buf,this.pos+4)*ce;return this.pos+=8,k},readSFixed64:function(){var k=Fe(this.buf,this.pos)+je(this.buf,this.pos+4)*ce;return this.pos+=8,k},readFloat:function(){var k=oe.read(this.buf,this.pos,!0,23,4);return this.pos+=4,k},readDouble:function(){var k=oe.read(this.buf,this.pos,!0,52,8);return this.pos+=8,k},readVarint:function(k){var ne=this.buf,P,L;return L=ne[this.pos++],P=L&127,L<128||(L=ne[this.pos++],P|=(L&127)<<7,L<128)||(L=ne[this.pos++],P|=(L&127)<<14,L<128)||(L=ne[this.pos++],P|=(L&127)<<21,L<128)?P:(L=ne[this.pos],P|=(L&15)<<28,Y(P,k,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var k=this.readVarint();return k%2==1?(k+1)/-2:k/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var k=this.readVarint()+this.pos,ne=this.pos;return this.pos=k,k-ne>=U&&re?tt(this.buf,ne,k):Be(this.buf,ne,k)},readBytes:function(){var k=this.readVarint()+this.pos,ne=this.buf.subarray(this.pos,k);return this.pos=k,ne},readPackedVarint:function(k,ne){if(this.type!==E.Bytes)return k.push(this.readVarint(ne));var P=se(this);for(k=k||[];this.pos<P;)k.push(this.readVarint(ne));return k},readPackedSVarint:function(k){if(this.type!==E.Bytes)return k.push(this.readSVarint());var ne=se(this);for(k=k||[];this.pos<ne;)k.push(this.readSVarint());return k},readPackedBoolean:function(k){if(this.type!==E.Bytes)return k.push(this.readBoolean());var ne=se(this);for(k=k||[];this.pos<ne;)k.push(this.readBoolean());return k},readPackedFloat:function(k){if(this.type!==E.Bytes)return k.push(this.readFloat());var ne=se(this);for(k=k||[];this.pos<ne;)k.push(this.readFloat());return k},readPackedDouble:function(k){if(this.type!==E.Bytes)return k.push(this.readDouble());var ne=se(this);for(k=k||[];this.pos<ne;)k.push(this.readDouble());return k},readPackedFixed32:function(k){if(this.type!==E.Bytes)return k.push(this.readFixed32());var ne=se(this);for(k=k||[];this.pos<ne;)k.push(this.readFixed32());return k},readPackedSFixed32:function(k){if(this.type!==E.Bytes)return k.push(this.readSFixed32());var ne=se(this);for(k=k||[];this.pos<ne;)k.push(this.readSFixed32());return k},readPackedFixed64:function(k){if(this.type!==E.Bytes)return k.push(this.readFixed64());var ne=se(this);for(k=k||[];this.pos<ne;)k.push(this.readFixed64());return k},readPackedSFixed64:function(k){if(this.type!==E.Bytes)return k.push(this.readSFixed64());var ne=se(this);for(k=k||[];this.pos<ne;)k.push(this.readSFixed64());return k},skip:function(k){var ne=k&7;if(ne===E.Varint)for(;this.buf[this.pos++]>127;);else if(ne===E.Bytes)this.pos=this.readVarint()+this.pos;else if(ne===E.Fixed32)this.pos+=4;else if(ne===E.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+ne)},writeTag:function(k,ne){this.writeVarint(k<<3|ne)},realloc:function(k){for(var ne=this.length||16;ne<this.pos+k;)ne*=2;if(ne!==this.length){var P=new Uint8Array(ne);P.set(this.buf),this.buf=P,this.length=ne}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(k){this.realloc(4),ge(this.buf,k,this.pos),this.pos+=4},writeSFixed32:function(k){this.realloc(4),ge(this.buf,k,this.pos),this.pos+=4},writeFixed64:function(k){this.realloc(8),ge(this.buf,k&-1,this.pos),ge(this.buf,Math.floor(k*J),this.pos+4),this.pos+=8},writeSFixed64:function(k){this.realloc(8),ge(this.buf,k&-1,this.pos),ge(this.buf,Math.floor(k*J),this.pos+4),this.pos+=8},writeVarint:function(k){if(k=+k||0,k>268435455||k<0){ye(k,this);return}this.realloc(4),this.buf[this.pos++]=k&127|(k>127?128:0),!(k<=127)&&(this.buf[this.pos++]=(k>>>=7)&127|(k>127?128:0),!(k<=127)&&(this.buf[this.pos++]=(k>>>=7)&127|(k>127?128:0),!(k<=127)&&(this.buf[this.pos++]=k>>>7&127)))},writeSVarint:function(k){this.writeVarint(k<0?-k*2-1:k*2)},writeBoolean:function(k){this.writeVarint(Boolean(k))},writeString:function(k){k=String(k),this.realloc(k.length*4),this.pos++;var ne=this.pos;this.pos=_t(this.buf,k,this.pos);var P=this.pos-ne;P>=128&&Ue(ne,P,this),this.pos=ne-1,this.writeVarint(P),this.pos+=P},writeFloat:function(k){this.realloc(4),oe.write(this.buf,k,this.pos,!0,23,4),this.pos+=4},writeDouble:function(k){this.realloc(8),oe.write(this.buf,k,this.pos,!0,52,8),this.pos+=8},writeBytes:function(k){var ne=k.length;this.writeVarint(ne),this.realloc(ne);for(var P=0;P<ne;P++)this.buf[this.pos++]=k[P]},writeRawMessage:function(k,ne){this.pos++;var P=this.pos;k(ne,this);var L=this.pos-P;L>=128&&Ue(P,L,this),this.pos=P-1,this.writeVarint(L),this.pos+=L},writeMessage:function(k,ne,P){this.writeTag(k,E.Bytes),this.writeRawMessage(ne,P)},writePackedVarint:function(k,ne){ne.length&&this.writeMessage(k,pt,ne)},writePackedSVarint:function(k,ne){ne.length&&this.writeMessage(k,Ge,ne)},writePackedBoolean:function(k,ne){ne.length&&this.writeMessage(k,Ye,ne)},writePackedFloat:function(k,ne){ne.length&&this.writeMessage(k,lt,ne)},writePackedDouble:function(k,ne){ne.length&&this.writeMessage(k,Je,ne)},writePackedFixed32:function(k,ne){ne.length&&this.writeMessage(k,Ke,ne)},writePackedSFixed32:function(k,ne){ne.length&&this.writeMessage(k,xt,ne)},writePackedFixed64:function(k,ne){ne.length&&this.writeMessage(k,I,ne)},writePackedSFixed64:function(k,ne){ne.length&&this.writeMessage(k,ht,ne)},writeBytesField:function(k,ne){this.writeTag(k,E.Bytes),this.writeBytes(ne)},writeFixed32Field:function(k,ne){this.writeTag(k,E.Fixed32),this.writeFixed32(ne)},writeSFixed32Field:function(k,ne){this.writeTag(k,E.Fixed32),this.writeSFixed32(ne)},writeFixed64Field:function(k,ne){this.writeTag(k,E.Fixed64),this.writeFixed64(ne)},writeSFixed64Field:function(k,ne){this.writeTag(k,E.Fixed64),this.writeSFixed64(ne)},writeVarintField:function(k,ne){this.writeTag(k,E.Varint),this.writeVarint(ne)},writeSVarintField:function(k,ne){this.writeTag(k,E.Varint),this.writeSVarint(ne)},writeStringField:function(k,ne){this.writeTag(k,E.Bytes),this.writeString(ne)},writeFloatField:function(k,ne){this.writeTag(k,E.Fixed32),this.writeFloat(ne)},writeDoubleField:function(k,ne){this.writeTag(k,E.Fixed64),this.writeDouble(ne)},writeBooleanField:function(k,ne){this.writeVarintField(k,Boolean(ne))}};function Y(k,ne,P){var L=P.buf,b,de;if(de=L[P.pos++],b=(de&112)>>4,de<128||(de=L[P.pos++],b|=(de&127)<<3,de<128)||(de=L[P.pos++],b|=(de&127)<<10,de<128)||(de=L[P.pos++],b|=(de&127)<<17,de<128)||(de=L[P.pos++],b|=(de&127)<<24,de<128)||(de=L[P.pos++],b|=(de&1)<<31,de<128))return le(k,b,ne);throw new Error("Expected varint not more than 10 bytes")}function se(k){return k.type===E.Bytes?k.readVarint()+k.pos:k.pos+1}function le(k,ne,P){return P?ne*4294967296+(k>>>0):(ne>>>0)*4294967296+(k>>>0)}function ye(k,ne){var P,L;if(k>=0?(P=k%4294967296|0,L=k/4294967296|0):(P=~(-k%4294967296),L=~(-k/4294967296),P^4294967295?P=P+1|0:(P=0,L=L+1|0)),k>=18446744073709552e3||k<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ne.realloc(10),Ce(P,L,ne),Oe(L,ne)}function Ce(k,ne,P){P.buf[P.pos++]=k&127|128,k>>>=7,P.buf[P.pos++]=k&127|128,k>>>=7,P.buf[P.pos++]=k&127|128,k>>>=7,P.buf[P.pos++]=k&127|128,k>>>=7,P.buf[P.pos]=k&127}function Oe(k,ne){var P=(k&7)<<4;ne.buf[ne.pos++]|=P|((k>>>=3)?128:0),!!k&&(ne.buf[ne.pos++]=k&127|((k>>>=7)?128:0),!!k&&(ne.buf[ne.pos++]=k&127|((k>>>=7)?128:0),!!k&&(ne.buf[ne.pos++]=k&127|((k>>>=7)?128:0),!!k&&(ne.buf[ne.pos++]=k&127|((k>>>=7)?128:0),!!k&&(ne.buf[ne.pos++]=k&127)))))}function Ue(k,ne,P){var L=ne<=16383?1:ne<=2097151?2:ne<=268435455?3:Math.floor(Math.log(ne)/(Math.LN2*7));P.realloc(L);for(var b=P.pos-1;b>=k;b--)P.buf[b+L]=P.buf[b]}function pt(k,ne){for(var P=0;P<k.length;P++)ne.writeVarint(k[P])}function Ge(k,ne){for(var P=0;P<k.length;P++)ne.writeSVarint(k[P])}function lt(k,ne){for(var P=0;P<k.length;P++)ne.writeFloat(k[P])}function Je(k,ne){for(var P=0;P<k.length;P++)ne.writeDouble(k[P])}function Ye(k,ne){for(var P=0;P<k.length;P++)ne.writeBoolean(k[P])}function Ke(k,ne){for(var P=0;P<k.length;P++)ne.writeFixed32(k[P])}function xt(k,ne){for(var P=0;P<k.length;P++)ne.writeSFixed32(k[P])}function I(k,ne){for(var P=0;P<k.length;P++)ne.writeFixed64(k[P])}function ht(k,ne){for(var P=0;P<k.length;P++)ne.writeSFixed64(k[P])}function Fe(k,ne){return(k[ne]|k[ne+1]<<8|k[ne+2]<<16)+k[ne+3]*16777216}function ge(k,ne,P){k[P]=ne,k[P+1]=ne>>>8,k[P+2]=ne>>>16,k[P+3]=ne>>>24}function je(k,ne){return(k[ne]|k[ne+1]<<8|k[ne+2]<<16)+(k[ne+3]<<24)}function Be(k,ne,P){for(var L="",b=ne;b<P;){var de=k[b],Te=null,we=de>239?4:de>223?3:de>191?2:1;if(b+we>P)break;var We,St,ar;we===1?de<128&&(Te=de):we===2?(We=k[b+1],(We&192)==128&&(Te=(de&31)<<6|We&63,Te<=127&&(Te=null))):we===3?(We=k[b+1],St=k[b+2],(We&192)==128&&(St&192)==128&&(Te=(de&15)<<12|(We&63)<<6|St&63,(Te<=2047||Te>=55296&&Te<=57343)&&(Te=null))):we===4&&(We=k[b+1],St=k[b+2],ar=k[b+3],(We&192)==128&&(St&192)==128&&(ar&192)==128&&(Te=(de&15)<<18|(We&63)<<12|(St&63)<<6|ar&63,(Te<=65535||Te>=1114112)&&(Te=null))),Te===null?(Te=65533,we=1):Te>65535&&(Te-=65536,L+=String.fromCharCode(Te>>>10&1023|55296),Te=56320|Te&1023),L+=String.fromCharCode(Te),b+=we}return L}function tt(k,ne,P){return re.decode(k.subarray(ne,P))}function _t(k,ne,P){for(var L=0,b,de;L<ne.length;L++){if(b=ne.charCodeAt(L),b>55295&&b<57344)if(de)if(b<56320){k[P++]=239,k[P++]=191,k[P++]=189,de=b;continue}else b=de-55296<<10|b-56320|65536,de=null;else{b>56319||L+1===ne.length?(k[P++]=239,k[P++]=191,k[P++]=189):de=b;continue}else de&&(k[P++]=239,k[P++]=191,k[P++]=189,de=null);b<128?k[P++]=b:(b<2048?k[P++]=b>>6|192:(b<65536?k[P++]=b>>12|224:(k[P++]=b>>18|240,k[P++]=b>>12&63|128),k[P++]=b>>6&63|128),k[P++]=b&63|128)}return P}},32676:function(rr,G,D){var oe=D(34155);(function(E,ce){rr.exports=ce()})(this,function(){"use strict";function E(Ne,V){if(!(Ne instanceof V))throw new TypeError("Cannot call a class as a function")}function ce(Ne,V){for(var Z=0;Z<V.length;Z++){var $=V[Z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(Ne,$.key,$)}}function J(Ne,V,Z){return V&&ce(Ne.prototype,V),Z&&ce(Ne,Z),Ne}/**
 * splaytree v3.1.0
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */var U=function(){function Ne(V,Z){this.next=null,this.key=V,this.data=Z,this.left=null,this.right=null}return Ne}();function re(Ne,V){return Ne>V?1:Ne<V?-1:0}function Y(Ne,V,Z){for(var $=new U(null,null),T=$,xe=$;;){var vt=Z(Ne,V.key);if(vt<0){if(V.left===null)break;if(Z(Ne,V.left.key)<0){var Gt=V.left;if(V.left=Gt.right,Gt.right=V,V=Gt,V.left===null)break}xe.left=V,xe=V,V=V.left}else if(vt>0){if(V.right===null)break;if(Z(Ne,V.right.key)>0){var Gt=V.right;if(V.right=Gt.left,Gt.left=V,V=Gt,V.right===null)break}T.right=V,T=V,V=V.right}else break}return T.right=V.left,xe.left=V.right,V.left=$.right,V.right=$.left,V}function se(Ne,V,Z,$){var T=new U(Ne,V);if(Z===null)return T.left=T.right=null,T;Z=Y(Ne,Z,$);var xe=$(Ne,Z.key);return xe<0?(T.left=Z.left,T.right=Z,Z.left=null):xe>=0&&(T.right=Z.right,T.left=Z,Z.right=null),T}function le(Ne,V,Z){var $=null,T=null;if(V){V=Y(Ne,V,Z);var xe=Z(V.key,Ne);xe===0?($=V.left,T=V.right):xe<0?(T=V.right,V.right=null,$=V):($=V.left,V.left=null,T=V)}return{left:$,right:T}}function ye(Ne,V,Z){return V===null?Ne:(Ne===null||(V=Y(Ne.key,V,Z),V.left=Ne),V)}function Ce(Ne,V,Z,$,T){if(Ne){$(""+V+(Z?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+T(Ne)+`
`);var xe=V+(Z?"    ":"\u2502   ");Ne.left&&Ce(Ne.left,xe,!1,$,T),Ne.right&&Ce(Ne.right,xe,!0,$,T)}}var Oe=function(){function Ne(V){V===void 0&&(V=re),this._root=null,this._size=0,this._comparator=V}return Ne.prototype.insert=function(V,Z){return this._size++,this._root=se(V,Z,this._root,this._comparator)},Ne.prototype.add=function(V,Z){var $=new U(V,Z);this._root===null&&($.left=$.right=null,this._size++,this._root=$);var T=this._comparator,xe=Y(V,this._root,T),vt=T(V,xe.key);return vt===0?this._root=xe:(vt<0?($.left=xe.left,$.right=xe,xe.left=null):vt>0&&($.right=xe.right,$.left=xe,xe.right=null),this._size++,this._root=$),this._root},Ne.prototype.remove=function(V){this._root=this._remove(V,this._root,this._comparator)},Ne.prototype._remove=function(V,Z,$){var T;if(Z===null)return null;Z=Y(V,Z,$);var xe=$(V,Z.key);return xe===0?(Z.left===null?T=Z.right:(T=Y(V,Z.left,$),T.right=Z.right),this._size--,T):Z},Ne.prototype.pop=function(){var V=this._root;if(V){for(;V.left;)V=V.left;return this._root=Y(V.key,this._root,this._comparator),this._root=this._remove(V.key,this._root,this._comparator),{key:V.key,data:V.data}}return null},Ne.prototype.findStatic=function(V){for(var Z=this._root,$=this._comparator;Z;){var T=$(V,Z.key);if(T===0)return Z;T<0?Z=Z.left:Z=Z.right}return null},Ne.prototype.find=function(V){return this._root&&(this._root=Y(V,this._root,this._comparator),this._comparator(V,this._root.key)!==0)?null:this._root},Ne.prototype.contains=function(V){for(var Z=this._root,$=this._comparator;Z;){var T=$(V,Z.key);if(T===0)return!0;T<0?Z=Z.left:Z=Z.right}return!1},Ne.prototype.forEach=function(V,Z){for(var $=this._root,T=[],xe=!1;!xe;)$!==null?(T.push($),$=$.left):T.length!==0?($=T.pop(),V.call(Z,$),$=$.right):xe=!0;return this},Ne.prototype.range=function(V,Z,$,T){for(var xe=[],vt=this._comparator,Gt=this._root,_e;xe.length!==0||Gt;)if(Gt)xe.push(Gt),Gt=Gt.left;else{if(Gt=xe.pop(),_e=vt(Gt.key,Z),_e>0)break;if(vt(Gt.key,V)>=0&&$.call(T,Gt))return this;Gt=Gt.right}return this},Ne.prototype.keys=function(){var V=[];return this.forEach(function(Z){var $=Z.key;return V.push($)}),V},Ne.prototype.values=function(){var V=[];return this.forEach(function(Z){var $=Z.data;return V.push($)}),V},Ne.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Ne.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Ne.prototype.minNode=function(V){if(V===void 0&&(V=this._root),V)for(;V.left;)V=V.left;return V},Ne.prototype.maxNode=function(V){if(V===void 0&&(V=this._root),V)for(;V.right;)V=V.right;return V},Ne.prototype.at=function(V){for(var Z=this._root,$=!1,T=0,xe=[];!$;)if(Z)xe.push(Z),Z=Z.left;else if(xe.length>0){if(Z=xe.pop(),T===V)return Z;T++,Z=Z.right}else $=!0;return null},Ne.prototype.next=function(V){var Z=this._root,$=null;if(V.right){for($=V.right;$.left;)$=$.left;return $}for(var T=this._comparator;Z;){var xe=T(V.key,Z.key);if(xe===0)break;xe<0?($=Z,Z=Z.left):Z=Z.right}return $},Ne.prototype.prev=function(V){var Z=this._root,$=null;if(V.left!==null){for($=V.left;$.right;)$=$.right;return $}for(var T=this._comparator;Z;){var xe=T(V.key,Z.key);if(xe===0)break;xe<0?Z=Z.left:($=Z,Z=Z.right)}return $},Ne.prototype.clear=function(){return this._root=null,this._size=0,this},Ne.prototype.toList=function(){return Ge(this._root)},Ne.prototype.load=function(V,Z,$){Z===void 0&&(Z=[]),$===void 0&&($=!1);var T=V.length,xe=this._comparator;if($&&Ye(V,Z,0,T-1,xe),this._root===null)this._root=Ue(V,Z,0,T),this._size=T;else{var vt=Je(this.toList(),pt(V,Z),xe);T=this._size+T,this._root=lt({head:vt},0,T)}return this},Ne.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Ne.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Ne.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Ne.prototype.toString=function(V){V===void 0&&(V=function(T){return String(T.key)});var Z=[];return Ce(this._root,"",!0,function($){return Z.push($)},V),Z.join("")},Ne.prototype.update=function(V,Z,$){var T=this._comparator,xe=le(V,this._root,T),vt=xe.left,Gt=xe.right;T(V,Z)<0?Gt=se(Z,$,Gt,T):vt=se(Z,$,vt,T),this._root=ye(vt,Gt,T)},Ne.prototype.split=function(V){return le(V,this._root,this._comparator)},Ne}();function Ue(Ne,V,Z,$){var T=$-Z;if(T>0){var xe=Z+Math.floor(T/2),vt=Ne[xe],Gt=V[xe],_e=new U(vt,Gt);return _e.left=Ue(Ne,V,Z,xe),_e.right=Ue(Ne,V,xe+1,$),_e}return null}function pt(Ne,V){for(var Z=new U(null,null),$=Z,T=0;T<Ne.length;T++)$=$.next=new U(Ne[T],V[T]);return $.next=null,Z.next}function Ge(Ne){for(var V=Ne,Z=[],$=!1,T=new U(null,null),xe=T;!$;)V?(Z.push(V),V=V.left):Z.length>0?(V=xe=xe.next=Z.pop(),V=V.right):$=!0;return xe.next=null,T.next}function lt(Ne,V,Z){var $=Z-V;if($>0){var T=V+Math.floor($/2),xe=lt(Ne,V,T),vt=Ne.head;return vt.left=xe,Ne.head=Ne.head.next,vt.right=lt(Ne,T+1,Z),vt}return null}function Je(Ne,V,Z){for(var $=new U(null,null),T=$,xe=Ne,vt=V;xe!==null&&vt!==null;)Z(xe.key,vt.key)<0?(T.next=xe,xe=xe.next):(T.next=vt,vt=vt.next),T=T.next;return xe!==null?T.next=xe:vt!==null&&(T.next=vt),$.next}function Ye(Ne,V,Z,$,T){if(!(Z>=$)){for(var xe=Ne[Z+$>>1],vt=Z-1,Gt=$+1;;){do vt++;while(T(Ne[vt],xe)<0);do Gt--;while(T(Ne[Gt],xe)>0);if(vt>=Gt)break;var _e=Ne[vt];Ne[vt]=Ne[Gt],Ne[Gt]=_e,_e=V[vt],V[vt]=V[Gt],V[Gt]=_e}Ye(Ne,V,Z,Gt,T),Ye(Ne,V,Gt+1,$,T)}}var Ke=function(V,Z){return V.ll.x<=Z.x&&Z.x<=V.ur.x&&V.ll.y<=Z.y&&Z.y<=V.ur.y},xt=function(V,Z){if(Z.ur.x<V.ll.x||V.ur.x<Z.ll.x||Z.ur.y<V.ll.y||V.ur.y<Z.ll.y)return null;var $=V.ll.x<Z.ll.x?Z.ll.x:V.ll.x,T=V.ur.x<Z.ur.x?V.ur.x:Z.ur.x,xe=V.ll.y<Z.ll.y?Z.ll.y:V.ll.y,vt=V.ur.y<Z.ur.y?V.ur.y:Z.ur.y;return{ll:{x:$,y:xe},ur:{x:T,y:vt}}},I=Number.EPSILON;I===void 0&&(I=Math.pow(2,-52));var ht=I*I,Fe=function(V,Z){if(-I<V&&V<I&&-I<Z&&Z<I)return 0;var $=V-Z;return $*$<ht*V*Z?0:V<Z?-1:1},ge=function(){function Ne(){E(this,Ne),this.reset()}return J(Ne,[{key:"reset",value:function(){this.xRounder=new je,this.yRounder=new je}},{key:"round",value:function(Z,$){return{x:this.xRounder.round(Z),y:this.yRounder.round($)}}}]),Ne}(),je=function(){function Ne(){E(this,Ne),this.tree=new Oe,this.round(0)}return J(Ne,[{key:"round",value:function(Z){var $=this.tree.add(Z),T=this.tree.prev($);if(T!==null&&Fe($.key,T.key)===0)return this.tree.remove(Z),T.key;var xe=this.tree.next($);return xe!==null&&Fe($.key,xe.key)===0?(this.tree.remove(Z),xe.key):Z}}]),Ne}(),Be=new ge,tt=function(V,Z){return V.x*Z.y-V.y*Z.x},_t=function(V,Z){return V.x*Z.x+V.y*Z.y},k=function(V,Z,$){var T={x:Z.x-V.x,y:Z.y-V.y},xe={x:$.x-V.x,y:$.y-V.y},vt=tt(T,xe);return Fe(vt,0)},ne=function(V){return Math.sqrt(_t(V,V))},P=function(V,Z,$){var T={x:Z.x-V.x,y:Z.y-V.y},xe={x:$.x-V.x,y:$.y-V.y};return tt(xe,T)/ne(xe)/ne(T)},L=function(V,Z,$){var T={x:Z.x-V.x,y:Z.y-V.y},xe={x:$.x-V.x,y:$.y-V.y};return _t(xe,T)/ne(xe)/ne(T)},b=function(V,Z,$){return Z.y===0?null:{x:V.x+Z.x/Z.y*($-V.y),y:$}},de=function(V,Z,$){return Z.x===0?null:{x:$,y:V.y+Z.y/Z.x*($-V.x)}},Te=function(V,Z,$,T){if(Z.x===0)return de($,T,V.x);if(T.x===0)return de(V,Z,$.x);if(Z.y===0)return b($,T,V.y);if(T.y===0)return b(V,Z,$.y);var xe=tt(Z,T);if(xe==0)return null;var vt={x:$.x-V.x,y:$.y-V.y},Gt=tt(vt,Z)/xe,_e=tt(vt,T)/xe,$e=V.x+_e*Z.x,At=$.x+Gt*T.x,Zt=V.y+_e*Z.y,er=$.y+Gt*T.y,lr=($e+At)/2,Nr=(Zt+er)/2;return{x:lr,y:Nr}},we=function(){J(Ne,null,[{key:"compare",value:function(Z,$){var T=Ne.comparePoints(Z.point,$.point);return T!==0?T:(Z.point!==$.point&&Z.link($),Z.isLeft!==$.isLeft?Z.isLeft?1:-1:St.compare(Z.segment,$.segment))}},{key:"comparePoints",value:function(Z,$){return Z.x<$.x?-1:Z.x>$.x?1:Z.y<$.y?-1:Z.y>$.y?1:0}}]);function Ne(V,Z){E(this,Ne),V.events===void 0?V.events=[this]:V.events.push(this),this.point=V,this.isLeft=Z}return J(Ne,[{key:"link",value:function(Z){if(Z.point===this.point)throw new Error("Tried to link already linked events");for(var $=Z.point.events,T=0,xe=$.length;T<xe;T++){var vt=$[T];this.point.events.push(vt),vt.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var Z=this.point.events.length,$=0;$<Z;$++){var T=this.point.events[$];if(T.segment.consumedBy===void 0)for(var xe=$+1;xe<Z;xe++){var vt=this.point.events[xe];vt.consumedBy===void 0&&T.otherSE.point.events===vt.otherSE.point.events&&T.segment.consume(vt.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var Z=[],$=0,T=this.point.events.length;$<T;$++){var xe=this.point.events[$];xe!==this&&!xe.segment.ringOut&&xe.segment.isInResult()&&Z.push(xe)}return Z}},{key:"getLeftmostComparator",value:function(Z){var $=this,T=new Map,xe=function(Gt){var _e=Gt.otherSE;T.set(Gt,{sine:P($.point,Z.point,_e.point),cosine:L($.point,Z.point,_e.point)})};return function(vt,Gt){T.has(vt)||xe(vt),T.has(Gt)||xe(Gt);var _e=T.get(vt),$e=_e.sine,At=_e.cosine,Zt=T.get(Gt),er=Zt.sine,lr=Zt.cosine;return $e>=0&&er>=0?At<lr?1:At>lr?-1:0:$e<0&&er<0?At<lr?-1:At>lr?1:0:er<$e?-1:er>$e?1:0}}}]),Ne}(),We=0,St=function(){J(Ne,null,[{key:"compare",value:function(Z,$){var T=Z.leftSE.point.x,xe=$.leftSE.point.x,vt=Z.rightSE.point.x,Gt=$.rightSE.point.x;if(Gt<T)return 1;if(vt<xe)return-1;var _e=Z.leftSE.point.y,$e=$.leftSE.point.y,At=Z.rightSE.point.y,Zt=$.rightSE.point.y;if(T<xe){if($e<_e&&$e<At)return 1;if($e>_e&&$e>At)return-1;var er=Z.comparePoint($.leftSE.point);if(er<0)return 1;if(er>0)return-1;var lr=$.comparePoint(Z.rightSE.point);return lr!==0?lr:-1}if(T>xe){if(_e<$e&&_e<Zt)return-1;if(_e>$e&&_e>Zt)return 1;var Nr=$.comparePoint(Z.leftSE.point);if(Nr!==0)return Nr;var Ir=Z.comparePoint($.rightSE.point);return Ir<0?1:Ir>0?-1:1}if(_e<$e)return-1;if(_e>$e)return 1;if(vt<Gt){var cr=$.comparePoint(Z.rightSE.point);if(cr!==0)return cr}if(vt>Gt){var Yr=Z.comparePoint($.rightSE.point);if(Yr<0)return 1;if(Yr>0)return-1}if(vt!==Gt){var en=At-_e,Un=vt-T,mi=Zt-$e,di=Gt-xe;if(en>Un&&mi<di)return 1;if(en<Un&&mi>di)return-1}return vt>Gt?1:vt<Gt||At<Zt?-1:At>Zt?1:Z.id<$.id?-1:Z.id>$.id?1:0}}]);function Ne(V,Z,$,T){E(this,Ne),this.id=++We,this.leftSE=V,V.segment=this,V.otherSE=Z,this.rightSE=Z,Z.segment=this,Z.otherSE=V,this.rings=$,this.windings=T}return J(Ne,[{key:"replaceRightSE",value:function(Z){this.rightSE=Z,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var Z=this.leftSE.point.y,$=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:Z<$?Z:$},ur:{x:this.rightSE.point.x,y:Z>$?Z:$}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(Z){return Z.x===this.leftSE.point.x&&Z.y===this.leftSE.point.y||Z.x===this.rightSE.point.x&&Z.y===this.rightSE.point.y}},{key:"comparePoint",value:function(Z){if(this.isAnEndpoint(Z))return 0;var $=this.leftSE.point,T=this.rightSE.point,xe=this.vector();if($.x===T.x)return Z.x===$.x?0:Z.x<$.x?1:-1;var vt=(Z.y-$.y)/xe.y,Gt=$.x+vt*xe.x;if(Z.x===Gt)return 0;var _e=(Z.x-$.x)/xe.x,$e=$.y+_e*xe.y;return Z.y===$e?0:Z.y<$e?-1:1}},{key:"getIntersection",value:function(Z){var $=this.bbox(),T=Z.bbox(),xe=xt($,T);if(xe===null)return null;var vt=this.leftSE.point,Gt=this.rightSE.point,_e=Z.leftSE.point,$e=Z.rightSE.point,At=Ke($,_e)&&this.comparePoint(_e)===0,Zt=Ke(T,vt)&&Z.comparePoint(vt)===0,er=Ke($,$e)&&this.comparePoint($e)===0,lr=Ke(T,Gt)&&Z.comparePoint(Gt)===0;if(Zt&&At)return lr&&!er?Gt:!lr&&er?$e:null;if(Zt)return er&&vt.x===$e.x&&vt.y===$e.y?null:vt;if(At)return lr&&Gt.x===_e.x&&Gt.y===_e.y?null:_e;if(lr&&er)return null;if(lr)return Gt;if(er)return $e;var Nr=Te(vt,this.vector(),_e,Z.vector());return Nr===null||!Ke(xe,Nr)?null:Be.round(Nr.x,Nr.y)}},{key:"split",value:function(Z){var $=[],T=Z.events!==void 0,xe=new we(Z,!0),vt=new we(Z,!1),Gt=this.rightSE;this.replaceRightSE(vt),$.push(vt),$.push(xe);var _e=new Ne(xe,Gt,this.rings.slice(),this.windings.slice());return we.comparePoints(_e.leftSE.point,_e.rightSE.point)>0&&_e.swapEvents(),we.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),T&&(xe.checkForConsuming(),vt.checkForConsuming()),$}},{key:"swapEvents",value:function(){var Z=this.rightSE;this.rightSE=this.leftSE,this.leftSE=Z,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var $=0,T=this.windings.length;$<T;$++)this.windings[$]*=-1}},{key:"consume",value:function(Z){for(var $=this,T=Z;$.consumedBy;)$=$.consumedBy;for(;T.consumedBy;)T=T.consumedBy;var xe=Ne.compare($,T);if(xe!==0){if(xe>0){var vt=$;$=T,T=vt}if($.prev===T){var Gt=$;$=T,T=Gt}for(var _e=0,$e=T.rings.length;_e<$e;_e++){var At=T.rings[_e],Zt=T.windings[_e],er=$.rings.indexOf(At);er===-1?($.rings.push(At),$.windings.push(Zt)):$.windings[er]+=Zt}T.rings=null,T.windings=null,T.consumedBy=$,T.leftSE.consumedBy=$.leftSE,T.rightSE.consumedBy=$.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var Z=this.prev.consumedBy||this.prev;this._beforeState=Z.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var Z=this.beforeState();this._afterState={rings:Z.rings.slice(0),windings:Z.windings.slice(0),multiPolys:[]};for(var $=this._afterState.rings,T=this._afterState.windings,xe=this._afterState.multiPolys,vt=0,Gt=this.rings.length;vt<Gt;vt++){var _e=this.rings[vt],$e=this.windings[vt],At=$.indexOf(_e);At===-1?($.push(_e),T.push($e)):T[At]+=$e}for(var Zt=[],er=[],lr=0,Nr=$.length;lr<Nr;lr++)if(T[lr]!==0){var Ir=$[lr],cr=Ir.poly;if(er.indexOf(cr)===-1)if(Ir.isExterior)Zt.push(cr);else{er.indexOf(cr)===-1&&er.push(cr);var Yr=Zt.indexOf(Ir.poly);Yr!==-1&&Zt.splice(Yr,1)}}for(var en=0,Un=Zt.length;en<Un;en++){var mi=Zt[en].multiPoly;xe.indexOf(mi)===-1&&xe.push(mi)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var Z=this.beforeState().multiPolys,$=this.afterState().multiPolys;switch(nn.type){case"union":{var T=Z.length===0,xe=$.length===0;this._isInResult=T!==xe;break}case"intersection":{var vt,Gt;Z.length<$.length?(vt=Z.length,Gt=$.length):(vt=$.length,Gt=Z.length),this._isInResult=Gt===nn.numMultiPolys&&vt<Gt;break}case"xor":{var _e=Math.abs(Z.length-$.length);this._isInResult=_e%2==1;break}case"difference":{var $e=function(Zt){return Zt.length===1&&Zt[0].isSubject};this._isInResult=$e(Z)!==$e($);break}default:throw new Error("Unrecognized operation type found ".concat(nn.type))}return this._isInResult}}],[{key:"fromRing",value:function(Z,$,T){var xe,vt,Gt,_e=we.comparePoints(Z,$);if(_e<0)xe=Z,vt=$,Gt=1;else if(_e>0)xe=$,vt=Z,Gt=-1;else throw new Error("Tried to create degenerate segment at [".concat(Z.x,", ").concat(Z.y,"]"));var $e=new we(xe,!0),At=new we(vt,!1);return new Ne($e,At,[T],[Gt])}}]),Ne}(),ar=function(){function Ne(V,Z,$){if(E(this,Ne),!Array.isArray(V)||V.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=Z,this.isExterior=$,this.segments=[],typeof V[0][0]!="number"||typeof V[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var T=Be.round(V[0][0],V[0][1]);this.bbox={ll:{x:T.x,y:T.y},ur:{x:T.x,y:T.y}};for(var xe=T,vt=1,Gt=V.length;vt<Gt;vt++){if(typeof V[vt][0]!="number"||typeof V[vt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var _e=Be.round(V[vt][0],V[vt][1]);_e.x===xe.x&&_e.y===xe.y||(this.segments.push(St.fromRing(xe,_e,this)),_e.x<this.bbox.ll.x&&(this.bbox.ll.x=_e.x),_e.y<this.bbox.ll.y&&(this.bbox.ll.y=_e.y),_e.x>this.bbox.ur.x&&(this.bbox.ur.x=_e.x),_e.y>this.bbox.ur.y&&(this.bbox.ur.y=_e.y),xe=_e)}(T.x!==xe.x||T.y!==xe.y)&&this.segments.push(St.fromRing(xe,T,this))}return J(Ne,[{key:"getSweepEvents",value:function(){for(var Z=[],$=0,T=this.segments.length;$<T;$++){var xe=this.segments[$];Z.push(xe.leftSE),Z.push(xe.rightSE)}return Z}}]),Ne}(),jt=function(){function Ne(V,Z){if(E(this,Ne),!Array.isArray(V))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ar(V[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var $=1,T=V.length;$<T;$++){var xe=new ar(V[$],this,!1);xe.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=xe.bbox.ll.x),xe.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=xe.bbox.ll.y),xe.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=xe.bbox.ur.x),xe.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=xe.bbox.ur.y),this.interiorRings.push(xe)}this.multiPoly=Z}return J(Ne,[{key:"getSweepEvents",value:function(){for(var Z=this.exteriorRing.getSweepEvents(),$=0,T=this.interiorRings.length;$<T;$++)for(var xe=this.interiorRings[$].getSweepEvents(),vt=0,Gt=xe.length;vt<Gt;vt++)Z.push(xe[vt]);return Z}}]),Ne}(),Or=function(){function Ne(V,Z){if(E(this,Ne),!Array.isArray(V))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof V[0][0][0]=="number"&&(V=[V])}catch(vt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var $=0,T=V.length;$<T;$++){var xe=new jt(V[$],this);xe.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=xe.bbox.ll.x),xe.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=xe.bbox.ll.y),xe.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=xe.bbox.ur.x),xe.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=xe.bbox.ur.y),this.polys.push(xe)}this.isSubject=Z}return J(Ne,[{key:"getSweepEvents",value:function(){for(var Z=[],$=0,T=this.polys.length;$<T;$++)for(var xe=this.polys[$].getSweepEvents(),vt=0,Gt=xe.length;vt<Gt;vt++)Z.push(xe[vt]);return Z}}]),Ne}(),Wr=function(){J(Ne,null,[{key:"factory",value:function(Z){for(var $=[],T=0,xe=Z.length;T<xe;T++){var vt=Z[T];if(!(!vt.isInResult()||vt.ringOut)){for(var Gt=null,_e=vt.leftSE,$e=vt.rightSE,At=[_e],Zt=_e.point,er=[];Gt=_e,_e=$e,At.push(_e),_e.point!==Zt;)for(;;){var lr=_e.getAvailableLinkedEvents();if(lr.length===0){var Nr=At[0].point,Ir=At[At.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Nr.x,",")+" ".concat(Nr.y,"]. Last matching segment found ends at")+" [".concat(Ir.x,", ").concat(Ir.y,"]."))}if(lr.length===1){$e=lr[0].otherSE;break}for(var cr=null,Yr=0,en=er.length;Yr<en;Yr++)if(er[Yr].point===_e.point){cr=Yr;break}if(cr!==null){var Un=er.splice(cr)[0],mi=At.splice(Un.index);mi.unshift(mi[0].otherSE),$.push(new Ne(mi.reverse()));continue}er.push({index:At.length,point:_e.point});var di=_e.getLeftmostComparator(Gt);$e=lr.sort(di)[0].otherSE;break}$.push(new Ne(At))}}return $}}]);function Ne(V){E(this,Ne),this.events=V;for(var Z=0,$=V.length;Z<$;Z++)V[Z].segment.ringOut=this;this.poly=null}return J(Ne,[{key:"getGeom",value:function(){for(var Z=this.events[0].point,$=[Z],T=1,xe=this.events.length-1;T<xe;T++){var vt=this.events[T].point,Gt=this.events[T+1].point;k(vt,Z,Gt)!==0&&($.push(vt),Z=vt)}if($.length===1)return null;var _e=$[0],$e=$[1];k(_e,Z,$e)===0&&$.shift(),$.push($[0]);for(var At=this.isExteriorRing()?1:-1,Zt=this.isExteriorRing()?0:$.length-1,er=this.isExteriorRing()?$.length:-1,lr=[],Nr=Zt;Nr!=er;Nr+=At)lr.push([$[Nr].x,$[Nr].y]);return lr}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var Z=this.enclosingRing();this._isExteriorRing=Z?!Z.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var Z=this.events[0],$=1,T=this.events.length;$<T;$++){var xe=this.events[$];we.compare(Z,xe)>0&&(Z=xe)}for(var vt=Z.segment.prevInResult(),Gt=vt?vt.prevInResult():null;;){if(!vt)return null;if(!Gt)return vt.ringOut;if(Gt.ringOut!==vt.ringOut)return Gt.ringOut.enclosingRing()!==vt.ringOut?vt.ringOut:vt.ringOut.enclosingRing();vt=Gt.prevInResult(),Gt=vt?vt.prevInResult():null}}}]),Ne}(),Zr=function(){function Ne(V){E(this,Ne),this.exteriorRing=V,V.poly=this,this.interiorRings=[]}return J(Ne,[{key:"addInterior",value:function(Z){this.interiorRings.push(Z),Z.poly=this}},{key:"getGeom",value:function(){var Z=[this.exteriorRing.getGeom()];if(Z[0]===null)return null;for(var $=0,T=this.interiorRings.length;$<T;$++){var xe=this.interiorRings[$].getGeom();xe!==null&&Z.push(xe)}return Z}}]),Ne}(),pn=function(){function Ne(V){E(this,Ne),this.rings=V,this.polys=this._composePolys(V)}return J(Ne,[{key:"getGeom",value:function(){for(var Z=[],$=0,T=this.polys.length;$<T;$++){var xe=this.polys[$].getGeom();xe!==null&&Z.push(xe)}return Z}},{key:"_composePolys",value:function(Z){for(var $=[],T=0,xe=Z.length;T<xe;T++){var vt=Z[T];if(!vt.poly)if(vt.isExteriorRing())$.push(new Zr(vt));else{var Gt=vt.enclosingRing();Gt.poly||$.push(new Zr(Gt)),Gt.poly.addInterior(vt)}}return $}}]),Ne}(),an=function(){function Ne(V){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:St.compare;E(this,Ne),this.queue=V,this.tree=new Oe(Z),this.segments=[]}return J(Ne,[{key:"process",value:function(Z){var $=Z.segment,T=[];if(Z.consumedBy)return Z.isLeft?this.queue.remove(Z.otherSE):this.tree.remove($),T;var xe=Z.isLeft?this.tree.insert($):this.tree.find($);if(!xe)throw new Error("Unable to find segment #".concat($.id," ")+"[".concat($.leftSE.point.x,", ").concat($.leftSE.point.y,"] -> ")+"[".concat($.rightSE.point.x,", ").concat($.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var vt=xe,Gt=xe,_e=void 0,$e=void 0;_e===void 0;)vt=this.tree.prev(vt),vt===null?_e=null:vt.key.consumedBy===void 0&&(_e=vt.key);for(;$e===void 0;)Gt=this.tree.next(Gt),Gt===null?$e=null:Gt.key.consumedBy===void 0&&($e=Gt.key);if(Z.isLeft){var At=null;if(_e){var Zt=_e.getIntersection($);if(Zt!==null&&($.isAnEndpoint(Zt)||(At=Zt),!_e.isAnEndpoint(Zt)))for(var er=this._splitSafely(_e,Zt),lr=0,Nr=er.length;lr<Nr;lr++)T.push(er[lr])}var Ir=null;if($e){var cr=$e.getIntersection($);if(cr!==null&&($.isAnEndpoint(cr)||(Ir=cr),!$e.isAnEndpoint(cr)))for(var Yr=this._splitSafely($e,cr),en=0,Un=Yr.length;en<Un;en++)T.push(Yr[en])}if(At!==null||Ir!==null){var mi=null;if(At===null)mi=Ir;else if(Ir===null)mi=At;else{var di=we.comparePoints(At,Ir);mi=di<=0?At:Ir}this.queue.remove($.rightSE),T.push($.rightSE);for(var Yn=$.split(mi),Vi=0,ja=Yn.length;Vi<ja;Vi++)T.push(Yn[Vi])}T.length>0?(this.tree.remove($),T.push(Z)):(this.segments.push($),$.prev=_e)}else{if(_e&&$e){var ea=_e.getIntersection($e);if(ea!==null){if(!_e.isAnEndpoint(ea))for(var Ra=this._splitSafely(_e,ea),Wa=0,ia=Ra.length;Wa<ia;Wa++)T.push(Ra[Wa]);if(!$e.isAnEndpoint(ea))for(var Ei=this._splitSafely($e,ea),ho=0,Mu=Ei.length;ho<Mu;ho++)T.push(Ei[ho])}}this.tree.remove($)}return T}},{key:"_splitSafely",value:function(Z,$){this.tree.remove(Z);var T=Z.rightSE;this.queue.remove(T);var xe=Z.split($);return xe.push(T),Z.consumedBy===void 0&&this.tree.insert(Z),xe}}]),Ne}(),Fn=typeof oe!="undefined"&&{NODE_ENV:"production"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,ln=typeof oe!="undefined"&&{NODE_ENV:"production"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,gn=function(){function Ne(){E(this,Ne)}return J(Ne,[{key:"run",value:function(Z,$,T){nn.type=Z,Be.reset();for(var xe=[new Or($,!0)],vt=0,Gt=T.length;vt<Gt;vt++)xe.push(new Or(T[vt],!1));if(nn.numMultiPolys=xe.length,nn.type==="difference")for(var _e=xe[0],$e=1;$e<xe.length;)xt(xe[$e].bbox,_e.bbox)!==null?$e++:xe.splice($e,1);if(nn.type==="intersection"){for(var At=0,Zt=xe.length;At<Zt;At++)for(var er=xe[At],lr=At+1,Nr=xe.length;lr<Nr;lr++)if(xt(er.bbox,xe[lr].bbox)===null)return[]}for(var Ir=new Oe(we.compare),cr=0,Yr=xe.length;cr<Yr;cr++)for(var en=xe[cr].getSweepEvents(),Un=0,mi=en.length;Un<mi;Un++)if(Ir.insert(en[Un]),Ir.size>Fn)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var di=new an(Ir),Yn=Ir.size,Vi=Ir.pop();Vi;){var ja=Vi.key;if(Ir.size===Yn){var ea=ja.segment;throw new Error("Unable to pop() ".concat(ja.isLeft?"left":"right"," SweepEvent ")+"[".concat(ja.point.x,", ").concat(ja.point.y,"] from segment #").concat(ea.id," ")+"[".concat(ea.leftSE.point.x,", ").concat(ea.leftSE.point.y,"] -> ")+"[".concat(ea.rightSE.point.x,", ").concat(ea.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Ir.size>Fn)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(di.segments.length>ln)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Ra=di.process(ja),Wa=0,ia=Ra.length;Wa<ia;Wa++){var Ei=Ra[Wa];Ei.consumedBy===void 0&&Ir.insert(Ei)}Yn=Ir.size,Vi=Ir.pop()}Be.reset();var ho=Wr.factory(di.segments),Mu=new pn(ho);return Mu.getGeom()}}]),Ne}(),nn=new gn,Tr=function(V){for(var Z=arguments.length,$=new Array(Z>1?Z-1:0),T=1;T<Z;T++)$[T-1]=arguments[T];return nn.run("union",V,$)},Vr=function(V){for(var Z=arguments.length,$=new Array(Z>1?Z-1:0),T=1;T<Z;T++)$[T-1]=arguments[T];return nn.run("intersection",V,$)},fi=function(V){for(var Z=arguments.length,$=new Array(Z>1?Z-1:0),T=1;T<Z;T++)$[T-1]=arguments[T];return nn.run("xor",V,$)},ti=function(V){for(var Z=arguments.length,$=new Array(Z>1?Z-1:0),T=1;T<Z;T++)$[T-1]=arguments[T];return nn.run("difference",V,$)},Zn={union:Tr,intersection:Vr,xor:fi,difference:ti};return Zn})},28660:function(rr,G,D){var oe=D(34155);/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var E;(function(ce){(function(J){var U=typeof D.g=="object"?D.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),re=Y(ce);typeof U.Reflect=="undefined"?U.Reflect=ce:re=Y(U.Reflect,re),J(re);function Y(se,le){return function(ye,Ce){typeof se[ye]!="function"&&Object.defineProperty(se,ye,{configurable:!0,writable:!0,value:Ce}),le&&le(ye,Ce)}}})(function(J){var U=Object.prototype.hasOwnProperty,re=typeof Symbol=="function",Y=re&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",se=re&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",le=typeof Object.create=="function",ye={__proto__:[]}instanceof Array,Ce=!le&&!ye,Oe={create:le?function(){return Gt(Object.create(null))}:ye?function(){return Gt({__proto__:null})}:function(){return Gt({})},has:Ce?function(_e,$e){return U.call(_e,$e)}:function(_e,$e){return $e in _e},get:Ce?function(_e,$e){return U.call(_e,$e)?_e[$e]:void 0}:function(_e,$e){return _e[$e]}},Ue=Object.getPrototypeOf(Function),pt=typeof oe=="object"&&{NODE_ENV:"production"}&&{NODE_ENV:"production"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",Ge=!pt&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:T(),lt=!pt&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:xe(),Je=!pt&&typeof WeakMap=="function"?WeakMap:vt(),Ye=new Je;function Ke(_e,$e,At,Zt){if(jt(At)){if(!nn(_e))throw new TypeError;if(!Vr($e))throw new TypeError;return k(_e,$e)}else{if(!nn(_e))throw new TypeError;if(!Zr($e))throw new TypeError;if(!Zr(Zt)&&!jt(Zt)&&!Or(Zt))throw new TypeError;return Or(Zt)&&(Zt=void 0),At=gn(At),ne(_e,$e,At,Zt)}}J("decorate",Ke);function xt(_e,$e){function At(Zt,er){if(!Zr(Zt))throw new TypeError;if(!jt(er)&&!fi(er))throw new TypeError;we(_e,$e,Zt,er)}return At}J("metadata",xt);function I(_e,$e,At,Zt){if(!Zr(At))throw new TypeError;return jt(Zt)||(Zt=gn(Zt)),we(_e,$e,At,Zt)}J("defineMetadata",I);function ht(_e,$e,At){if(!Zr($e))throw new TypeError;return jt(At)||(At=gn(At)),L(_e,$e,At)}J("hasMetadata",ht);function Fe(_e,$e,At){if(!Zr($e))throw new TypeError;return jt(At)||(At=gn(At)),b(_e,$e,At)}J("hasOwnMetadata",Fe);function ge(_e,$e,At){if(!Zr($e))throw new TypeError;return jt(At)||(At=gn(At)),de(_e,$e,At)}J("getMetadata",ge);function je(_e,$e,At){if(!Zr($e))throw new TypeError;return jt(At)||(At=gn(At)),Te(_e,$e,At)}J("getOwnMetadata",je);function Be(_e,$e){if(!Zr(_e))throw new TypeError;return jt($e)||($e=gn($e)),We(_e,$e)}J("getMetadataKeys",Be);function tt(_e,$e){if(!Zr(_e))throw new TypeError;return jt($e)||($e=gn($e)),St(_e,$e)}J("getOwnMetadataKeys",tt);function _t(_e,$e,At){if(!Zr($e))throw new TypeError;jt(At)||(At=gn(At));var Zt=P($e,At,!1);if(jt(Zt)||!Zt.delete(_e))return!1;if(Zt.size>0)return!0;var er=Ye.get($e);return er.delete(At),er.size>0||Ye.delete($e),!0}J("deleteMetadata",_t);function k(_e,$e){for(var At=_e.length-1;At>=0;--At){var Zt=_e[At],er=Zt($e);if(!jt(er)&&!Or(er)){if(!Vr(er))throw new TypeError;$e=er}}return $e}function ne(_e,$e,At,Zt){for(var er=_e.length-1;er>=0;--er){var lr=_e[er],Nr=lr($e,At,Zt);if(!jt(Nr)&&!Or(Nr)){if(!Zr(Nr))throw new TypeError;Zt=Nr}}return Zt}function P(_e,$e,At){var Zt=Ye.get(_e);if(jt(Zt)){if(!At)return;Zt=new Ge,Ye.set(_e,Zt)}var er=Zt.get($e);if(jt(er)){if(!At)return;er=new Ge,Zt.set($e,er)}return er}function L(_e,$e,At){var Zt=b(_e,$e,At);if(Zt)return!0;var er=$($e);return Or(er)?!1:L(_e,er,At)}function b(_e,$e,At){var Zt=P($e,At,!1);return jt(Zt)?!1:Fn(Zt.has(_e))}function de(_e,$e,At){var Zt=b(_e,$e,At);if(Zt)return Te(_e,$e,At);var er=$($e);if(!Or(er))return de(_e,er,At)}function Te(_e,$e,At){var Zt=P($e,At,!1);if(!jt(Zt))return Zt.get(_e)}function we(_e,$e,At,Zt){var er=P(At,Zt,!0);er.set(_e,$e)}function We(_e,$e){var At=St(_e,$e),Zt=$(_e);if(Zt===null)return At;var er=We(Zt,$e);if(er.length<=0)return At;if(At.length<=0)return er;for(var lr=new lt,Nr=[],Ir=0,cr=At;Ir<cr.length;Ir++){var Yr=cr[Ir],en=lr.has(Yr);en||(lr.add(Yr),Nr.push(Yr))}for(var Un=0,mi=er;Un<mi.length;Un++){var Yr=mi[Un],en=lr.has(Yr);en||(lr.add(Yr),Nr.push(Yr))}return Nr}function St(_e,$e){var At=[],Zt=P(_e,$e,!1);if(jt(Zt))return At;for(var er=Zt.keys(),lr=Zn(er),Nr=0;;){var Ir=V(lr);if(!Ir)return At.length=Nr,At;var cr=Ne(Ir);try{At[Nr]=cr}catch(Yr){try{Z(lr)}finally{throw Yr}}Nr++}}function ar(_e){if(_e===null)return 1;switch(typeof _e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return _e===null?1:6;default:return 6}}function jt(_e){return _e===void 0}function Or(_e){return _e===null}function Wr(_e){return typeof _e=="symbol"}function Zr(_e){return typeof _e=="object"?_e!==null:typeof _e=="function"}function pn(_e,$e){switch(ar(_e)){case 0:return _e;case 1:return _e;case 2:return _e;case 3:return _e;case 4:return _e;case 5:return _e}var At=$e===3?"string":$e===5?"number":"default",Zt=ti(_e,Y);if(Zt!==void 0){var er=Zt.call(_e,At);if(Zr(er))throw new TypeError;return er}return an(_e,At==="default"?"number":At)}function an(_e,$e){if($e==="string"){var At=_e.toString;if(Tr(At)){var Zt=At.call(_e);if(!Zr(Zt))return Zt}var er=_e.valueOf;if(Tr(er)){var Zt=er.call(_e);if(!Zr(Zt))return Zt}}else{var er=_e.valueOf;if(Tr(er)){var Zt=er.call(_e);if(!Zr(Zt))return Zt}var lr=_e.toString;if(Tr(lr)){var Zt=lr.call(_e);if(!Zr(Zt))return Zt}}throw new TypeError}function Fn(_e){return!!_e}function ln(_e){return""+_e}function gn(_e){var $e=pn(_e,3);return Wr($e)?$e:ln($e)}function nn(_e){return Array.isArray?Array.isArray(_e):_e instanceof Object?_e instanceof Array:Object.prototype.toString.call(_e)==="[object Array]"}function Tr(_e){return typeof _e=="function"}function Vr(_e){return typeof _e=="function"}function fi(_e){switch(ar(_e)){case 3:return!0;case 4:return!0;default:return!1}}function ti(_e,$e){var At=_e[$e];if(At!=null){if(!Tr(At))throw new TypeError;return At}}function Zn(_e){var $e=ti(_e,se);if(!Tr($e))throw new TypeError;var At=$e.call(_e);if(!Zr(At))throw new TypeError;return At}function Ne(_e){return _e.value}function V(_e){var $e=_e.next();return $e.done?!1:$e}function Z(_e){var $e=_e.return;$e&&$e.call(_e)}function $(_e){var $e=Object.getPrototypeOf(_e);if(typeof _e!="function"||_e===Ue||$e!==Ue)return $e;var At=_e.prototype,Zt=At&&Object.getPrototypeOf(At);if(Zt==null||Zt===Object.prototype)return $e;var er=Zt.constructor;return typeof er!="function"||er===_e?$e:er}function T(){var _e={},$e=[],At=function(){function Nr(Ir,cr,Yr){this._index=0,this._keys=Ir,this._values=cr,this._selector=Yr}return Nr.prototype["@@iterator"]=function(){return this},Nr.prototype[se]=function(){return this},Nr.prototype.next=function(){var Ir=this._index;if(Ir>=0&&Ir<this._keys.length){var cr=this._selector(this._keys[Ir],this._values[Ir]);return Ir+1>=this._keys.length?(this._index=-1,this._keys=$e,this._values=$e):this._index++,{value:cr,done:!1}}return{value:void 0,done:!0}},Nr.prototype.throw=function(Ir){throw this._index>=0&&(this._index=-1,this._keys=$e,this._values=$e),Ir},Nr.prototype.return=function(Ir){return this._index>=0&&(this._index=-1,this._keys=$e,this._values=$e),{value:Ir,done:!0}},Nr}();return function(){function Nr(){this._keys=[],this._values=[],this._cacheKey=_e,this._cacheIndex=-2}return Object.defineProperty(Nr.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Nr.prototype.has=function(Ir){return this._find(Ir,!1)>=0},Nr.prototype.get=function(Ir){var cr=this._find(Ir,!1);return cr>=0?this._values[cr]:void 0},Nr.prototype.set=function(Ir,cr){var Yr=this._find(Ir,!0);return this._values[Yr]=cr,this},Nr.prototype.delete=function(Ir){var cr=this._find(Ir,!1);if(cr>=0){for(var Yr=this._keys.length,en=cr+1;en<Yr;en++)this._keys[en-1]=this._keys[en],this._values[en-1]=this._values[en];return this._keys.length--,this._values.length--,Ir===this._cacheKey&&(this._cacheKey=_e,this._cacheIndex=-2),!0}return!1},Nr.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=_e,this._cacheIndex=-2},Nr.prototype.keys=function(){return new At(this._keys,this._values,Zt)},Nr.prototype.values=function(){return new At(this._keys,this._values,er)},Nr.prototype.entries=function(){return new At(this._keys,this._values,lr)},Nr.prototype["@@iterator"]=function(){return this.entries()},Nr.prototype[se]=function(){return this.entries()},Nr.prototype._find=function(Ir,cr){return this._cacheKey!==Ir&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Ir)),this._cacheIndex<0&&cr&&(this._cacheIndex=this._keys.length,this._keys.push(Ir),this._values.push(void 0)),this._cacheIndex},Nr}();function Zt(Nr,Ir){return Nr}function er(Nr,Ir){return Ir}function lr(Nr,Ir){return[Nr,Ir]}}function xe(){return function(){function _e(){this._map=new Ge}return Object.defineProperty(_e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),_e.prototype.has=function($e){return this._map.has($e)},_e.prototype.add=function($e){return this._map.set($e,$e),this},_e.prototype.delete=function($e){return this._map.delete($e)},_e.prototype.clear=function(){this._map.clear()},_e.prototype.keys=function(){return this._map.keys()},_e.prototype.values=function(){return this._map.values()},_e.prototype.entries=function(){return this._map.entries()},_e.prototype["@@iterator"]=function(){return this.keys()},_e.prototype[se]=function(){return this.keys()},_e}()}function vt(){var _e=16,$e=Oe.create(),At=Zt();return function(){function cr(){this._key=Zt()}return cr.prototype.has=function(Yr){var en=er(Yr,!1);return en!==void 0?Oe.has(en,this._key):!1},cr.prototype.get=function(Yr){var en=er(Yr,!1);return en!==void 0?Oe.get(en,this._key):void 0},cr.prototype.set=function(Yr,en){var Un=er(Yr,!0);return Un[this._key]=en,this},cr.prototype.delete=function(Yr){var en=er(Yr,!1);return en!==void 0?delete en[this._key]:!1},cr.prototype.clear=function(){this._key=Zt()},cr}();function Zt(){var cr;do cr="@@WeakMap@@"+Ir();while(Oe.has($e,cr));return $e[cr]=!0,cr}function er(cr,Yr){if(!U.call(cr,At)){if(!Yr)return;Object.defineProperty(cr,At,{value:Oe.create()})}return cr[At]}function lr(cr,Yr){for(var en=0;en<Yr;++en)cr[en]=Math.random()*255|0;return cr}function Nr(cr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(cr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(cr)):lr(new Uint8Array(cr),cr):lr(new Array(cr),cr)}function Ir(){var cr=Nr(_e);cr[6]=cr[6]&79|64,cr[8]=cr[8]&191|128;for(var Yr="",en=0;en<_e;++en){var Un=cr[en];(en===4||en===6||en===8)&&(Yr+="-"),Un<16&&(Yr+="0"),Yr+=Un.toString(16).toLowerCase()}return Yr}}function Gt(_e){return _e.__=void 0,delete _e.__,_e}})})(E||(E={}))},69848:function(rr){(function(G,D){rr.exports=D()})(this,function(){"use strict";function G(Fe,ge,je,Be,tt,_t){if(!(tt-Be<=je)){var k=Be+tt>>1;D(Fe,ge,k,Be,tt,_t%2),G(Fe,ge,je,Be,k-1,_t+1),G(Fe,ge,je,k+1,tt,_t+1)}}function D(Fe,ge,je,Be,tt,_t){for(;tt>Be;){if(tt-Be>600){var k=tt-Be+1,ne=je-Be+1,P=Math.log(k),L=.5*Math.exp(2*P/3),b=.5*Math.sqrt(P*L*(k-L)/k)*(ne-k/2<0?-1:1),de=Math.max(Be,Math.floor(je-ne*L/k+b)),Te=Math.min(tt,Math.floor(je+(k-ne)*L/k+b));D(Fe,ge,je,de,Te,_t)}var we=ge[2*je+_t],We=Be,St=tt;for(oe(Fe,ge,Be,je),ge[2*tt+_t]>we&&oe(Fe,ge,Be,tt);We<St;){for(oe(Fe,ge,We,St),We++,St--;ge[2*We+_t]<we;)We++;for(;ge[2*St+_t]>we;)St--}ge[2*Be+_t]===we?oe(Fe,ge,Be,St):(St++,oe(Fe,ge,St,tt)),St<=je&&(Be=St+1),je<=St&&(tt=St-1)}}function oe(Fe,ge,je,Be){E(Fe,je,Be),E(ge,2*je,2*Be),E(ge,2*je+1,2*Be+1)}function E(Fe,ge,je){var Be=Fe[ge];Fe[ge]=Fe[je],Fe[je]=Be}function ce(Fe,ge,je,Be,tt,_t,k){for(var ne=[0,Fe.length-1,0],P=[],L,b;ne.length;){var de=ne.pop(),Te=ne.pop(),we=ne.pop();if(Te-we<=k){for(var We=we;We<=Te;We++)L=ge[2*We],b=ge[2*We+1],L>=je&&L<=tt&&b>=Be&&b<=_t&&P.push(Fe[We]);continue}var St=Math.floor((we+Te)/2);L=ge[2*St],b=ge[2*St+1],L>=je&&L<=tt&&b>=Be&&b<=_t&&P.push(Fe[St]);var ar=(de+1)%2;(de===0?je<=L:Be<=b)&&(ne.push(we),ne.push(St-1),ne.push(ar)),(de===0?tt>=L:_t>=b)&&(ne.push(St+1),ne.push(Te),ne.push(ar))}return P}function J(Fe,ge,je,Be,tt,_t){for(var k=[0,Fe.length-1,0],ne=[],P=tt*tt;k.length;){var L=k.pop(),b=k.pop(),de=k.pop();if(b-de<=_t){for(var Te=de;Te<=b;Te++)U(ge[2*Te],ge[2*Te+1],je,Be)<=P&&ne.push(Fe[Te]);continue}var we=Math.floor((de+b)/2),We=ge[2*we],St=ge[2*we+1];U(We,St,je,Be)<=P&&ne.push(Fe[we]);var ar=(L+1)%2;(L===0?je-tt<=We:Be-tt<=St)&&(k.push(de),k.push(we-1),k.push(ar)),(L===0?je+tt>=We:Be+tt>=St)&&(k.push(we+1),k.push(b),k.push(ar))}return ne}function U(Fe,ge,je,Be){var tt=Fe-je,_t=ge-Be;return tt*tt+_t*_t}var re=function(Fe){return Fe[0]},Y=function(Fe){return Fe[1]},se=function(ge,je,Be,tt,_t){je===void 0&&(je=re),Be===void 0&&(Be=Y),tt===void 0&&(tt=64),_t===void 0&&(_t=Float64Array),this.nodeSize=tt,this.points=ge;for(var k=ge.length<65536?Uint16Array:Uint32Array,ne=this.ids=new k(ge.length),P=this.coords=new _t(ge.length*2),L=0;L<ge.length;L++)ne[L]=L,P[2*L]=je(ge[L]),P[2*L+1]=Be(ge[L]);G(ne,P,tt,0,ne.length-1,0)};se.prototype.range=function(ge,je,Be,tt){return ce(this.ids,this.coords,ge,je,Be,tt,this.nodeSize)},se.prototype.within=function(ge,je,Be){return J(this.ids,this.coords,ge,je,Be,this.nodeSize)};var le={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Fe){return Fe}},ye=Math.fround||function(Fe){return function(ge){return Fe[0]=+ge,Fe[0]}}(new Float32Array(1)),Ce=function(ge){this.options=xt(Object.create(le),ge),this.trees=new Array(this.options.maxZoom+1)};Ce.prototype.load=function(ge){var je=this.options,Be=je.log,tt=je.minZoom,_t=je.maxZoom,k=je.nodeSize;Be&&console.time("total time");var ne="prepare "+ge.length+" points";Be&&console.time(ne),this.points=ge;for(var P=[],L=0;L<ge.length;L++)!ge[L].geometry||P.push(Ue(ge[L],L));this.trees[_t+1]=new se(P,I,ht,k,Float32Array),Be&&console.timeEnd(ne);for(var b=_t;b>=tt;b--){var de=+Date.now();P=this._cluster(P,b),this.trees[b]=new se(P,I,ht,k,Float32Array),Be&&console.log("z%d: %d clusters in %dms",b,P.length,+Date.now()-de)}return Be&&console.timeEnd("total time"),this},Ce.prototype.getClusters=function(ge,je){var Be=((ge[0]+180)%360+360)%360-180,tt=Math.max(-90,Math.min(90,ge[1])),_t=ge[2]===180?180:((ge[2]+180)%360+360)%360-180,k=Math.max(-90,Math.min(90,ge[3]));if(ge[2]-ge[0]>=360)Be=-180,_t=180;else if(Be>_t){var ne=this.getClusters([Be,tt,180,k],je),P=this.getClusters([-180,tt,_t,k],je);return ne.concat(P)}for(var L=this.trees[this._limitZoom(je)],b=L.range(lt(Be),Je(k),lt(_t),Je(tt)),de=[],Te=0,we=b;Te<we.length;Te+=1){var We=we[Te],St=L.points[We];de.push(St.numPoints?pt(St):this.points[St.index])}return de},Ce.prototype.getChildren=function(ge){var je=this._getOriginId(ge),Be=this._getOriginZoom(ge),tt="No cluster with the specified id.",_t=this.trees[Be];if(!_t)throw new Error(tt);var k=_t.points[je];if(!k)throw new Error(tt);for(var ne=this.options.radius/(this.options.extent*Math.pow(2,Be-1)),P=_t.within(k.x,k.y,ne),L=[],b=0,de=P;b<de.length;b+=1){var Te=de[b],we=_t.points[Te];we.parentId===ge&&L.push(we.numPoints?pt(we):this.points[we.index])}if(L.length===0)throw new Error(tt);return L},Ce.prototype.getLeaves=function(ge,je,Be){je=je||10,Be=Be||0;var tt=[];return this._appendLeaves(tt,ge,je,Be,0),tt},Ce.prototype.getTile=function(ge,je,Be){var tt=this.trees[this._limitZoom(ge)],_t=Math.pow(2,ge),k=this.options,ne=k.extent,P=k.radius,L=P/ne,b=(Be-L)/_t,de=(Be+1+L)/_t,Te={features:[]};return this._addTileFeatures(tt.range((je-L)/_t,b,(je+1+L)/_t,de),tt.points,je,Be,_t,Te),je===0&&this._addTileFeatures(tt.range(1-L/_t,b,1,de),tt.points,_t,Be,_t,Te),je===_t-1&&this._addTileFeatures(tt.range(0,b,L/_t,de),tt.points,-1,Be,_t,Te),Te.features.length?Te:null},Ce.prototype.getClusterExpansionZoom=function(ge){for(var je=this._getOriginZoom(ge)-1;je<=this.options.maxZoom;){var Be=this.getChildren(ge);if(je++,Be.length!==1)break;ge=Be[0].properties.cluster_id}return je},Ce.prototype._appendLeaves=function(ge,je,Be,tt,_t){for(var k=this.getChildren(je),ne=0,P=k;ne<P.length;ne+=1){var L=P[ne],b=L.properties;if(b&&b.cluster?_t+b.point_count<=tt?_t+=b.point_count:_t=this._appendLeaves(ge,b.cluster_id,Be,tt,_t):_t<tt?_t++:ge.push(L),ge.length===Be)break}return _t},Ce.prototype._addTileFeatures=function(ge,je,Be,tt,_t,k){for(var ne=0,P=ge;ne<P.length;ne+=1){var L=P[ne],b=je[L],de=b.numPoints,Te=void 0,we=void 0,We=void 0;if(de)Te=Ge(b),we=b.x,We=b.y;else{var St=this.points[b.index];Te=St.properties,we=lt(St.geometry.coordinates[0]),We=Je(St.geometry.coordinates[1])}var ar={type:1,geometry:[[Math.round(this.options.extent*(we*_t-Be)),Math.round(this.options.extent*(We*_t-tt))]],tags:Te},jt=void 0;de?jt=b.id:this.options.generateId?jt=b.index:this.points[b.index].id&&(jt=this.points[b.index].id),jt!==void 0&&(ar.id=jt),k.features.push(ar)}},Ce.prototype._limitZoom=function(ge){return Math.max(this.options.minZoom,Math.min(Math.floor(+ge),this.options.maxZoom+1))},Ce.prototype._cluster=function(ge,je){for(var Be=[],tt=this.options,_t=tt.radius,k=tt.extent,ne=tt.reduce,P=tt.minPoints,L=_t/(k*Math.pow(2,je)),b=0;b<ge.length;b++){var de=ge[b];if(!(de.zoom<=je)){de.zoom=je;for(var Te=this.trees[je+1],we=Te.within(de.x,de.y,L),We=de.numPoints||1,St=We,ar=0,jt=we;ar<jt.length;ar+=1){var Or=jt[ar],Wr=Te.points[Or];Wr.zoom>je&&(St+=Wr.numPoints||1)}if(St>We&&St>=P){for(var Zr=de.x*We,pn=de.y*We,an=ne&&We>1?this._map(de,!0):null,Fn=(b<<5)+(je+1)+this.points.length,ln=0,gn=we;ln<gn.length;ln+=1){var nn=gn[ln],Tr=Te.points[nn];if(!(Tr.zoom<=je)){Tr.zoom=je;var Vr=Tr.numPoints||1;Zr+=Tr.x*Vr,pn+=Tr.y*Vr,Tr.parentId=Fn,ne&&(an||(an=this._map(de,!0)),ne(an,this._map(Tr)))}}de.parentId=Fn,Be.push(Oe(Zr/St,pn/St,Fn,St,an))}else if(Be.push(de),St>1)for(var fi=0,ti=we;fi<ti.length;fi+=1){var Zn=ti[fi],Ne=Te.points[Zn];Ne.zoom<=je||(Ne.zoom=je,Be.push(Ne))}}}return Be},Ce.prototype._getOriginId=function(ge){return ge-this.points.length>>5},Ce.prototype._getOriginZoom=function(ge){return(ge-this.points.length)%32},Ce.prototype._map=function(ge,je){if(ge.numPoints)return je?xt({},ge.properties):ge.properties;var Be=this.points[ge.index].properties,tt=this.options.map(Be);return je&&tt===Be?xt({},tt):tt};function Oe(Fe,ge,je,Be,tt){return{x:ye(Fe),y:ye(ge),zoom:Infinity,id:je,parentId:-1,numPoints:Be,properties:tt}}function Ue(Fe,ge){var je=Fe.geometry.coordinates,Be=je[0],tt=je[1];return{x:ye(lt(Be)),y:ye(Je(tt)),zoom:Infinity,index:ge,parentId:-1}}function pt(Fe){return{type:"Feature",id:Fe.id,properties:Ge(Fe),geometry:{type:"Point",coordinates:[Ye(Fe.x),Ke(Fe.y)]}}}function Ge(Fe){var ge=Fe.numPoints,je=ge>=1e4?Math.round(ge/1e3)+"k":ge>=1e3?Math.round(ge/100)/10+"k":ge;return xt(xt({},Fe.properties),{cluster:!0,cluster_id:Fe.id,point_count:ge,point_count_abbreviated:je})}function lt(Fe){return Fe/360+.5}function Je(Fe){var ge=Math.sin(Fe*Math.PI/180),je=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return je<0?0:je>1?1:je}function Ye(Fe){return(Fe-.5)*360}function Ke(Fe){var ge=(180-Fe*360)*Math.PI/180;return 360*Math.atan(Math.exp(ge))/Math.PI-90}function xt(Fe,ge){for(var je in ge)Fe[je]=ge[je];return Fe}function I(Fe){return Fe.x}function ht(Fe){return Fe.y}return Ce})}}]);
